<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SSAGES: SSAGES::CFF Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SSAGES
   &#160;<span id="projectnumber">0.9.0</span>
   </div>
   <div id="projectbrief">Software Suite for Advanced General Ensemble Simulations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceSSAGES.html">SSAGES</a></li><li class="navelem"><a class="el" href="classSSAGES_1_1CFF.html">CFF</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classSSAGES_1_1CFF-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">SSAGES::CFF Class Reference<div class="ingroups"><a class="el" href="group__Methods.html">Methods</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Combined Force Frequency (<a class="el" href="classSSAGES_1_1CFF.html" title="Combined Force Frequency (CFF) Algorithm.">CFF</a>) Algorithm.  
 <a href="classSSAGES_1_1CFF.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="CFF_8h_source.html">CFF.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for SSAGES::CFF:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1CFF__inherit__graph.png" border="0" usemap="#SSAGES_1_1CFF_inherit__map" alt="Inheritance graph"/></div>
<map name="SSAGES_1_1CFF_inherit__map" id="SSAGES_1_1CFF_inherit__map">
<area shape="rect" title="Combined Force Frequency (CFF) Algorithm." alt="" coords="33,155,143,181"/>
<area shape="rect" href="classSSAGES_1_1Method.html" title="Interface for Method implementations." alt="" coords="24,80,152,107"/>
<area shape="rect" href="classSSAGES_1_1EventListener.html" title="Base abstract class for listening in to events fired by &quot;Hook&quot;." alt="" coords="5,5,171,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aab3150942788dfe58e4ab5c9e1ceb24b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#aab3150942788dfe58e4ab5c9e1ceb24b">CFF</a> (const MPI_Comm &amp;world, const MPI_Comm &amp;comm, const Eigen::VectorXi &amp;topol, <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; Eigen::VectorXd &gt; *fgrid, <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; unsigned int &gt; *hgrid, <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; *ugrid, std::vector&lt; <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; * &gt; F, std::vector&lt; <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; * &gt; Fworld, const std::vector&lt; double &gt; &amp;lowerb, const std::vector&lt; double &gt; &amp;upperb, const std::vector&lt; double &gt; &amp;lowerk, const std::vector&lt; double &gt; &amp;upperk, double temperature, double unitconv, double timestep, double weight, unsigned int nsweep, int min)</td></tr>
<tr class="memdesc:aab3150942788dfe58e4ab5c9e1ceb24b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classSSAGES_1_1CFF.html#aab3150942788dfe58e4ab5c9e1ceb24b">More...</a><br /></td></tr>
<tr class="separator:aab3150942788dfe58e4ab5c9e1ceb24b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad51094624daa5d1a27a75e7c15dce24a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#ad51094624daa5d1a27a75e7c15dce24a">PreSimulation</a> (<a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *snapshot, const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;cvmanager) override</td></tr>
<tr class="memdesc:ad51094624daa5d1a27a75e7c15dce24a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations.">Method</a> call prior to simulation initiation.  <a href="classSSAGES_1_1CFF.html#ad51094624daa5d1a27a75e7c15dce24a">More...</a><br /></td></tr>
<tr class="separator:ad51094624daa5d1a27a75e7c15dce24a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9f74c2ba9de08954e95678e0cb9ce46"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#ab9f74c2ba9de08954e95678e0cb9ce46">PostIntegration</a> (<a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *snapshot, const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;cvmanager) override</td></tr>
<tr class="memdesc:ab9f74c2ba9de08954e95678e0cb9ce46"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations.">Method</a> call post integration.  <a href="classSSAGES_1_1CFF.html#ab9f74c2ba9de08954e95678e0cb9ce46">More...</a><br /></td></tr>
<tr class="separator:ab9f74c2ba9de08954e95678e0cb9ce46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5912cbccb7be5d75ce666eefd4d1789"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#ae5912cbccb7be5d75ce666eefd4d1789">PostSimulation</a> (<a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *snapshot, const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;cvmanager) override</td></tr>
<tr class="memdesc:ae5912cbccb7be5d75ce666eefd4d1789"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations.">Method</a> call post simulation.  <a href="classSSAGES_1_1CFF.html#ae5912cbccb7be5d75ce666eefd4d1789">More...</a><br /></td></tr>
<tr class="separator:ae5912cbccb7be5d75ce666eefd4d1789"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a473e787f70a289e85a93e32830ae6d"><td class="memItemLeft" align="right" valign="top"><a id="a6a473e787f70a289e85a93e32830ae6d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a6a473e787f70a289e85a93e32830ae6d">SetPrevWeight</a> (double h)</td></tr>
<tr class="memdesc:a6a473e787f70a289e85a93e32830ae6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set previous history weight. <br /></td></tr>
<tr class="separator:a6a473e787f70a289e85a93e32830ae6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af985eac0f74a2927951eec898c1be019"><td class="memItemLeft" align="right" valign="top"><a id="af985eac0f74a2927951eec898c1be019"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#af985eac0f74a2927951eec898c1be019">SetOutput</a> (const std::string &amp;outfile)</td></tr>
<tr class="memdesc:af985eac0f74a2927951eec898c1be019"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set name of output file. <br /></td></tr>
<tr class="separator:af985eac0f74a2927951eec898c1be019"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb62fa3cf053a7e44bf3b12c5d777439"><td class="memItemLeft" align="right" valign="top"><a id="aeb62fa3cf053a7e44bf3b12c5d777439"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#aeb62fa3cf053a7e44bf3b12c5d777439">SetOutputOverwrite</a> (bool overwrite)</td></tr>
<tr class="memdesc:aeb62fa3cf053a7e44bf3b12c5d777439"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set overwrite flag on output file. <br /></td></tr>
<tr class="separator:aeb62fa3cf053a7e44bf3b12c5d777439"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44d6de9f24b2386dce75eda6142d38bb"><td class="memItemLeft" align="right" valign="top"><a id="a44d6de9f24b2386dce75eda6142d38bb"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a44d6de9f24b2386dce75eda6142d38bb">SetConvergeIters</a> (unsigned int citers)</td></tr>
<tr class="memdesc:a44d6de9f24b2386dce75eda6142d38bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set number of iterations after which we turn on full weight. <br /></td></tr>
<tr class="separator:a44d6de9f24b2386dce75eda6142d38bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8d371aa3b39dd2109217db0f5117660"><td class="memItemLeft" align="right" valign="top"><a id="aa8d371aa3b39dd2109217db0f5117660"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#aa8d371aa3b39dd2109217db0f5117660">SetMaxIters</a> (unsigned int iters)</td></tr>
<tr class="memdesc:aa8d371aa3b39dd2109217db0f5117660"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set maximum number of training iterations per sweep. <br /></td></tr>
<tr class="separator:aa8d371aa3b39dd2109217db0f5117660"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60ad9c6535b0e4dc1ffd709e0537767f"><td class="memItemLeft" align="right" valign="top"><a id="a60ad9c6535b0e4dc1ffd709e0537767f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a60ad9c6535b0e4dc1ffd709e0537767f">SetMinLoss</a> (double loss)</td></tr>
<tr class="memdesc:a60ad9c6535b0e4dc1ffd709e0537767f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set minimum loss function value (should be zero for production). <br /></td></tr>
<tr class="separator:a60ad9c6535b0e4dc1ffd709e0537767f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16fca1165c46e1c5ad987fc0ed902098"><td class="memItemLeft" align="right" valign="top"><a id="a16fca1165c46e1c5ad987fc0ed902098"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a16fca1165c46e1c5ad987fc0ed902098">SetRatio</a> (double trainratio)</td></tr>
<tr class="memdesc:a16fca1165c46e1c5ad987fc0ed902098"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set training ratio for gradient vs value. <br /></td></tr>
<tr class="separator:a16fca1165c46e1c5ad987fc0ed902098"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ca11f41570c830ffab180d9aa8173d7"><td class="memItemLeft" align="right" valign="top"><a id="a4ca11f41570c830ffab180d9aa8173d7"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a4ca11f41570c830ffab180d9aa8173d7">~CFF</a> ()</td></tr>
<tr class="memdesc:a4ca11f41570c830ffab180d9aa8173d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:a4ca11f41570c830ffab180d9aa8173d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classSSAGES_1_1Method"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classSSAGES_1_1Method')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classSSAGES_1_1Method.html">SSAGES::Method</a></td></tr>
<tr class="memitem:ad751450ecd30e8ab40024c6f5e870d30 inherit pub_methods_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#ad751450ecd30e8ab40024c6f5e870d30">Method</a> (unsigned int frequency, const MPI_Comm &amp;world, const MPI_Comm &amp;comm)</td></tr>
<tr class="memdesc:ad751450ecd30e8ab40024c6f5e870d30 inherit pub_methods_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classSSAGES_1_1Method.html#ad751450ecd30e8ab40024c6f5e870d30">More...</a><br /></td></tr>
<tr class="separator:ad751450ecd30e8ab40024c6f5e870d30 inherit pub_methods_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a701c90bfcddeb2099b78528fea850c07 inherit pub_methods_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a701c90bfcddeb2099b78528fea850c07">SetCVMask</a> (const std::vector&lt; unsigned int &gt; &amp;mask)</td></tr>
<tr class="memdesc:a701c90bfcddeb2099b78528fea850c07 inherit pub_methods_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the collective variable mask.  <a href="classSSAGES_1_1Method.html#a701c90bfcddeb2099b78528fea850c07">More...</a><br /></td></tr>
<tr class="separator:a701c90bfcddeb2099b78528fea850c07 inherit pub_methods_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86b979a552970f63a8edf160387f6ff9 inherit pub_methods_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top"><a id="a86b979a552970f63a8edf160387f6ff9"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a86b979a552970f63a8edf160387f6ff9">~Method</a> ()</td></tr>
<tr class="memdesc:a86b979a552970f63a8edf160387f6ff9 inherit pub_methods_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:a86b979a552970f63a8edf160387f6ff9 inherit pub_methods_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classSSAGES_1_1EventListener"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classSSAGES_1_1EventListener')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classSSAGES_1_1EventListener.html">SSAGES::EventListener</a></td></tr>
<tr class="memitem:a4a4d51653806e0348e9d1c99890bb87b inherit pub_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#a4a4d51653806e0348e9d1c99890bb87b">EventListener</a> (unsigned int frequency)</td></tr>
<tr class="memdesc:a4a4d51653806e0348e9d1c99890bb87b inherit pub_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classSSAGES_1_1EventListener.html#a4a4d51653806e0348e9d1c99890bb87b">More...</a><br /></td></tr>
<tr class="separator:a4a4d51653806e0348e9d1c99890bb87b inherit pub_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82dd6716f443cd24451e7355c2353614 inherit pub_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#a82dd6716f443cd24451e7355c2353614">GetFrequency</a> () const</td></tr>
<tr class="memdesc:a82dd6716f443cd24451e7355c2353614 inherit pub_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get frequency of event listener.  <a href="classSSAGES_1_1EventListener.html#a82dd6716f443cd24451e7355c2353614">More...</a><br /></td></tr>
<tr class="separator:a82dd6716f443cd24451e7355c2353614 inherit pub_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cadffb0e82186a12023dd5963c3c5b1 inherit pub_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top"><a id="a7cadffb0e82186a12023dd5963c3c5b1"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#a7cadffb0e82186a12023dd5963c3c5b1">~EventListener</a> ()</td></tr>
<tr class="memdesc:a7cadffb0e82186a12023dd5963c3c5b1 inherit pub_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:a7cadffb0e82186a12023dd5963c3c5b1 inherit pub_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a6ef7a9444289638816b44c2acee1bd68"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSSAGES_1_1CFF.html">CFF</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a6ef7a9444289638816b44c2acee1bd68">Build</a> (const Json::Value &amp;json, const MPI_Comm &amp;world, const MPI_Comm &amp;comm, const std::string &amp;path)</td></tr>
<tr class="memdesc:a6ef7a9444289638816b44c2acee1bd68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build a derived method from <a class="el" href="namespaceJSON.html">JSON</a> node.  <a href="classSSAGES_1_1CFF.html#a6ef7a9444289638816b44c2acee1bd68">More...</a><br /></td></tr>
<tr class="separator:a6ef7a9444289638816b44c2acee1bd68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_classSSAGES_1_1Method"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classSSAGES_1_1Method')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classSSAGES_1_1Method.html">SSAGES::Method</a></td></tr>
<tr class="memitem:a1464579bb8b15653ccd0ffa834e15e93 inherit pub_static_methods_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSSAGES_1_1Method.html">Method</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a1464579bb8b15653ccd0ffa834e15e93">BuildMethod</a> (const Json::Value &amp;json, const MPI_Comm &amp;world, const MPI_Comm &amp;comm, const std::string &amp;path)</td></tr>
<tr class="memdesc:a1464579bb8b15653ccd0ffa834e15e93 inherit pub_static_methods_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build a derived method from <a class="el" href="namespaceJSON.html">JSON</a> node.  <a href="classSSAGES_1_1Method.html#a1464579bb8b15653ccd0ffa834e15e93">More...</a><br /></td></tr>
<tr class="separator:a1464579bb8b15653ccd0ffa834e15e93 inherit pub_static_methods_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_classSSAGES_1_1EventListener"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classSSAGES_1_1EventListener')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classSSAGES_1_1EventListener.html">SSAGES::EventListener</a></td></tr>
<tr class="memitem:affe4b9179e312192ba364d44f0638874 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top">static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#affe4b9179e312192ba364d44f0638874">GetWalkerID</a> (const MPI_Comm &amp;world, const MPI_Comm &amp;comm)</td></tr>
<tr class="memdesc:affe4b9179e312192ba364d44f0638874 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get walker ID number of specified communicator.  <a href="classSSAGES_1_1EventListener.html#affe4b9179e312192ba364d44f0638874">More...</a><br /></td></tr>
<tr class="separator:affe4b9179e312192ba364d44f0638874 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a917f9526b9adfa66166eafb5b9b34d54 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top">static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#a917f9526b9adfa66166eafb5b9b34d54">GetNumWalkers</a> (const MPI_Comm &amp;world, const MPI_Comm &amp;comm)</td></tr>
<tr class="memdesc:a917f9526b9adfa66166eafb5b9b34d54 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get total number of walkers in the simulation.  <a href="classSSAGES_1_1EventListener.html#a917f9526b9adfa66166eafb5b9b34d54">More...</a><br /></td></tr>
<tr class="separator:a917f9526b9adfa66166eafb5b9b34d54 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9666daacfb047c1dd279ea339524d07 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#af9666daacfb047c1dd279ea339524d07">IsMasterRank</a> (const MPI_Comm &amp;comm)</td></tr>
<tr class="memdesc:af9666daacfb047c1dd279ea339524d07 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if current processor is master.  <a href="classSSAGES_1_1EventListener.html#af9666daacfb047c1dd279ea339524d07">More...</a><br /></td></tr>
<tr class="separator:af9666daacfb047c1dd279ea339524d07 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ae71f141f144ada85ab9ffdec8a2acdb2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#ae71f141f144ada85ab9ffdec8a2acdb2">TrainNetwork</a> ()</td></tr>
<tr class="memdesc:ae71f141f144ada85ab9ffdec8a2acdb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trains the neural network.  <a href="classSSAGES_1_1CFF.html#ae71f141f144ada85ab9ffdec8a2acdb2">More...</a><br /></td></tr>
<tr class="separator:ae71f141f144ada85ab9ffdec8a2acdb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbbfe00f423669ebe4b02abca581d4ff"><td class="memItemLeft" align="right" valign="top"><a id="abbbfe00f423669ebe4b02abca581d4ff"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#abbbfe00f423669ebe4b02abca581d4ff">WriteBias</a> ()</td></tr>
<tr class="memdesc:abbbfe00f423669ebe4b02abca581d4ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes out the bias and <a class="el" href="classSSAGES_1_1CFF.html" title="Combined Force Frequency (CFF) Algorithm.">CFF</a> output files. <br /></td></tr>
<tr class="separator:abbbfe00f423669ebe4b02abca581d4ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a5ae96842cc6a3c907da11d12de90b79f"><td class="memItemLeft" align="right" valign="top"><a id="a5ae96842cc6a3c907da11d12de90b79f"></a>
Eigen::VectorXi&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a5ae96842cc6a3c907da11d12de90b79f">topol_</a></td></tr>
<tr class="memdesc:a5ae96842cc6a3c907da11d12de90b79f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Neural network topology. <br /></td></tr>
<tr class="separator:a5ae96842cc6a3c907da11d12de90b79f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a341c64332f5ff6ba3cdc6442e5406ed4"><td class="memItemLeft" align="right" valign="top"><a id="a341c64332f5ff6ba3cdc6442e5406ed4"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a341c64332f5ff6ba3cdc6442e5406ed4">sweep_</a></td></tr>
<tr class="memdesc:a341c64332f5ff6ba3cdc6442e5406ed4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of iterations per sweep. <br /></td></tr>
<tr class="separator:a341c64332f5ff6ba3cdc6442e5406ed4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c8c7d3afd6053ff3cdd59cbef7b78fe"><td class="memItemLeft" align="right" valign="top"><a id="a3c8c7d3afd6053ff3cdd59cbef7b78fe"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><b>nsweep_</b></td></tr>
<tr class="separator:a3c8c7d3afd6053ff3cdd59cbef7b78fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15b0b7d29205cc4d1645612c6f8ffbba"><td class="memItemLeft" align="right" valign="top"><a id="a15b0b7d29205cc4d1645612c6f8ffbba"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a15b0b7d29205cc4d1645612c6f8ffbba">citers_</a></td></tr>
<tr class="memdesc:a15b0b7d29205cc4d1645612c6f8ffbba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of iterations after which we turn on full weight. <br /></td></tr>
<tr class="separator:a15b0b7d29205cc4d1645612c6f8ffbba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25f6bcb7fb67d5b6ed22c0bff9861386"><td class="memItemLeft" align="right" valign="top"><a id="a25f6bcb7fb67d5b6ed22c0bff9861386"></a>
nnet::neural_net&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a25f6bcb7fb67d5b6ed22c0bff9861386">net_</a></td></tr>
<tr class="memdesc:a25f6bcb7fb67d5b6ed22c0bff9861386"><td class="mdescLeft">&#160;</td><td class="mdescRight">Neural network trained using visit frequency. <br /></td></tr>
<tr class="separator:a25f6bcb7fb67d5b6ed22c0bff9861386"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63b71ad4ad5f00e274f9b7412c374d8c"><td class="memItemLeft" align="right" valign="top"><a id="a63b71ad4ad5f00e274f9b7412c374d8c"></a>
nnet::neural_net&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a63b71ad4ad5f00e274f9b7412c374d8c">net2_</a></td></tr>
<tr class="memdesc:a63b71ad4ad5f00e274f9b7412c374d8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Neural network trained on both visit frequency and force. <br /></td></tr>
<tr class="separator:a63b71ad4ad5f00e274f9b7412c374d8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57e61481b774bf1a12c0aba8ad4e9064"><td class="memItemLeft" align="right" valign="top"><a id="a57e61481b774bf1a12c0aba8ad4e9064"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a57e61481b774bf1a12c0aba8ad4e9064">timestep_</a></td></tr>
<tr class="memdesc:a57e61481b774bf1a12c0aba8ad4e9064"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timestep. <br /></td></tr>
<tr class="separator:a57e61481b774bf1a12c0aba8ad4e9064"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf57efee95f11623cccb4ddb99e4b39c"><td class="memItemLeft" align="right" valign="top"><a id="aaf57efee95f11623cccb4ddb99e4b39c"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#aaf57efee95f11623cccb4ddb99e4b39c">pweight_</a></td></tr>
<tr class="memdesc:aaf57efee95f11623cccb4ddb99e4b39c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Previous and current histogram weight. <br /></td></tr>
<tr class="separator:aaf57efee95f11623cccb4ddb99e4b39c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5b4ea52fadfa757375e8fa9bec0e699"><td class="memItemLeft" align="right" valign="top"><a id="ae5b4ea52fadfa757375e8fa9bec0e699"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>weight_</b></td></tr>
<tr class="separator:ae5b4ea52fadfa757375e8fa9bec0e699"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4acd48bf29d688abab039d9ad07bca05"><td class="memItemLeft" align="right" valign="top"><a id="a4acd48bf29d688abab039d9ad07bca05"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a4acd48bf29d688abab039d9ad07bca05">temp_</a></td></tr>
<tr class="memdesc:a4acd48bf29d688abab039d9ad07bca05"><td class="mdescLeft">&#160;</td><td class="mdescRight">System temperature and energy units. <br /></td></tr>
<tr class="separator:a4acd48bf29d688abab039d9ad07bca05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73ca89782c356cac1b85359b5a39becc"><td class="memItemLeft" align="right" valign="top"><a id="a73ca89782c356cac1b85359b5a39becc"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>kbt_</b></td></tr>
<tr class="separator:a73ca89782c356cac1b85359b5a39becc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae40a6c617732bc0bf260dbaba5b62330"><td class="memItemLeft" align="right" valign="top"><a id="ae40a6c617732bc0bf260dbaba5b62330"></a>
std::vector&lt; <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#ae40a6c617732bc0bf260dbaba5b62330">F_</a></td></tr>
<tr class="memdesc:ae40a6c617732bc0bf260dbaba5b62330"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generalized force grid that stores total of the local walker. <br /></td></tr>
<tr class="separator:ae40a6c617732bc0bf260dbaba5b62330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a885e158d5d31846a427f3ee3c1ecfccc"><td class="memItemLeft" align="right" valign="top"><a id="a885e158d5d31846a427f3ee3c1ecfccc"></a>
std::vector&lt; <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a885e158d5d31846a427f3ee3c1ecfccc">Fworld_</a></td></tr>
<tr class="memdesc:a885e158d5d31846a427f3ee3c1ecfccc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generalized force grid that stors the global total. <br /></td></tr>
<tr class="separator:a885e158d5d31846a427f3ee3c1ecfccc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a857edf66ca0e8f468bcc93a761a10984"><td class="memItemLeft" align="right" valign="top"><a id="a857edf66ca0e8f468bcc93a761a10984"></a>
Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a857edf66ca0e8f468bcc93a761a10984">Fold_</a></td></tr>
<tr class="memdesc:a857edf66ca0e8f468bcc93a761a10984"><td class="mdescLeft">&#160;</td><td class="mdescRight">To hold the last iterations F_ value for removing bias. <br /></td></tr>
<tr class="separator:a857edf66ca0e8f468bcc93a761a10984"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4472f7ce0b907d88bff353deb2d9a00"><td class="memItemLeft" align="right" valign="top"><a id="af4472f7ce0b907d88bff353deb2d9a00"></a>
Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#af4472f7ce0b907d88bff353deb2d9a00">wdotp1_</a></td></tr>
<tr class="memdesc:af4472f7ce0b907d88bff353deb2d9a00"><td class="mdescLeft">&#160;</td><td class="mdescRight">To hold last iteration wdotp value for numerical derivative. <br /></td></tr>
<tr class="separator:af4472f7ce0b907d88bff353deb2d9a00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa39ac519b1d4c33a22f98ff75ce8da02"><td class="memItemLeft" align="right" valign="top"><a id="aa39ac519b1d4c33a22f98ff75ce8da02"></a>
Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#aa39ac519b1d4c33a22f98ff75ce8da02">wdotp2_</a></td></tr>
<tr class="memdesc:aa39ac519b1d4c33a22f98ff75ce8da02"><td class="mdescLeft">&#160;</td><td class="mdescRight">To hold second to last iteration wdotp value for numerical derivative. <br /></td></tr>
<tr class="separator:aa39ac519b1d4c33a22f98ff75ce8da02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5fd2beef14c41ec395185e6a8ee4fc2"><td class="memItemLeft" align="right" valign="top"><a id="ac5fd2beef14c41ec395185e6a8ee4fc2"></a>
<a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; Eigen::VectorXd &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#ac5fd2beef14c41ec395185e6a8ee4fc2">fgrid_</a></td></tr>
<tr class="memdesc:ac5fd2beef14c41ec395185e6a8ee4fc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force grid. <br /></td></tr>
<tr class="separator:ac5fd2beef14c41ec395185e6a8ee4fc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4268b195c8b6084e805b1006f29f1755"><td class="memItemLeft" align="right" valign="top"><a id="a4268b195c8b6084e805b1006f29f1755"></a>
<a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; unsigned int &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a></td></tr>
<tr class="memdesc:a4268b195c8b6084e805b1006f29f1755"><td class="mdescLeft">&#160;</td><td class="mdescRight">Histogram grid. <br /></td></tr>
<tr class="separator:a4268b195c8b6084e805b1006f29f1755"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68d3b1aa7c03c407b9a13a55f5c529cb"><td class="memItemLeft" align="right" valign="top"><a id="a68d3b1aa7c03c407b9a13a55f5c529cb"></a>
Eigen::ArrayXi&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a68d3b1aa7c03c407b9a13a55f5c529cb">Nworld_</a></td></tr>
<tr class="memdesc:a68d3b1aa7c03c407b9a13a55f5c529cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Histogram grid for that sotres the number of global hits. <br /></td></tr>
<tr class="separator:a68d3b1aa7c03c407b9a13a55f5c529cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7ff346cb1092b47b2b1c92a3493e043"><td class="memItemLeft" align="right" valign="top"><a id="ab7ff346cb1092b47b2b1c92a3493e043"></a>
<a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#ab7ff346cb1092b47b2b1c92a3493e043">ugrid_</a></td></tr>
<tr class="memdesc:ab7ff346cb1092b47b2b1c92a3493e043"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unbiased histogram grid. <br /></td></tr>
<tr class="separator:ab7ff346cb1092b47b2b1c92a3493e043"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60107d02f7c6a9f8d3ace76474abdce4"><td class="memItemLeft" align="right" valign="top"><a id="a60107d02f7c6a9f8d3ace76474abdce4"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a60107d02f7c6a9f8d3ace76474abdce4">ratio_</a></td></tr>
<tr class="memdesc:a60107d02f7c6a9f8d3ace76474abdce4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hold parameters to adjust ratio of 1st and 2nd neural networks (freq vs force-based). <br /></td></tr>
<tr class="separator:a60107d02f7c6a9f8d3ace76474abdce4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1cf5451e2263ef28e69b2aa62f2086b"><td class="memItemLeft" align="right" valign="top"><a id="ae1cf5451e2263ef28e69b2aa62f2086b"></a>
Eigen::MatrixXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#ae1cf5451e2263ef28e69b2aa62f2086b">hist_</a></td></tr>
<tr class="memdesc:ae1cf5451e2263ef28e69b2aa62f2086b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Eigen matrices of grids. <br /></td></tr>
<tr class="separator:ae1cf5451e2263ef28e69b2aa62f2086b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad01927d3b64ecf517569dbef7bb9cdfc"><td class="memItemLeft" align="right" valign="top"><a id="ad01927d3b64ecf517569dbef7bb9cdfc"></a>
Eigen::MatrixXd&#160;</td><td class="memItemRight" valign="bottom"><b>bias_</b></td></tr>
<tr class="separator:ad01927d3b64ecf517569dbef7bb9cdfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaa2b8d2e893ba22734d6caaef2c4e4a"><td class="memItemLeft" align="right" valign="top"><a id="aaaa2b8d2e893ba22734d6caaef2c4e4a"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#aaaa2b8d2e893ba22734d6caaef2c4e4a">lowerb_</a></td></tr>
<tr class="memdesc:aaaa2b8d2e893ba22734d6caaef2c4e4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bounds. <br /></td></tr>
<tr class="separator:aaaa2b8d2e893ba22734d6caaef2c4e4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6803b7d62f2c3143963b7889d8847129"><td class="memItemLeft" align="right" valign="top"><a id="a6803b7d62f2c3143963b7889d8847129"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>upperb_</b></td></tr>
<tr class="separator:a6803b7d62f2c3143963b7889d8847129"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf1402b886e72ac0fb43ca5d6695cd62"><td class="memItemLeft" align="right" valign="top"><a id="acf1402b886e72ac0fb43ca5d6695cd62"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#acf1402b886e72ac0fb43ca5d6695cd62">lowerk_</a></td></tr>
<tr class="memdesc:acf1402b886e72ac0fb43ca5d6695cd62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bound restraints. <br /></td></tr>
<tr class="separator:acf1402b886e72ac0fb43ca5d6695cd62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a784fc49d20d3986cb5f6ca798f3ff4bb"><td class="memItemLeft" align="right" valign="top"><a id="a784fc49d20d3986cb5f6ca798f3ff4bb"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>upperk_</b></td></tr>
<tr class="separator:a784fc49d20d3986cb5f6ca798f3ff4bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a649ecdc2b50e67ce7afc663d43da8425"><td class="memItemLeft" align="right" valign="top"><a id="a649ecdc2b50e67ce7afc663d43da8425"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a649ecdc2b50e67ce7afc663d43da8425">outfile_</a></td></tr>
<tr class="memdesc:a649ecdc2b50e67ce7afc663d43da8425"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output filename. <br /></td></tr>
<tr class="separator:a649ecdc2b50e67ce7afc663d43da8425"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23c970ab7afe94bea80389fbfe254586"><td class="memItemLeft" align="right" valign="top"><a id="a23c970ab7afe94bea80389fbfe254586"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a23c970ab7afe94bea80389fbfe254586">overwrite_</a></td></tr>
<tr class="memdesc:a23c970ab7afe94bea80389fbfe254586"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overwrite outputs. <br /></td></tr>
<tr class="separator:a23c970ab7afe94bea80389fbfe254586"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7abba4174eac0b3f7b1f9bf7697b456"><td class="memItemLeft" align="right" valign="top"><a id="ae7abba4174eac0b3f7b1f9bf7697b456"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a></td></tr>
<tr class="memdesc:ae7abba4174eac0b3f7b1f9bf7697b456"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of CVs in system. <br /></td></tr>
<tr class="separator:ae7abba4174eac0b3f7b1f9bf7697b456"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8f3f198bf558555934e57f8911a0b80"><td class="memItemLeft" align="right" valign="top"><a id="ae8f3f198bf558555934e57f8911a0b80"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#ae8f3f198bf558555934e57f8911a0b80">unitconv_</a></td></tr>
<tr class="memdesc:ae8f3f198bf558555934e57f8911a0b80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unit conversion from mass*velocity/time to force. <br /></td></tr>
<tr class="separator:ae8f3f198bf558555934e57f8911a0b80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18619ba8fb2d677895af1282ff26f35c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#a18619ba8fb2d677895af1282ff26f35c">min_</a></td></tr>
<tr class="separator:a18619ba8fb2d677895af1282ff26f35c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3b9f23780098639d2a52b3f774a6525"><td class="memItemLeft" align="right" valign="top"><a id="ad3b9f23780098639d2a52b3f774a6525"></a>
Eigen::MatrixXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1CFF.html#ad3b9f23780098639d2a52b3f774a6525">force_to_val_ratio_</a></td></tr>
<tr class="memdesc:ad3b9f23780098639d2a52b3f774a6525"><td class="mdescLeft">&#160;</td><td class="mdescRight">To hold booleans for training neural network only in specific region for net2_. <br /></td></tr>
<tr class="separator:ad3b9f23780098639d2a52b3f774a6525"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classSSAGES_1_1Method"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classSSAGES_1_1Method')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classSSAGES_1_1Method.html">SSAGES::Method</a></td></tr>
<tr class="memitem:a8471b11097a1018a9635bc578bf22f61 inherit pro_attribs_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top"><a id="a8471b11097a1018a9635bc578bf22f61"></a>
mxx::comm&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">world_</a></td></tr>
<tr class="memdesc:a8471b11097a1018a9635bc578bf22f61 inherit pro_attribs_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global MPI communicator. <br /></td></tr>
<tr class="separator:a8471b11097a1018a9635bc578bf22f61 inherit pro_attribs_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1118666d61dbf3bc7606e3b61aa3a460 inherit pro_attribs_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top"><a id="a1118666d61dbf3bc7606e3b61aa3a460"></a>
mxx::comm&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a1118666d61dbf3bc7606e3b61aa3a460">comm_</a></td></tr>
<tr class="memdesc:a1118666d61dbf3bc7606e3b61aa3a460 inherit pro_attribs_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local MPI communicator. <br /></td></tr>
<tr class="separator:a1118666d61dbf3bc7606e3b61aa3a460 inherit pro_attribs_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24b0ac53b1fabcab0a5f3bd6cde26909 inherit pro_attribs_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top"><a id="a24b0ac53b1fabcab0a5f3bd6cde26909"></a>
std::vector&lt; unsigned int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a24b0ac53b1fabcab0a5f3bd6cde26909">cvmask_</a></td></tr>
<tr class="memdesc:a24b0ac53b1fabcab0a5f3bd6cde26909 inherit pro_attribs_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mask which identifies which CVs to act on. <br /></td></tr>
<tr class="separator:a24b0ac53b1fabcab0a5f3bd6cde26909 inherit pro_attribs_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Combined Force Frequency (<a class="el" href="classSSAGES_1_1CFF.html" title="Combined Force Frequency (CFF) Algorithm.">CFF</a>) Algorithm. </p>
<p>Implementation of the <a class="el" href="classSSAGES_1_1CFF.html" title="Combined Force Frequency (CFF) Algorithm.">CFF</a> algorithm based on Sevgen et al. J. Chem. Theory Comput. 2020, 16, 3, 1448-1455. </p>

<p class="definition">Definition at line <a class="el" href="CFF_8h_source.html#l00036">36</a> of file <a class="el" href="CFF_8h_source.html">CFF.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aab3150942788dfe58e4ab5c9e1ceb24b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab3150942788dfe58e4ab5c9e1ceb24b">&#9670;&nbsp;</a></span>CFF()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SSAGES::CFF::CFF </td>
          <td>(</td>
          <td class="paramtype">const MPI_Comm &amp;&#160;</td>
          <td class="paramname"><em>world</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MPI_Comm &amp;&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::VectorXi &amp;&#160;</td>
          <td class="paramname"><em>topol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; Eigen::VectorXd &gt; *&#160;</td>
          <td class="paramname"><em>fgrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; unsigned int &gt; *&#160;</td>
          <td class="paramname"><em>hgrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>ugrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; * &gt;&#160;</td>
          <td class="paramname"><em>F</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; * &gt;&#160;</td>
          <td class="paramname"><em>Fworld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>lowerb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>upperb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>lowerk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>upperk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>unitconv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>nsweep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>min</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">world</td><td>MPI global communicator. </td></tr>
    <tr><td class="paramname">comm</td><td>MPI local communicator. </td></tr>
    <tr><td class="paramname">topol</td><td>Topology of network. </td></tr>
    <tr><td class="paramname">fgrid</td><td><a class="el" href="classSSAGES_1_1Grid.html" title="Basic Grid.">Grid</a> containing biasing forces. </td></tr>
    <tr><td class="paramname">hgrid</td><td><a class="el" href="classSSAGES_1_1Grid.html" title="Basic Grid.">Grid</a> containing histogram. </td></tr>
    <tr><td class="paramname">ugrid</td><td><a class="el" href="classSSAGES_1_1Grid.html" title="Basic Grid.">Grid</a> containing unbiased histogram. </td></tr>
    <tr><td class="paramname">F</td><td>Vector of grids holding local raw generalized force totals per bin per CV. </td></tr>
    <tr><td class="paramname">Fworld</td><td>Vector of grids holding global raw generalized force totals per bin per CV. </td></tr>
    <tr><td class="paramname">lowerb</td><td>Lower bounds for CVs. </td></tr>
    <tr><td class="paramname">upperb</td><td>Upper bounds for CVs. </td></tr>
    <tr><td class="paramname">lowerk</td><td>Lower bound restraints for CVs. </td></tr>
    <tr><td class="paramname">upperk</td><td>Upper bound restraints for CVs. </td></tr>
    <tr><td class="paramname">temperature</td><td>Temperature of the simulation. </td></tr>
    <tr><td class="paramname">unitconv</td><td>Unit conversion from d(momentum)/d(time) to force. </td></tr>
    <tr><td class="paramname">timestep</td><td>Simulation time step. </td></tr>
    <tr><td class="paramname">weight</td><td>Relative weight of the statistics in sweep. </td></tr>
    <tr><td class="paramname">nsweep</td><td>Number of iterations in the sweep. </td></tr>
    <tr><td class="paramname">min</td><td>Number of counts for scaling back force biasing</td></tr>
  </table>
  </dd>
</dl>
<p>Constructs an instance of Combined Force Frequency method. </p>

<p class="definition">Definition at line <a class="el" href="CFF_8h_source.html#l00151">151</a> of file <a class="el" href="CFF_8h_source.html">CFF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          :</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <a class="code" href="classSSAGES_1_1Method.html#ad751450ecd30e8ab40024c6f5e870d30">Method</a>(1, world, comm), <a class="code" href="classSSAGES_1_1CFF.html#a5ae96842cc6a3c907da11d12de90b79f">topol_</a>(topol), <a class="code" href="classSSAGES_1_1CFF.html#a341c64332f5ff6ba3cdc6442e5406ed4">sweep_</a>(0), nsweep_(nsweep), <a class="code" href="classSSAGES_1_1CFF.html#a15b0b7d29205cc4d1645612c6f8ffbba">citers_</a>(0),</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <a class="code" href="classSSAGES_1_1CFF.html#a25f6bcb7fb67d5b6ed22c0bff9861386">net_</a>(topol), <a class="code" href="classSSAGES_1_1CFF.html#a63b71ad4ad5f00e274f9b7412c374d8c">net2_</a>(topol), <a class="code" href="classSSAGES_1_1CFF.html#a57e61481b774bf1a12c0aba8ad4e9064">timestep_</a>(timestep), <a class="code" href="classSSAGES_1_1CFF.html#aaf57efee95f11623cccb4ddb99e4b39c">pweight_</a>(1.), weight_(weight),</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <a class="code" href="classSSAGES_1_1CFF.html#a4acd48bf29d688abab039d9ad07bca05">temp_</a>(temperature), kbt_(), <a class="code" href="classSSAGES_1_1CFF.html#ae40a6c617732bc0bf260dbaba5b62330">F_</a>(F), <a class="code" href="classSSAGES_1_1CFF.html#a885e158d5d31846a427f3ee3c1ecfccc">Fworld_</a>(Fworld), <a class="code" href="classSSAGES_1_1CFF.html#ac5fd2beef14c41ec395185e6a8ee4fc2">fgrid_</a>(fgrid),</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>(hgrid), <a class="code" href="classSSAGES_1_1CFF.html#ab7ff346cb1092b47b2b1c92a3493e043">ugrid_</a>(ugrid), <a class="code" href="classSSAGES_1_1CFF.html#ae1cf5451e2263ef28e69b2aa62f2086b">hist_</a>(), bias_(), <a class="code" href="classSSAGES_1_1CFF.html#aaaa2b8d2e893ba22734d6caaef2c4e4a">lowerb_</a>(lowerb),</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            upperb_(upperb), <a class="code" href="classSSAGES_1_1CFF.html#acf1402b886e72ac0fb43ca5d6695cd62">lowerk_</a>(lowerk), upperk_(upperk), <a class="code" href="classSSAGES_1_1CFF.html#a649ecdc2b50e67ce7afc663d43da8425">outfile_</a>(<span class="stringliteral">&quot;CFF.out&quot;</span>),</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <a class="code" href="classSSAGES_1_1CFF.html#a23c970ab7afe94bea80389fbfe254586">overwrite_</a>(<span class="keyword">true</span>), <a class="code" href="classSSAGES_1_1CFF.html#ae8f3f198bf558555934e57f8911a0b80">unitconv_</a>(unitconv), <a class="code" href="classSSAGES_1_1CFF.html#a18619ba8fb2d677895af1282ff26f35c">min_</a>(min)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="comment">// Create histogram grid matrix.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <a class="code" href="classSSAGES_1_1CFF.html#ae1cf5451e2263ef28e69b2aa62f2086b">hist_</a>.resize(<a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a4f8abb752ae6ec51ebcf24b599bf4896">size</a>(), <a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a72f98ef47da691b00823d612efbd46b8">GetDimension</a>());</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="comment">// Fill it up.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">auto</span> it = <a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1Grid.html#a709374b3cadf320347604077a2e45e5b">begin</a>(); it != <a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1Grid.html#ac4fcc9f0cd61476ce4fd880c768d9694">end</a>(); ++it)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="keyword">auto</span> coord = it.coordinates();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <span class="keyword">auto</span> n = coord.size();</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                <span class="keywordflow">for</span>(decltype(n) j = 0; j &lt; n; ++j)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                    <a class="code" href="classSSAGES_1_1CFF.html#ae1cf5451e2263ef28e69b2aa62f2086b">hist_</a>(i, j) = coord[j];</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                ++i;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="comment">// Initialize free energy surface vector.</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            bias_.resize(<a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a4f8abb752ae6ec51ebcf24b599bf4896">size</a>(), 1);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <a class="code" href="classSSAGES_1_1CFF.html#a25f6bcb7fb67d5b6ed22c0bff9861386">net_</a>.forward_pass(<a class="code" href="classSSAGES_1_1CFF.html#ae1cf5451e2263ef28e69b2aa62f2086b">hist_</a>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <a class="code" href="classSSAGES_1_1CFF.html#a63b71ad4ad5f00e274f9b7412c374d8c">net2_</a>.forward_pass(<a class="code" href="classSSAGES_1_1CFF.html#ae1cf5451e2263ef28e69b2aa62f2086b">hist_</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            bias_.array() = <a class="code" href="classSSAGES_1_1CFF.html#a25f6bcb7fb67d5b6ed22c0bff9861386">net_</a>.get_activation().col(0).array();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Grid_8h_source.html#l00527">SSAGES::Grid&lt; T &gt;::begin()</a>, <a class="el" href="Grid_8h_source.html#l00540">SSAGES::Grid&lt; T &gt;::end()</a>, <a class="el" href="GridBase_8h_source.html#l00195">SSAGES::GridBase&lt; T &gt;::GetDimension()</a>, <a class="el" href="CFF_8h_source.html#l00082">hgrid_</a>, <a class="el" href="CFF_8h_source.html#l00094">hist_</a>, <a class="el" href="CFF_8h_source.html#l00052">net2_</a>, <a class="el" href="CFF_8h_source.html#l00049">net_</a>, and <a class="el" href="GridBase_8h_source.html#l00326">SSAGES::GridBase&lt; T &gt;::size()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1CFF_aab3150942788dfe58e4ab5c9e1ceb24b_cgraph.png" border="0" usemap="#classSSAGES_1_1CFF_aab3150942788dfe58e4ab5c9e1ceb24b_cgraph" alt=""/></div>
<map name="classSSAGES_1_1CFF_aab3150942788dfe58e4ab5c9e1ceb24b_cgraph" id="classSSAGES_1_1CFF_aab3150942788dfe58e4ab5c9e1ceb24b_cgraph">
<area shape="rect" title="Constructor." alt="" coords="5,81,151,108"/>
<area shape="rect" href="classSSAGES_1_1Grid.html#a709374b3cadf320347604077a2e45e5b" title="Return iterator at first grid point." alt="" coords="240,5,388,32"/>
<area shape="rect" href="classSSAGES_1_1Grid.html#ac4fcc9f0cd61476ce4fd880c768d9694" title="Return iterator after last valid grid point." alt="" coords="245,56,383,83"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a72f98ef47da691b00823d612efbd46b8" title="Get the dimension." alt="" coords="199,107,429,133"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a4f8abb752ae6ec51ebcf24b599bf4896" title="Get the size of the internal storage vector." alt="" coords="229,157,399,184"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6ef7a9444289638816b44c2acee1bd68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ef7a9444289638816b44c2acee1bd68">&#9670;&nbsp;</a></span>Build()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSSAGES_1_1CFF.html">CFF</a> * SSAGES::CFF::Build </td>
          <td>(</td>
          <td class="paramtype">const Json::Value &amp;&#160;</td>
          <td class="paramname"><em>json</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MPI_Comm &amp;&#160;</td>
          <td class="paramname"><em>world</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MPI_Comm &amp;&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build a derived method from <a class="el" href="namespaceJSON.html">JSON</a> node. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">json</td><td><a class="el" href="namespaceJSON.html">JSON</a> Value containing all input information. </td></tr>
    <tr><td class="paramname">world</td><td>MPI global communicator. </td></tr>
    <tr><td class="paramname">comm</td><td>MPI local communicator. </td></tr>
    <tr><td class="paramname">path</td><td>Path for <a class="el" href="namespaceJSON.html">JSON</a> path specification. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the <a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations.">Method</a> built. nullptr if an unknown error occurred.</dd></dl>
<p>This function builds a registered method from a <a class="el" href="namespaceJSON.html">JSON</a> node. The difference between this function and "Build" is that this automatically determines the appropriate derived type based on the <a class="el" href="namespaceJSON.html">JSON</a> node information.</p>
<dl class="section note"><dt>Note</dt><dd>Object lifetime is the caller's responsibility. </dd></dl>

<p class="definition">Definition at line <a class="el" href="CFF_8cpp_source.html#l00407">407</a> of file <a class="el" href="CFF_8cpp_source.html">CFF.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <a class="code" href="classJson_1_1ObjectRequirement.html">ObjectRequirement</a> validator;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        Value schema;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        CharReaderBuilder rbuilder;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        CharReader* reader = rbuilder.newCharReader();</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        reader-&gt;parse(</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            JsonSchema::CFFMethod.c_str(),</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            JsonSchema::CFFMethod.c_str() + JsonSchema::CFFMethod.size(),</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            &amp;schema,</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="keyword">nullptr</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        );</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        validator.<a class="code" href="classJson_1_1ObjectRequirement.html#a4ed02ae1d612a5efba1688fcdd2df092">Parse</a>(schema, path);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="comment">// Validate inputs.</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        validator.<a class="code" href="classJson_1_1ObjectRequirement.html#a9ac3b920001a35bc70580035d8d802b7">Validate</a>(json, path);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keywordflow">if</span>(validator.<a class="code" href="classJson_1_1Requirement.html#adfaec336a9f051d6f6b9a6d7f1d97b75">HasErrors</a>())</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="keywordflow">throw</span> BuildException(validator.<a class="code" href="classJson_1_1Requirement.html#a60bc275c366eb59f192fa2e621268480">GetErrors</a>());</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="comment">// Grid.</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keyword">auto</span> jsongrid = json.get(<span class="stringliteral">&quot;grid&quot;</span>, Json::Value());</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keyword">auto</span>* fgrid = <a class="code" href="classSSAGES_1_1Grid.html#a24d2373042debae156618906637e819c">Grid&lt;Eigen::VectorXd&gt;::BuildGrid</a>(jsongrid);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keyword">auto</span>* hgrid = <a class="code" href="classSSAGES_1_1Grid.html#a24d2373042debae156618906637e819c">Grid&lt;unsigned int&gt;::BuildGrid</a>(jsongrid);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keyword">auto</span>* ugrid = <a class="code" href="classSSAGES_1_1Grid.html#a24d2373042debae156618906637e819c">Grid&lt;double&gt;::BuildGrid</a>(jsongrid);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        std::vector&lt;Grid&lt;double&gt;*&gt; F(json[<span class="stringliteral">&quot;grid&quot;</span>][<span class="stringliteral">&quot;upper&quot;</span>].size());</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; grid : F)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            grid =  <a class="code" href="classSSAGES_1_1Grid.html#a24d2373042debae156618906637e819c">Grid&lt;double&gt;::BuildGrid</a>(jsongrid);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        std::vector&lt;Grid&lt;double&gt;*&gt; Fworld(json[<span class="stringliteral">&quot;grid&quot;</span>][<span class="stringliteral">&quot;upper&quot;</span>].size());</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; grid : Fworld)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            grid =  <a class="code" href="classSSAGES_1_1Grid.html#a24d2373042debae156618906637e819c">Grid&lt;double&gt;::BuildGrid</a>(jsongrid);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="comment">// Topology.</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keyword">auto</span> nlayers = json[<span class="stringliteral">&quot;topology&quot;</span>].size() + 2;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        Eigen::VectorXi topol(nlayers);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        topol[0] = fgrid-&gt;GetDimension();</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        topol[nlayers-1] = 1;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">for</span>(decltype(nlayers) i = 0; i &lt; json[<span class="stringliteral">&quot;topology&quot;</span>].size(); ++i)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            topol[i+1] = json[<span class="stringliteral">&quot;topology&quot;</span>][i].asInt();</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="comment">// CFF parameters</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keyword">auto</span> weight = json.get(<span class="stringliteral">&quot;weight&quot;</span>, 1.).asDouble();</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keyword">auto</span> temp = json[<span class="stringliteral">&quot;temperature&quot;</span>].asDouble();</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="keyword">auto</span> nsweep = json[<span class="stringliteral">&quot;nsweep&quot;</span>].asUInt();</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keyword">auto</span> unitconv = json.get(<span class="stringliteral">&quot;unit_conversion&quot;</span>, 1).asDouble();</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keyword">auto</span> timestep = json.get(<span class="stringliteral">&quot;timestep&quot;</span>, 0.002).asDouble();</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="keyword">auto</span> min = json.get(<span class="stringliteral">&quot;minimum_count&quot;</span>, 200).asInt();</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="comment">// Assume all vectors are the same size.</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        std::vector&lt;double&gt; lowerb, upperb, lowerk, upperk;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keyword">auto</span> lbr_size = json[<span class="stringliteral">&quot;lower_bound_restraints&quot;</span>].size();</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">for</span>(decltype(lbr_size) i = 0; i &lt; lbr_size; ++i)</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            lowerk.push_back(json[<span class="stringliteral">&quot;lower_bound_restraints&quot;</span>][i].asDouble());</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            upperk.push_back(json[<span class="stringliteral">&quot;upper_bound_restraints&quot;</span>][i].asDouble());</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            lowerb.push_back(json[<span class="stringliteral">&quot;lower_bounds&quot;</span>][i].asDouble());</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            upperb.push_back(json[<span class="stringliteral">&quot;upper_bounds&quot;</span>][i].asDouble());</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="keyword">auto</span>* m = <span class="keyword">new</span> <a class="code" href="classSSAGES_1_1CFF.html#aab3150942788dfe58e4ab5c9e1ceb24b">CFF</a>(world, comm, topol, fgrid, hgrid, ugrid, F, Fworld, lowerb, upperb, lowerk, upperk, temp, unitconv, timestep, weight, nsweep, min);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="comment">// Set optional params.</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        m-&gt;SetPrevWeight(json.get(<span class="stringliteral">&quot;prev_weight&quot;</span>, 1).asDouble());</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        m-&gt;SetOutput(json.get(<span class="stringliteral">&quot;output_file&quot;</span>, <span class="stringliteral">&quot;CFF.out&quot;</span>).asString());</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        m-&gt;SetOutputOverwrite( json.get(<span class="stringliteral">&quot;overwrite_output&quot;</span>, <span class="keyword">true</span>).asBool());</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        m-&gt;SetConvergeIters(json.get(<span class="stringliteral">&quot;converge_iters&quot;</span>, 0).asUInt());</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        m-&gt;SetMaxIters(json.get(<span class="stringliteral">&quot;max_iters&quot;</span>, 1000).asUInt());</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        m-&gt;SetMinLoss(json.get(<span class="stringliteral">&quot;min_loss&quot;</span>, 0).asDouble());</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        m-&gt;SetRatio(json.get(<span class="stringliteral">&quot;ratio&quot;</span>, 0.0).asDouble());</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordflow">return</span> m;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Requirement_8h_source.html#l00092">Json::Requirement::GetErrors()</a>, <a class="el" href="Requirement_8h_source.html#l00086">Json::Requirement::HasErrors()</a>, <a class="el" href="ObjectRequirement_8h_source.html#l00142">Json::ObjectRequirement::Parse()</a>, and <a class="el" href="ObjectRequirement_8h_source.html#l00239">Json::ObjectRequirement::Validate()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1CFF_a6ef7a9444289638816b44c2acee1bd68_cgraph.png" border="0" usemap="#classSSAGES_1_1CFF_a6ef7a9444289638816b44c2acee1bd68_cgraph" alt=""/></div>
<map name="classSSAGES_1_1CFF_a6ef7a9444289638816b44c2acee1bd68_cgraph" id="classSSAGES_1_1CFF_a6ef7a9444289638816b44c2acee1bd68_cgraph">
<area shape="rect" title="Build a derived method from JSON node." alt="" coords="5,167,153,194"/>
<area shape="rect" href="classJson_1_1Requirement.html#a60bc275c366eb59f192fa2e621268480" title="Get list of error messages." alt="" coords="435,5,575,47"/>
<area shape="rect" href="classJson_1_1Requirement.html#adfaec336a9f051d6f6b9a6d7f1d97b75" title="Check if errors have occured." alt="" coords="435,71,575,112"/>
<area shape="rect" href="classJson_1_1ObjectRequirement.html#a4ed02ae1d612a5efba1688fcdd2df092" title="Parse JSON value to generate Requirement(s)." alt="" coords="201,495,372,536"/>
<area shape="rect" href="classJson_1_1ObjectRequirement.html#a9ac3b920001a35bc70580035d8d802b7" title="Validate JSON value." alt="" coords="201,189,372,231"/>
<area shape="rect" href="classJson_1_1RequirementLoader.html#a82857d029b7ebfeb315f5b1b32401291" title="Extended Requirement loader." alt="" coords="420,463,591,504"/>
<area shape="rect" href="classJson_1_1RequirementLoader.html#aeb1344919deda4bd8b8aa8a00cb50390" title="Load specific requirement." alt="" coords="420,528,591,569"/>
<area shape="rect" href="classJson_1_1ObjectRequirement.html#a4f2e76636df4f7b153aaac02a1b05e4f" title="Reset Requirement." alt="" coords="420,593,591,635"/>
<area shape="rect" href="classJson_1_1ObjectRequirement.html#aa8181c37cbe67db098bc2b82cdea71ef" title="Clear errors on all Requirements." alt="" coords="639,560,809,601"/>
<area shape="rect" href="classJson_1_1ObjectRequirement.html#a4fc797684496f4f0381d1388877c133d" title="Clear notices on all Requirements." alt="" coords="639,625,809,667"/>
<area shape="rect" href="classJson_1_1Requirement.html#ace71ebbbcc885f0c4c391a3807c80f33" title="Clear list of error messages." alt="" coords="857,560,997,601"/>
<area shape="rect" href="classJson_1_1Requirement.html#a8a8a4020e4955be56dcacf4727ae5bc3" title="Clear list of notice messages." alt="" coords="857,625,997,667"/>
<area shape="rect" href="classJson_1_1Requirement.html#a46a0056414100386541cd1cb899e0030" title="Get list of notices." alt="" coords="435,136,575,177"/>
<area shape="rect" href="classJson_1_1Requirement.html#ad407cff3cc37295c3b2a7ebe31798548" title="Check if notices have been queued." alt="" coords="435,201,575,243"/>
<area shape="rect" href="classJson_1_1Requirement.html#adeb9efa6cf271d9cea0599ff2d458a08" title="Add error to list of error messages." alt="" coords="435,267,575,308"/>
<area shape="rect" href="classJson_1_1Requirement.html#a00feadb29fa33f4f2cca7362f12aaed4" title="Add message to list of notices." alt="" coords="435,332,575,373"/>
<area shape="rect" href="classJson_1_1Requirement.html#aa97494b642414d00482745a0d5b2c2c3" title="Validate that JSON value meets requirements." alt="" coords="435,397,575,439"/>
</map>
</div>

</div>
</div>
<a id="ab9f74c2ba9de08954e95678e0cb9ce46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9f74c2ba9de08954e95678e0cb9ce46">&#9670;&nbsp;</a></span>PostIntegration()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::CFF::PostIntegration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *&#160;</td>
          <td class="paramname"><em>snapshot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;&#160;</td>
          <td class="paramname"><em>cvmanager</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations.">Method</a> call post integration. </p>
<p>Post-integration hook.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">snapshot</td><td>Pointer to the simulation snapshot. </td></tr>
    <tr><td class="paramname">cvmanager</td><td>Collective variable manager.</td></tr>
  </table>
  </dd>
</dl>
<p>This function will be called after each integration step.</p>
<p>First, information from current snapshot is retrieved and stored in v-integration hook. Then, coordinates in CV space are determined. Then, for each CV, biasing force is calculated. Then, neural networks are trained if called. Then, information is printed out if called. Finally, bias is applied using either genralized force (for the first sweep) or neural networks. </p>

<p>Implements <a class="el" href="classSSAGES_1_1Method.html#af2f33dfaa758c5cd505477f4767fb339">SSAGES::Method</a>.</p>

<p class="definition">Definition at line <a class="el" href="CFF_8cpp_source.html#l00079">79</a> of file <a class="el" href="CFF_8cpp_source.html">CFF.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="comment">// Gather information.</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="comment">// // Bias energy is kb*T*ln(P) where P = unbiased distribution</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keyword">auto</span> cvs = cvmanager.GetCVs(<a class="code" href="classSSAGES_1_1Method.html#a24b0ac53b1fabcab0a5f3bd6cde26909">cvmask_</a>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keyword">auto</span>&amp; vels = snapshot-&gt;GetVelocities();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keyword">auto</span>&amp; mass = snapshot-&gt;GetMasses();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keyword">auto</span>&amp; forces = snapshot-&gt;GetForces();</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keyword">auto</span>&amp; virial = snapshot-&gt;GetVirial();</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keyword">auto</span> n = snapshot-&gt;GetNumAtoms();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keyword">using</span> NAtoms = decltype(n);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">if</span>(snapshot-&gt;GetIteration() &amp;&amp; snapshot-&gt;GetIteration() % nsweep_ == 0 &amp;&amp; snapshot-&gt;GetIteration() &gt;= nsweep_*1 )</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="comment">// Switch to full blast.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1CFF.html#a15b0b7d29205cc4d1645612c6f8ffbba">citers_</a> &amp;&amp; snapshot-&gt;GetIteration() &gt; <a class="code" href="classSSAGES_1_1CFF.html#a15b0b7d29205cc4d1645612c6f8ffbba">citers_</a>)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                <a class="code" href="classSSAGES_1_1CFF.html#aaf57efee95f11623cccb4ddb99e4b39c">pweight_</a> = 1.0;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <a class="code" href="classSSAGES_1_1CFF.html#ae71f141f144ada85ab9ffdec8a2acdb2">TrainNetwork</a>();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1EventListener.html#af9666daacfb047c1dd279ea339524d07">IsMasterRank</a>(<a class="code" href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">world_</a>))</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <a class="code" href="classSSAGES_1_1CFF.html#abbbfe00f423669ebe4b02abca581d4ff">WriteBias</a>();</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="comment">// Determine if we are in bounds.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        Eigen::RowVectorXd vec(<a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        std::vector&lt;double&gt; val(<a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordtype">bool</span> inbounds = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>; ++i)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            val[i] = cvs[i]-&gt;GetValue();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            vec[i] = cvs[i]-&gt;GetValue();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keywordflow">if</span>(val[i] &lt; <a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a2270a9233a9dc2d341e8ab88ce6655c9">GetLower</a>(i) || val[i] &gt; <a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a875feace8fff4743b103147c4193eca0">GetUpper</a>(i))</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                inbounds = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="comment">// Initialize matrix to hold the CV gradient.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        Eigen::MatrixXd J(<a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>, 3*n);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="comment">// Fill J and CV. Each column represents grad(CV) with flattened Cartesian elements.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>; ++i)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keyword">auto</span>&amp; grad = cvs[i]-&gt;GetGradient();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keywordflow">for</span>(NAtoms j = 0; j &lt; n; ++j)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                J.block&lt;1, 3&gt;(i,3*j) = grad[j];</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="comment">//* Calculate W using Darve&#39;s approach (http://mc.stanford.edu/cgi-bin/images/0/06/Darve_2008.pdf).</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="comment">// However, we will not use mass weighing.</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        Eigen::MatrixXd Jmass = J.transpose();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        Eigen::MatrixXd Minv = J*Jmass;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        MPI_Allreduce(MPI_IN_PLACE, Minv.data(), Minv.size(), MPI_DOUBLE, MPI_SUM, <a class="code" href="classSSAGES_1_1Method.html#a1118666d61dbf3bc7606e3b61aa3a460">comm_</a>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        Eigen::MatrixXd Wt = Minv.inverse()*Jmass.transpose();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="comment">// Fill momenta.</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        Eigen::VectorXd momenta(3*n);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">for</span>(NAtoms i = 0; i &lt; n; ++i)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            momenta.segment&lt;3&gt;(3*i) = mass[i]*vels[i];</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="comment">// Compute dot(w,p)</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        Eigen::VectorXd wdotp = Wt*momenta;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">// Reduce dot product across processors.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        MPI_Allreduce(MPI_IN_PLACE, wdotp.data(), wdotp.size(), MPI_DOUBLE, MPI_SUM, <a class="code" href="classSSAGES_1_1Method.html#a1118666d61dbf3bc7606e3b61aa3a460">comm_</a>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="comment">// Compute d(wdotp)/dt second order backwards finite difference.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">// Adding old force removes bias.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        Eigen::VectorXd dwdotpdt = <a class="code" href="classSSAGES_1_1CFF.html#ae8f3f198bf558555934e57f8911a0b80">unitconv_</a>*(1.5*wdotp - 2.0*<a class="code" href="classSSAGES_1_1CFF.html#af4472f7ce0b907d88bff353deb2d9a00">wdotp1_</a> + 0.5*<a class="code" href="classSSAGES_1_1CFF.html#aa39ac519b1d4c33a22f98ff75ce8da02">wdotp2_</a>)/<a class="code" href="classSSAGES_1_1CFF.html#a57e61481b774bf1a12c0aba8ad4e9064">timestep_</a> + <a class="code" href="classSSAGES_1_1CFF.html#a857edf66ca0e8f468bcc93a761a10984">Fold_</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        Eigen::VectorXd derivatives = Eigen::VectorXd::Zero(<a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="comment">// If we are in bounds, sum force and frequency into running total.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">if</span> (inbounds)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1EventListener.html#af9666daacfb047c1dd279ea339524d07">IsMasterRank</a>(<a class="code" href="classSSAGES_1_1Method.html#a1118666d61dbf3bc7606e3b61aa3a460">comm_</a>))</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>; ++i)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                    <a class="code" href="classSSAGES_1_1CFF.html#ae40a6c617732bc0bf260dbaba5b62330">F_</a>[i]-&gt;at(val) += dwdotpdt[i];</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a7da01557a9b85498c2acd975c152403a">at</a>(val) += 1;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="comment">// Initial sweep is the same as doing adaptive basing force</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="comment">// i.e., Calculate biasing forces from averaged F at current CV coodinates</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordflow">if</span>(snapshot-&gt;GetIteration() &lt; nsweep_)</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>; ++i)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    derivatives[i] = (<a class="code" href="classSSAGES_1_1CFF.html#ae40a6c617732bc0bf260dbaba5b62330">F_</a>[i]-&gt;at(val)/std::max((<span class="keywordtype">double</span>(<a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a7da01557a9b85498c2acd975c152403a">at</a>(val))),<span class="keywordtype">double</span>(<a class="code" href="classSSAGES_1_1CFF.html#a18619ba8fb2d677895af1282ff26f35c">min_</a>)));</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                <a class="code" href="classSSAGES_1_1CFF.html#a25f6bcb7fb67d5b6ed22c0bff9861386">net_</a>.forward_pass(vec);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <a class="code" href="classSSAGES_1_1CFF.html#a63b71ad4ad5f00e274f9b7412c374d8c">net2_</a>.forward_pass(vec);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                derivatives = <a class="code" href="classSSAGES_1_1CFF.html#a25f6bcb7fb67d5b6ed22c0bff9861386">net_</a>.get_gradient(0)*<a class="code" href="classSSAGES_1_1CFF.html#a60107d02f7c6a9f8d3ace76474abdce4">ratio_</a> + <a class="code" href="classSSAGES_1_1CFF.html#a63b71ad4ad5f00e274f9b7412c374d8c">net2_</a>.get_gradient(0)*(1.0-<a class="code" href="classSSAGES_1_1CFF.html#a60107d02f7c6a9f8d3ace76474abdce4">ratio_</a>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="comment">// If out of bounds, apply harmonic restraint</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="comment">// Output to screen CV value that is out of bounds</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1EventListener.html#af9666daacfb047c1dd279ea339524d07">IsMasterRank</a>(<a class="code" href="classSSAGES_1_1Method.html#a1118666d61dbf3bc7606e3b61aa3a460">comm_</a>))</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                std::cerr &lt;&lt; <span class="stringliteral">&quot;CFF (&quot;</span> &lt;&lt; snapshot-&gt;GetIteration() &lt;&lt; <span class="stringliteral">&quot;): out of bounds ( &quot;</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; v : val)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                    std::cerr &lt;&lt; v &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                std::cerr &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="comment">// Apply harmonic restraints</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>; ++i)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="keyword">auto</span> cval = cvs[i]-&gt;GetValue();</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <span class="keywordflow">if</span>(cval &lt; <a class="code" href="classSSAGES_1_1CFF.html#aaaa2b8d2e893ba22734d6caaef2c4e4a">lowerb_</a>[i])</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                    derivatives[i] += <a class="code" href="classSSAGES_1_1CFF.html#acf1402b886e72ac0fb43ca5d6695cd62">lowerk_</a>[i]*cvs[i]-&gt;GetDifference(cval - <a class="code" href="classSSAGES_1_1CFF.html#aaaa2b8d2e893ba22734d6caaef2c4e4a">lowerb_</a>[i]);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(cval &gt; upperb_[i])</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                    derivatives[i] += upperk_[i]*cvs[i]-&gt;GetDifference(cval - upperb_[i]);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>; ++i)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="keyword">auto</span>&amp; grad = cvs[i]-&gt;GetGradient();</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <span class="keyword">auto</span>&amp; boxgrad = cvs[i]-&gt;GetBoxGradient();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="comment">// Update the forces in snapshot by adding in the force bias from each</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="comment">// CV to each atom based on the gradient of the CV.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="keywordflow">for</span> (NAtoms j = 0; j &lt; n; ++j)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                forces[j] -= derivatives[i]*grad[j];</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="comment">// Update virial.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            virial += derivatives[i]*boxgrad;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="comment">// Collect all walkers.</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        MPI_Barrier(<a class="code" href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">world_</a>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="comment">// Store the old summed forces.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#a857edf66ca0e8f468bcc93a761a10984">Fold_</a> = derivatives;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="comment">// Update finite difference time derivatives.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#aa39ac519b1d4c33a22f98ff75ce8da02">wdotp2_</a> = <a class="code" href="classSSAGES_1_1CFF.html#af4472f7ce0b907d88bff353deb2d9a00">wdotp1_</a>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#af4472f7ce0b907d88bff353deb2d9a00">wdotp1_</a> = wdotp;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CVManager_8h_source.html#l00081">SSAGES::CVManager::GetCVs()</a>, <a class="el" href="Snapshot_8h_source.html#l00351">SSAGES::Snapshot::GetForces()</a>, <a class="el" href="Snapshot_8h_source.html#l00105">SSAGES::Snapshot::GetIteration()</a>, <a class="el" href="Snapshot_8h_source.html#l00367">SSAGES::Snapshot::GetMasses()</a>, <a class="el" href="Snapshot_8h_source.html#l00202">SSAGES::Snapshot::GetNumAtoms()</a>, <a class="el" href="Snapshot_8h_source.html#l00338">SSAGES::Snapshot::GetVelocities()</a>, and <a class="el" href="Snapshot_8h_source.html#l00135">SSAGES::Snapshot::GetVirial()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1CFF_ab9f74c2ba9de08954e95678e0cb9ce46_cgraph.png" border="0" usemap="#classSSAGES_1_1CFF_ab9f74c2ba9de08954e95678e0cb9ce46_cgraph" alt=""/></div>
<map name="classSSAGES_1_1CFF_ab9f74c2ba9de08954e95678e0cb9ce46_cgraph" id="classSSAGES_1_1CFF_ab9f74c2ba9de08954e95678e0cb9ce46_cgraph">
<area shape="rect" title="Method call post integration." alt="" coords="5,173,212,199"/>
<area shape="rect" href="classSSAGES_1_1CVManager.html#ad2a31c91a0298b4e80ca5ba720c5eee3" title="Get CV iterator." alt="" coords="292,5,455,47"/>
<area shape="rect" href="classSSAGES_1_1Snapshot.html#a2d195c04efbc7d7d1c3dd4ccd4b9a5bc" title="Access the per&#45;particle forces." alt="" coords="269,71,478,98"/>
<area shape="rect" href="classSSAGES_1_1Snapshot.html#ab38cbf3c463820d1b8bbd733759bfa32" title="Get the current iteration." alt="" coords="265,122,481,149"/>
<area shape="rect" href="classSSAGES_1_1Snapshot.html#abef8348e7811deeea88a7ff8f49a1af4" title="Const access to the particle masses." alt="" coords="266,173,481,199"/>
<area shape="rect" href="classSSAGES_1_1Snapshot.html#a103af07a012d55a9637f6203c7eba0af" title="Get number of atoms in this snapshot." alt="" coords="275,224,472,265"/>
<area shape="rect" href="classSSAGES_1_1Snapshot.html#adb14bcfae16bc7490320fd1890b36cff" title="Access the particle velocities." alt="" coords="260,290,487,317"/>
<area shape="rect" href="classSSAGES_1_1Snapshot.html#a02b7418ade9d06c64d1c074a95783635" title="Get box virial." alt="" coords="274,341,473,367"/>
</map>
</div>

</div>
</div>
<a id="ae5912cbccb7be5d75ce666eefd4d1789"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5912cbccb7be5d75ce666eefd4d1789">&#9670;&nbsp;</a></span>PostSimulation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::CFF::PostSimulation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *&#160;</td>
          <td class="paramname"><em>snapshot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;&#160;</td>
          <td class="paramname"><em>cvmanager</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations.">Method</a> call post simulation. </p>
<p>Post-simulation hook.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">snapshot</td><td>Pointer to the simulation snapshot. </td></tr>
    <tr><td class="paramname">cvmanager</td><td>Collective variable manager.</td></tr>
  </table>
  </dd>
</dl>
<p>This function will be called after the end of the simulation run. </p>

<p>Implements <a class="el" href="classSSAGES_1_1Method.html#a7d18226669c88bc76b9b758f2d29e3c9">SSAGES::Method</a>.</p>

<p class="definition">Definition at line <a class="el" href="CFF_8cpp_source.html#l00227">227</a> of file <a class="el" href="CFF_8cpp_source.html">CFF.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad51094624daa5d1a27a75e7c15dce24a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad51094624daa5d1a27a75e7c15dce24a">&#9670;&nbsp;</a></span>PreSimulation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::CFF::PreSimulation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *&#160;</td>
          <td class="paramname"><em>snapshot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;&#160;</td>
          <td class="paramname"><em>cvmanager</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations.">Method</a> call prior to simulation initiation. </p>
<p>Pre-simulation hook.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">snapshot</td><td>Pointer to the simulation snapshot. </td></tr>
    <tr><td class="paramname">cvmanager</td><td>Collective variable manager.</td></tr>
  </table>
  </dd>
</dl>
<p>This function will be called before the simulation is started.</p>
<p>Initialize biasing forces and histogram. </p>

<p>Implements <a class="el" href="classSSAGES_1_1Method.html#a7d840d2b5f6dbf9ec75a7909ccf13ef7">SSAGES::Method</a>.</p>

<p class="definition">Definition at line <a class="el" href="CFF_8cpp_source.html#l00041">41</a> of file <a class="el" href="CFF_8cpp_source.html">CFF.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keyword">auto</span> cvs = cvmanager.GetCVs(<a class="code" href="classSSAGES_1_1Method.html#a24b0ac53b1fabcab0a5f3bd6cde26909">cvmask_</a>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a> = cvs.size();</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="comment">// Size and initialize Fold_.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#a857edf66ca0e8f468bcc93a761a10984">Fold_</a>.setZero(<a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="comment">// Initialize w \dot p&#39;s for finite difference.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#af4472f7ce0b907d88bff353deb2d9a00">wdotp1_</a>.setZero(<a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#aa39ac519b1d4c33a22f98ff75ce8da02">wdotp2_</a>.setZero(<a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordtype">int</span> ndim = <a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a72f98ef47da691b00823d612efbd46b8">GetDimension</a>();</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        kbt_ = snapshot-&gt;GetKb()*<a class="code" href="classSSAGES_1_1CFF.html#a4acd48bf29d688abab039d9ad07bca05">temp_</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="comment">// Zero out forces and histogram.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        Eigen::VectorXd vec = Eigen::VectorXd::Zero(ndim);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        std::fill(<a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1Grid.html#a709374b3cadf320347604077a2e45e5b">begin</a>(), <a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1Grid.html#ac4fcc9f0cd61476ce4fd880c768d9694">end</a>(), 0);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        std::fill(<a class="code" href="classSSAGES_1_1CFF.html#ab7ff346cb1092b47b2b1c92a3493e043">ugrid_</a>-&gt;<a class="code" href="classSSAGES_1_1Grid.html#a709374b3cadf320347604077a2e45e5b">begin</a>(), <a class="code" href="classSSAGES_1_1CFF.html#ab7ff346cb1092b47b2b1c92a3493e043">ugrid_</a>-&gt;<a class="code" href="classSSAGES_1_1Grid.html#ac4fcc9f0cd61476ce4fd880c768d9694">end</a>(), 1.0);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        std::fill(<a class="code" href="classSSAGES_1_1CFF.html#ac5fd2beef14c41ec395185e6a8ee4fc2">fgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1Grid.html#a709374b3cadf320347604077a2e45e5b">begin</a>(), <a class="code" href="classSSAGES_1_1CFF.html#ac5fd2beef14c41ec395185e6a8ee4fc2">fgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1Grid.html#ac4fcc9f0cd61476ce4fd880c768d9694">end</a>(), vec);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="comment">// Initialize Nworld.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        Eigen::Map&lt;Eigen::Array&lt;unsigned int, Eigen::Dynamic, 1&gt;&gt; hist(<a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a52e519b13f9b53c0767957d86015b0a1">data</a>(), <a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a4f8abb752ae6ec51ebcf24b599bf4896">size</a>());</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#a68d3b1aa7c03c407b9a13a55f5c529cb">Nworld_</a> = hist.cast&lt;<span class="keywordtype">int</span>&gt;();</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="comment">// Scale initial bias by 1/2*kT and make them positive.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        bias_.array() = abs(bias_.array())*kbt_*0.5;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;     }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CVManager_8h_source.html#l00081">SSAGES::CVManager::GetCVs()</a>, and <a class="el" href="Snapshot_8h_source.html#l00165">SSAGES::Snapshot::GetKb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1CFF_ad51094624daa5d1a27a75e7c15dce24a_cgraph.png" border="0" usemap="#classSSAGES_1_1CFF_ad51094624daa5d1a27a75e7c15dce24a_cgraph" alt=""/></div>
<map name="classSSAGES_1_1CFF_ad51094624daa5d1a27a75e7c15dce24a_cgraph" id="classSSAGES_1_1CFF_ad51094624daa5d1a27a75e7c15dce24a_cgraph">
<area shape="rect" title="Method call prior to simulation initiation." alt="" coords="5,42,205,69"/>
<area shape="rect" href="classSSAGES_1_1CVManager.html#ad2a31c91a0298b4e80ca5ba720c5eee3" title="Get CV iterator." alt="" coords="265,5,427,47"/>
<area shape="rect" href="classSSAGES_1_1Snapshot.html#a00e9e35fb3f541b61a39acb142470a61" title="Get system Kb." alt="" coords="253,71,439,98"/>
</map>
</div>

</div>
</div>
<a id="ae71f141f144ada85ab9ffdec8a2acdb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae71f141f144ada85ab9ffdec8a2acdb2">&#9670;&nbsp;</a></span>TrainNetwork()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::CFF::TrainNetwork </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Trains the neural network. </p>
<p>Train neural networks. </p>

<p class="definition">Definition at line <a class="el" href="CFF_8cpp_source.html#l00232">232</a> of file <a class="el" href="CFF_8cpp_source.html">CFF.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="comment">// Start the clock to measure the neural network training time.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        std::clock_t start = std::clock();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="comment">// Increment cycle counter.</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        ++<a class="code" href="classSSAGES_1_1CFF.html#a341c64332f5ff6ba3cdc6442e5406ed4">sweep_</a>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="comment">// Reduce histogram across procs and sync in case system is periodic.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        mxx::allreduce(<a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a52e519b13f9b53c0767957d86015b0a1">data</a>(), <a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a4f8abb752ae6ec51ebcf24b599bf4896">size</a>(), std::plus&lt;unsigned int&gt;(), <a class="code" href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">world_</a>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#ab52bfd510cd1dffb2d91f516c9266c4b">syncGrid</a>();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="comment">// Update visit frequencies.</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        Eigen::Map&lt;Eigen::Array&lt;unsigned int, Eigen::Dynamic, 1&gt;&gt; hist(<a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a52e519b13f9b53c0767957d86015b0a1">data</a>(), <a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a4f8abb752ae6ec51ebcf24b599bf4896">size</a>());</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#a68d3b1aa7c03c407b9a13a55f5c529cb">Nworld_</a> += hist.cast&lt;<span class="keywordtype">int</span>&gt;();</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="comment">// Synchronize unbiased histogram.</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#ab7ff346cb1092b47b2b1c92a3493e043">ugrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#ab52bfd510cd1dffb2d91f516c9266c4b">syncGrid</a>();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        Eigen::Map&lt;Eigen::Matrix&lt;double, Eigen::Dynamic, 1&gt;&gt; uhist(<a class="code" href="classSSAGES_1_1CFF.html#ab7ff346cb1092b47b2b1c92a3493e043">ugrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a52e519b13f9b53c0767957d86015b0a1">data</a>(), <a class="code" href="classSSAGES_1_1CFF.html#ab7ff346cb1092b47b2b1c92a3493e043">ugrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a4f8abb752ae6ec51ebcf24b599bf4896">size</a>());</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="comment">// Update average biased forces across all processors</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        std::vector&lt;Eigen::MatrixXd&gt; Ftrain;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>; ++i)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            MPI_Allreduce(<a class="code" href="classSSAGES_1_1CFF.html#ae40a6c617732bc0bf260dbaba5b62330">F_</a>[i]-&gt;data(), <a class="code" href="classSSAGES_1_1CFF.html#a885e158d5d31846a427f3ee3c1ecfccc">Fworld_</a>[i]-&gt;data(), (<a class="code" href="classSSAGES_1_1CFF.html#ae40a6c617732bc0bf260dbaba5b62330">F_</a>[i]-&gt;size()), MPI_DOUBLE, MPI_SUM, <a class="code" href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">world_</a>);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <a class="code" href="classSSAGES_1_1CFF.html#a885e158d5d31846a427f3ee3c1ecfccc">Fworld_</a>[i]-&gt;syncGrid();</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="comment">// Damp forces used to train net2_ via minimum number of hits</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            Eigen::ArrayXd Nmin = Eigen::ArrayXd::Ones(<a class="code" href="classSSAGES_1_1CFF.html#a885e158d5d31846a427f3ee3c1ecfccc">Fworld_</a>[0]-&gt;size())*<a class="code" href="classSSAGES_1_1CFF.html#a18619ba8fb2d677895af1282ff26f35c">min_</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            Ftrain.push_back(Eigen::Map&lt;Eigen::Array&lt;double, Eigen::Dynamic, 1&gt;&gt; (<a class="code" href="classSSAGES_1_1CFF.html#a885e158d5d31846a427f3ee3c1ecfccc">Fworld_</a>[i]-&gt;data(),<a class="code" href="classSSAGES_1_1CFF.html#a885e158d5d31846a427f3ee3c1ecfccc">Fworld_</a>[i]-&gt;size()) /</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                ( (<a class="code" href="classSSAGES_1_1CFF.html#a68d3b1aa7c03c407b9a13a55f5c529cb">Nworld_</a>.cast&lt;<span class="keywordtype">double</span>&gt;()).max(Nmin) ) );</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="comment">// Calculate unbiased histrogram from previous unbiased histogram plus estimates from bias energy.</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        uhist.array() = <a class="code" href="classSSAGES_1_1CFF.html#aaf57efee95f11623cccb4ddb99e4b39c">pweight_</a>*uhist.array() + hist.cast&lt;<span class="keywordtype">double</span>&gt;()*(bias_/kbt_).array().exp()*weight_;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="comment">// Synchronize unbiased histogram and clear global histogram holder.</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#ab7ff346cb1092b47b2b1c92a3493e043">ugrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#ab52bfd510cd1dffb2d91f516c9266c4b">syncGrid</a>();</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        hist.setZero();</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">// Initialize boolean vector to enable training data.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">// 1 = include specified CV bin for training; 0 = remove from training.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="comment">// Useful for training data partially in the future.</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#ad3b9f23780098639d2a52b3f774a6525">force_to_val_ratio_</a> = Eigen::MatrixXd::Zero(<a class="code" href="classSSAGES_1_1CFF.html#ae1cf5451e2263ef28e69b2aa62f2086b">hist_</a>.rows(),1);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">// Bias energy is kb*T*ln(P) where P = unbiased distribution.</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        bias_.array() = kbt_*uhist.array().log();</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        bias_.array() -= bias_.minCoeff();</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSSAGES_1_1CFF.html#a60107d02f7c6a9f8d3ace76474abdce4">ratio_</a> &gt; 0.6)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <a class="code" href="classSSAGES_1_1CFF.html#a63b71ad4ad5f00e274f9b7412c374d8c">net2_</a>.init_weights();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment">// Train network.</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#a25f6bcb7fb67d5b6ed22c0bff9861386">net_</a>.autoscale(<a class="code" href="classSSAGES_1_1CFF.html#ae1cf5451e2263ef28e69b2aa62f2086b">hist_</a>, bias_);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#a63b71ad4ad5f00e274f9b7412c374d8c">net2_</a>.autoscale_w_grad(<a class="code" href="classSSAGES_1_1CFF.html#ae1cf5451e2263ef28e69b2aa62f2086b">hist_</a>, bias_, Ftrain);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1EventListener.html#af9666daacfb047c1dd279ea339524d07">IsMasterRank</a>(<a class="code" href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">world_</a>))</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <a class="code" href="classSSAGES_1_1CFF.html#a16fca1165c46e1c5ad987fc0ed902098">SetRatio</a>(1.0);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <span class="keywordtype">double</span> gamma1;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            gamma1 = <a class="code" href="classSSAGES_1_1CFF.html#a25f6bcb7fb67d5b6ed22c0bff9861386">net_</a>.train(<a class="code" href="classSSAGES_1_1CFF.html#ae1cf5451e2263ef28e69b2aa62f2086b">hist_</a>, bias_, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <a class="code" href="classSSAGES_1_1CFF.html#a16fca1165c46e1c5ad987fc0ed902098">SetRatio</a>(0.0);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="keywordtype">double</span> gamma2 = <a class="code" href="classSSAGES_1_1CFF.html#a63b71ad4ad5f00e274f9b7412c374d8c">net2_</a>.train_w_grad(<a class="code" href="classSSAGES_1_1CFF.html#ae1cf5451e2263ef28e69b2aa62f2086b">hist_</a>, bias_,Ftrain, <a class="code" href="classSSAGES_1_1CFF.html#ad3b9f23780098639d2a52b3f774a6525">force_to_val_ratio_</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;gamma1 &quot;</span> &lt;&lt; gamma1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; gamma2 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <a class="code" href="classSSAGES_1_1CFF.html#a60107d02f7c6a9f8d3ace76474abdce4">ratio_</a> = gamma1/(gamma1+gamma2);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Ratio: &quot;</span> &lt;&lt; <a class="code" href="classSSAGES_1_1CFF.html#a60107d02f7c6a9f8d3ace76474abdce4">ratio_</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="comment">// Output file that accumulates information on the value of ratio_ for every sweeps</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            std::ofstream gammaout;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            gammaout.open(<a class="code" href="classSSAGES_1_1CFF.html#a649ecdc2b50e67ce7afc663d43da8425">outfile_</a> + <span class="stringliteral">&quot;_gamma&quot;</span>, std::ios_base::app);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            gammaout.precision(16);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            gammaout &lt;&lt; <a class="code" href="classSSAGES_1_1CFF.html#a341c64332f5ff6ba3cdc6442e5406ed4">sweep_</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; gamma1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; gamma2 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classSSAGES_1_1CFF.html#a60107d02f7c6a9f8d3ace76474abdce4">ratio_</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            gammaout.close();</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="comment">// Send optimal neural net params to all procs.</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        nnet::vector_t wb = <a class="code" href="classSSAGES_1_1CFF.html#a25f6bcb7fb67d5b6ed22c0bff9861386">net_</a>.get_wb();</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        mxx::bcast(wb.data(), wb.size(), 0, <a class="code" href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">world_</a>);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#a25f6bcb7fb67d5b6ed22c0bff9861386">net_</a>.set_wb(wb);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        nnet::vector_t wb2 = <a class="code" href="classSSAGES_1_1CFF.html#a63b71ad4ad5f00e274f9b7412c374d8c">net2_</a>.get_wb();</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        mxx::bcast(wb2.data(), wb2.size(), 0, <a class="code" href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">world_</a>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#a63b71ad4ad5f00e274f9b7412c374d8c">net2_</a>.set_wb(wb2);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        mxx::bcast(&amp;<a class="code" href="classSSAGES_1_1CFF.html#a60107d02f7c6a9f8d3ace76474abdce4">ratio_</a>, 1, 0, <a class="code" href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">world_</a>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="comment">// Evaluate and subtract off min value for applied bias.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#a25f6bcb7fb67d5b6ed22c0bff9861386">net_</a>.forward_pass(<a class="code" href="classSSAGES_1_1CFF.html#ae1cf5451e2263ef28e69b2aa62f2086b">hist_</a>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <a class="code" href="classSSAGES_1_1CFF.html#a63b71ad4ad5f00e274f9b7412c374d8c">net2_</a>.forward_pass(<a class="code" href="classSSAGES_1_1CFF.html#ae1cf5451e2263ef28e69b2aa62f2086b">hist_</a>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        bias_.array() = <a class="code" href="classSSAGES_1_1CFF.html#a25f6bcb7fb67d5b6ed22c0bff9861386">net_</a>.get_activation().col(0).array() * <a class="code" href="classSSAGES_1_1CFF.html#a60107d02f7c6a9f8d3ace76474abdce4">ratio_</a> + <a class="code" href="classSSAGES_1_1CFF.html#a63b71ad4ad5f00e274f9b7412c374d8c">net2_</a>.get_activation().col(0).array() * (1.0-<a class="code" href="classSSAGES_1_1CFF.html#a60107d02f7c6a9f8d3ace76474abdce4">ratio_</a>);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        bias_.array() -= bias_.minCoeff();</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="comment">// Average the generalized force for each bin and output the file.</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1EventListener.html#af9666daacfb047c1dd279ea339524d07">IsMasterRank</a>(<a class="code" href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">world_</a>))</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="keywordtype">int</span> gridPoints = 1;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>; ++i)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                gridPoints = gridPoints * <a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#ab56c5b7786560a9a35951f1c3a44b077">GetNumPoints</a>(i);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            std::string filename;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            filename = <a class="code" href="classSSAGES_1_1CFF.html#a23c970ab7afe94bea80389fbfe254586">overwrite_</a> ? <span class="stringliteral">&quot;F_out&quot;</span> : <span class="stringliteral">&quot;F_out_&quot;</span>+std::to_string(<a class="code" href="classSSAGES_1_1CFF.html#a341c64332f5ff6ba3cdc6442e5406ed4">sweep_</a>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            std::ofstream file(filename);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            file &lt;&lt; std::endl;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;Sweep: &quot;</span> &lt;&lt; <a class="code" href="classSSAGES_1_1CFF.html#a341c64332f5ff6ba3cdc6442e5406ed4">sweep_</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;Printing out the current Biasing Vector Field from CFF.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;First (Nr of CVs) columns are the coordinates, the next (Nr of CVs) columns are components of the Generalized Force vector at that point.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;The columns are &quot;</span> &lt;&lt; gridPoints &lt;&lt; <span class="stringliteral">&quot; long, mapping out a surface of &quot;</span>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>-1; ++i)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                file &lt;&lt; (<a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#ab56c5b7786560a9a35951f1c3a44b077">GetNumPoints</a>())[i] &lt;&lt; <span class="stringliteral">&quot; by &quot;</span> ;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            file &lt;&lt; (<a class="code" href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#ab56c5b7786560a9a35951f1c3a44b077">GetNumPoints</a>(<a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>-1)) &lt;&lt; <span class="stringliteral">&quot; points in &quot;</span> &lt;&lt; <a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a> &lt;&lt; <span class="stringliteral">&quot; dimensions.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            file &lt;&lt; std::endl;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j &lt; (Ftrain[0].array()).size();++j)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                file &lt;&lt; std::setw(14) &lt;&lt; std::setprecision(8) &lt;&lt; std::fixed &lt;&lt; <a class="code" href="classSSAGES_1_1CFF.html#ae1cf5451e2263ef28e69b2aa62f2086b">hist_</a>.row(j);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">dim_</a>; ++i){</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                    nnet::matrix_t x = Ftrain[i].array();</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                    file &lt;&lt; std::setw(14) &lt;&lt; std::setprecision(8) &lt;&lt; std::fixed &lt;&lt; x(j) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                file &lt;&lt; std::endl;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            file &lt;&lt; std::endl;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            file &lt;&lt; std::endl;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            file.close();</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="comment">// Output training time information</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordtype">double</span> duration = ( std::clock() - start ) / (<span class="keywordtype">double</span>) CLOCKS_PER_SEC;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        std::ofstream file1(<span class="stringliteral">&quot;traintime.out&quot;</span>,std::ofstream::app);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        file1 &lt;&lt; duration &lt;&lt; std::endl;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        file1.close();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a18619ba8fb2d677895af1282ff26f35c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18619ba8fb2d677895af1282ff26f35c">&#9670;&nbsp;</a></span>min_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SSAGES::CFF::min_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The minimum number of hits required before full biasing, bias is F_[i]/max(N_[i],min_). </p>

<p class="definition">Definition at line <a class="el" href="CFF_8h_source.html#l00122">122</a> of file <a class="el" href="CFF_8h_source.html">CFF.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/michael/development/SSAGES/src/Methods/<a class="el" href="CFF_8h_source.html">CFF.h</a></li>
<li>/home/michael/development/SSAGES/src/Methods/<a class="el" href="CFF_8cpp_source.html">CFF.cpp</a></li>
</ul>
</div><!-- contents -->
<div class="ttc" id="aclassSSAGES_1_1GridBase_html_a52e519b13f9b53c0767957d86015b0a1"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#a52e519b13f9b53c0767957d86015b0a1">SSAGES::GridBase::data</a></div><div class="ttdeci">T * data()</div><div class="ttdoc">Get pointer to the internal data storage vector.</div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00338">GridBase.h:338</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_a60107d02f7c6a9f8d3ace76474abdce4"><div class="ttname"><a href="classSSAGES_1_1CFF.html#a60107d02f7c6a9f8d3ace76474abdce4">SSAGES::CFF::ratio_</a></div><div class="ttdeci">double ratio_</div><div class="ttdoc">Hold parameters to adjust ratio of 1st and 2nd neural networks (freq vs force-based).</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00091">CFF.h:91</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_a25f6bcb7fb67d5b6ed22c0bff9861386"><div class="ttname"><a href="classSSAGES_1_1CFF.html#a25f6bcb7fb67d5b6ed22c0bff9861386">SSAGES::CFF::net_</a></div><div class="ttdeci">nnet::neural_net net_</div><div class="ttdoc">Neural network trained using visit frequency.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00049">CFF.h:49</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_a18619ba8fb2d677895af1282ff26f35c"><div class="ttname"><a href="classSSAGES_1_1CFF.html#a18619ba8fb2d677895af1282ff26f35c">SSAGES::CFF::min_</a></div><div class="ttdeci">int min_</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00122">CFF.h:122</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_a16fca1165c46e1c5ad987fc0ed902098"><div class="ttname"><a href="classSSAGES_1_1CFF.html#a16fca1165c46e1c5ad987fc0ed902098">SSAGES::CFF::SetRatio</a></div><div class="ttdeci">void SetRatio(double trainratio)</div><div class="ttdoc">Set training ratio for gradient vs value.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00257">CFF.h:257</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_a4268b195c8b6084e805b1006f29f1755"><div class="ttname"><a href="classSSAGES_1_1CFF.html#a4268b195c8b6084e805b1006f29f1755">SSAGES::CFF::hgrid_</a></div><div class="ttdeci">Grid&lt; unsigned int &gt; * hgrid_</div><div class="ttdoc">Histogram grid.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00082">CFF.h:82</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1Grid_html_ac4fcc9f0cd61476ce4fd880c768d9694"><div class="ttname"><a href="classSSAGES_1_1Grid.html#ac4fcc9f0cd61476ce4fd880c768d9694">SSAGES::Grid::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdoc">Return iterator after last valid grid point.</div><div class="ttdef"><b>Definition:</b> <a href="Grid_8h_source.html#l00540">Grid.h:540</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_ae8f3f198bf558555934e57f8911a0b80"><div class="ttname"><a href="classSSAGES_1_1CFF.html#ae8f3f198bf558555934e57f8911a0b80">SSAGES::CFF::unitconv_</a></div><div class="ttdeci">double unitconv_</div><div class="ttdoc">Unit conversion from mass*velocity/time to force.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00118">CFF.h:118</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1Method_html_ad751450ecd30e8ab40024c6f5e870d30"><div class="ttname"><a href="classSSAGES_1_1Method.html#ad751450ecd30e8ab40024c6f5e870d30">SSAGES::Method::Method</a></div><div class="ttdeci">Method(unsigned int frequency, const MPI_Comm &amp;world, const MPI_Comm &amp;comm)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00061">Method.h:61</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_aab3150942788dfe58e4ab5c9e1ceb24b"><div class="ttname"><a href="classSSAGES_1_1CFF.html#aab3150942788dfe58e4ab5c9e1ceb24b">SSAGES::CFF::CFF</a></div><div class="ttdeci">CFF(const MPI_Comm &amp;world, const MPI_Comm &amp;comm, const Eigen::VectorXi &amp;topol, Grid&lt; Eigen::VectorXd &gt; *fgrid, Grid&lt; unsigned int &gt; *hgrid, Grid&lt; double &gt; *ugrid, std::vector&lt; Grid&lt; double &gt; * &gt; F, std::vector&lt; Grid&lt; double &gt; * &gt; Fworld, const std::vector&lt; double &gt; &amp;lowerb, const std::vector&lt; double &gt; &amp;upperb, const std::vector&lt; double &gt; &amp;lowerk, const std::vector&lt; double &gt; &amp;upperk, double temperature, double unitconv, double timestep, double weight, unsigned int nsweep, int min)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00151">CFF.h:151</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_aa39ac519b1d4c33a22f98ff75ce8da02"><div class="ttname"><a href="classSSAGES_1_1CFF.html#aa39ac519b1d4c33a22f98ff75ce8da02">SSAGES::CFF::wdotp2_</a></div><div class="ttdeci">Eigen::VectorXd wdotp2_</div><div class="ttdoc">To hold second to last iteration wdotp value for numerical derivative.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00076">CFF.h:76</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_a23c970ab7afe94bea80389fbfe254586"><div class="ttname"><a href="classSSAGES_1_1CFF.html#a23c970ab7afe94bea80389fbfe254586">SSAGES::CFF::overwrite_</a></div><div class="ttdeci">bool overwrite_</div><div class="ttdoc">Overwrite outputs.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00106">CFF.h:106</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1GridBase_html_a2270a9233a9dc2d341e8ab88ce6655c9"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#a2270a9233a9dc2d341e8ab88ce6655c9">SSAGES::GridBase::GetLower</a></div><div class="ttdeci">const std::vector&lt; double &gt; GetLower() const</div><div class="ttdoc">Return the lower edges of the Grid.</div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00231">GridBase.h:231</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1Method_html_a24b0ac53b1fabcab0a5f3bd6cde26909"><div class="ttname"><a href="classSSAGES_1_1Method.html#a24b0ac53b1fabcab0a5f3bd6cde26909">SSAGES::Method::cvmask_</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; cvmask_</div><div class="ttdoc">Mask which identifies which CVs to act on.</div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00050">Method.h:50</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1GridBase_html_a7da01557a9b85498c2acd975c152403a"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#a7da01557a9b85498c2acd975c152403a">SSAGES::GridBase::at</a></div><div class="ttdeci">const T &amp; at(const std::vector&lt; int &gt; &amp;indices) const</div><div class="ttdoc">Access Grid element read-only.</div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00546">GridBase.h:546</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_ad3b9f23780098639d2a52b3f774a6525"><div class="ttname"><a href="classSSAGES_1_1CFF.html#ad3b9f23780098639d2a52b3f774a6525">SSAGES::CFF::force_to_val_ratio_</a></div><div class="ttdeci">Eigen::MatrixXd force_to_val_ratio_</div><div class="ttdoc">To hold booleans for training neural network only in specific region for net2_.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00125">CFF.h:125</a></div></div>
<div class="ttc" id="aclassJson_1_1ObjectRequirement_html"><div class="ttname"><a href="classJson_1_1ObjectRequirement.html">Json::ObjectRequirement</a></div><div class="ttdoc">Requirements on an object.</div><div class="ttdef"><b>Definition:</b> <a href="ObjectRequirement_8h_source.html#l00046">ObjectRequirement.h:47</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_a5ae96842cc6a3c907da11d12de90b79f"><div class="ttname"><a href="classSSAGES_1_1CFF.html#a5ae96842cc6a3c907da11d12de90b79f">SSAGES::CFF::topol_</a></div><div class="ttdeci">Eigen::VectorXi topol_</div><div class="ttdoc">Neural network topology.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00040">CFF.h:40</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1GridBase_html_a875feace8fff4743b103147c4193eca0"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#a875feace8fff4743b103147c4193eca0">SSAGES::GridBase::GetUpper</a></div><div class="ttdeci">const std::vector&lt; double &gt; GetUpper() const</div><div class="ttdoc">Return the upper edges of the Grid.</div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00262">GridBase.h:262</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_a341c64332f5ff6ba3cdc6442e5406ed4"><div class="ttname"><a href="classSSAGES_1_1CFF.html#a341c64332f5ff6ba3cdc6442e5406ed4">SSAGES::CFF::sweep_</a></div><div class="ttdeci">unsigned int sweep_</div><div class="ttdoc">Number of iterations per sweep.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00043">CFF.h:43</a></div></div>
<div class="ttc" id="aclassJson_1_1Requirement_html_a60bc275c366eb59f192fa2e621268480"><div class="ttname"><a href="classJson_1_1Requirement.html#a60bc275c366eb59f192fa2e621268480">Json::Requirement::GetErrors</a></div><div class="ttdeci">std::vector&lt; std::string &gt; GetErrors()</div><div class="ttdoc">Get list of error messages.</div><div class="ttdef"><b>Definition:</b> <a href="Requirement_8h_source.html#l00092">Requirement.h:92</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_a68d3b1aa7c03c407b9a13a55f5c529cb"><div class="ttname"><a href="classSSAGES_1_1CFF.html#a68d3b1aa7c03c407b9a13a55f5c529cb">SSAGES::CFF::Nworld_</a></div><div class="ttdeci">Eigen::ArrayXi Nworld_</div><div class="ttdoc">Histogram grid for that sotres the number of global hits.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00085">CFF.h:85</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1GridBase_html_ab52bfd510cd1dffb2d91f516c9266c4b"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#ab52bfd510cd1dffb2d91f516c9266c4b">SSAGES::GridBase::syncGrid</a></div><div class="ttdeci">void syncGrid()</div><div class="ttdoc">Sync the grid.</div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00146">GridBase.h:146</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_abbbfe00f423669ebe4b02abca581d4ff"><div class="ttname"><a href="classSSAGES_1_1CFF.html#abbbfe00f423669ebe4b02abca581d4ff">SSAGES::CFF::WriteBias</a></div><div class="ttdeci">void WriteBias()</div><div class="ttdoc">Writes out the bias and CFF output files.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8cpp_source.html#l00369">CFF.cpp:369</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1GridBase_html_a72f98ef47da691b00823d612efbd46b8"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#a72f98ef47da691b00823d612efbd46b8">SSAGES::GridBase::GetDimension</a></div><div class="ttdeci">size_t GetDimension() const</div><div class="ttdoc">Get the dimension.</div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00195">GridBase.h:195</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_af4472f7ce0b907d88bff353deb2d9a00"><div class="ttname"><a href="classSSAGES_1_1CFF.html#af4472f7ce0b907d88bff353deb2d9a00">SSAGES::CFF::wdotp1_</a></div><div class="ttdeci">Eigen::VectorXd wdotp1_</div><div class="ttdoc">To hold last iteration wdotp value for numerical derivative.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00073">CFF.h:73</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1Grid_html_a24d2373042debae156618906637e819c"><div class="ttname"><a href="classSSAGES_1_1Grid.html#a24d2373042debae156618906637e819c">SSAGES::Grid::BuildGrid</a></div><div class="ttdeci">static Grid&lt; T &gt; * BuildGrid(const Json::Value &amp;json)</div><div class="ttdoc">Set up the grid.</div><div class="ttdef"><b>Definition:</b> <a href="Grid_8h_source.html#l00127">Grid.h:127</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_a57e61481b774bf1a12c0aba8ad4e9064"><div class="ttname"><a href="classSSAGES_1_1CFF.html#a57e61481b774bf1a12c0aba8ad4e9064">SSAGES::CFF::timestep_</a></div><div class="ttdeci">double timestep_</div><div class="ttdoc">Timestep.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00055">CFF.h:55</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_a4acd48bf29d688abab039d9ad07bca05"><div class="ttname"><a href="classSSAGES_1_1CFF.html#a4acd48bf29d688abab039d9ad07bca05">SSAGES::CFF::temp_</a></div><div class="ttdeci">double temp_</div><div class="ttdoc">System temperature and energy units.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00061">CFF.h:61</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_ae7abba4174eac0b3f7b1f9bf7697b456"><div class="ttname"><a href="classSSAGES_1_1CFF.html#ae7abba4174eac0b3f7b1f9bf7697b456">SSAGES::CFF::dim_</a></div><div class="ttdeci">int dim_</div><div class="ttdoc">Number of CVs in system.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00115">CFF.h:115</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_a15b0b7d29205cc4d1645612c6f8ffbba"><div class="ttname"><a href="classSSAGES_1_1CFF.html#a15b0b7d29205cc4d1645612c6f8ffbba">SSAGES::CFF::citers_</a></div><div class="ttdeci">unsigned int citers_</div><div class="ttdoc">Number of iterations after which we turn on full weight.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00046">CFF.h:46</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_ae1cf5451e2263ef28e69b2aa62f2086b"><div class="ttname"><a href="classSSAGES_1_1CFF.html#ae1cf5451e2263ef28e69b2aa62f2086b">SSAGES::CFF::hist_</a></div><div class="ttdeci">Eigen::MatrixXd hist_</div><div class="ttdoc">Eigen matrices of grids.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00094">CFF.h:94</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_a885e158d5d31846a427f3ee3c1ecfccc"><div class="ttname"><a href="classSSAGES_1_1CFF.html#a885e158d5d31846a427f3ee3c1ecfccc">SSAGES::CFF::Fworld_</a></div><div class="ttdeci">std::vector&lt; Grid&lt; double &gt; * &gt; Fworld_</div><div class="ttdoc">Generalized force grid that stors the global total.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00067">CFF.h:67</a></div></div>
<div class="ttc" id="aclassJson_1_1ObjectRequirement_html_a9ac3b920001a35bc70580035d8d802b7"><div class="ttname"><a href="classJson_1_1ObjectRequirement.html#a9ac3b920001a35bc70580035d8d802b7">Json::ObjectRequirement::Validate</a></div><div class="ttdeci">virtual void Validate(const Value &amp;json, const std::string &amp;path) override</div><div class="ttdoc">Validate JSON value.</div><div class="ttdef"><b>Definition:</b> <a href="ObjectRequirement_8h_source.html#l00239">ObjectRequirement.h:239</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_ac5fd2beef14c41ec395185e6a8ee4fc2"><div class="ttname"><a href="classSSAGES_1_1CFF.html#ac5fd2beef14c41ec395185e6a8ee4fc2">SSAGES::CFF::fgrid_</a></div><div class="ttdeci">Grid&lt; Eigen::VectorXd &gt; * fgrid_</div><div class="ttdoc">Force grid.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00079">CFF.h:79</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_a63b71ad4ad5f00e274f9b7412c374d8c"><div class="ttname"><a href="classSSAGES_1_1CFF.html#a63b71ad4ad5f00e274f9b7412c374d8c">SSAGES::CFF::net2_</a></div><div class="ttdeci">nnet::neural_net net2_</div><div class="ttdoc">Neural network trained on both visit frequency and force.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00052">CFF.h:52</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1Method_html_a8471b11097a1018a9635bc578bf22f61"><div class="ttname"><a href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">SSAGES::Method::world_</a></div><div class="ttdeci">mxx::comm world_</div><div class="ttdoc">Global MPI communicator.</div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00046">Method.h:46</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1GridBase_html_ab56c5b7786560a9a35951f1c3a44b077"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#ab56c5b7786560a9a35951f1c3a44b077">SSAGES::GridBase::GetNumPoints</a></div><div class="ttdeci">const std::vector&lt; int &gt; GetNumPoints() const</div><div class="ttdoc">Get the number of points for all dimensions.</div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00205">GridBase.h:205</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_ae40a6c617732bc0bf260dbaba5b62330"><div class="ttname"><a href="classSSAGES_1_1CFF.html#ae40a6c617732bc0bf260dbaba5b62330">SSAGES::CFF::F_</a></div><div class="ttdeci">std::vector&lt; Grid&lt; double &gt; * &gt; F_</div><div class="ttdoc">Generalized force grid that stores total of the local walker.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00064">CFF.h:64</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_a857edf66ca0e8f468bcc93a761a10984"><div class="ttname"><a href="classSSAGES_1_1CFF.html#a857edf66ca0e8f468bcc93a761a10984">SSAGES::CFF::Fold_</a></div><div class="ttdeci">Eigen::VectorXd Fold_</div><div class="ttdoc">To hold the last iterations F_ value for removing bias.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00070">CFF.h:70</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_ae71f141f144ada85ab9ffdec8a2acdb2"><div class="ttname"><a href="classSSAGES_1_1CFF.html#ae71f141f144ada85ab9ffdec8a2acdb2">SSAGES::CFF::TrainNetwork</a></div><div class="ttdeci">void TrainNetwork()</div><div class="ttdoc">Trains the neural network.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8cpp_source.html#l00232">CFF.cpp:232</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_aaaa2b8d2e893ba22734d6caaef2c4e4a"><div class="ttname"><a href="classSSAGES_1_1CFF.html#aaaa2b8d2e893ba22734d6caaef2c4e4a">SSAGES::CFF::lowerb_</a></div><div class="ttdeci">std::vector&lt; double &gt; lowerb_</div><div class="ttdoc">Bounds.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00097">CFF.h:97</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_acf1402b886e72ac0fb43ca5d6695cd62"><div class="ttname"><a href="classSSAGES_1_1CFF.html#acf1402b886e72ac0fb43ca5d6695cd62">SSAGES::CFF::lowerk_</a></div><div class="ttdeci">std::vector&lt; double &gt; lowerk_</div><div class="ttdoc">Bound restraints.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00100">CFF.h:100</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1Grid_html_a709374b3cadf320347604077a2e45e5b"><div class="ttname"><a href="classSSAGES_1_1Grid.html#a709374b3cadf320347604077a2e45e5b">SSAGES::Grid::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdoc">Return iterator at first grid point.</div><div class="ttdef"><b>Definition:</b> <a href="Grid_8h_source.html#l00527">Grid.h:527</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_aaf57efee95f11623cccb4ddb99e4b39c"><div class="ttname"><a href="classSSAGES_1_1CFF.html#aaf57efee95f11623cccb4ddb99e4b39c">SSAGES::CFF::pweight_</a></div><div class="ttdeci">double pweight_</div><div class="ttdoc">Previous and current histogram weight.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00058">CFF.h:58</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1EventListener_html_af9666daacfb047c1dd279ea339524d07"><div class="ttname"><a href="classSSAGES_1_1EventListener.html#af9666daacfb047c1dd279ea339524d07">SSAGES::EventListener::IsMasterRank</a></div><div class="ttdeci">static bool IsMasterRank(const MPI_Comm &amp;comm)</div><div class="ttdoc">Check if current processor is master.</div><div class="ttdef"><b>Definition:</b> <a href="EventListener_8h_source.html#l00110">EventListener.h:110</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1Method_html_a1118666d61dbf3bc7606e3b61aa3a460"><div class="ttname"><a href="classSSAGES_1_1Method.html#a1118666d61dbf3bc7606e3b61aa3a460">SSAGES::Method::comm_</a></div><div class="ttdeci">mxx::comm comm_</div><div class="ttdoc">Local MPI communicator.</div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00047">Method.h:47</a></div></div>
<div class="ttc" id="aclassJson_1_1ObjectRequirement_html_a4ed02ae1d612a5efba1688fcdd2df092"><div class="ttname"><a href="classJson_1_1ObjectRequirement.html#a4ed02ae1d612a5efba1688fcdd2df092">Json::ObjectRequirement::Parse</a></div><div class="ttdeci">virtual void Parse(Value json, const std::string &amp;path) override</div><div class="ttdoc">Parse JSON value to generate Requirement(s).</div><div class="ttdef"><b>Definition:</b> <a href="ObjectRequirement_8h_source.html#l00142">ObjectRequirement.h:142</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_ab7ff346cb1092b47b2b1c92a3493e043"><div class="ttname"><a href="classSSAGES_1_1CFF.html#ab7ff346cb1092b47b2b1c92a3493e043">SSAGES::CFF::ugrid_</a></div><div class="ttdeci">Grid&lt; double &gt; * ugrid_</div><div class="ttdoc">Unbiased histogram grid.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00088">CFF.h:88</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1GridBase_html_a4f8abb752ae6ec51ebcf24b599bf4896"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#a4f8abb752ae6ec51ebcf24b599bf4896">SSAGES::GridBase::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdoc">Get the size of the internal storage vector.</div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00326">GridBase.h:326</a></div></div>
<div class="ttc" id="aclassJson_1_1Requirement_html_adfaec336a9f051d6f6b9a6d7f1d97b75"><div class="ttname"><a href="classJson_1_1Requirement.html#adfaec336a9f051d6f6b9a6d7f1d97b75">Json::Requirement::HasErrors</a></div><div class="ttdeci">bool HasErrors()</div><div class="ttdoc">Check if errors have occured.</div><div class="ttdef"><b>Definition:</b> <a href="Requirement_8h_source.html#l00086">Requirement.h:86</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1CFF_html_a649ecdc2b50e67ce7afc663d43da8425"><div class="ttname"><a href="classSSAGES_1_1CFF.html#a649ecdc2b50e67ce7afc663d43da8425">SSAGES::CFF::outfile_</a></div><div class="ttdeci">std::string outfile_</div><div class="ttdoc">Output filename.</div><div class="ttdef"><b>Definition:</b> <a href="CFF_8h_source.html#l00103">CFF.h:103</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jun 11 2020 15:10:17 for SSAGES by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
