\hypertarget{classSSAGES_1_1GyrationTensorCV}{}\doxysection{S\+S\+A\+G\+ES\+::Gyration\+Tensor\+CV Class Reference}
\label{classSSAGES_1_1GyrationTensorCV}\index{SSAGES::GyrationTensorCV@{SSAGES::GyrationTensorCV}}


Collective variable on components of the gyration tensor.  




{\ttfamily \#include $<$Gyration\+Tensor\+C\+V.\+h$>$}



Inheritance diagram for S\+S\+A\+G\+ES\+::Gyration\+Tensor\+CV\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=225pt]{classSSAGES_1_1GyrationTensorCV__inherit__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_a54a008fdec13d9fc23b9adfb41172717}{Gyration\+Tensor\+CV}} (const \mbox{\hyperlink{namespaceSSAGES_afbb26053e292f94ea83b1c441ce6df74}{Label}} \&atomids, \mbox{\hyperlink{namespaceSSAGES_a1e8dbeb2d0dee0f1c921aa72b5fd6dba}{Gyration\+Tensor}} component)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_a4f1fb7586aec99f7ddbb3faf8ef9364d}{Gyration\+Tensor\+CV}} (const \mbox{\hyperlink{namespaceSSAGES_afbb26053e292f94ea83b1c441ce6df74}{Label}} \&atomids, \mbox{\hyperlink{namespaceSSAGES_a1e8dbeb2d0dee0f1c921aa72b5fd6dba}{Gyration\+Tensor}} component, bool dimx, bool dimy, bool dimz)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_ad45ea81cf07cb3a95da83feb0ee1f3ba}{Initialize}} (const \mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} \&snapshot) override
\begin{DoxyCompactList}\small\item\em Initialize necessary variables. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_ac613c1659bd00b335c3d6de3d8ff0ebc}{Evaluate}} (const \mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} \&snapshot) override
\begin{DoxyCompactList}\small\item\em Evaluate the CV. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV}{Gyration\+Tensor\+CV}} $\ast$ \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_a68cd7731a77e1a4e4ba2835a6fe65467}{Build}} (const Json\+::\+Value \&json, const std\+::string \&path)
\begin{DoxyCompactList}\small\item\em Set up collective variable. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classSSAGES_1_1GyrationTensorCV_a5afa1881237d42f38a130663581f632b}\label{classSSAGES_1_1GyrationTensorCV_a5afa1881237d42f38a130663581f632b}} 
\mbox{\hyperlink{namespaceSSAGES_afbb26053e292f94ea83b1c441ce6df74}{Label}} \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_a5afa1881237d42f38a130663581f632b}{atomids\+\_\+}}
\begin{DoxyCompactList}\small\item\em I\+Ds of the atoms used for calculation. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1GyrationTensorCV_a0204db1d939bda7405d66cbb6a56dfcb}\label{classSSAGES_1_1GyrationTensorCV_a0204db1d939bda7405d66cbb6a56dfcb}} 
\mbox{\hyperlink{namespaceSSAGES_a1e8dbeb2d0dee0f1c921aa72b5fd6dba}{Gyration\+Tensor}} \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_a0204db1d939bda7405d66cbb6a56dfcb}{component\+\_\+}}
\begin{DoxyCompactList}\small\item\em Component of gyration tensor to compute. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1GyrationTensorCV_aaa3d5c7351486917dbcebd1e921cc846}\label{classSSAGES_1_1GyrationTensorCV_aaa3d5c7351486917dbcebd1e921cc846}} 
\mbox{\hyperlink{namespaceSSAGES_ab85a44d30d5f2621f266dc52203aacef}{Bool3}} \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_aaa3d5c7351486917dbcebd1e921cc846}{dim\+\_\+}}
\begin{DoxyCompactList}\small\item\em Each dimension determines if it is applied by the CV. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
Collective variable on components of the gyration tensor. 

Collective variable on components of gyration tensor. Depending on the user selection, this will specify a principal moment, radius of gyration, or another shape descriptor. 

Definition at line 56 of file Gyration\+Tensor\+C\+V.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classSSAGES_1_1GyrationTensorCV_a54a008fdec13d9fc23b9adfb41172717}\label{classSSAGES_1_1GyrationTensorCV_a54a008fdec13d9fc23b9adfb41172717}} 
\index{SSAGES::GyrationTensorCV@{SSAGES::GyrationTensorCV}!GyrationTensorCV@{GyrationTensorCV}}
\index{GyrationTensorCV@{GyrationTensorCV}!SSAGES::GyrationTensorCV@{SSAGES::GyrationTensorCV}}
\doxysubsubsection{\texorpdfstring{GyrationTensorCV()}{GyrationTensorCV()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily S\+S\+A\+G\+E\+S\+::\+Gyration\+Tensor\+C\+V\+::\+Gyration\+Tensor\+CV (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{namespaceSSAGES_afbb26053e292f94ea83b1c441ce6df74}{Label}} \&}]{atomids,  }\item[{\mbox{\hyperlink{namespaceSSAGES_a1e8dbeb2d0dee0f1c921aa72b5fd6dba}{Gyration\+Tensor}}}]{component }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em atomids} & I\+Ds of the atoms defining gyration tensor. \\
\hline
{\em component} & Specification of component to compute.\\
\hline
\end{DoxyParams}
Construct a \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV}{Gyration\+Tensor\+CV}}. 

Definition at line 74 of file Gyration\+Tensor\+C\+V.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{74                                                                          :}
\DoxyCodeLine{75         \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_a5afa1881237d42f38a130663581f632b}{atomids\_}}(atomids), \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_a0204db1d939bda7405d66cbb6a56dfcb}{component\_}}(component), \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_aaa3d5c7351486917dbcebd1e921cc846}{dim\_}}\{\textcolor{keyword}{true}, \textcolor{keyword}{true}, \textcolor{keyword}{true}\}}
\DoxyCodeLine{76         \{}
\DoxyCodeLine{77         \}}

\end{DoxyCode}


Referenced by Build().

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1GyrationTensorCV_a54a008fdec13d9fc23b9adfb41172717_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1GyrationTensorCV_a4f1fb7586aec99f7ddbb3faf8ef9364d}\label{classSSAGES_1_1GyrationTensorCV_a4f1fb7586aec99f7ddbb3faf8ef9364d}} 
\index{SSAGES::GyrationTensorCV@{SSAGES::GyrationTensorCV}!GyrationTensorCV@{GyrationTensorCV}}
\index{GyrationTensorCV@{GyrationTensorCV}!SSAGES::GyrationTensorCV@{SSAGES::GyrationTensorCV}}
\doxysubsubsection{\texorpdfstring{GyrationTensorCV()}{GyrationTensorCV()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily S\+S\+A\+G\+E\+S\+::\+Gyration\+Tensor\+C\+V\+::\+Gyration\+Tensor\+CV (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{namespaceSSAGES_afbb26053e292f94ea83b1c441ce6df74}{Label}} \&}]{atomids,  }\item[{\mbox{\hyperlink{namespaceSSAGES_a1e8dbeb2d0dee0f1c921aa72b5fd6dba}{Gyration\+Tensor}}}]{component,  }\item[{bool}]{dimx,  }\item[{bool}]{dimy,  }\item[{bool}]{dimz }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em atomids} & I\+Ds of the atoms defining gyration tensor. \\
\hline
{\em component} & Specification of component to compute. \\
\hline
{\em dimx} & If {\ttfamily True}, include x dimension. \\
\hline
{\em dimy} & If {\ttfamily True}, include y dimension. \\
\hline
{\em dimz} & If {\ttfamily True}, include z dimension.\\
\hline
\end{DoxyParams}
Construct a \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV}{Gyration\+Tensor\+CV}}. 

Definition at line 90 of file Gyration\+Tensor\+C\+V.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{90                                                                                                           :}
\DoxyCodeLine{91         \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_a5afa1881237d42f38a130663581f632b}{atomids\_}}(atomids), \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_a0204db1d939bda7405d66cbb6a56dfcb}{component\_}}(component), \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_aaa3d5c7351486917dbcebd1e921cc846}{dim\_}}\{dimx, dimy, dimz\}}
\DoxyCodeLine{92         \{}
\DoxyCodeLine{93         \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classSSAGES_1_1GyrationTensorCV_a68cd7731a77e1a4e4ba2835a6fe65467}\label{classSSAGES_1_1GyrationTensorCV_a68cd7731a77e1a4e4ba2835a6fe65467}} 
\index{SSAGES::GyrationTensorCV@{SSAGES::GyrationTensorCV}!Build@{Build}}
\index{Build@{Build}!SSAGES::GyrationTensorCV@{SSAGES::GyrationTensorCV}}
\doxysubsubsection{\texorpdfstring{Build()}{Build()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV}{Gyration\+Tensor\+CV}}$\ast$ S\+S\+A\+G\+E\+S\+::\+Gyration\+Tensor\+C\+V\+::\+Build (\begin{DoxyParamCaption}\item[{const Json\+::\+Value \&}]{json,  }\item[{const std\+::string \&}]{path }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Set up collective variable. 


\begin{DoxyParams}{Parameters}
{\em json} & \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} input value. \\
\hline
{\em path} & Path for \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} path specification. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the CV built by this function. {\ttfamily nullptr} in case of unknown error.
\end{DoxyReturn}
Builds a CV from a \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} node. Returns a pointer to the built cv. If an unknown error is encountered, this function will return a {\ttfamily nullptr}, but generally it will throw a \mbox{\hyperlink{classSSAGES_1_1BuildException}{Build\+Exception}} on failure. \begin{DoxyWarning}{Warning}
Object lifetime is the caller\textquotesingle{}s responsibility. 
\end{DoxyWarning}


Definition at line 246 of file Gyration\+Tensor\+C\+V.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{247         \{}
\DoxyCodeLine{248             \mbox{\hyperlink{classJson_1_1ObjectRequirement}{Json::ObjectRequirement}} validator;}
\DoxyCodeLine{249             Json::Value schema;}
\DoxyCodeLine{250             Json::CharReaderBuilder rbuilder;}
\DoxyCodeLine{251             Json::CharReader* reader = rbuilder.newCharReader();}
\DoxyCodeLine{252 }
\DoxyCodeLine{253             reader-\/>parse(JsonSchema::GyrationTensorCV.c\_str(),}
\DoxyCodeLine{254                           JsonSchema::GyrationTensorCV.c\_str() + JsonSchema::GyrationTensorCV.size(),}
\DoxyCodeLine{255                           \&schema, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{256             validator.\mbox{\hyperlink{classJson_1_1ObjectRequirement_a4ed02ae1d612a5efba1688fcdd2df092}{Parse}}(schema, path);}
\DoxyCodeLine{257 }
\DoxyCodeLine{258             \textcolor{comment}{// Validate inputs. }}
\DoxyCodeLine{259             validator.\mbox{\hyperlink{classJson_1_1ObjectRequirement_a9ac3b920001a35bc70580035d8d802b7}{Validate}}(json, path); }
\DoxyCodeLine{260             \textcolor{keywordflow}{if}(validator.\mbox{\hyperlink{classJson_1_1Requirement_adfaec336a9f051d6f6b9a6d7f1d97b75}{HasErrors}}())}
\DoxyCodeLine{261                 \textcolor{keywordflow}{throw} BuildException(validator.\mbox{\hyperlink{classJson_1_1Requirement_a60bc275c366eb59f192fa2e621268480}{GetErrors}}());}
\DoxyCodeLine{262 }
\DoxyCodeLine{263             std::vector<int> atomids; }
\DoxyCodeLine{264             \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& s : json[\textcolor{stringliteral}{"atom\_ids"}])}
\DoxyCodeLine{265                 atomids.push\_back(s.asInt());}
\DoxyCodeLine{266 }
\DoxyCodeLine{267             \mbox{\hyperlink{namespaceSSAGES_a1e8dbeb2d0dee0f1c921aa72b5fd6dba}{GyrationTensor}} component = Rg;}
\DoxyCodeLine{268             \textcolor{keyword}{auto} comp = json[\textcolor{stringliteral}{"component"}].asString();}
\DoxyCodeLine{269             }
\DoxyCodeLine{270             \textcolor{keywordflow}{if}(comp == \textcolor{stringliteral}{"Rg"})}
\DoxyCodeLine{271                 component = Rg; }
\DoxyCodeLine{272             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(comp == \textcolor{stringliteral}{"principal1"})}
\DoxyCodeLine{273                 component = principal1;}
\DoxyCodeLine{274             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(comp == \textcolor{stringliteral}{"principal2"})}
\DoxyCodeLine{275                 component = principal2;}
\DoxyCodeLine{276             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(comp == \textcolor{stringliteral}{"principal3"})}
\DoxyCodeLine{277                 component = principal3;}
\DoxyCodeLine{278             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(comp == \textcolor{stringliteral}{"asphericity"})}
\DoxyCodeLine{279                 component = asphericity;}
\DoxyCodeLine{280             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(comp == \textcolor{stringliteral}{"acylindricity"})}
\DoxyCodeLine{281                 component = acylindricity;}
\DoxyCodeLine{282             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(comp == \textcolor{stringliteral}{"shapeaniso"})}
\DoxyCodeLine{283                 component = shapeaniso;}
\DoxyCodeLine{284 }
\DoxyCodeLine{285             \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_a54a008fdec13d9fc23b9adfb41172717}{GyrationTensorCV}}* c;}
\DoxyCodeLine{286             \textcolor{keywordflow}{if}(json.isMember(\textcolor{stringliteral}{"dimension"}))}
\DoxyCodeLine{287             \{}
\DoxyCodeLine{288                 \textcolor{keyword}{auto} dimx = json[\textcolor{stringliteral}{"dimension"}][0].asBool();}
\DoxyCodeLine{289                 \textcolor{keyword}{auto} dimy = json[\textcolor{stringliteral}{"dimension"}][1].asBool();}
\DoxyCodeLine{290                 \textcolor{keyword}{auto} dimz = json[\textcolor{stringliteral}{"dimension"}][2].asBool();}
\DoxyCodeLine{291                 c = \textcolor{keyword}{new} \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_a54a008fdec13d9fc23b9adfb41172717}{GyrationTensorCV}}(atomids, component, dimx, dimy, dimz);}
\DoxyCodeLine{292             \}}
\DoxyCodeLine{293             \textcolor{keywordflow}{else}}
\DoxyCodeLine{294                 c = \textcolor{keyword}{new} \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_a54a008fdec13d9fc23b9adfb41172717}{GyrationTensorCV}}(atomids, component);}
\DoxyCodeLine{295 }
\DoxyCodeLine{296             \textcolor{keywordflow}{return} c;}
\DoxyCodeLine{297         \}}

\end{DoxyCode}


References Json\+::\+Requirement\+::\+Get\+Errors(), Gyration\+Tensor\+C\+V(), Json\+::\+Requirement\+::\+Has\+Errors(), Json\+::\+Object\+Requirement\+::\+Parse(), and Json\+::\+Object\+Requirement\+::\+Validate().



Referenced by S\+S\+A\+G\+E\+S\+::\+Collective\+Variable\+::\+Build\+C\+V().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1GyrationTensorCV_a68cd7731a77e1a4e4ba2835a6fe65467_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1GyrationTensorCV_a68cd7731a77e1a4e4ba2835a6fe65467_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1GyrationTensorCV_ac613c1659bd00b335c3d6de3d8ff0ebc}\label{classSSAGES_1_1GyrationTensorCV_ac613c1659bd00b335c3d6de3d8ff0ebc}} 
\index{SSAGES::GyrationTensorCV@{SSAGES::GyrationTensorCV}!Evaluate@{Evaluate}}
\index{Evaluate@{Evaluate}!SSAGES::GyrationTensorCV@{SSAGES::GyrationTensorCV}}
\doxysubsubsection{\texorpdfstring{Evaluate()}{Evaluate()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+Gyration\+Tensor\+C\+V\+::\+Evaluate (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} \&}]{snapshot }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}



Evaluate the CV. 


\begin{DoxyParams}{Parameters}
{\em snapshot} & Current simulation snapshot. \\
\hline
\end{DoxyParams}


Definition at line 128 of file Gyration\+Tensor\+C\+V.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{129         \{}
\DoxyCodeLine{130             \textcolor{keyword}{using namespace }Eigen; }
\DoxyCodeLine{131 }
\DoxyCodeLine{132             \textcolor{comment}{// Get local atom indices and compute COM. }}
\DoxyCodeLine{133             std::vector<int> idx;}
\DoxyCodeLine{134             snapshot.GetLocalIndices(\mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_a5afa1881237d42f38a130663581f632b}{atomids\_}}, \&idx);}
\DoxyCodeLine{135 }
\DoxyCodeLine{136             \textcolor{comment}{// Get data from snapshot. }}
\DoxyCodeLine{137             \textcolor{keyword}{auto} n = snapshot.GetNumAtoms();}
\DoxyCodeLine{138             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& masses = snapshot.GetMasses();}
\DoxyCodeLine{139             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& pos = snapshot.GetPositions();}
\DoxyCodeLine{140 }
\DoxyCodeLine{141             \textcolor{comment}{// Initialize gradient.}}
\DoxyCodeLine{142             std::fill(\mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a390202f6e541da879f1cfcde22c49489}{grad\_}}.begin(), \mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a390202f6e541da879f1cfcde22c49489}{grad\_}}.end(), \mbox{\hyperlink{namespaceSSAGES_a630084a0a5e185e89e21b3735f8f8b2e}{Vector3}}\{0,0,0\});}
\DoxyCodeLine{143             \mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a390202f6e541da879f1cfcde22c49489}{grad\_}}.resize(n, \mbox{\hyperlink{namespaceSSAGES_a630084a0a5e185e89e21b3735f8f8b2e}{Vector3}}\{0,0,0\});}
\DoxyCodeLine{144             }
\DoxyCodeLine{145             \textcolor{comment}{// Compute total and center of mass.}}
\DoxyCodeLine{146             \textcolor{keyword}{auto} masstot = snapshot.TotalMass(idx);}
\DoxyCodeLine{147             \mbox{\hyperlink{namespaceSSAGES_a630084a0a5e185e89e21b3735f8f8b2e}{Vector3}} com = snapshot.CenterOfMass(idx);}
\DoxyCodeLine{148 }
\DoxyCodeLine{149             \textcolor{comment}{// Gyration tensor and temporary vector to store positions in inertial frame. }}
\DoxyCodeLine{150             \mbox{\hyperlink{namespaceSSAGES_a306e635f4b20f86fbc726fbf9a5d11a8}{Matrix3}} S = Matrix3::Zero();}
\DoxyCodeLine{151             std::vector<Vector3> ris; }
\DoxyCodeLine{152             ris.reserve(idx.size());}
\DoxyCodeLine{153             \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& i : idx)}
\DoxyCodeLine{154             \{}
\DoxyCodeLine{155                 ris.emplace\_back(snapshot.ApplyMinimumImage(pos[i] -\/ com).cwiseProduct(\mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_aaa3d5c7351486917dbcebd1e921cc846}{dim\_}}.cast<\textcolor{keywordtype}{double}>()));}
\DoxyCodeLine{156                 S.noalias() += masses[i]*ris.back()*ris.back().transpose();}
\DoxyCodeLine{157             \}}
\DoxyCodeLine{158 }
\DoxyCodeLine{159             \textcolor{comment}{// Reduce gyration tensor across processors and normalize.}}
\DoxyCodeLine{160             MPI\_Allreduce(MPI\_IN\_PLACE, S.data(), S.size(), MPI\_DOUBLE, MPI\_SUM, snapshot.GetCommunicator());}
\DoxyCodeLine{161             S /= masstot;}
\DoxyCodeLine{162 }
\DoxyCodeLine{163             \textcolor{comment}{// Perform EVD. The columns are the eigenvectors. }}
\DoxyCodeLine{164             \textcolor{comment}{// SelfAdjoint solver sorts in ascending order. }}
\DoxyCodeLine{165             SelfAdjointEigenSolver<Matrix3> solver;}
\DoxyCodeLine{166             solver.computeDirect(S);}
\DoxyCodeLine{167             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& eigvals = solver.eigenvalues();}
\DoxyCodeLine{168             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& eigvecs = solver.eigenvectors();}
\DoxyCodeLine{169             }
\DoxyCodeLine{170             \textcolor{comment}{// Assign variables for clarity. l1 is largest.}}
\DoxyCodeLine{171             \textcolor{keyword}{auto} l1 = eigvals[2], }
\DoxyCodeLine{172                  l2 = eigvals[1], }
\DoxyCodeLine{173                  l3 = eigvals[0];}
\DoxyCodeLine{174             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& n1 = eigvecs.col(2), }
\DoxyCodeLine{175                         n2 = eigvecs.col(1), }
\DoxyCodeLine{176                         n3 = eigvecs.col(0);}
\DoxyCodeLine{177 }
\DoxyCodeLine{178             \mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a65b17f3e9b3c967ad42814c3eec88bb2}{val\_}} = 0;}
\DoxyCodeLine{179             \textcolor{keyword}{auto} sum = l1 + l2 + l3;}
\DoxyCodeLine{180             \textcolor{keyword}{auto} sqsum = l1*l1 + l2*l2 + l3*l3;}
\DoxyCodeLine{181             \textcolor{keywordflow}{switch}(\mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_a0204db1d939bda7405d66cbb6a56dfcb}{component\_}})}
\DoxyCodeLine{182             \{}
\DoxyCodeLine{183                 \textcolor{keywordflow}{case} Rg:}
\DoxyCodeLine{184                     \mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a65b17f3e9b3c967ad42814c3eec88bb2}{val\_}} = sum;}
\DoxyCodeLine{185                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{186                 \textcolor{keywordflow}{case} principal1:}
\DoxyCodeLine{187                     \mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a65b17f3e9b3c967ad42814c3eec88bb2}{val\_}} = l1;}
\DoxyCodeLine{188                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{189                 \textcolor{keywordflow}{case} principal2:}
\DoxyCodeLine{190                     \mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a65b17f3e9b3c967ad42814c3eec88bb2}{val\_}} = l2;}
\DoxyCodeLine{191                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{192                 \textcolor{keywordflow}{case} principal3:}
\DoxyCodeLine{193                     \mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a65b17f3e9b3c967ad42814c3eec88bb2}{val\_}} = l3;}
\DoxyCodeLine{194                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{195                 \textcolor{keywordflow}{case} asphericity:}
\DoxyCodeLine{196                     \mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a65b17f3e9b3c967ad42814c3eec88bb2}{val\_}} = l1 -\/ 0.5*(l2 + l3);}
\DoxyCodeLine{197                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{198                 \textcolor{keywordflow}{case} acylindricity:}
\DoxyCodeLine{199                     \mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a65b17f3e9b3c967ad42814c3eec88bb2}{val\_}} = l2 -\/ l3;}
\DoxyCodeLine{200                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{201                 \textcolor{keywordflow}{case} shapeaniso:}
\DoxyCodeLine{202                     \mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a65b17f3e9b3c967ad42814c3eec88bb2}{val\_}} = 1.5*sqsum/(sum*sum) -\/ 0.5;}
\DoxyCodeLine{203                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{204             \}}
\DoxyCodeLine{205 }
\DoxyCodeLine{206             \textcolor{comment}{// Compute gradient.}}
\DoxyCodeLine{207             \textcolor{keywordtype}{size\_t} j = 0;}
\DoxyCodeLine{208             \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& i : idx)}
\DoxyCodeLine{209             \{}
\DoxyCodeLine{210                 \textcolor{comment}{// Compute derivative of each eigenvalue and use combos in components. }}
\DoxyCodeLine{211                 \textcolor{keyword}{auto} dl1 = 2.*masses[i]/masstot*(1.-\/masses[i]/masstot)*ris[j].dot(n1)*n1;}
\DoxyCodeLine{212                 \textcolor{keyword}{auto} dl2 = 2.*masses[i]/masstot*(1.-\/masses[i]/masstot)*ris[j].dot(n2)*n2;}
\DoxyCodeLine{213                 \textcolor{keyword}{auto} dl3 = 2.*masses[i]/masstot*(1.-\/masses[i]/masstot)*ris[j].dot(n3)*n3;}
\DoxyCodeLine{214 }
\DoxyCodeLine{215                 \textcolor{keywordflow}{switch}(\mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_a0204db1d939bda7405d66cbb6a56dfcb}{component\_}})}
\DoxyCodeLine{216                 \{}
\DoxyCodeLine{217                     \textcolor{keywordflow}{case} Rg:}
\DoxyCodeLine{218                         \mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a390202f6e541da879f1cfcde22c49489}{grad\_}}[i] = dl1 + dl2 + dl3;}
\DoxyCodeLine{219                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{220                     \textcolor{keywordflow}{case} principal1:}
\DoxyCodeLine{221                         \mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a390202f6e541da879f1cfcde22c49489}{grad\_}}[i] = dl1;}
\DoxyCodeLine{222                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{223                     \textcolor{keywordflow}{case} principal2:}
\DoxyCodeLine{224                         \mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a390202f6e541da879f1cfcde22c49489}{grad\_}}[i] = dl2;}
\DoxyCodeLine{225                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{226                     \textcolor{keywordflow}{case} principal3:}
\DoxyCodeLine{227                         \mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a390202f6e541da879f1cfcde22c49489}{grad\_}}[i] = dl3;}
\DoxyCodeLine{228                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{229                     \textcolor{keywordflow}{case} asphericity:}
\DoxyCodeLine{230                         \mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a390202f6e541da879f1cfcde22c49489}{grad\_}}[i] = dl1 -\/ 0.5*(dl2 + dl3);}
\DoxyCodeLine{231                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{232                     \textcolor{keywordflow}{case} acylindricity:}
\DoxyCodeLine{233                         \mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a390202f6e541da879f1cfcde22c49489}{grad\_}}[i] = dl2 -\/ dl3;}
\DoxyCodeLine{234                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{235                     \textcolor{keywordflow}{case} shapeaniso:}
\DoxyCodeLine{236                         \mbox{\hyperlink{classSSAGES_1_1CollectiveVariable_a390202f6e541da879f1cfcde22c49489}{grad\_}}[i] = 3.*(l1*dl1+l2*dl2+l3*dl3)/(sum*sum) -\/ }
\DoxyCodeLine{237                                    3.*sqsum*(dl1+dl2+dl3)/(sum*sum*sum);}
\DoxyCodeLine{238                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{239                 \}}
\DoxyCodeLine{240 }
\DoxyCodeLine{241                 ++j;}
\DoxyCodeLine{242             \}}
\DoxyCodeLine{243         \}}

\end{DoxyCode}


References S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Apply\+Minimum\+Image(), atomids\+\_\+, S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Center\+Of\+Mass(), component\+\_\+, dim\+\_\+, S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Communicator(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Local\+Indices(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Masses(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Num\+Atoms(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Positions(), S\+S\+A\+G\+E\+S\+::\+Collective\+Variable\+::grad\+\_\+, S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Total\+Mass(), and S\+S\+A\+G\+E\+S\+::\+Collective\+Variable\+::val\+\_\+.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1GyrationTensorCV_ac613c1659bd00b335c3d6de3d8ff0ebc_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1GyrationTensorCV_ad45ea81cf07cb3a95da83feb0ee1f3ba}\label{classSSAGES_1_1GyrationTensorCV_ad45ea81cf07cb3a95da83feb0ee1f3ba}} 
\index{SSAGES::GyrationTensorCV@{SSAGES::GyrationTensorCV}!Initialize@{Initialize}}
\index{Initialize@{Initialize}!SSAGES::GyrationTensorCV@{SSAGES::GyrationTensorCV}}
\doxysubsubsection{\texorpdfstring{Initialize()}{Initialize()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+Gyration\+Tensor\+C\+V\+::\+Initialize (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} \&}]{snapshot }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}



Initialize necessary variables. 


\begin{DoxyParams}{Parameters}
{\em snapshot} & Current simulation snapshot. \\
\hline
\end{DoxyParams}


Definition at line 99 of file Gyration\+Tensor\+C\+V.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{100         \{}
\DoxyCodeLine{101             \textcolor{keyword}{using} std::to\_string;}
\DoxyCodeLine{102 }
\DoxyCodeLine{103             \textcolor{keyword}{auto} n = \mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_a5afa1881237d42f38a130663581f632b}{atomids\_}}.size();}
\DoxyCodeLine{104 }
\DoxyCodeLine{105             \textcolor{comment}{// Make sure atom ID's are on at least one processor. }}
\DoxyCodeLine{106             std::vector<int> found(n, 0);}
\DoxyCodeLine{107             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < n; ++i)}
\DoxyCodeLine{108             \{}
\DoxyCodeLine{109                 \textcolor{keywordflow}{if}(snapshot.GetLocalIndex(\mbox{\hyperlink{classSSAGES_1_1GyrationTensorCV_a5afa1881237d42f38a130663581f632b}{atomids\_}}[i]) != -\/1)}
\DoxyCodeLine{110                     found[i] = 1;}
\DoxyCodeLine{111             \}}
\DoxyCodeLine{112 }
\DoxyCodeLine{113             MPI\_Allreduce(MPI\_IN\_PLACE, found.data(), n, MPI\_INT, MPI\_SUM, snapshot.GetCommunicator());}
\DoxyCodeLine{114             \textcolor{keywordtype}{unsigned} ntot = std::accumulate(found.begin(), found.end(), 0, std::plus<int>());}
\DoxyCodeLine{115             \textcolor{keywordflow}{if}(ntot != n)}
\DoxyCodeLine{116                 \textcolor{keywordflow}{throw} BuildException(\{}
\DoxyCodeLine{117                     \textcolor{stringliteral}{"GyrationTensorCV: Expected to find "} + }
\DoxyCodeLine{118                     to\_string(n) + }
\DoxyCodeLine{119                     \textcolor{stringliteral}{" atoms, but only found "} + }
\DoxyCodeLine{120                     to\_string(ntot) + \textcolor{stringliteral}{"."}}
\DoxyCodeLine{121                 \});     }
\DoxyCodeLine{122         \}       }

\end{DoxyCode}


References atomids\+\_\+, S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Communicator(), and S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Local\+Index().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1GyrationTensorCV_ad45ea81cf07cb3a95da83feb0ee1f3ba_cgraph}
\end{center}
\end{figure}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/home/michael/development/\+S\+S\+A\+G\+E\+S/src/\+C\+Vs/Gyration\+Tensor\+C\+V.\+h\end{DoxyCompactItemize}
