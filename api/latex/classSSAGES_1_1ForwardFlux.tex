\hypertarget{classSSAGES_1_1ForwardFlux}{}\doxysection{S\+S\+A\+G\+ES\+::Forward\+Flux Class Reference}
\label{classSSAGES_1_1ForwardFlux}\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}


\mbox{\hyperlink{classSSAGES_1_1ForwardFlux}{Forward\+Flux}} sampling method.  




{\ttfamily \#include $<$Forward\+Flux.\+h$>$}



Inheritance diagram for S\+S\+A\+G\+ES\+::Forward\+Flux\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=224pt]{classSSAGES_1_1ForwardFlux__inherit__graph}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID}{F\+F\+S\+Config\+ID}}
\begin{DoxyCompactList}\small\item\em Nested class to store different F\+FS Config I\+Ds. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a77060dea307348f3df6b9dfb4069dfdb}{Forward\+Flux}} (const M\+P\+I\+\_\+\+Comm \&world, const M\+P\+I\+\_\+\+Comm \&comm, double ninterfaces, std\+::vector$<$ double $>$ interfaces, unsigned int N0\+Target, std\+::vector$<$ unsigned int $>$ M, bool initial\+Flux\+Flag, bool save\+Trajectories, unsigned int current\+Interface, std\+::string output\+\_\+directory, unsigned int frequency)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a3faeed11a3923e06b286ee8c51c10e86}{Pre\+Simulation}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$snapshot, const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&cvmanager) override
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{classSSAGES_1_1Method}{Method}} call prior to simulation initiation. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ad001fc1bc419967f3c9679cac04820f2}{Post\+Integration}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$snapshot, const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&cvmanager) override=0
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{classSSAGES_1_1Method}{Method}} call post integration. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a36b935ebdb93f80be3cd8f43684662f1}{Post\+Simulation}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$snapshot, const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&cvmanager) override
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{classSSAGES_1_1Method}{Method}} call post simulation. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{classSSAGES_1_1ForwardFlux}{Forward\+Flux}} $\ast$ \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a2fa0e637c261108c34cd14d7e8855cab}{Build}} (const Json\+::\+Value \&json, const M\+P\+I\+\_\+\+Comm \&world, const M\+P\+I\+\_\+\+Comm \&comm, const std\+::string \&path)
\begin{DoxyCompactList}\small\item\em Build a derived method from \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} node. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_aa0c07d4738ea73ed1d3589c3eb42c258}\label{classSSAGES_1_1ForwardFlux_aa0c07d4738ea73ed1d3589c3eb42c258}} 
void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_aa0c07d4738ea73ed1d3589c3eb42c258}{Check\+Initial\+Structure}} (const \mbox{\hyperlink{namespaceSSAGES_acddea47426ac0a643b048f870ddd2907}{C\+V\+List}} \&)
\begin{DoxyCompactList}\small\item\em Function that checks the initial structure that user provides. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_abb0ea2c2f477ba2d8aa4c43f72532eff}\label{classSSAGES_1_1ForwardFlux_abb0ea2c2f477ba2d8aa4c43f72532eff}} 
void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_abb0ea2c2f477ba2d8aa4c43f72532eff}{Write\+Initial\+Flux}} ()
\begin{DoxyCompactList}\small\item\em Function to compute and write the initial flux. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_afecda91c236066c31471e34680a4c9f1}{Add\+New\+I\+Ds\+To\+Queue}} ()
\item 
bool \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ae7c156e7bbb5e4d70c59c09587deb553}{Has\+Returned\+ToA}} (double current)
\begin{DoxyCompactList}\small\item\em Function checks if configuration has returned to A. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ad503e21a587cbac6536538de35d9e872}{Has\+Crossed\+Interface}} (double current, double prev, unsigned int i)
\begin{DoxyCompactList}\small\item\em Function checks if configuration has crossed interface specified since the last check. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a8f3da6706283040f7adf33399bdb2376}{Write\+F\+F\+S\+Configuration}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$snapshot, \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID}{F\+F\+S\+Config\+ID}} \&ffsconfig, bool wassuccess)
\begin{DoxyCompactList}\small\item\em Write a file corresponding to \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID}{F\+F\+S\+Config\+ID}} from current snapshot. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_aaf21bde2adc1a021de4ebb47d10c05a7}{Read\+F\+F\+S\+Configuration}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$snapshot, \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID}{F\+F\+S\+Config\+ID}} \&ffsconfig, bool wassuccess)
\begin{DoxyCompactList}\small\item\em Read a file corresponding to a \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID}{F\+F\+S\+Config\+ID}} into current snapshot. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a7406bdfbded69fca48c675d69949626d}\label{classSSAGES_1_1ForwardFlux_a7406bdfbded69fca48c675d69949626d}} 
void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a7406bdfbded69fca48c675d69949626d}{Compute\+Initial\+Flux}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$, const \mbox{\hyperlink{namespaceSSAGES_acddea47426ac0a643b048f870ddd2907}{C\+V\+List}} \&)
\begin{DoxyCompactList}\small\item\em Compute Initial Flux. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_ab29defb5bcbaca0c7c33d7ecb91184f6}\label{classSSAGES_1_1ForwardFlux_ab29defb5bcbaca0c7c33d7ecb91184f6}} 
virtual void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ab29defb5bcbaca0c7c33d7ecb91184f6}{Check\+For\+Interface\+Crossings}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$, const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&)=0
\begin{DoxyCompactList}\small\item\em Function that checks if interfaces have been crossed (different for each F\+FS flavor) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a23c3a0bbf9e7a4ad567f360ddadf0243}\label{classSSAGES_1_1ForwardFlux_a23c3a0bbf9e7a4ad567f360ddadf0243}} 
virtual void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a23c3a0bbf9e7a4ad567f360ddadf0243}{Initialize\+Queue}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$, const \mbox{\hyperlink{namespaceSSAGES_acddea47426ac0a643b048f870ddd2907}{C\+V\+List}} \&)=0
\begin{DoxyCompactList}\small\item\em Initialize the Queue. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a40ea4795340f509536b8276a8c1cc92a}{Compute\+Transition\+Probabilities}} ()
\begin{DoxyCompactList}\small\item\em Compute the probability of going from each lambda\+\_\+i to lambda\+\_\+\{i+1\}. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a7f814e3f300b0567e8b134364f882d58}\label{classSSAGES_1_1ForwardFlux_a7f814e3f300b0567e8b134364f882d58}} 
void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a7f814e3f300b0567e8b134364f882d58}{Print\+Queue}} ()
\begin{DoxyCompactList}\small\item\em Print the queue, useful for debugging. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_ac5227afa53bf05d387b480850ef4bb77}\label{classSSAGES_1_1ForwardFlux_ac5227afa53bf05d387b480850ef4bb77}} 
void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac5227afa53bf05d387b480850ef4bb77}{Pop\+Queue\+M\+PI}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$, const \mbox{\hyperlink{namespaceSSAGES_acddea47426ac0a643b048f870ddd2907}{C\+V\+List}} \&, unsigned)
\begin{DoxyCompactList}\small\item\em Pop the queue, do M\+PI so that all procs maintain the same queue. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a79c153b2923fc05f5bff4b9d696900de}{Flux\+Brute\+Force}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$, const \mbox{\hyperlink{namespaceSSAGES_acddea47426ac0a643b048f870ddd2907}{C\+V\+List}} \&)
\begin{DoxyCompactList}\small\item\em Compute the flux via brute force. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_af43aaa9c60e7bc90556b70ef17f033f3}\label{classSSAGES_1_1ForwardFlux_af43aaa9c60e7bc90556b70ef17f033f3}} 
void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_af43aaa9c60e7bc90556b70ef17f033f3}{Reconstruct\+Trajectories}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$)
\begin{DoxyCompactList}\small\item\em When simulation is finished, parse through the trajectories that reached B, and reconstruct the complete trajectory from where it started at A (lambda0) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_ad4e486e6d257797cd8ed504f6303aaa4}\label{classSSAGES_1_1ForwardFlux_ad4e486e6d257797cd8ed504f6303aaa4}} 
void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ad4e486e6d257797cd8ed504f6303aaa4}{Compute\+Committor\+Probability}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$)
\begin{DoxyCompactList}\small\item\em When simulation is finished, recursively parse through the trajectories that reached B or failed back to A and calculate the Commitor Probability of that state going to B (\+\_\+pB) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a28017e532afacbc0c2bee398a5aeabd1}{Append\+Trajectory\+File}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$, std\+::ofstream \&)
\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a63a23043983fcf2e6a2cc5956b215fb6}\label{classSSAGES_1_1ForwardFlux_a63a23043983fcf2e6a2cc5956b215fb6}} 
void \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a63a23043983fcf2e6a2cc5956b215fb6}{Open\+Trajectory\+File}} (std\+::ofstream \&)
\begin{DoxyCompactList}\small\item\em Take the current config in snapshot and append it to the provided ofstream. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
double \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a0c80fe955a8b1cb8dacca0d1a3c9f2dd}{\+\_\+ninterfaces}}
\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a5104c9611f7eda4e7c8ec013de246a1a}\label{classSSAGES_1_1ForwardFlux_a5104c9611f7eda4e7c8ec013de246a1a}} 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5104c9611f7eda4e7c8ec013de246a1a}{\+\_\+interfaces}}
\begin{DoxyCompactList}\small\item\em F\+FS Interfaces. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a8074c209dedbe8427975d588c34679d7}\label{classSSAGES_1_1ForwardFlux_a8074c209dedbe8427975d588c34679d7}} 
bool \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a8074c209dedbe8427975d588c34679d7}{\+\_\+interfaces\+\_\+increase}}
\begin{DoxyCompactList}\small\item\em Interfaces must monotonically increase (or decrease), this determines whether going to the \textquotesingle{}next\textquotesingle{} interface will be higher values of CV, or lower ones. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a3dafbb3b76d1de95fcf94538c6d7edcb}\label{classSSAGES_1_1ForwardFlux_a3dafbb3b76d1de95fcf94538c6d7edcb}} 
double \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a3dafbb3b76d1de95fcf94538c6d7edcb}{\+\_\+cvvalue\+\_\+previous}}
\begin{DoxyCompactList}\small\item\em Previous cv position, used to determine if you\textquotesingle{}ve crossed an interface since last time. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_ac40d1ade8599276bf048d7ff693cfbcf}\label{classSSAGES_1_1ForwardFlux_ac40d1ade8599276bf048d7ff693cfbcf}} 
double \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac40d1ade8599276bf048d7ff693cfbcf}{\+\_\+cvvalue}}
\begin{DoxyCompactList}\small\item\em current cv position \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a0125d16dda0fa57bf7596fb933e26a36}\label{classSSAGES_1_1ForwardFlux_a0125d16dda0fa57bf7596fb933e26a36}} 
double \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a0125d16dda0fa57bf7596fb933e26a36}{\+\_\+rate}}
\begin{DoxyCompactList}\small\item\em rate constant \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a105dbc34e1ad69dcb7cbcc3cdc34ef4f}\label{classSSAGES_1_1ForwardFlux_a105dbc34e1ad69dcb7cbcc3cdc34ef4f}} 
std\+::vector$<$ \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID}{F\+F\+S\+Config\+ID}} $>$ \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a105dbc34e1ad69dcb7cbcc3cdc34ef4f}{Lambda0\+Config\+Library}}
\begin{DoxyCompactList}\small\item\em Data structure that holds a Library N0 configurations at lambda0. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_ac190b638f475be049fd84c0b3cdae52f}\label{classSSAGES_1_1ForwardFlux_ac190b638f475be049fd84c0b3cdae52f}} 
double \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac190b638f475be049fd84c0b3cdae52f}{\+\_\+\+N0\+Total\+Sim\+Time}}
\begin{DoxyCompactList}\small\item\em Total Simulation Time spent in accumulating \textbackslash{} \+\_\+\+N0. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_ad302fb5b968202af924f62a15d1f0f4b}\label{classSSAGES_1_1ForwardFlux_ad302fb5b968202af924f62a15d1f0f4b}} 
unsigned int \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ad302fb5b968202af924f62a15d1f0f4b}{\+\_\+\+N0\+Target}}
\begin{DoxyCompactList}\small\item\em Number of configurations to store at lambda0, target. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a09f7d69a5ab36e249c7384195906de8a}\label{classSSAGES_1_1ForwardFlux_a09f7d69a5ab36e249c7384195906de8a}} 
double \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a09f7d69a5ab36e249c7384195906de8a}{\+\_\+flux\+A0}}
\begin{DoxyCompactList}\small\item\em Flux of trajectories out of state A. Denoted Phi\+A0 over h\+\_\+A in Allen2009. \end{DoxyCompactList}\item 
std\+::vector$<$ unsigned int $>$ \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5f0d531dfdc3347990b2c645af61b15f}{\+\_\+M}}
\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_afed0593963a178677403c88acd2afb66}\label{classSSAGES_1_1ForwardFlux_afed0593963a178677403c88acd2afb66}} 
std\+::vector$<$ unsigned int $>$ \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_afed0593963a178677403c88acd2afb66}{\+\_\+A}}
\begin{DoxyCompactList}\small\item\em Number of attempts from interface i. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_aba89ee2a376c8b46e17d83e6dd6b9255}{\+\_\+P}}
\begin{DoxyCompactList}\small\item\em Flag to determine wheter flux\+A0 should be calculated, seems not using this. \end{DoxyCompactList}\item 
std\+::vector$<$ unsigned int $>$ \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ab306e381420317cb8b25ce506e2564a0}{\+\_\+S}}
\item 
std\+::vector$<$ unsigned int $>$ \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a87bd6d104bc29a6d11b61a09a9a152f9}{\+\_\+N}}
\item 
bool \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a24bce6318d9821293945a32620ffc7b6}{\+\_\+pop\+\_\+tried\+\_\+but\+\_\+empty\+\_\+queue}}
\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a868a0b2256841b47073b0db6f8ab265b}\label{classSSAGES_1_1ForwardFlux_a868a0b2256841b47073b0db6f8ab265b}} 
bool \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a868a0b2256841b47073b0db6f8ab265b}{\+\_\+initial\+Flux\+Flag}}
\begin{DoxyCompactList}\small\item\em if 1, compute initial flux \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_abaa1b2c8e2bfb290ad526d8c15ea7634}\label{classSSAGES_1_1ForwardFlux_abaa1b2c8e2bfb290ad526d8c15ea7634}} 
bool \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_abaa1b2c8e2bfb290ad526d8c15ea7634}{initialize\+Queue\+Flag}}
\begin{DoxyCompactList}\small\item\em if 1, initialize the Queue \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}\label{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}} 
\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID}{F\+F\+S\+Config\+ID}} \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}{my\+F\+F\+S\+Config\+ID}}
\begin{DoxyCompactList}\small\item\em The current \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID}{F\+F\+S\+Config\+ID}} of this M\+PI process. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a737e0bfd8bf851bc3423b7178862c2dc}\label{classSSAGES_1_1ForwardFlux_a737e0bfd8bf851bc3423b7178862c2dc}} 
bool \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a737e0bfd8bf851bc3423b7178862c2dc}{\+\_\+save\+Trajectories}}
\begin{DoxyCompactList}\small\item\em should the F\+FS trajectories be saved \end{DoxyCompactList}\item 
unsigned int \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a4e11c0ee989ab0a7f89ecaa8cb1b50af}{\+\_\+nfailure\+\_\+total}}
\item 
std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a96401cbf2ffdd31cfd055580df493182}{\+\_\+pB}}
\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}\label{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}} 
unsigned int \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\+\_\+current\+\_\+interface}}
\begin{DoxyCompactList}\small\item\em Current Interface. \end{DoxyCompactList}\item 
std\+::deque$<$ \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID}{F\+F\+S\+Config\+ID}} $>$ \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_aca7da062aee9a5e3a1e8a173d50447a7}{F\+F\+S\+Config\+I\+D\+Queue}}
\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a27ecff80fb9c3e7130cc89ae4ce67f88}\label{classSSAGES_1_1ForwardFlux_a27ecff80fb9c3e7130cc89ae4ce67f88}} 
std\+::string \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a27ecff80fb9c3e7130cc89ae4ce67f88}{\+\_\+output\+\_\+directory}}
\begin{DoxyCompactList}\small\item\em Directory of F\+FS output. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a9869778ef4203d8383ff970a9373c68f}\label{classSSAGES_1_1ForwardFlux_a9869778ef4203d8383ff970a9373c68f}} 
std\+::ofstream \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a9869778ef4203d8383ff970a9373c68f}{\+\_\+trajectory\+\_\+file}}
\begin{DoxyCompactList}\small\item\em file to which the current trajectory is written to \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_ac19692d0a59c4375fe84698783baaee2}\label{classSSAGES_1_1ForwardFlux_ac19692d0a59c4375fe84698783baaee2}} 
std\+::default\+\_\+random\+\_\+engine \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac19692d0a59c4375fe84698783baaee2}{\+\_\+generator}}
\begin{DoxyCompactList}\small\item\em random number generator \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a5ae20c5bdab1ddf824a744e6faf4cbea}\label{classSSAGES_1_1ForwardFlux_a5ae20c5bdab1ddf824a744e6faf4cbea}} 
unsigned int \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5ae20c5bdab1ddf824a744e6faf4cbea}{iteration\+\_\+}}
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{classSSAGES_1_1Method}{Method}} iteration counter/. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\mbox{\hyperlink{classSSAGES_1_1ForwardFlux}{Forward\+Flux}} sampling method. 

The notation used here is drawn largely from Allen, Valeriani and Rein ten Wolde. J. Phys.\+: Condens. Matter (2009) 21\+:463102. We recommend referring to this review if the reader is unfamiliar with the method, or our variable naming conventions. 

Definition at line 38 of file Forward\+Flux.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a77060dea307348f3df6b9dfb4069dfdb}\label{classSSAGES_1_1ForwardFlux_a77060dea307348f3df6b9dfb4069dfdb}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!ForwardFlux@{ForwardFlux}}
\index{ForwardFlux@{ForwardFlux}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{ForwardFlux()}{ForwardFlux()}}
{\footnotesize\ttfamily S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Forward\+Flux (\begin{DoxyParamCaption}\item[{const M\+P\+I\+\_\+\+Comm \&}]{world,  }\item[{const M\+P\+I\+\_\+\+Comm \&}]{comm,  }\item[{double}]{ninterfaces,  }\item[{std\+::vector$<$ double $>$}]{interfaces,  }\item[{unsigned int}]{N0\+Target,  }\item[{std\+::vector$<$ unsigned int $>$}]{M,  }\item[{bool}]{initial\+Flux\+Flag,  }\item[{bool}]{save\+Trajectories,  }\item[{unsigned int}]{current\+Interface,  }\item[{std\+::string}]{output\+\_\+directory,  }\item[{unsigned int}]{frequency }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em world} & M\+PI global communicator. \\
\hline
{\em comm} & M\+PI local communicator. \\
\hline
{\em ninterfaces} & Number of interfaces. \\
\hline
{\em interfaces} & Vector of interfaces. \\
\hline
{\em N0\+Target} & Required number of initial configurations. \\
\hline
{\em M} & Vector of trials. \\
\hline
{\em initial\+Flux\+Flag} & Flag for first step of this method. \\
\hline
{\em save\+Trajectories} & Flag to save flux trajectories. \\
\hline
{\em current\+Interface} & The number of the current interface. \\
\hline
{\em output\+\_\+directory} & Directory to which trajectories are saved. \\
\hline
{\em frequency} & Frequency with which this method is invoked.\\
\hline
\end{DoxyParams}
Create instance of Forward Flux 

Definition at line 284 of file Forward\+Flux.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{289                                                                                                        : }
\DoxyCodeLine{290          \mbox{\hyperlink{classSSAGES_1_1Method_ad751450ecd30e8ab40024c6f5e870d30}{Method}}(frequency, world, comm), \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a0c80fe955a8b1cb8dacca0d1a3c9f2dd}{\_ninterfaces}}(ninterfaces), \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5104c9611f7eda4e7c8ec013de246a1a}{\_interfaces}}(interfaces), \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ad302fb5b968202af924f62a15d1f0f4b}{\_N0Target}}(N0Target), }
\DoxyCodeLine{291          \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5f0d531dfdc3347990b2c645af61b15f}{\_M}}(M), \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a868a0b2256841b47073b0db6f8ab265b}{\_initialFluxFlag}}(initialFluxFlag), \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a737e0bfd8bf851bc3423b7178862c2dc}{\_saveTrajectories}}(saveTrajectories), \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}(currentInterface),}
\DoxyCodeLine{292          \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a27ecff80fb9c3e7130cc89ae4ce67f88}{\_output\_directory}}(output\_directory), \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac19692d0a59c4375fe84698783baaee2}{\_generator}}(1), \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5ae20c5bdab1ddf824a744e6faf4cbea}{iteration\_}}(0) }
\DoxyCodeLine{293         \{}
\DoxyCodeLine{294             \textcolor{comment}{//\_output\_directory = "FFSoutput";}}
\DoxyCodeLine{295             mkdir(\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a27ecff80fb9c3e7130cc89ae4ce67f88}{\_output\_directory}}.c\_str(),S\_IRWXU); \textcolor{comment}{//how to make directory?}}
\DoxyCodeLine{296 }
\DoxyCodeLine{297             \textcolor{comment}{//\_current\_interface = 0;}}
\DoxyCodeLine{298             \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac190b638f475be049fd84c0b3cdae52f}{\_N0TotalSimTime}} = 0;}
\DoxyCodeLine{299 }
\DoxyCodeLine{300             \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a868a0b2256841b47073b0db6f8ab265b}{\_initialFluxFlag}})}
\DoxyCodeLine{301                 \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_abaa1b2c8e2bfb290ad526d8c15ea7634}{initializeQueueFlag}} = \textcolor{keyword}{true};}
\DoxyCodeLine{302 }
\DoxyCodeLine{303             \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_afed0593963a178677403c88acd2afb66}{\_A}}.resize(\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a0c80fe955a8b1cb8dacca0d1a3c9f2dd}{\_ninterfaces}});}
\DoxyCodeLine{304             \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_aba89ee2a376c8b46e17d83e6dd6b9255}{\_P}}.resize(\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a0c80fe955a8b1cb8dacca0d1a3c9f2dd}{\_ninterfaces}});}
\DoxyCodeLine{305             \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ab306e381420317cb8b25ce506e2564a0}{\_S}}.resize(\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a0c80fe955a8b1cb8dacca0d1a3c9f2dd}{\_ninterfaces}});}
\DoxyCodeLine{306             \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a87bd6d104bc29a6d11b61a09a9a152f9}{\_N}}.resize(\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a0c80fe955a8b1cb8dacca0d1a3c9f2dd}{\_ninterfaces}});}
\DoxyCodeLine{307 }
\DoxyCodeLine{308             \textcolor{comment}{//\_N[\_current\_interface] = \_N0Target;}}
\DoxyCodeLine{309             \textcolor{comment}{/*\_M.resize(\_ninterfaces);}}
\DoxyCodeLine{310 \textcolor{comment}{}}
\DoxyCodeLine{311 \textcolor{comment}{            //code for setting up simple simulation and debugging}}
\DoxyCodeLine{312 \textcolor{comment}{            \_ninterfaces = 5;}}
\DoxyCodeLine{313 \textcolor{comment}{            int i;}}
\DoxyCodeLine{314 \textcolor{comment}{            \_interfaces.resize(\_ninterfaces);}}
\DoxyCodeLine{315 \textcolor{comment}{            \_interfaces[0]=-\/1.0;}}
\DoxyCodeLine{316 \textcolor{comment}{            \_interfaces[1]=-\/0.95;}}
\DoxyCodeLine{317 \textcolor{comment}{            \_interfaces[2]=-\/0.8;}}
\DoxyCodeLine{318 \textcolor{comment}{            \_interfaces[3]= 0;}}
\DoxyCodeLine{319 \textcolor{comment}{            \_interfaces[4]= 1.0;}}
\DoxyCodeLine{320 \textcolor{comment}{}}
\DoxyCodeLine{321 \textcolor{comment}{            \_saveTrajectories = true;}}
\DoxyCodeLine{322 \textcolor{comment}{}}
\DoxyCodeLine{323 \textcolor{comment}{            \_initialFluxFlag = true;}}
\DoxyCodeLine{324 \textcolor{comment}{}}
\DoxyCodeLine{325 \textcolor{comment}{            for(i=0;i<\_ninterfaces;i++) \_M[i] = 50;}}
\DoxyCodeLine{326 \textcolor{comment}{}}
\DoxyCodeLine{327 \textcolor{comment}{            \_N0Target = 100;*/}}
\DoxyCodeLine{328             \textcolor{comment}{//\_N0Target = 100;}}
\DoxyCodeLine{329             \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a4e11c0ee989ab0a7f89ecaa8cb1b50af}{\_nfailure\_total}} = 0;}
\DoxyCodeLine{330 }
\DoxyCodeLine{331 }
\DoxyCodeLine{332             \textcolor{comment}{//check if interfaces monotonically increase or decrease}}
\DoxyCodeLine{333             \textcolor{keywordtype}{bool} errflag = \textcolor{keyword}{false};}
\DoxyCodeLine{334             \textcolor{keywordflow}{if} (\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5104c9611f7eda4e7c8ec013de246a1a}{\_interfaces}}[0]< \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5104c9611f7eda4e7c8ec013de246a1a}{\_interfaces}}[1]) \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a8074c209dedbe8427975d588c34679d7}{\_interfaces\_increase}} = \textcolor{keyword}{true};}
\DoxyCodeLine{335             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5104c9611f7eda4e7c8ec013de246a1a}{\_interfaces}}[0] > \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5104c9611f7eda4e7c8ec013de246a1a}{\_interfaces}}[1]) \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a8074c209dedbe8427975d588c34679d7}{\_interfaces\_increase}} = \textcolor{keyword}{false};}
\DoxyCodeLine{336             \textcolor{keywordflow}{else} errflag = \textcolor{keyword}{true};}
\DoxyCodeLine{337             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i=0;i<\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a0c80fe955a8b1cb8dacca0d1a3c9f2dd}{\_ninterfaces}}-\/1;i++)}
\DoxyCodeLine{338             \{}
\DoxyCodeLine{339                 \textcolor{keywordflow}{if}((\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a8074c209dedbe8427975d588c34679d7}{\_interfaces\_increase}}) \&\& (\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5104c9611f7eda4e7c8ec013de246a1a}{\_interfaces}}[i] >= \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5104c9611f7eda4e7c8ec013de246a1a}{\_interfaces}}[i+1]))}
\DoxyCodeLine{340                     errflag = \textcolor{keyword}{true};}
\DoxyCodeLine{341                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((!\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a8074c209dedbe8427975d588c34679d7}{\_interfaces\_increase}}) \&\& (\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5104c9611f7eda4e7c8ec013de246a1a}{\_interfaces}}[i] <= \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5104c9611f7eda4e7c8ec013de246a1a}{\_interfaces}}[i+1]))}
\DoxyCodeLine{342                     errflag = \textcolor{keyword}{true};}
\DoxyCodeLine{343             \}}
\DoxyCodeLine{344             \textcolor{keywordflow}{if} (errflag)}
\DoxyCodeLine{345             \{}
\DoxyCodeLine{346                 std::cerr << \textcolor{stringliteral}{"Error! The interfaces are poorly defined. They must be monotonically increasing or decreasing and cannot equal one another! Please fix this.\(\backslash\)n"};}
\DoxyCodeLine{347                 \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} interface : \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5104c9611f7eda4e7c8ec013de246a1a}{\_interfaces}})}
\DoxyCodeLine{348                     std::cerr << \textcolor{keyword}{interface }<< " ";}
\DoxyCodeLine{349                 std::cerr << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{350                 MPI\_Abort(\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}}, EXIT\_FAILURE);}
\DoxyCodeLine{351             \}}
\DoxyCodeLine{352 }
\DoxyCodeLine{353             \textcolor{comment}{// This is to generate an artificial Lambda0ConfigLibrary, Hadi's code does this for real}}
\DoxyCodeLine{354             \textcolor{comment}{// THIS SHOULD BE SOMEWHERE ELSE!!! }}
\DoxyCodeLine{355             \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a105dbc34e1ad69dcb7cbcc3cdc34ef4f}{Lambda0ConfigLibrary}}.resize(\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ad302fb5b968202af924f62a15d1f0f4b}{\_N0Target}});}
\DoxyCodeLine{356             std::normal\_distribution<double> distribution(0,1);}
\DoxyCodeLine{357             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ad302fb5b968202af924f62a15d1f0f4b}{\_N0Target}} ; i++)}
\DoxyCodeLine{358             \{}
\DoxyCodeLine{359                 \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a105dbc34e1ad69dcb7cbcc3cdc34ef4f}{Lambda0ConfigLibrary}}[i].l = 0;}
\DoxyCodeLine{360                 \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a105dbc34e1ad69dcb7cbcc3cdc34ef4f}{Lambda0ConfigLibrary}}[i].n = i;}
\DoxyCodeLine{361                 \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a105dbc34e1ad69dcb7cbcc3cdc34ef4f}{Lambda0ConfigLibrary}}[i].a = 0;}
\DoxyCodeLine{362                 \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a105dbc34e1ad69dcb7cbcc3cdc34ef4f}{Lambda0ConfigLibrary}}[i].lprev = 0;}
\DoxyCodeLine{363                 \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a105dbc34e1ad69dcb7cbcc3cdc34ef4f}{Lambda0ConfigLibrary}}[i].nprev = i;}
\DoxyCodeLine{364                 \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a105dbc34e1ad69dcb7cbcc3cdc34ef4f}{Lambda0ConfigLibrary}}[i].aprev = 0;}
\DoxyCodeLine{365                 \textcolor{comment}{//FFSConfigID ffsconfig = Lambda0ConfigLibrary[i];}}
\DoxyCodeLine{366             \}}
\DoxyCodeLine{367             \textcolor{comment}{/*// Write the dump file out}}
\DoxyCodeLine{368 \textcolor{comment}{            std::ofstream file;}}
\DoxyCodeLine{369 \textcolor{comment}{            std::string filename = \_output\_directory + "/l" + std::to\_string(ffsconfig.l) + "-\/n" + std::to\_string(ffsconfig.n) + ".dat";}}
\DoxyCodeLine{370 \textcolor{comment}{            file.open(filename.c\_str());}}
\DoxyCodeLine{371 \textcolor{comment}{}}
\DoxyCodeLine{372 \textcolor{comment}{            //first line gives ID of where it came from}}
\DoxyCodeLine{373 \textcolor{comment}{            file << ffsconfig.lprev << " " << ffsconfig.nprev << " " << ffsconfig.aprev << "\(\backslash\)n";}}
\DoxyCodeLine{374 \textcolor{comment}{            //write position and velocity}}
\DoxyCodeLine{375 \textcolor{comment}{            file << "1 -\/1 0 0 " << distribution(\_generator) << " "  << distribution(\_generator) << " 0\(\backslash\)n";}}
\DoxyCodeLine{376 \textcolor{comment}{}}
\DoxyCodeLine{377 \textcolor{comment}{            \}}}
\DoxyCodeLine{378 \textcolor{comment}{            */}}
\DoxyCodeLine{379             \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a24bce6318d9821293945a32620ffc7b6}{\_pop\_tried\_but\_empty\_queue}} = \textcolor{keyword}{false};}
\DoxyCodeLine{380         \}}

\end{DoxyCode}


References \+\_\+A, \+\_\+initial\+Flux\+Flag, \+\_\+interfaces, \+\_\+interfaces\+\_\+increase, \+\_\+N, \+\_\+\+N0\+Target, \+\_\+\+N0\+Total\+Sim\+Time, \+\_\+nfailure\+\_\+total, \+\_\+ninterfaces, \+\_\+output\+\_\+directory, \+\_\+P, \+\_\+pop\+\_\+tried\+\_\+but\+\_\+empty\+\_\+queue, \+\_\+S, initialize\+Queue\+Flag, Lambda0\+Config\+Library, and S\+S\+A\+G\+E\+S\+::\+Method\+::world\+\_\+.



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_afecda91c236066c31471e34680a4c9f1}\label{classSSAGES_1_1ForwardFlux_afecda91c236066c31471e34680a4c9f1}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!AddNewIDsToQueue@{AddNewIDsToQueue}}
\index{AddNewIDsToQueue@{AddNewIDsToQueue}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{AddNewIDsToQueue()}{AddNewIDsToQueue()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Add\+New\+I\+Ds\+To\+Queue (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

Function that adds new F\+FS configurations to the Queue Different F\+FS flavors can have differences in this method \mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a28017e532afacbc0c2bee398a5aeabd1}\label{classSSAGES_1_1ForwardFlux_a28017e532afacbc0c2bee398a5aeabd1}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!AppendTrajectoryFile@{AppendTrajectoryFile}}
\index{AppendTrajectoryFile@{AppendTrajectoryFile}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{AppendTrajectoryFile()}{AppendTrajectoryFile()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Append\+Trajectory\+File (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$}]{snapshot,  }\item[{std\+::ofstream \&}]{file }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

Take the current config in snapshot and append it to the provided ofstream Current format is xyz style (including vx,vy,vz) 

Definition at line 279 of file Forward\+Flux.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{280     \{}
\DoxyCodeLine{281         \textcolor{keyword}{const} \textcolor{keyword}{auto}\& positions = snapshot-\/>GetPositions();}
\DoxyCodeLine{282         \textcolor{keyword}{const} \textcolor{keyword}{auto}\& velocities = snapshot-\/>GetVelocities();}
\DoxyCodeLine{283         \textcolor{keyword}{const} \textcolor{keyword}{auto}\& atomID = snapshot-\/>GetAtomIDs();}
\DoxyCodeLine{284 }
\DoxyCodeLine{285         \textcolor{comment}{//first line gives number of atoms}}
\DoxyCodeLine{286         file << atomID.size() << \textcolor{stringliteral}{"\(\backslash\)n\(\backslash\)n"};}
\DoxyCodeLine{287 }
\DoxyCodeLine{288         \textcolor{comment}{// Then write positions and velocities}}
\DoxyCodeLine{289         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i< atomID.size(); i++)}
\DoxyCodeLine{290         \{}
\DoxyCodeLine{291             file<<atomID[i]<<\textcolor{stringliteral}{" "};}
\DoxyCodeLine{292             file<<positions[i][0]<<\textcolor{stringliteral}{" "}<<positions[i][1]<<\textcolor{stringliteral}{" "}<<positions[i][2]<<\textcolor{stringliteral}{" "};}
\DoxyCodeLine{293             file<<velocities[i][0]<<\textcolor{stringliteral}{" "}<<velocities[i][1]<<\textcolor{stringliteral}{" "}<<velocities[i][2]<<std::endl;}
\DoxyCodeLine{294         \}}
\DoxyCodeLine{295     \}}

\end{DoxyCode}


References S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Atom\+I\+Ds(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Positions(), and S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Velocities().



Referenced by S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Check\+For\+Interface\+Crossings().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1ForwardFlux_a28017e532afacbc0c2bee398a5aeabd1_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1ForwardFlux_a28017e532afacbc0c2bee398a5aeabd1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a2fa0e637c261108c34cd14d7e8855cab}\label{classSSAGES_1_1ForwardFlux_a2fa0e637c261108c34cd14d7e8855cab}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!Build@{Build}}
\index{Build@{Build}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{Build()}{Build()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classSSAGES_1_1ForwardFlux}{Forward\+Flux}} $\ast$ S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Build (\begin{DoxyParamCaption}\item[{const Json\+::\+Value \&}]{json,  }\item[{const M\+P\+I\+\_\+\+Comm \&}]{world,  }\item[{const M\+P\+I\+\_\+\+Comm \&}]{comm,  }\item[{const std\+::string \&}]{path }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Build a derived method from \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} node. 


\begin{DoxyParams}{Parameters}
{\em json} & \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} Value containing all input information. \\
\hline
{\em world} & M\+PI global communicator. \\
\hline
{\em comm} & M\+PI local communicator. \\
\hline
{\em path} & Path for \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} path specification. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the \mbox{\hyperlink{classSSAGES_1_1Method}{Method}} built. nullptr if an unknown error occurred.
\end{DoxyReturn}
This function builds a registered method from a \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} node. The difference between this function and \char`\"{}\+Build\char`\"{} is that this automatically determines the appropriate derived type based on the \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} node information.

\begin{DoxyNote}{Note}
Object lifetime is the caller\textquotesingle{}s responsibility. 
\end{DoxyNote}


Definition at line 628 of file Forward\+Flux.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{632     \{}
\DoxyCodeLine{633         \mbox{\hyperlink{classJson_1_1ObjectRequirement}{ObjectRequirement}} validator;}
\DoxyCodeLine{634         Value schema;}
\DoxyCodeLine{635         CharReaderBuilder rbuilder;}
\DoxyCodeLine{636         CharReader* reader = rbuilder.newCharReader();}
\DoxyCodeLine{637 }
\DoxyCodeLine{638         reader-\/>parse(JsonSchema::ForwardFluxMethod.c\_str(),}
\DoxyCodeLine{639                       JsonSchema::ForwardFluxMethod.c\_str() + JsonSchema::ForwardFluxMethod.size(),}
\DoxyCodeLine{640                       \&schema, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{641         validator.\mbox{\hyperlink{classJson_1_1ObjectRequirement_a4ed02ae1d612a5efba1688fcdd2df092}{Parse}}(schema, path);}
\DoxyCodeLine{642 }
\DoxyCodeLine{643         \textcolor{comment}{// Validate inputs.}}
\DoxyCodeLine{644         validator.\mbox{\hyperlink{classJson_1_1ObjectRequirement_a9ac3b920001a35bc70580035d8d802b7}{Validate}}(json, path);}
\DoxyCodeLine{645         \textcolor{keywordflow}{if}(validator.\mbox{\hyperlink{classJson_1_1Requirement_adfaec336a9f051d6f6b9a6d7f1d97b75}{HasErrors}}())}
\DoxyCodeLine{646             \textcolor{keywordflow}{throw} BuildException(validator.\mbox{\hyperlink{classJson_1_1Requirement_a60bc275c366eb59f192fa2e621268480}{GetErrors}}());}
\DoxyCodeLine{647         }
\DoxyCodeLine{648         \textcolor{keywordtype}{double} ninterfaces = json.get(\textcolor{stringliteral}{"nInterfaces"}, 2).asDouble();}
\DoxyCodeLine{649         std::vector<double> interfaces;}
\DoxyCodeLine{650         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& s : json[\textcolor{stringliteral}{"interfaces"}])}
\DoxyCodeLine{651             interfaces.push\_back(s.asDouble());}
\DoxyCodeLine{652 }
\DoxyCodeLine{653         std::vector<unsigned int> M;}
\DoxyCodeLine{654         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& s : json[\textcolor{stringliteral}{"trials"}])}
\DoxyCodeLine{655             M.push\_back(s.asInt());}
\DoxyCodeLine{656         }
\DoxyCodeLine{657         \textcolor{keywordflow}{if} ((ninterfaces != interfaces.size()) || (ninterfaces != M.size()))}
\DoxyCodeLine{658             \textcolor{keywordflow}{throw} BuildException(\{\textcolor{stringliteral}{"The size of \(\backslash\)"interfaces\(\backslash\)" and \(\backslash\)"trials\(\backslash\)" must be equal to \(\backslash\)"nInterfaces\(\backslash\)". See documentation for more information"}\});}
\DoxyCodeLine{659 }
\DoxyCodeLine{660         \textcolor{keyword}{auto} N0Target = json.get(\textcolor{stringliteral}{"N0Target"}, 1).asInt();}
\DoxyCodeLine{661         \textcolor{keyword}{auto} initialFluxFlag = json.get(\textcolor{stringliteral}{"computeInitialFlux"}, \textcolor{keyword}{true}).asBool();}
\DoxyCodeLine{662         \textcolor{keyword}{auto} saveTrajectories = json.get(\textcolor{stringliteral}{"saveTrajectories"}, \textcolor{keyword}{true}).asBool();}
\DoxyCodeLine{663         \textcolor{keyword}{auto} currentInterface = json.get(\textcolor{stringliteral}{"currentInterface"}, 0).asInt();}
\DoxyCodeLine{664         \textcolor{keyword}{auto} freq = json.get(\textcolor{stringliteral}{"frequency"}, 1).asInt();}
\DoxyCodeLine{665         \textcolor{keyword}{auto} flavor = json.get(\textcolor{stringliteral}{"flavor"}, \textcolor{stringliteral}{"none"}).asString();}
\DoxyCodeLine{666         \textcolor{keyword}{auto} output\_directory = json.get(\textcolor{stringliteral}{"outputDirectoryName"}, \textcolor{stringliteral}{"FFSoutput"}).asString();}
\DoxyCodeLine{667 }
\DoxyCodeLine{668         \textcolor{keywordflow}{if}(flavor == \textcolor{stringliteral}{"DirectForwardFlux"})}
\DoxyCodeLine{669         \{}
\DoxyCodeLine{670             \textcolor{keywordflow}{return} \textcolor{keyword}{new} DirectForwardFlux(world, comm, ninterfaces, interfaces, N0Target, M, initialFluxFlag, saveTrajectories, currentInterface, output\_directory, freq);               }
\DoxyCodeLine{671         \}}
\DoxyCodeLine{672         \textcolor{keywordflow}{else} }
\DoxyCodeLine{673         \{}
\DoxyCodeLine{674             \textcolor{keywordflow}{throw} BuildException(\{\textcolor{stringliteral}{"Unknow flavor of forward flux. The options are \(\backslash\)"DirectForwardFlux\(\backslash\)""}\});}
\DoxyCodeLine{675         \}}
\DoxyCodeLine{676     \}}

\end{DoxyCode}


References Json\+::\+Requirement\+::\+Get\+Errors(), Json\+::\+Requirement\+::\+Has\+Errors(), Json\+::\+Object\+Requirement\+::\+Parse(), and Json\+::\+Object\+Requirement\+::\+Validate().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1ForwardFlux_a2fa0e637c261108c34cd14d7e8855cab_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a40ea4795340f509536b8276a8c1cc92a}\label{classSSAGES_1_1ForwardFlux_a40ea4795340f509536b8276a8c1cc92a}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!ComputeTransitionProbabilities@{ComputeTransitionProbabilities}}
\index{ComputeTransitionProbabilities@{ComputeTransitionProbabilities}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{ComputeTransitionProbabilities()}{ComputeTransitionProbabilities()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Compute\+Transition\+Probabilities (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Compute the probability of going from each lambda\+\_\+i to lambda\+\_\+\{i+1\}. 

Using number of successes and number of trials This will need to be different for each F\+FS flavor 

Definition at line 214 of file Forward\+Flux.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{215     \{}
\DoxyCodeLine{216         \textcolor{keywordtype}{double} Ptotal = 1;}
\DoxyCodeLine{217         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a0c80fe955a8b1cb8dacca0d1a3c9f2dd}{\_ninterfaces}} -\/1; i++)}
\DoxyCodeLine{218             Ptotal *= \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_aba89ee2a376c8b46e17d83e6dd6b9255}{\_P}}[i];}
\DoxyCodeLine{219 }
\DoxyCodeLine{220         \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a0125d16dda0fa57bf7596fb933e26a36}{\_rate}} = Ptotal*\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a09f7d69a5ab36e249c7384195906de8a}{\_fluxA0}};}
\DoxyCodeLine{221         }
\DoxyCodeLine{222         \textcolor{comment}{//write file}}
\DoxyCodeLine{223         std::ofstream file;}
\DoxyCodeLine{224         std::string filename = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a27ecff80fb9c3e7130cc89ae4ce67f88}{\_output\_directory}} + \textcolor{stringliteral}{"/rate.dat"};}
\DoxyCodeLine{225         file.open(filename.c\_str());}
\DoxyCodeLine{226         \textcolor{keywordflow}{if} (!file) \{std::cerr << \textcolor{stringliteral}{"Error! Unable to write "} << filename << \textcolor{stringliteral}{"\(\backslash\)n"}; exit(1);\}}
\DoxyCodeLine{227         file << \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a0125d16dda0fa57bf7596fb933e26a36}{\_rate}} << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{228         file.close();}
\DoxyCodeLine{229     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a79c153b2923fc05f5bff4b9d696900de}\label{classSSAGES_1_1ForwardFlux_a79c153b2923fc05f5bff4b9d696900de}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!FluxBruteForce@{FluxBruteForce}}
\index{FluxBruteForce@{FluxBruteForce}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{FluxBruteForce()}{FluxBruteForce()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Flux\+Brute\+Force (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$}]{,  }\item[{const \mbox{\hyperlink{namespaceSSAGES_acddea47426ac0a643b048f870ddd2907}{C\+V\+List}} \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Compute the flux via brute force. 

Eventually this should be a new class that inherits from \mbox{\hyperlink{classSSAGES_1_1ForwardFlux}{Forward\+Flux}}, but for the time being I\textquotesingle{}ll just hard code it This function takes the configurations at lambda0 and run them until they reach B (lambdaN) or return to A \mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_ad503e21a587cbac6536538de35d9e872}\label{classSSAGES_1_1ForwardFlux_ad503e21a587cbac6536538de35d9e872}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!HasCrossedInterface@{HasCrossedInterface}}
\index{HasCrossedInterface@{HasCrossedInterface}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{HasCrossedInterface()}{HasCrossedInterface()}}
{\footnotesize\ttfamily int S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Has\+Crossed\+Interface (\begin{DoxyParamCaption}\item[{double}]{current,  }\item[{double}]{prev,  }\item[{unsigned int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Function checks if configuration has crossed interface specified since the last check. 

Simple function, given current and previous CV position, checks if interface i has been crossed. If crossed in positive direction, return +1, if crossed in negative direction return -\/1, if nothing crossed return 0. 
\begin{DoxyParams}{Parameters}
{\em current} & Current value of CV. \\
\hline
{\em prev} & Previous value of CV. \\
\hline
{\em i} & Index of interface to check for crossing.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Ternary value for direction of crossing (positive, negative, or none). 
\end{DoxyReturn}


Definition at line 79 of file Forward\+Flux.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{80     \{}
\DoxyCodeLine{81         \textcolor{keywordtype}{double} interface\_location = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5104c9611f7eda4e7c8ec013de246a1a}{\_interfaces}}[i];}
\DoxyCodeLine{82         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a8074c209dedbe8427975d588c34679d7}{\_interfaces\_increase}})}
\DoxyCodeLine{83         \{}
\DoxyCodeLine{84           \textcolor{keywordflow}{if} ((prev <= interface\_location) \&\& (current >= interface\_location))}
\DoxyCodeLine{85               \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{86           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((prev >= interface\_location) \&\& (current <= interface\_location))}
\DoxyCodeLine{87               \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{88           \textcolor{keywordflow}{else}}
\DoxyCodeLine{89               \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{90         \}}
\DoxyCodeLine{91         \textcolor{keywordflow}{else}}
\DoxyCodeLine{92         \{}
\DoxyCodeLine{93           \textcolor{keywordflow}{if} ((prev >= interface\_location) \&\& (current <= interface\_location))}
\DoxyCodeLine{94               \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{95           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((prev <= interface\_location) \&\& (current >= interface\_location))}
\DoxyCodeLine{96               \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{97           \textcolor{keywordflow}{else}}
\DoxyCodeLine{98               \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{99         \}}
\DoxyCodeLine{100     \}}

\end{DoxyCode}


Referenced by S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Check\+For\+Interface\+Crossings().

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1ForwardFlux_ad503e21a587cbac6536538de35d9e872_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_ae7c156e7bbb5e4d70c59c09587deb553}\label{classSSAGES_1_1ForwardFlux_ae7c156e7bbb5e4d70c59c09587deb553}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!HasReturnedToA@{HasReturnedToA}}
\index{HasReturnedToA@{HasReturnedToA}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{HasReturnedToA()}{HasReturnedToA()}}
{\footnotesize\ttfamily bool S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Has\+Returned\+ToA (\begin{DoxyParamCaption}\item[{double}]{current }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Function checks if configuration has returned to A. 


\begin{DoxyParams}{Parameters}
{\em current} & Current value of CV.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Boolean if the trajectory returned to state A 
\end{DoxyReturn}


Definition at line 102 of file Forward\+Flux.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{103     \{}
\DoxyCodeLine{104         \textcolor{keywordtype}{double} interface\_location = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5104c9611f7eda4e7c8ec013de246a1a}{\_interfaces}}[0];}
\DoxyCodeLine{105         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a8074c209dedbe8427975d588c34679d7}{\_interfaces\_increase}})}
\DoxyCodeLine{106         \{}
\DoxyCodeLine{107             \textcolor{keywordflow}{if} (current < interface\_location) \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{108             \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{109         \}}
\DoxyCodeLine{110         \textcolor{keywordflow}{else}}
\DoxyCodeLine{111         \{}
\DoxyCodeLine{112             \textcolor{keywordflow}{if} (current > interface\_location) \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{113             \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{114         \}}
\DoxyCodeLine{115     \}}

\end{DoxyCode}


Referenced by S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Check\+For\+Interface\+Crossings().

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1ForwardFlux_ae7c156e7bbb5e4d70c59c09587deb553_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_ad001fc1bc419967f3c9679cac04820f2}\label{classSSAGES_1_1ForwardFlux_ad001fc1bc419967f3c9679cac04820f2}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!PostIntegration@{PostIntegration}}
\index{PostIntegration@{PostIntegration}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{PostIntegration()}{PostIntegration()}}
{\footnotesize\ttfamily virtual void S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Post\+Integration (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$}]{snapshot,  }\item[{const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&}]{cvmanager }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [pure virtual]}}



\mbox{\hyperlink{classSSAGES_1_1Method}{Method}} call post integration. 


\begin{DoxyParams}{Parameters}
{\em snapshot} & Pointer to the simulation snapshot. \\
\hline
{\em cvmanager} & Collective variable manager.\\
\hline
\end{DoxyParams}
This function will be called after each integration step. 

Implements \mbox{\hyperlink{classSSAGES_1_1Method_af2f33dfaa758c5cd505477f4767fb339}{S\+S\+A\+G\+E\+S\+::\+Method}}.



Implemented in \mbox{\hyperlink{classSSAGES_1_1DirectForwardFlux_a5491cd537f737524f5fc295236eefb85}{S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux}}.

\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a36b935ebdb93f80be3cd8f43684662f1}\label{classSSAGES_1_1ForwardFlux_a36b935ebdb93f80be3cd8f43684662f1}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!PostSimulation@{PostSimulation}}
\index{PostSimulation@{PostSimulation}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{PostSimulation()}{PostSimulation()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Post\+Simulation (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$}]{snapshot,  }\item[{const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&}]{cvmanager }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



\mbox{\hyperlink{classSSAGES_1_1Method}{Method}} call post simulation. 


\begin{DoxyParams}{Parameters}
{\em snapshot} & Pointer to the simulation snapshot. \\
\hline
{\em cvmanager} & Collective variable manager.\\
\hline
\end{DoxyParams}
This function will be called after the end of the simulation run. 

Implements \mbox{\hyperlink{classSSAGES_1_1Method_a7d18226669c88bc76b9b758f2d29e3c9}{S\+S\+A\+G\+E\+S\+::\+Method}}.



Definition at line 48 of file Forward\+Flux.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{49     \{}
\DoxyCodeLine{50         std::cout << \textcolor{stringliteral}{"Post simulation\(\backslash\)n"};}
\DoxyCodeLine{51 }
\DoxyCodeLine{52         \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ad4e486e6d257797cd8ed504f6303aaa4}{ComputeCommittorProbability}}(snapshot);}
\DoxyCodeLine{53         \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a40ea4795340f509536b8276a8c1cc92a}{ComputeTransitionProbabilities}}();}
\DoxyCodeLine{54 }
\DoxyCodeLine{55         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a737e0bfd8bf851bc3423b7178862c2dc}{\_saveTrajectories}})}
\DoxyCodeLine{56             \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_af43aaa9c60e7bc90556b70ef17f033f3}{ReconstructTrajectories}}(snapshot);   }
\DoxyCodeLine{57         }
\DoxyCodeLine{58         MPI\_Abort(\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}}, EXIT\_FAILURE); \textcolor{comment}{//more elegant solution?}}
\DoxyCodeLine{59     \}}

\end{DoxyCode}


Referenced by S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Check\+For\+Interface\+Crossings().

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1ForwardFlux_a36b935ebdb93f80be3cd8f43684662f1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a3faeed11a3923e06b286ee8c51c10e86}\label{classSSAGES_1_1ForwardFlux_a3faeed11a3923e06b286ee8c51c10e86}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!PreSimulation@{PreSimulation}}
\index{PreSimulation@{PreSimulation}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{PreSimulation()}{PreSimulation()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Pre\+Simulation (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$}]{snapshot,  }\item[{const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&}]{cvmanager }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



\mbox{\hyperlink{classSSAGES_1_1Method}{Method}} call prior to simulation initiation. 


\begin{DoxyParams}{Parameters}
{\em snapshot} & Pointer to the simulation snapshot. \\
\hline
{\em cvmanager} & Collective variable manager.\\
\hline
\end{DoxyParams}
This function will be called before the simulation is started. 

Implements \mbox{\hyperlink{classSSAGES_1_1Method_a7d840d2b5f6dbf9ec75a7909ccf13ef7}{S\+S\+A\+G\+E\+S\+::\+Method}}.



Definition at line 39 of file Forward\+Flux.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{40     \{}
\DoxyCodeLine{41         \textcolor{keyword}{auto} cvs = cvmanager.GetCVs(\mbox{\hyperlink{classSSAGES_1_1Method_a24b0ac53b1fabcab0a5f3bd6cde26909}{cvmask\_}});}
\DoxyCodeLine{42         \textcolor{keywordflow}{if}(cvs.size() > 1)}
\DoxyCodeLine{43             \textcolor{keywordflow}{throw} BuildException(\{\textcolor{stringliteral}{"Forwardflux currently only works with one cv."}\});}
\DoxyCodeLine{44 }
\DoxyCodeLine{45         std::cout << \textcolor{stringliteral}{"\(\backslash\)nWARNING! MAKE SURE LAMMPS GIVES A DIFFERENT RANDOM SEED TO EACH PROCESSOR, OTHERWISE EACH FFS TRAJ WILL BE IDENTICAL!\(\backslash\)n"};        }
\DoxyCodeLine{46     \}}

\end{DoxyCode}


References S\+S\+A\+G\+E\+S\+::\+C\+V\+Manager\+::\+Get\+C\+Vs().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1ForwardFlux_a3faeed11a3923e06b286ee8c51c10e86_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_aaf21bde2adc1a021de4ebb47d10c05a7}\label{classSSAGES_1_1ForwardFlux_aaf21bde2adc1a021de4ebb47d10c05a7}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!ReadFFSConfiguration@{ReadFFSConfiguration}}
\index{ReadFFSConfiguration@{ReadFFSConfiguration}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{ReadFFSConfiguration()}{ReadFFSConfiguration()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Read\+F\+F\+S\+Configuration (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$}]{snapshot,  }\item[{\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID}{F\+F\+S\+Config\+ID}} \&}]{ffsconfig,  }\item[{bool}]{wassuccess }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Read a file corresponding to a \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID}{F\+F\+S\+Config\+ID}} into current snapshot. 


\begin{DoxyParams}{Parameters}
{\em snapshot} & Current snaphshot of the system \\
\hline
{\em ffsconfig} & ID of the current F\+FS configuration \\
\hline
{\em wassuccess} & If the last attempt was a success \\
\hline
\end{DoxyParams}


Definition at line 297 of file Forward\+Flux.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{298     \{}
\DoxyCodeLine{299         \textcolor{keyword}{auto}\& positions = snapshot-\/>GetPositions();}
\DoxyCodeLine{300         \textcolor{keyword}{auto}\& velocities = snapshot-\/>GetVelocities();}
\DoxyCodeLine{301         \textcolor{keyword}{auto}\& atomID = snapshot-\/>GetAtomIDs();}
\DoxyCodeLine{302         \textcolor{keyword}{auto}\& forces = snapshot-\/>GetForces();}
\DoxyCodeLine{303         \textcolor{comment}{//auto\& ID = snapshot-\/>GetSnapshotID();}}
\DoxyCodeLine{304 }
\DoxyCodeLine{305         std::ifstream file; }
\DoxyCodeLine{306         std::string filename;}
\DoxyCodeLine{307         \textcolor{keywordflow}{if} (wassuccess)}
\DoxyCodeLine{308           filename =  \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a27ecff80fb9c3e7130cc89ae4ce67f88}{\_output\_directory}} + \textcolor{stringliteral}{"/l"}+ std::to\_string(ffsconfig.l) +\textcolor{stringliteral}{"-\/n"}+ std::to\_string(ffsconfig.n) + \textcolor{stringliteral}{".dat"};}
\DoxyCodeLine{309         \textcolor{keywordflow}{else}}
\DoxyCodeLine{310           filename =  \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a27ecff80fb9c3e7130cc89ae4ce67f88}{\_output\_directory}} + \textcolor{stringliteral}{"/fail-\/l"}+ std::to\_string(ffsconfig.l) +\textcolor{stringliteral}{"-\/n"}+ std::to\_string(ffsconfig.n) + \textcolor{stringliteral}{".dat"};}
\DoxyCodeLine{311 }
\DoxyCodeLine{312         std::string line;}
\DoxyCodeLine{313         file.open(filename);}
\DoxyCodeLine{314         \textcolor{keywordflow}{if}(!file) }
\DoxyCodeLine{315         \{}
\DoxyCodeLine{316             std::cerr << \textcolor{stringliteral}{"Error! Unable to read "} << filename << \textcolor{stringliteral}{"\(\backslash\)n"}; }
\DoxyCodeLine{317             MPI\_Abort(\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}}, EXIT\_FAILURE);}
\DoxyCodeLine{318         \}}
\DoxyCodeLine{319 }
\DoxyCodeLine{320         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} line\_count = 0; }
\DoxyCodeLine{321         \textcolor{keywordflow}{while}(!std::getline(file,line).eof())}
\DoxyCodeLine{322         \{}
\DoxyCodeLine{323             \textcolor{keywordtype}{int} atomindex = -\/1;}
\DoxyCodeLine{324             }
\DoxyCodeLine{325             \textcolor{comment}{//parse line into tokens}}
\DoxyCodeLine{326             std::string buf; \textcolor{comment}{// Have a buffer string}}
\DoxyCodeLine{327             std::stringstream ss(line); \textcolor{comment}{// Insert the string into a stream}}
\DoxyCodeLine{328             std::vector<std::string> tokens; \textcolor{comment}{// Create vector to hold our words}}
\DoxyCodeLine{329             \textcolor{keywordflow}{while} (ss >> buf)}
\DoxyCodeLine{330                 tokens.push\_back(buf);}
\DoxyCodeLine{331 }
\DoxyCodeLine{332             \textcolor{comment}{// first line contains the previous ffsconfig information}}
\DoxyCodeLine{333             \textcolor{keywordflow}{if} ((line\_count == 0) \&\& (tokens.size() == 3))}
\DoxyCodeLine{334             \{}
\DoxyCodeLine{335                 ffsconfig.lprev = std::stoi(tokens[0]);}
\DoxyCodeLine{336                 ffsconfig.nprev = std::stoi(tokens[1]);}
\DoxyCodeLine{337                 ffsconfig.aprev = std::stoi(tokens[2]);}
\DoxyCodeLine{338             \}}
\DoxyCodeLine{339             \textcolor{comment}{// all other lines contain config information}}
\DoxyCodeLine{340             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((line\_count != 0) \&\& (tokens.size() == 7))}
\DoxyCodeLine{341             \{}
\DoxyCodeLine{342                 \textcolor{comment}{//FIXME: try using snapshot-\/>GetLocalIndex()}}
\DoxyCodeLine{343 }
\DoxyCodeLine{344                 \textcolor{comment}{//copied from Ben's previous implementation}}
\DoxyCodeLine{345                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i < atomID.size(); i++)}
\DoxyCodeLine{346                 \{}
\DoxyCodeLine{347                     \textcolor{keywordflow}{if}(atomID[i] == std::stoi(tokens[0]))}
\DoxyCodeLine{348                         atomindex = i;}
\DoxyCodeLine{349                 \}}
\DoxyCodeLine{350 }
\DoxyCodeLine{351                 \textcolor{keywordflow}{if}(atomindex < 0)}
\DoxyCodeLine{352                 \{}
\DoxyCodeLine{353                     std::cout<<\textcolor{stringliteral}{"error, could not locate atomID "}<<tokens[0]<<\textcolor{stringliteral}{" from dumpfile"}<<std::endl;}
\DoxyCodeLine{354                     MPI\_Abort(\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}}, EXIT\_FAILURE);}
\DoxyCodeLine{355                 \}}
\DoxyCodeLine{356 }
\DoxyCodeLine{357                 positions[atomindex][0] = std::stod(tokens[1]);}
\DoxyCodeLine{358                 positions[atomindex][1] = std::stod(tokens[2]);}
\DoxyCodeLine{359                 positions[atomindex][2] = std::stod(tokens[3]);}
\DoxyCodeLine{360                 velocities[atomindex][0] = std::stod(tokens[4]);}
\DoxyCodeLine{361                 velocities[atomindex][1] = std::stod(tokens[5]);}
\DoxyCodeLine{362                 velocities[atomindex][2] = std::stod(tokens[6]);}
\DoxyCodeLine{363 }
\DoxyCodeLine{364                 \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& force : forces)}
\DoxyCodeLine{365                     force.setZero();}
\DoxyCodeLine{366             \}}
\DoxyCodeLine{367             \textcolor{comment}{// else throw error}}
\DoxyCodeLine{368             \textcolor{keywordflow}{else}}
\DoxyCodeLine{369             \{}
\DoxyCodeLine{370                 std::cout<<\textcolor{stringliteral}{"ERROR: incorrect line format in "}<< filename <<\textcolor{stringliteral}{" on line"} << line\_count << \textcolor{stringliteral}{":\(\backslash\)n"};}
\DoxyCodeLine{371                 std::cout<<line<<std::endl;}
\DoxyCodeLine{372                 MPI\_Abort(\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}}, EXIT\_FAILURE);}
\DoxyCodeLine{373             \}}
\DoxyCodeLine{374             line\_count++;}
\DoxyCodeLine{375         \}}
\DoxyCodeLine{376         file.close();}
\DoxyCodeLine{377     \}}

\end{DoxyCode}


References S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+F\+F\+S\+Config\+I\+D\+::aprev, S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Atom\+I\+Ds(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Forces(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Positions(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Velocities(), S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+F\+F\+S\+Config\+I\+D\+::l, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+F\+F\+S\+Config\+I\+D\+::lprev, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+F\+F\+S\+Config\+I\+D\+::n, and S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+F\+F\+S\+Config\+I\+D\+::nprev.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1ForwardFlux_aaf21bde2adc1a021de4ebb47d10c05a7_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a8f3da6706283040f7adf33399bdb2376}\label{classSSAGES_1_1ForwardFlux_a8f3da6706283040f7adf33399bdb2376}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!WriteFFSConfiguration@{WriteFFSConfiguration}}
\index{WriteFFSConfiguration@{WriteFFSConfiguration}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{WriteFFSConfiguration()}{WriteFFSConfiguration()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Write\+F\+F\+S\+Configuration (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$}]{snapshot,  }\item[{\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID}{F\+F\+S\+Config\+ID}} \&}]{ffsconfig,  }\item[{bool}]{wassuccess }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Write a file corresponding to \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID}{F\+F\+S\+Config\+ID}} from current snapshot. 


\begin{DoxyParams}{Parameters}
{\em snapshot} & Current snaphshot of the system \\
\hline
{\em ffsconfig} & ID of the current F\+FS configuration \\
\hline
{\em wassuccess} & If the last attempt was a success \\
\hline
\end{DoxyParams}


Definition at line 231 of file Forward\+Flux.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{232     \{}
\DoxyCodeLine{233         \textcolor{keyword}{const} \textcolor{keyword}{auto}\& positions = snapshot-\/>GetPositions();}
\DoxyCodeLine{234         \textcolor{keyword}{const} \textcolor{keyword}{auto}\& velocities = snapshot-\/>GetVelocities();}
\DoxyCodeLine{235         \textcolor{keyword}{const} \textcolor{keyword}{auto}\& atomID = snapshot-\/>GetAtomIDs();}
\DoxyCodeLine{236         \textcolor{comment}{//unsigned natoms = snapshot-\/>GetNumAtoms();}}
\DoxyCodeLine{237         \textcolor{comment}{//const auto\& dumpfilename = snapshot-\/>GetSnapshotID();}}
\DoxyCodeLine{238 }
\DoxyCodeLine{239         \textcolor{comment}{// Write the dump file out}}
\DoxyCodeLine{240         std::ofstream file;}
\DoxyCodeLine{241         std::string filename;}
\DoxyCodeLine{242         \textcolor{keywordflow}{if} (wassuccess)}
\DoxyCodeLine{243           filename = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a27ecff80fb9c3e7130cc89ae4ce67f88}{\_output\_directory}} + \textcolor{stringliteral}{"/l"} + std::to\_string(ffsconfig.l) + \textcolor{stringliteral}{"-\/n"} + std::to\_string(ffsconfig.n) + \textcolor{stringliteral}{".dat"};}
\DoxyCodeLine{244         \textcolor{keywordflow}{else}}
\DoxyCodeLine{245           filename = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a27ecff80fb9c3e7130cc89ae4ce67f88}{\_output\_directory}} + \textcolor{stringliteral}{"/fail-\/l"} + std::to\_string(ffsconfig.l) + \textcolor{stringliteral}{"-\/n"} + std::to\_string(ffsconfig.n) + \textcolor{stringliteral}{".dat"};}
\DoxyCodeLine{246 }
\DoxyCodeLine{247         file.open(filename.c\_str());}
\DoxyCodeLine{248         \textcolor{keywordflow}{if}(!file)}
\DoxyCodeLine{249         \{}
\DoxyCodeLine{250             std::cerr << \textcolor{stringliteral}{"Error! Unable to write "} << filename << \textcolor{stringliteral}{"\(\backslash\)n"}; }
\DoxyCodeLine{251             MPI\_Abort(\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}}, EXIT\_FAILURE);}
\DoxyCodeLine{252         \}}
\DoxyCodeLine{253 }
\DoxyCodeLine{254         \textcolor{comment}{//first line gives ID of where it came from}}
\DoxyCodeLine{255         file << ffsconfig.lprev << \textcolor{stringliteral}{" "} << ffsconfig.nprev << \textcolor{stringliteral}{" "} << ffsconfig.aprev << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{256 }
\DoxyCodeLine{257         \textcolor{comment}{// Then write positions and velocities}}
\DoxyCodeLine{258         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i< atomID.size(); i++)}
\DoxyCodeLine{259         \textcolor{comment}{//for(size\_t i = 0; i< natoms; i++)}}
\DoxyCodeLine{260         \{}
\DoxyCodeLine{261             file<<atomID[i]<<\textcolor{stringliteral}{" "};}
\DoxyCodeLine{262             file<<positions[i][0]<<\textcolor{stringliteral}{" "}<<positions[i][1]<<\textcolor{stringliteral}{" "}<<positions[i][2]<<\textcolor{stringliteral}{" "};}
\DoxyCodeLine{263             file<<velocities[i][0]<<\textcolor{stringliteral}{" "}<<velocities[i][1]<<\textcolor{stringliteral}{" "}<<velocities[i][2]<<std::endl;}
\DoxyCodeLine{264         \}}
\DoxyCodeLine{265     \}}

\end{DoxyCode}


References S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+F\+F\+S\+Config\+I\+D\+::aprev, S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Atom\+I\+Ds(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Positions(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Velocities(), S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+F\+F\+S\+Config\+I\+D\+::l, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+F\+F\+S\+Config\+I\+D\+::lprev, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+F\+F\+S\+Config\+I\+D\+::n, and S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+F\+F\+S\+Config\+I\+D\+::nprev.



Referenced by S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Check\+For\+Interface\+Crossings().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1ForwardFlux_a8f3da6706283040f7adf33399bdb2376_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1ForwardFlux_a8f3da6706283040f7adf33399bdb2376_icgraph}
\end{center}
\end{figure}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a5f0d531dfdc3347990b2c645af61b15f}\label{classSSAGES_1_1ForwardFlux_a5f0d531dfdc3347990b2c645af61b15f}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!\_M@{\_M}}
\index{\_M@{\_M}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{\_M}{\_M}}
{\footnotesize\ttfamily std\+::vector$<$unsigned int$>$ S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+M\hspace{0.3cm}{\ttfamily [protected]}}

Number of trials to attemt from each interface Note \+\_\+M\mbox{[}0\mbox{]} sets the number of \textquotesingle{}branches\textquotesingle{} for R\+B\+F\+FS and B\+G\+F\+FS? 

Definition at line 109 of file Forward\+Flux.\+h.



Referenced by S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Check\+For\+Interface\+Crossings(), and S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Initialize\+Queue().

\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a87bd6d104bc29a6d11b61a09a9a152f9}\label{classSSAGES_1_1ForwardFlux_a87bd6d104bc29a6d11b61a09a9a152f9}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!\_N@{\_N}}
\index{\_N@{\_N}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{\_N}{\_N}}
{\footnotesize\ttfamily std\+::vector$<$unsigned int$>$ S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+N\hspace{0.3cm}{\ttfamily [protected]}}

Current number of configurations currently stored at interface i This is somewhat redundant since \+\_\+N\mbox{[}i\mbox{]} == \+\_\+S\mbox{[}i-\/1\mbox{]}, but for clarity N\mbox{[}0\mbox{]} -\/ current number of configurations collected at lambda0 (first interface) ~\newline
 

Definition at line 127 of file Forward\+Flux.\+h.



Referenced by S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Check\+For\+Interface\+Crossings(), Forward\+Flux(), and S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Initialize\+Queue().

\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a4e11c0ee989ab0a7f89ecaa8cb1b50af}\label{classSSAGES_1_1ForwardFlux_a4e11c0ee989ab0a7f89ecaa8cb1b50af}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!\_nfailure\_total@{\_nfailure\_total}}
\index{\_nfailure\_total@{\_nfailure\_total}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{\_nfailure\_total}{\_nfailure\_total}}
{\footnotesize\ttfamily unsigned int S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+nfailure\+\_\+total\hspace{0.3cm}{\ttfamily [protected]}}

Counts the total number of failures eventually if I prune, will want this to be a vector, where it stores the number of failures at each interface however in the absence of pruning, a traj can only fail at lambda0, so this is just a scalar 

Definition at line 149 of file Forward\+Flux.\+h.



Referenced by S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Check\+For\+Interface\+Crossings(), and Forward\+Flux().

\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a0c80fe955a8b1cb8dacca0d1a3c9f2dd}\label{classSSAGES_1_1ForwardFlux_a0c80fe955a8b1cb8dacca0d1a3c9f2dd}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!\_ninterfaces@{\_ninterfaces}}
\index{\_ninterfaces@{\_ninterfaces}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{\_ninterfaces}{\_ninterfaces}}
{\footnotesize\ttfamily double S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+ninterfaces\hspace{0.3cm}{\ttfamily [protected]}}

Number of F\+FS interfaces note that \+\_\+ninterfaces = n+1 where n is lambda\+\_\+n the interface defining B 

Definition at line 78 of file Forward\+Flux.\+h.



Referenced by S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Check\+For\+Interface\+Crossings(), and Forward\+Flux().

\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_aba89ee2a376c8b46e17d83e6dd6b9255}\label{classSSAGES_1_1ForwardFlux_aba89ee2a376c8b46e17d83e6dd6b9255}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!\_P@{\_P}}
\index{\_P@{\_P}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{\_P}{\_P}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+P\hspace{0.3cm}{\ttfamily [protected]}}



Flag to determine wheter flux\+A0 should be calculated, seems not using this. 

Probability of going from lambda\+\_\+\{i\} to lambda\+\_\+\{i+1\} 

Definition at line 118 of file Forward\+Flux.\+h.



Referenced by S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Check\+For\+Interface\+Crossings(), and Forward\+Flux().

\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a96401cbf2ffdd31cfd055580df493182}\label{classSSAGES_1_1ForwardFlux_a96401cbf2ffdd31cfd055580df493182}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!\_pB@{\_pB}}
\index{\_pB@{\_pB}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{\_pB}{\_pB}}
{\footnotesize\ttfamily std\+::vector$<$std\+::vector$<$double$>$ $>$ S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+pB\hspace{0.3cm}{\ttfamily [protected]}}

commitor probability. The probability of a given configuration reaching B 

Definition at line 153 of file Forward\+Flux.\+h.

\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_a24bce6318d9821293945a32620ffc7b6}\label{classSSAGES_1_1ForwardFlux_a24bce6318d9821293945a32620ffc7b6}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!\_pop\_tried\_but\_empty\_queue@{\_pop\_tried\_but\_empty\_queue}}
\index{\_pop\_tried\_but\_empty\_queue@{\_pop\_tried\_but\_empty\_queue}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{\_pop\_tried\_but\_empty\_queue}{\_pop\_tried\_but\_empty\_queue}}
{\footnotesize\ttfamily bool S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+pop\+\_\+tried\+\_\+but\+\_\+empty\+\_\+queue\hspace{0.3cm}{\ttfamily [protected]}}

Keep track of jobs that have suceeded or failed but couldn\textquotesingle{}t get reassigned a new task and must wait for the queue to get more jobs This could happen in D\+F\+FS once a job has finished but M\mbox{[}i\mbox{]} hasn\textquotesingle{}t been reached (waiting on other jobs) If this is the case I call it a \textquotesingle{}zombie job\textquotesingle{}, since the job is running, but isnt doing anything useful. Its just burning cpu cycles waiting for the queue to repopulate 

Definition at line 132 of file Forward\+Flux.\+h.



Referenced by S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Check\+For\+Interface\+Crossings(), and Forward\+Flux().

\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_ab306e381420317cb8b25ce506e2564a0}\label{classSSAGES_1_1ForwardFlux_ab306e381420317cb8b25ce506e2564a0}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!\_S@{\_S}}
\index{\_S@{\_S}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{\_S}{\_S}}
{\footnotesize\ttfamily std\+::vector$<$unsigned int$>$ S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+S\hspace{0.3cm}{\ttfamily [protected]}}

Number of successes from lambda\+\_\+\{i\} to lambda\+\_\+\{i+1\} (might need to be 2d vector if multiple branches are used (with R\+B\+F\+FS) 

Definition at line 122 of file Forward\+Flux.\+h.



Referenced by S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Check\+For\+Interface\+Crossings(), and Forward\+Flux().

\mbox{\Hypertarget{classSSAGES_1_1ForwardFlux_aca7da062aee9a5e3a1e8a173d50447a7}\label{classSSAGES_1_1ForwardFlux_aca7da062aee9a5e3a1e8a173d50447a7}} 
\index{SSAGES::ForwardFlux@{SSAGES::ForwardFlux}!FFSConfigIDQueue@{FFSConfigIDQueue}}
\index{FFSConfigIDQueue@{FFSConfigIDQueue}!SSAGES::ForwardFlux@{SSAGES::ForwardFlux}}
\doxysubsubsection{\texorpdfstring{FFSConfigIDQueue}{FFSConfigIDQueue}}
{\footnotesize\ttfamily std\+::deque$<$\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID}{F\+F\+S\+Config\+ID}}$>$ S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+F\+F\+S\+Config\+I\+D\+Queue\hspace{0.3cm}{\ttfamily [protected]}}

Queue When a given processor reaches an interface, it pulls a config from this Queue to figure out what it should do next This object should be syncronized between all F\+FS walkers (is walker the correct terminology here?) technically this is a double-\/ended queue, this was mostly for debugging to allow element access of the queue (which std\+::queue doesn\textquotesingle{}t allow). I use it like a queue though. 

Definition at line 163 of file Forward\+Flux.\+h.



Referenced by S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Check\+For\+Interface\+Crossings(), and S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Initialize\+Queue().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/michael/development/\+S\+S\+A\+G\+E\+S/src/\+Methods/Forward\+Flux.\+h\item 
/home/michael/development/\+S\+S\+A\+G\+E\+S/src/\+Methods/Forward\+Flux.\+cpp\end{DoxyCompactItemize}
