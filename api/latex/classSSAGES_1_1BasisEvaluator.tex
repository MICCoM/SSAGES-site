\hypertarget{classSSAGES_1_1BasisEvaluator}{}\doxysection{S\+S\+A\+G\+ES\+::Basis\+Evaluator Class Reference}
\label{classSSAGES_1_1BasisEvaluator}\index{SSAGES::BasisEvaluator@{SSAGES::BasisEvaluator}}


Calculates the inner product of all the basis functions and the histogram.  




{\ttfamily \#include $<$Basis.\+h$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a52dc4b1c0aa2d92f47ef2f55eec772ae}{Basis\+Evaluator}} (const std\+::vector$<$ \mbox{\hyperlink{classSSAGES_1_1BasisFunction}{Basis\+Function}} $\ast$ $>$ \&functions)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_af48c0e905d578ca0f80434b60aa6d84b}{Coeff\+Init}} ()
\begin{DoxyCompactList}\small\item\em Initializes coefficient lookup vector. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1BasisEvaluator_ab77ec65105e7885b53be39f29dee7d99}\label{classSSAGES_1_1BasisEvaluator_ab77ec65105e7885b53be39f29dee7d99}} 
void \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ab77ec65105e7885b53be39f29dee7d99}{Basis\+Init}} ()
\begin{DoxyCompactList}\small\item\em Creates lookup table for basis functions. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad017032c44a0840f05c7ac4d7fedd5cd}{Update\+Bias}} (\mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ double $>$ $\ast$bias, \mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ std\+::vector$<$ double $>$$>$ $\ast$grad)
\begin{DoxyCompactList}\small\item\em Outputs the basis projection at a specific coordinate. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad02d4d3e5e2e0af87a8e4a9d759a64a0}{Update\+Coeff}} (const std\+::vector$<$ double $>$ \&array, \mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ unsigned int $>$ $\ast$hist)
\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a24714eacab2c0afdf4fa17a570354a34}{Get\+Coeff}} (void)
\begin{DoxyCompactList}\small\item\em Gets the coefficient array. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a17469fad6d29661c670c2b4ce4877570}{Set\+Coeff}} (const std\+::vector$<$ double $>$ \&coeff)
\begin{DoxyCompactList}\small\item\em Set the coefficient array in the event of a restart run. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classSSAGES_1_1BasisEvaluator_a8760f28614bf89568f5a4cbca0904e58}\label{classSSAGES_1_1BasisEvaluator_a8760f28614bf89568f5a4cbca0904e58}} 
std\+::vector$<$ \mbox{\hyperlink{structSSAGES_1_1Map}{Map}} $>$ \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a8760f28614bf89568f5a4cbca0904e58}{coeff\+\_\+}}
\begin{DoxyCompactList}\small\item\em Vector of basis function coefficients. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}\label{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}} 
std\+::vector$<$ \mbox{\hyperlink{classSSAGES_1_1BasisFunction}{Basis\+Function}} $\ast$ $>$ \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\+\_\+}}
\begin{DoxyCompactList}\small\item\em Vector of basis functions. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1BasisEvaluator_a688f5516b08cfdafe6004550e2f16249}\label{classSSAGES_1_1BasisEvaluator_a688f5516b08cfdafe6004550e2f16249}} 
std\+::vector$<$ \mbox{\hyperlink{structSSAGES_1_1BasisLUT}{Basis\+L\+UT}} $>$ \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a688f5516b08cfdafe6004550e2f16249}{lookup\+\_\+}}
\begin{DoxyCompactList}\small\item\em Lookup table for basis functions. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Calculates the inner product of all the basis functions and the histogram. 

Definition at line 355 of file Basis.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classSSAGES_1_1BasisEvaluator_a52dc4b1c0aa2d92f47ef2f55eec772ae}\label{classSSAGES_1_1BasisEvaluator_a52dc4b1c0aa2d92f47ef2f55eec772ae}} 
\index{SSAGES::BasisEvaluator@{SSAGES::BasisEvaluator}!BasisEvaluator@{BasisEvaluator}}
\index{BasisEvaluator@{BasisEvaluator}!SSAGES::BasisEvaluator@{SSAGES::BasisEvaluator}}
\doxysubsubsection{\texorpdfstring{BasisEvaluator()}{BasisEvaluator()}}
{\footnotesize\ttfamily S\+S\+A\+G\+E\+S\+::\+Basis\+Evaluator\+::\+Basis\+Evaluator (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ \mbox{\hyperlink{classSSAGES_1_1BasisFunction}{Basis\+Function}} $\ast$ $>$ \&}]{functions }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em functions} & Vector of \mbox{\hyperlink{classSSAGES_1_1BasisFunction}{Basis\+Function}} members.\\
\hline
\end{DoxyParams}
Initialize the evaluator. 

Definition at line 369 of file Basis.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{369                                                                    : }
\DoxyCodeLine{370             \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\_}}(functions)}
\DoxyCodeLine{371         \{}
\DoxyCodeLine{372             \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_af48c0e905d578ca0f80434b60aa6d84b}{CoeffInit}}();}
\DoxyCodeLine{373             \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ab77ec65105e7885b53be39f29dee7d99}{BasisInit}}();}
\DoxyCodeLine{374         \}}

\end{DoxyCode}


References Basis\+Init(), and Coeff\+Init().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1BasisEvaluator_a52dc4b1c0aa2d92f47ef2f55eec772ae_cgraph}
\end{center}
\end{figure}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classSSAGES_1_1BasisEvaluator_af48c0e905d578ca0f80434b60aa6d84b}\label{classSSAGES_1_1BasisEvaluator_af48c0e905d578ca0f80434b60aa6d84b}} 
\index{SSAGES::BasisEvaluator@{SSAGES::BasisEvaluator}!CoeffInit@{CoeffInit}}
\index{CoeffInit@{CoeffInit}!SSAGES::BasisEvaluator@{SSAGES::BasisEvaluator}}
\doxysubsubsection{\texorpdfstring{CoeffInit()}{CoeffInit()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+Basis\+Evaluator\+::\+Coeff\+Init (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Initializes coefficient lookup vector. 

For now, when the basis evaluator is called it will store all the values of the basis functions into a lookup table. \mbox{[}Subject to change\mbox{]} 

Definition at line 100 of file Basis.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{101     \{     }
\DoxyCodeLine{102         \textcolor{keywordtype}{double} coeff\_size = 1;}
\DoxyCodeLine{103         \textcolor{comment}{//Get the size of the number of coefficients + 1}}
\DoxyCodeLine{104         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\_}}.size(); ++i)}
\DoxyCodeLine{105         \{}
\DoxyCodeLine{106             coeff\_size *= \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\_}}[i]-\/>GetOrder()+1;}
\DoxyCodeLine{107         \}}
\DoxyCodeLine{108 }
\DoxyCodeLine{109         std::vector<int> jdx(\mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\_}}.size(), 0);}
\DoxyCodeLine{110         Map temp\_map(jdx,0.0);}
\DoxyCodeLine{111         \textcolor{comment}{//Initialize the mapping for the coeff function}}
\DoxyCodeLine{112         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < coeff\_size; ++i)}
\DoxyCodeLine{113         \{}
\DoxyCodeLine{114             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < jdx.size(); ++j)}
\DoxyCodeLine{115             \{}
\DoxyCodeLine{116                 \textcolor{keywordflow}{if}(jdx[j] > 0 \&\& jdx[j] \% (\mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\_}}[j]-\/>GetOrder()+1) == 0)}
\DoxyCodeLine{117                 \{}
\DoxyCodeLine{118                     \textcolor{keywordflow}{if}(j != \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\_}}.size() -\/ 1)}
\DoxyCodeLine{119                     \{ }
\DoxyCodeLine{120                         jdx[j+1]++;}
\DoxyCodeLine{121                         jdx[j] = 0;}
\DoxyCodeLine{122                     \}}
\DoxyCodeLine{123                 \}}
\DoxyCodeLine{124                 temp\_map.map[j] = jdx[j];}
\DoxyCodeLine{125                 temp\_map.value  = 0; }
\DoxyCodeLine{126             \}}
\DoxyCodeLine{127             \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a8760f28614bf89568f5a4cbca0904e58}{coeff\_}}.push\_back(temp\_map);           }
\DoxyCodeLine{128             jdx[0]++;}
\DoxyCodeLine{129         \}}
\DoxyCodeLine{130     \}}

\end{DoxyCode}


References coeff\+\_\+, functions\+\_\+, S\+S\+A\+G\+E\+S\+::\+Map\+::map, and S\+S\+A\+G\+E\+S\+::\+Map\+::value.



Referenced by Basis\+Evaluator().

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1BasisEvaluator_af48c0e905d578ca0f80434b60aa6d84b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1BasisEvaluator_a24714eacab2c0afdf4fa17a570354a34}\label{classSSAGES_1_1BasisEvaluator_a24714eacab2c0afdf4fa17a570354a34}} 
\index{SSAGES::BasisEvaluator@{SSAGES::BasisEvaluator}!GetCoeff@{GetCoeff}}
\index{GetCoeff@{GetCoeff}!SSAGES::BasisEvaluator@{SSAGES::BasisEvaluator}}
\doxysubsubsection{\texorpdfstring{GetCoeff()}{GetCoeff()}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ S\+S\+A\+G\+E\+S\+::\+Basis\+Evaluator\+::\+Get\+Coeff (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Gets the coefficient array. 

\begin{DoxyReturn}{Returns}
Vector of current coefficients 
\end{DoxyReturn}


Definition at line 402 of file Basis.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{403         \{}
\DoxyCodeLine{404             std::vector<double> coeffArray (\mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a8760f28614bf89568f5a4cbca0904e58}{coeff\_}}.size(),0);}
\DoxyCodeLine{405             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<\mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a8760f28614bf89568f5a4cbca0904e58}{coeff\_}}.size(); i++)}
\DoxyCodeLine{406             \{}
\DoxyCodeLine{407                 coeffArray[i] = \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a8760f28614bf89568f5a4cbca0904e58}{coeff\_}}[i].value;}
\DoxyCodeLine{408             \}}
\DoxyCodeLine{409             \textcolor{keywordflow}{return} coeffArray; }
\DoxyCodeLine{410         \}}

\end{DoxyCode}


References coeff\+\_\+.

\mbox{\Hypertarget{classSSAGES_1_1BasisEvaluator_a17469fad6d29661c670c2b4ce4877570}\label{classSSAGES_1_1BasisEvaluator_a17469fad6d29661c670c2b4ce4877570}} 
\index{SSAGES::BasisEvaluator@{SSAGES::BasisEvaluator}!SetCoeff@{SetCoeff}}
\index{SetCoeff@{SetCoeff}!SSAGES::BasisEvaluator@{SSAGES::BasisEvaluator}}
\doxysubsubsection{\texorpdfstring{SetCoeff()}{SetCoeff()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+Basis\+Evaluator\+::\+Set\+Coeff (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ double $>$ \&}]{coeff }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set the coefficient array in the event of a restart run. 


\begin{DoxyParams}{Parameters}
{\em coeff} & Vector of coefficients to set \\
\hline
\end{DoxyParams}


Definition at line 416 of file Basis.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{417         \{}
\DoxyCodeLine{418             \textcolor{keywordtype}{size\_t} ii = 0;}
\DoxyCodeLine{419             \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& val : \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a8760f28614bf89568f5a4cbca0904e58}{coeff\_}}) }
\DoxyCodeLine{420             \{    }
\DoxyCodeLine{421                 val.value = coeff[ii];}
\DoxyCodeLine{422                 ii++;}
\DoxyCodeLine{423             \}}
\DoxyCodeLine{424         \}}

\end{DoxyCode}


References coeff\+\_\+.



Referenced by S\+S\+A\+G\+E\+S\+::\+B\+F\+S\+::\+Set\+Basis().

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1BasisEvaluator_a17469fad6d29661c670c2b4ce4877570_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1BasisEvaluator_ad017032c44a0840f05c7ac4d7fedd5cd}\label{classSSAGES_1_1BasisEvaluator_ad017032c44a0840f05c7ac4d7fedd5cd}} 
\index{SSAGES::BasisEvaluator@{SSAGES::BasisEvaluator}!UpdateBias@{UpdateBias}}
\index{UpdateBias@{UpdateBias}!SSAGES::BasisEvaluator@{SSAGES::BasisEvaluator}}
\doxysubsubsection{\texorpdfstring{UpdateBias()}{UpdateBias()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+Basis\+Evaluator\+::\+Update\+Bias (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ double $>$ $\ast$}]{bias,  }\item[{\mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ std\+::vector$<$ double $>$$>$ $\ast$}]{grad }\end{DoxyParamCaption})}



Outputs the basis projection at a specific coordinate. 


\begin{DoxyParams}{Parameters}
{\em bias} & \mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}} of current bias \\
\hline
{\em grad} & \mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}} of gradient to be applied \\
\hline
\end{DoxyParams}


Definition at line 154 of file Basis.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{155     \{ }
\DoxyCodeLine{156         \textcolor{keywordtype}{double} basis;}
\DoxyCodeLine{157         \textcolor{keywordtype}{double} temp;}
\DoxyCodeLine{158         \textcolor{keywordtype}{size\_t} j = 0;}
\DoxyCodeLine{159         \textcolor{keywordtype}{int} nbins;}
\DoxyCodeLine{160 }
\DoxyCodeLine{161         \textcolor{keywordflow}{for}(\mbox{\hyperlink{classSSAGES_1_1Grid_a7c8ea83ff2ad6a18ea2eee5f0d8b2e49}{Grid<double>::iterator}} it = bias-\/>\mbox{\hyperlink{classSSAGES_1_1Grid_a709374b3cadf320347604077a2e45e5b}{begin}}(); it != bias-\/>\mbox{\hyperlink{classSSAGES_1_1Grid_ac4fcc9f0cd61476ce4fd880c768d9694}{end}}(); ++it, ++j)}
\DoxyCodeLine{162         \{}
\DoxyCodeLine{163             std::vector<double> tmp\_grad (\mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\_}}.size(),0);}
\DoxyCodeLine{164             \textcolor{keywordtype}{double} tmp\_bias = 0;}
\DoxyCodeLine{165             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a8760f28614bf89568f5a4cbca0904e58}{coeff\_}}.size(); ++i)}
\DoxyCodeLine{166             \{}
\DoxyCodeLine{167                 basis = 1.0;}
\DoxyCodeLine{168                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} l = 0; l < \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\_}}.size(); l++)}
\DoxyCodeLine{169                 \{}
\DoxyCodeLine{170                     temp = 1.0;}
\DoxyCodeLine{171                     \textcolor{comment}{//For the gradients we only evaluate the gradient for diagonal terms}}
\DoxyCodeLine{172                     \textcolor{comment}{//Off diagonals are the basis set value}}
\DoxyCodeLine{173                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} k = 0; k < \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\_}}.size(); k++)}
\DoxyCodeLine{174                     \{}
\DoxyCodeLine{175                         nbins = bias-\/>\mbox{\hyperlink{classSSAGES_1_1GridBase_ab56c5b7786560a9a35951f1c3a44b077}{GetNumPoints}}(k);}
\DoxyCodeLine{176                         temp *= l == k ?  \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a688f5516b08cfdafe6004550e2f16249}{lookup\_}}[k].derivs[it.index(k) + \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a8760f28614bf89568f5a4cbca0904e58}{coeff\_}}[i].map[k]*nbins] * \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\_}}[l]-\/>GetRange() / (bias-\/>\mbox{\hyperlink{classSSAGES_1_1GridBase_a875feace8fff4743b103147c4193eca0}{GetUpper}}(l) -\/ bias-\/>\mbox{\hyperlink{classSSAGES_1_1GridBase_a2270a9233a9dc2d341e8ab88ce6655c9}{GetLower}}(l))}
\DoxyCodeLine{177                                        :  \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a688f5516b08cfdafe6004550e2f16249}{lookup\_}}[k].values[it.index(k) + \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a8760f28614bf89568f5a4cbca0904e58}{coeff\_}}[i].map[k]*nbins];}
\DoxyCodeLine{178                     \}}
\DoxyCodeLine{179                     tmp\_grad[l] -\/= \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a8760f28614bf89568f5a4cbca0904e58}{coeff\_}}[i].value * temp;}
\DoxyCodeLine{180                     nbins = bias-\/>\mbox{\hyperlink{classSSAGES_1_1GridBase_ab56c5b7786560a9a35951f1c3a44b077}{GetNumPoints}}(l);}
\DoxyCodeLine{181                     basis *= \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a688f5516b08cfdafe6004550e2f16249}{lookup\_}}[l].values[it.index(l) + \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a8760f28614bf89568f5a4cbca0904e58}{coeff\_}}[i].map[l]*nbins];}
\DoxyCodeLine{182                 \}}
\DoxyCodeLine{183                 \textcolor{comment}{//Update the bias values}}
\DoxyCodeLine{184                 tmp\_bias += \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a8760f28614bf89568f5a4cbca0904e58}{coeff\_}}[i].value * basis;}
\DoxyCodeLine{185                 \textcolor{comment}{//Store the gradient values}}
\DoxyCodeLine{186             \}}
\DoxyCodeLine{187             grad-\/>at(it.coordinates()) = tmp\_grad;}
\DoxyCodeLine{188             *it = tmp\_bias;}
\DoxyCodeLine{189         \}}
\DoxyCodeLine{190     \}}

\end{DoxyCode}


References S\+S\+A\+G\+E\+S\+::\+Grid$<$ T $>$\+::begin(), coeff\+\_\+, S\+S\+A\+G\+E\+S\+::\+Grid$<$ T $>$\+::end(), functions\+\_\+, S\+S\+A\+G\+E\+S\+::\+Grid\+Base$<$ T $>$\+::\+Get\+Lower(), S\+S\+A\+G\+E\+S\+::\+Grid\+Base$<$ T $>$\+::\+Get\+Num\+Points(), S\+S\+A\+G\+E\+S\+::\+Grid\+Base$<$ T $>$\+::\+Get\+Upper(), and lookup\+\_\+.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1BasisEvaluator_ad017032c44a0840f05c7ac4d7fedd5cd_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1BasisEvaluator_ad02d4d3e5e2e0af87a8e4a9d759a64a0}\label{classSSAGES_1_1BasisEvaluator_ad02d4d3e5e2e0af87a8e4a9d759a64a0}} 
\index{SSAGES::BasisEvaluator@{SSAGES::BasisEvaluator}!UpdateCoeff@{UpdateCoeff}}
\index{UpdateCoeff@{UpdateCoeff}!SSAGES::BasisEvaluator@{SSAGES::BasisEvaluator}}
\doxysubsubsection{\texorpdfstring{UpdateCoeff()}{UpdateCoeff()}}
{\footnotesize\ttfamily double S\+S\+A\+G\+E\+S\+::\+Basis\+Evaluator\+::\+Update\+Coeff (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ double $>$ \&}]{array,  }\item[{\mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ unsigned int $>$ $\ast$}]{hist }\end{DoxyParamCaption})}

Calculates the inner product of the basis set and the biased histogram This function then returns the coefficients from this calculation


\begin{DoxyParams}{Parameters}
{\em array} & Basis set. \\
\hline
{\em hist} & Biased histrogram.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Inner product of the basis set and the biased histogram. 
\end{DoxyReturn}


Definition at line 194 of file Basis.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{195     \{}
\DoxyCodeLine{196         \textcolor{keywordtype}{double} coeffTemp = 0;}
\DoxyCodeLine{197         \textcolor{keywordtype}{double} sum = 0;}
\DoxyCodeLine{198 }
\DoxyCodeLine{199         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& coeff : \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a8760f28614bf89568f5a4cbca0904e58}{coeff\_}})}
\DoxyCodeLine{200         \{}
\DoxyCodeLine{201             \textcolor{comment}{// The method uses a standard integration}}
\DoxyCodeLine{202             \textcolor{keywordtype}{size\_t} j = 0;}
\DoxyCodeLine{203             coeffTemp = coeff.value;}
\DoxyCodeLine{204             coeff.value = 0.0;}
\DoxyCodeLine{205             \textcolor{keywordflow}{for}(\mbox{\hyperlink{classSSAGES_1_1Grid_a7c8ea83ff2ad6a18ea2eee5f0d8b2e49}{Grid<unsigned int>::iterator}} it2 = hist-\/>\mbox{\hyperlink{classSSAGES_1_1Grid_a709374b3cadf320347604077a2e45e5b}{begin}}(); it2 != hist-\/>\mbox{\hyperlink{classSSAGES_1_1Grid_ac4fcc9f0cd61476ce4fd880c768d9694}{end}}(); ++it2, ++j)}
\DoxyCodeLine{206             \{ }
\DoxyCodeLine{207 }
\DoxyCodeLine{208                 \textcolor{keywordtype}{double} weight = std::pow(2.0,\mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\_}}.size());}
\DoxyCodeLine{209 }
\DoxyCodeLine{210                 \textcolor{comment}{// This adds in a trap-\/rule type weighting which lowers error significantly at the boundaries}}
\DoxyCodeLine{211                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} k = 0; k < \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\_}}.size(); ++k)}
\DoxyCodeLine{212                 \{}
\DoxyCodeLine{213                     \textcolor{keywordflow}{if}( it2.index(k) == 0 ||}
\DoxyCodeLine{214                         it2.index(k) == hist-\/>\mbox{\hyperlink{classSSAGES_1_1GridBase_ab56c5b7786560a9a35951f1c3a44b077}{GetNumPoints}}(k)-\/1)}
\DoxyCodeLine{215                         weight /= 2.0;}
\DoxyCodeLine{216                 \}}
\DoxyCodeLine{217                 \textcolor{comment}{/*The numerical integration of the biased histogram across the entirety of CV space}}
\DoxyCodeLine{218 \textcolor{comment}{                 *All calculations include the normalization as well}}
\DoxyCodeLine{219 \textcolor{comment}{                 */}}
\DoxyCodeLine{220                 \textcolor{keywordtype}{double} basis = 1.0;}
\DoxyCodeLine{221 }
\DoxyCodeLine{222                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} l = 0; l < \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\_}}.size(); l++)}
\DoxyCodeLine{223                 \{}
\DoxyCodeLine{224                     \textcolor{keywordtype}{int} nbins = hist-\/>\mbox{\hyperlink{classSSAGES_1_1GridBase_ab56c5b7786560a9a35951f1c3a44b077}{GetNumPoints}}(l);}
\DoxyCodeLine{225                     basis *= \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_a688f5516b08cfdafe6004550e2f16249}{lookup\_}}[l].values[it2.index(l) + coeff.map[l]*nbins]*\mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\_}}[l]-\/>GetRange()/nbins;}
\DoxyCodeLine{226                     \textcolor{comment}{//Normalize the values by the associated value}}
\DoxyCodeLine{227                     basis *= \mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\_}}[l]-\/>GetNorm(coeff.map[l])*\mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\_}}[l]-\/>Weight(it2.coordinate(l));}
\DoxyCodeLine{228                 \}}
\DoxyCodeLine{229                 coeff.value += basis * array[j] * weight/std::pow(2.0,\mbox{\hyperlink{classSSAGES_1_1BasisEvaluator_ad9ea3181ff6bcda8a78f42beecd7b977}{functions\_}}.size());}
\DoxyCodeLine{230             \}}
\DoxyCodeLine{231             coeffTemp -\/= coeff.value;}
\DoxyCodeLine{232             \textcolor{comment}{//std::cout<<coeffTemp<<std::endl;}}
\DoxyCodeLine{233             sum += fabs(coeffTemp);}
\DoxyCodeLine{234         \}}
\DoxyCodeLine{235         \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{236     \}}

\end{DoxyCode}


References S\+S\+A\+G\+E\+S\+::\+Grid$<$ T $>$\+::begin(), coeff\+\_\+, S\+S\+A\+G\+E\+S\+::\+Grid$<$ T $>$\+::end(), functions\+\_\+, S\+S\+A\+G\+E\+S\+::\+Grid\+Base$<$ T $>$\+::\+Get\+Num\+Points(), and lookup\+\_\+.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1BasisEvaluator_ad02d4d3e5e2e0af87a8e4a9d759a64a0_cgraph}
\end{center}
\end{figure}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/michael/development/\+S\+S\+A\+G\+E\+S/src/\+Utility/Basis.\+h\item 
/home/michael/development/\+S\+S\+A\+G\+E\+S/src/\+Utility/Basis.\+cpp\end{DoxyCompactItemize}
