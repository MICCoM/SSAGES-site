\hypertarget{classSSAGES_1_1ElasticBand}{}\doxysection{S\+S\+A\+G\+ES\+::Elastic\+Band Class Reference}
\label{classSSAGES_1_1ElasticBand}\index{SSAGES::ElasticBand@{SSAGES::ElasticBand}}


Multi-\/walker Elastic Band.  




{\ttfamily \#include $<$Elastic\+Band.\+h$>$}



Inheritance diagram for S\+S\+A\+G\+ES\+::Elastic\+Band\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=204pt]{classSSAGES_1_1ElasticBand__inherit__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classSSAGES_1_1ElasticBand_abf87da865fc5e668e21d21f9c9ff361a}{Elastic\+Band}} (const M\+P\+I\+\_\+\+Comm \&world, const M\+P\+I\+\_\+\+Comm \&comm, const std\+::vector$<$ double $>$ \&centers, unsigned int maxiterations, unsigned int nsamples, double tau, const std\+::vector$<$ double $>$ cvspring, unsigned int equilibrate, unsigned int evolution, double stringspring, unsigned int frequency)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1ElasticBand_a85177e2c02fa8f767eb98664636732da}{Post\+Integration}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$snapshot, const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&cvmanager) override
\begin{DoxyCompactList}\small\item\em Post-\/integration hook. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ElasticBand_a5e7a910172b44de2920681ab0ccd1e52}\label{classSSAGES_1_1ElasticBand_a5e7a910172b44de2920681ab0ccd1e52}} 
\mbox{\hyperlink{classSSAGES_1_1ElasticBand_a5e7a910172b44de2920681ab0ccd1e52}{$\sim$\+Elastic\+Band}} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classSSAGES_1_1ElasticBand_a131b99117f7f7f3ff18419513a2c507b}\label{classSSAGES_1_1ElasticBand_a131b99117f7f7f3ff18419513a2c507b}} 
void \mbox{\hyperlink{classSSAGES_1_1ElasticBand_a131b99117f7f7f3ff18419513a2c507b}{String\+Update}} () override
\begin{DoxyCompactList}\small\item\em Updates the nudged elastic band string. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
unsigned int \mbox{\hyperlink{classSSAGES_1_1ElasticBand_a22f5657825ca797d6a99a96b8948bd7a}{equilibrate\+\_\+}}
\item 
unsigned int \mbox{\hyperlink{classSSAGES_1_1ElasticBand_abb6609949340c8607070d7a0fcd57f57}{evolution\+\_\+}}
\item 
\mbox{\Hypertarget{classSSAGES_1_1ElasticBand_af2707477ac5163896229d79580d69ed1}\label{classSSAGES_1_1ElasticBand_af2707477ac5163896229d79580d69ed1}} 
unsigned int \mbox{\hyperlink{classSSAGES_1_1ElasticBand_af2707477ac5163896229d79580d69ed1}{nsamples\+\_\+}}
\begin{DoxyCompactList}\small\item\em Block iterations. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ElasticBand_a2396bd84759a798189f6c8227fd96e37}\label{classSSAGES_1_1ElasticBand_a2396bd84759a798189f6c8227fd96e37}} 
unsigned int \mbox{\hyperlink{classSSAGES_1_1ElasticBand_a2396bd84759a798189f6c8227fd96e37}{nsampled\+\_\+}}
\begin{DoxyCompactList}\small\item\em Number samples actually sampled. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ElasticBand_a61fb8f2ec2beda5d9b95fdeaf3054fef}\label{classSSAGES_1_1ElasticBand_a61fb8f2ec2beda5d9b95fdeaf3054fef}} 
double \mbox{\hyperlink{classSSAGES_1_1ElasticBand_a61fb8f2ec2beda5d9b95fdeaf3054fef}{tau\+\_\+}}
\begin{DoxyCompactList}\small\item\em Time step of string change. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ElasticBand_a4ee8cb591566fa5b3b95e629f3fc35ea}\label{classSSAGES_1_1ElasticBand_a4ee8cb591566fa5b3b95e629f3fc35ea}} 
double \mbox{\hyperlink{classSSAGES_1_1ElasticBand_a4ee8cb591566fa5b3b95e629f3fc35ea}{stringspring\+\_\+}}
\begin{DoxyCompactList}\small\item\em String spring constant. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
Multi-\/walker Elastic Band. 

Implementation of a multi-\/walker Elastic Band method with no bells and whistles. 

Definition at line 34 of file Elastic\+Band.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classSSAGES_1_1ElasticBand_abf87da865fc5e668e21d21f9c9ff361a}\label{classSSAGES_1_1ElasticBand_abf87da865fc5e668e21d21f9c9ff361a}} 
\index{SSAGES::ElasticBand@{SSAGES::ElasticBand}!ElasticBand@{ElasticBand}}
\index{ElasticBand@{ElasticBand}!SSAGES::ElasticBand@{SSAGES::ElasticBand}}
\doxysubsubsection{\texorpdfstring{ElasticBand()}{ElasticBand()}}
{\footnotesize\ttfamily S\+S\+A\+G\+E\+S\+::\+Elastic\+Band\+::\+Elastic\+Band (\begin{DoxyParamCaption}\item[{const M\+P\+I\+\_\+\+Comm \&}]{world,  }\item[{const M\+P\+I\+\_\+\+Comm \&}]{comm,  }\item[{const std\+::vector$<$ double $>$ \&}]{centers,  }\item[{unsigned int}]{maxiterations,  }\item[{unsigned int}]{nsamples,  }\item[{double}]{tau,  }\item[{const std\+::vector$<$ double $>$}]{cvspring,  }\item[{unsigned int}]{equilibrate,  }\item[{unsigned int}]{evolution,  }\item[{double}]{stringspring,  }\item[{unsigned int}]{frequency }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em world} & M\+PI global communicator. \\
\hline
{\em comm} & M\+PI local communicator. \\
\hline
{\em centers} & List of centers. \\
\hline
{\em maxiterations} & Maximum number of iterations. \\
\hline
{\em nsamples} & Number of samples to collect before updating string. \\
\hline
{\em tau} & Value of tau (default\+: 0.\+1). \\
\hline
{\em cvspring} & Spring constants for cvs. \\
\hline
{\em equilibrate} & Number of MD steps to allow the system to reequilibrate after updating string. \\
\hline
{\em evolution} & Number of MD steps to allow the system to evolve before gathering statistics. \\
\hline
{\em stringspring} & Spring constant used between nodes. \\
\hline
{\em frequency} & Frequency with which this method is invoked.\\
\hline
\end{DoxyParams}
Constructs an instance of Elastic Band method. 

Definition at line 77 of file Elastic\+Band.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{87                                             :}
\DoxyCodeLine{88         \mbox{\hyperlink{classSSAGES_1_1StringMethod_a52e179be14386a48b0d6e84e1f100fb7}{StringMethod}}(world, comm, centers, maxiterations,}
\DoxyCodeLine{89         cvspring, frequency), \mbox{\hyperlink{classSSAGES_1_1ElasticBand_a22f5657825ca797d6a99a96b8948bd7a}{equilibrate\_}}(equilibrate),}
\DoxyCodeLine{90         \mbox{\hyperlink{classSSAGES_1_1ElasticBand_abb6609949340c8607070d7a0fcd57f57}{evolution\_}}(evolution), \mbox{\hyperlink{classSSAGES_1_1ElasticBand_af2707477ac5163896229d79580d69ed1}{nsamples\_}}(nsamples),}
\DoxyCodeLine{91         \mbox{\hyperlink{classSSAGES_1_1ElasticBand_a2396bd84759a798189f6c8227fd96e37}{nsampled\_}}(0), \mbox{\hyperlink{classSSAGES_1_1ElasticBand_a61fb8f2ec2beda5d9b95fdeaf3054fef}{tau\_}}(tau), \mbox{\hyperlink{classSSAGES_1_1ElasticBand_a4ee8cb591566fa5b3b95e629f3fc35ea}{stringspring\_}}(stringspring)}
\DoxyCodeLine{92         \{}
\DoxyCodeLine{93         \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classSSAGES_1_1ElasticBand_a85177e2c02fa8f767eb98664636732da}\label{classSSAGES_1_1ElasticBand_a85177e2c02fa8f767eb98664636732da}} 
\index{SSAGES::ElasticBand@{SSAGES::ElasticBand}!PostIntegration@{PostIntegration}}
\index{PostIntegration@{PostIntegration}!SSAGES::ElasticBand@{SSAGES::ElasticBand}}
\doxysubsubsection{\texorpdfstring{PostIntegration()}{PostIntegration()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+Elastic\+Band\+::\+Post\+Integration (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$}]{snapshot,  }\item[{const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&}]{cvmanager }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Post-\/integration hook. 


\begin{DoxyParams}{Parameters}
{\em snapshot} & Current simulation snapshot. \\
\hline
{\em cvmanager} & Collective variable manager. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classSSAGES_1_1StringMethod_a5e02e69fbe65d3064f9fe76c36be6ab5}{S\+S\+A\+G\+E\+S\+::\+String\+Method}}.



Definition at line 30 of file Elastic\+Band.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{31     \{}
\DoxyCodeLine{32         \textcolor{keyword}{auto}\& forces = snapshot-\/>GetForces();}
\DoxyCodeLine{33         \textcolor{keyword}{auto} cvs = cvmanager.GetCVs(\mbox{\hyperlink{classSSAGES_1_1Method_a24b0ac53b1fabcab0a5f3bd6cde26909}{cvmask\_}});}
\DoxyCodeLine{34 }
\DoxyCodeLine{35         \textcolor{comment}{// Apply umbrella to CVs.}}
\DoxyCodeLine{36         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < cvs.size(); ++i)}
\DoxyCodeLine{37         \{}
\DoxyCodeLine{38             \textcolor{comment}{// Get current CV and gradient.}}
\DoxyCodeLine{39             \textcolor{keyword}{auto}\& cv = cvs[i];}
\DoxyCodeLine{40             \textcolor{keyword}{auto}\& grad = cv-\/>GetGradient();}
\DoxyCodeLine{41 }
\DoxyCodeLine{42             \textcolor{comment}{// Compute dV/dCV.}}
\DoxyCodeLine{43             \textcolor{keyword}{auto} diff = cv-\/>GetDifference(\mbox{\hyperlink{classSSAGES_1_1StringMethod_a8f5e8ddc90a86dc363d3323c31f8e3b7}{centers\_}}[i]);}
\DoxyCodeLine{44             \textcolor{keyword}{auto} D = \mbox{\hyperlink{classSSAGES_1_1StringMethod_a51f68bc9e02055a96375617626240a79}{cvspring\_}}[i] * diff;}
\DoxyCodeLine{45 }
\DoxyCodeLine{46             \textcolor{comment}{// Update forces.}}
\DoxyCodeLine{47             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < forces.size(); ++j)}
\DoxyCodeLine{48                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k = 0; k < forces[j].size(); ++k)}
\DoxyCodeLine{49                     forces[j][k] -\/= D*grad[j][k];}
\DoxyCodeLine{50 }
\DoxyCodeLine{51             \textcolor{comment}{// If not equilibrating and has evolved enough steps,}}
\DoxyCodeLine{52             \textcolor{comment}{// generate the gradient}}
\DoxyCodeLine{53             \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1StringMethod_ae1214f174d34de4481f639f7aab4b8c5}{iterator\_}} >= \mbox{\hyperlink{classSSAGES_1_1ElasticBand_a22f5657825ca797d6a99a96b8948bd7a}{equilibrate\_}} \&\& \mbox{\hyperlink{classSSAGES_1_1StringMethod_ae1214f174d34de4481f639f7aab4b8c5}{iterator\_}} \% \mbox{\hyperlink{classSSAGES_1_1ElasticBand_abb6609949340c8607070d7a0fcd57f57}{evolution\_}} == 0)}
\DoxyCodeLine{54             \{}
\DoxyCodeLine{55                 \mbox{\hyperlink{classSSAGES_1_1StringMethod_af62b2619c59a5b505d46ee861b034744}{newcenters\_}}[i] += D;}
\DoxyCodeLine{56                 \mbox{\hyperlink{classSSAGES_1_1ElasticBand_a2396bd84759a798189f6c8227fd96e37}{nsampled\_}}++;}
\DoxyCodeLine{57             \}}
\DoxyCodeLine{58         \}}
\DoxyCodeLine{59 }
\DoxyCodeLine{60         \textcolor{comment}{// Restart iteration and zero gradients when moving onto}}
\DoxyCodeLine{61         \textcolor{comment}{// next elastic band iteration}}
\DoxyCodeLine{62         \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1StringMethod_ae1214f174d34de4481f639f7aab4b8c5}{iterator\_}} > (\mbox{\hyperlink{classSSAGES_1_1ElasticBand_a22f5657825ca797d6a99a96b8948bd7a}{equilibrate\_}} + \mbox{\hyperlink{classSSAGES_1_1ElasticBand_abb6609949340c8607070d7a0fcd57f57}{evolution\_}} * \mbox{\hyperlink{classSSAGES_1_1ElasticBand_af2707477ac5163896229d79580d69ed1}{nsamples\_}}))}
\DoxyCodeLine{63         \{}
\DoxyCodeLine{64             \mbox{\hyperlink{classSSAGES_1_1ElasticBand_a131b99117f7f7f3ff18419513a2c507b}{StringUpdate}}();}
\DoxyCodeLine{65             \mbox{\hyperlink{classSSAGES_1_1StringMethod_a98d6840cc33ad30c2e9a4311e57ea2de}{CheckEnd}}(cvs);}
\DoxyCodeLine{66             \mbox{\hyperlink{classSSAGES_1_1StringMethod_a538a83e6f944a2b37ae9cc6207c970f5}{UpdateWorldString}}(cvs);}
\DoxyCodeLine{67             \mbox{\hyperlink{classSSAGES_1_1StringMethod_aaac8b878af3574e7da1c109e5d2bfaf0}{PrintString}}(cvs);}
\DoxyCodeLine{68 }
\DoxyCodeLine{69             \mbox{\hyperlink{classSSAGES_1_1StringMethod_ae1214f174d34de4481f639f7aab4b8c5}{iterator\_}} = 0;}
\DoxyCodeLine{70 }
\DoxyCodeLine{71             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} ii = 0; ii < \mbox{\hyperlink{classSSAGES_1_1StringMethod_af62b2619c59a5b505d46ee861b034744}{newcenters\_}}.size(); ii++)}
\DoxyCodeLine{72                 \mbox{\hyperlink{classSSAGES_1_1StringMethod_af62b2619c59a5b505d46ee861b034744}{newcenters\_}}[ii] = 0;}
\DoxyCodeLine{73 }
\DoxyCodeLine{74             \mbox{\hyperlink{classSSAGES_1_1ElasticBand_a2396bd84759a798189f6c8227fd96e37}{nsampled\_}} = 0;}
\DoxyCodeLine{75             \mbox{\hyperlink{classSSAGES_1_1StringMethod_a9aa61a19b2ad38d4890e53cb97176d58}{iteration\_}}++;}
\DoxyCodeLine{76         \}}
\DoxyCodeLine{77 }
\DoxyCodeLine{78         \mbox{\hyperlink{classSSAGES_1_1StringMethod_ae1214f174d34de4481f639f7aab4b8c5}{iterator\_}}++;}
\DoxyCodeLine{79     \}}

\end{DoxyCode}


References S\+S\+A\+G\+E\+S\+::\+String\+Method\+::centers\+\_\+, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::\+Check\+End(), S\+S\+A\+G\+E\+S\+::\+Method\+::cvmask\+\_\+, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::cvspring\+\_\+, equilibrate\+\_\+, evolution\+\_\+, S\+S\+A\+G\+E\+S\+::\+C\+V\+Manager\+::\+Get\+C\+Vs(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Forces(), S\+S\+A\+G\+E\+S\+::\+String\+Method\+::iteration\+\_\+, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::iterator\+\_\+, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::newcenters\+\_\+, nsampled\+\_\+, nsamples\+\_\+, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::\+Print\+String(), String\+Update(), and S\+S\+A\+G\+E\+S\+::\+String\+Method\+::\+Update\+World\+String().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1ElasticBand_a85177e2c02fa8f767eb98664636732da_cgraph}
\end{center}
\end{figure}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classSSAGES_1_1ElasticBand_a22f5657825ca797d6a99a96b8948bd7a}\label{classSSAGES_1_1ElasticBand_a22f5657825ca797d6a99a96b8948bd7a}} 
\index{SSAGES::ElasticBand@{SSAGES::ElasticBand}!equilibrate\_@{equilibrate\_}}
\index{equilibrate\_@{equilibrate\_}!SSAGES::ElasticBand@{SSAGES::ElasticBand}}
\doxysubsubsection{\texorpdfstring{equilibrate\_}{equilibrate\_}}
{\footnotesize\ttfamily unsigned int S\+S\+A\+G\+E\+S\+::\+Elastic\+Band\+::equilibrate\+\_\+\hspace{0.3cm}{\ttfamily [private]}}

Number Equilibration steps, number of MD steps to allow the system to reequilibrate before evolving. 

Definition at line 39 of file Elastic\+Band.\+h.



Referenced by Post\+Integration().

\mbox{\Hypertarget{classSSAGES_1_1ElasticBand_abb6609949340c8607070d7a0fcd57f57}\label{classSSAGES_1_1ElasticBand_abb6609949340c8607070d7a0fcd57f57}} 
\index{SSAGES::ElasticBand@{SSAGES::ElasticBand}!evolution\_@{evolution\_}}
\index{evolution\_@{evolution\_}!SSAGES::ElasticBand@{SSAGES::ElasticBand}}
\doxysubsubsection{\texorpdfstring{evolution\_}{evolution\_}}
{\footnotesize\ttfamily unsigned int S\+S\+A\+G\+E\+S\+::\+Elastic\+Band\+::evolution\+\_\+\hspace{0.3cm}{\ttfamily [private]}}

Number evolution steps, number of MD steps before collecting statistics for gradients. 

Definition at line 43 of file Elastic\+Band.\+h.



Referenced by Post\+Integration().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/michael/development/\+S\+S\+A\+G\+E\+S/src/\+Methods/Elastic\+Band.\+h\item 
/home/michael/development/\+S\+S\+A\+G\+E\+S/src/\+Methods/Elastic\+Band.\+cpp\end{DoxyCompactItemize}
