\hypertarget{classSSAGES_1_1DirectForwardFlux}{}\doxysection{S\+S\+A\+G\+ES\+::Direct\+Forward\+Flux Class Reference}
\label{classSSAGES_1_1DirectForwardFlux}\index{SSAGES::DirectForwardFlux@{SSAGES::DirectForwardFlux}}


\mbox{\hyperlink{classSSAGES_1_1ForwardFlux}{Forward\+Flux}} sampling method.  




{\ttfamily \#include $<$Direct\+Forward\+Flux.\+h$>$}



Inheritance diagram for S\+S\+A\+G\+ES\+::Direct\+Forward\+Flux\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=224pt]{classSSAGES_1_1DirectForwardFlux__inherit__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classSSAGES_1_1DirectForwardFlux_a8620d21463fe4ac3bf778a3e4ee588aa}{Direct\+Forward\+Flux}} (const M\+P\+I\+\_\+\+Comm \&world, const M\+P\+I\+\_\+\+Comm \&comm, double ninterfaces, std\+::vector$<$ double $>$ interfaces, unsigned int N0\+Target, std\+::vector$<$ unsigned int $>$ M, bool initial\+Flux\+Flag, bool save\+Trajectories, unsigned int current\+Interface, std\+::string output\+\_\+directory, unsigned int frequency)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1DirectForwardFlux_a5491cd537f737524f5fc295236eefb85}{Post\+Integration}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$snapshot, const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&cvmanager) override
\begin{DoxyCompactList}\small\item\em Post-\/integration hook. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{classSSAGES_1_1DirectForwardFlux}{Direct\+Forward\+Flux}} $\ast$ \mbox{\hyperlink{classSSAGES_1_1DirectForwardFlux_a6310efe6e04619f0d0a1fecdd8642aed}{Build}} (const Json\+::\+Value \&json, const M\+P\+I\+\_\+\+Comm \&world, const M\+P\+I\+\_\+\+Comm \&comm, const std\+::string \&path)
\begin{DoxyCompactList}\small\item\em Build a derived method from \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} node. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classSSAGES_1_1DirectForwardFlux_a2be13ab9b33d4cb90aa22ca9d71077e9}{Check\+For\+Interface\+Crossings}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$, const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&) override
\begin{DoxyCompactList}\small\item\em Function that checks if interfaces have been crossed (different for each F\+FS flavor) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1DirectForwardFlux_af14a27e7176c4cd6fca5479dfef17358}\label{classSSAGES_1_1DirectForwardFlux_af14a27e7176c4cd6fca5479dfef17358}} 
void \mbox{\hyperlink{classSSAGES_1_1DirectForwardFlux_af14a27e7176c4cd6fca5479dfef17358}{Initialize\+Queue}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$, const \mbox{\hyperlink{namespaceSSAGES_acddea47426ac0a643b048f870ddd2907}{C\+V\+List}} \&) override
\begin{DoxyCompactList}\small\item\em Initialize the Queue. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
\mbox{\hyperlink{classSSAGES_1_1ForwardFlux}{Forward\+Flux}} sampling method. 

The notation used here is drawn largely from Allen, Valeriani and Rein ten Wolde. J. Phys.\+: Condens. Matter (2009) 21\+:463102. We recommend referring to this review if the reader is unfamiliar with the method, or our variable naming conventions. 

Definition at line 35 of file Direct\+Forward\+Flux.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classSSAGES_1_1DirectForwardFlux_a8620d21463fe4ac3bf778a3e4ee588aa}\label{classSSAGES_1_1DirectForwardFlux_a8620d21463fe4ac3bf778a3e4ee588aa}} 
\index{SSAGES::DirectForwardFlux@{SSAGES::DirectForwardFlux}!DirectForwardFlux@{DirectForwardFlux}}
\index{DirectForwardFlux@{DirectForwardFlux}!SSAGES::DirectForwardFlux@{SSAGES::DirectForwardFlux}}
\doxysubsubsection{\texorpdfstring{DirectForwardFlux()}{DirectForwardFlux()}}
{\footnotesize\ttfamily S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Direct\+Forward\+Flux (\begin{DoxyParamCaption}\item[{const M\+P\+I\+\_\+\+Comm \&}]{world,  }\item[{const M\+P\+I\+\_\+\+Comm \&}]{comm,  }\item[{double}]{ninterfaces,  }\item[{std\+::vector$<$ double $>$}]{interfaces,  }\item[{unsigned int}]{N0\+Target,  }\item[{std\+::vector$<$ unsigned int $>$}]{M,  }\item[{bool}]{initial\+Flux\+Flag,  }\item[{bool}]{save\+Trajectories,  }\item[{unsigned int}]{current\+Interface,  }\item[{std\+::string}]{output\+\_\+directory,  }\item[{unsigned int}]{frequency }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em world} & M\+PI global communicator. \\
\hline
{\em comm} & M\+PI local communicator. \\
\hline
{\em ninterfaces} & Number of interfaces. \\
\hline
{\em interfaces} & Vector of interfaces. \\
\hline
{\em N0\+Target} & Required number of initial configurations. \\
\hline
{\em M} & Vector of trials. \\
\hline
{\em initial\+Flux\+Flag} & Flag for first step of this method. \\
\hline
{\em save\+Trajectories} & Flag to save flux trajectories. \\
\hline
{\em current\+Interface} & The number of the current interface. \\
\hline
{\em output\+\_\+directory} & Directory to which trajectories are saved. \\
\hline
{\em frequency} & Frequency with which this method is invoked.\\
\hline
\end{DoxyParams}
Create instance of Forward Flux 

Definition at line 58 of file Direct\+Forward\+Flux.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{64         : \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a77060dea307348f3df6b9dfb4069dfdb}{ForwardFlux}}(world, comm, ninterfaces, interfaces, N0Target, M, }
\DoxyCodeLine{65                       initialFluxFlag, saveTrajectories, currentInterface, output\_directory, frequency) \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classSSAGES_1_1DirectForwardFlux_a6310efe6e04619f0d0a1fecdd8642aed}\label{classSSAGES_1_1DirectForwardFlux_a6310efe6e04619f0d0a1fecdd8642aed}} 
\index{SSAGES::DirectForwardFlux@{SSAGES::DirectForwardFlux}!Build@{Build}}
\index{Build@{Build}!SSAGES::DirectForwardFlux@{SSAGES::DirectForwardFlux}}
\doxysubsubsection{\texorpdfstring{Build()}{Build()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{classSSAGES_1_1DirectForwardFlux}{Direct\+Forward\+Flux}}$\ast$ S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Build (\begin{DoxyParamCaption}\item[{const Json\+::\+Value \&}]{json,  }\item[{const M\+P\+I\+\_\+\+Comm \&}]{world,  }\item[{const M\+P\+I\+\_\+\+Comm \&}]{comm,  }\item[{const std\+::string \&}]{path }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Build a derived method from \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} node. 


\begin{DoxyParams}{Parameters}
{\em json} & \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} Value containing all input information. \\
\hline
{\em world} & M\+PI global communicator. \\
\hline
{\em comm} & M\+PI local communicator. \\
\hline
{\em path} & Path for \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} path specification. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the \mbox{\hyperlink{classSSAGES_1_1Method}{Method}} built. nullptr if an unknown error occurred.
\end{DoxyReturn}
This function builds a registered method from a \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} node. The difference between this function and \char`\"{}\+Build\char`\"{} is that this automatically determines the appropriate derived type based on the \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} node information.

\begin{DoxyNote}{Note}
Object lifetime is the caller\textquotesingle{}s responsibility. 
\end{DoxyNote}
\mbox{\Hypertarget{classSSAGES_1_1DirectForwardFlux_a2be13ab9b33d4cb90aa22ca9d71077e9}\label{classSSAGES_1_1DirectForwardFlux_a2be13ab9b33d4cb90aa22ca9d71077e9}} 
\index{SSAGES::DirectForwardFlux@{SSAGES::DirectForwardFlux}!CheckForInterfaceCrossings@{CheckForInterfaceCrossings}}
\index{CheckForInterfaceCrossings@{CheckForInterfaceCrossings}!SSAGES::DirectForwardFlux@{SSAGES::DirectForwardFlux}}
\doxysubsubsection{\texorpdfstring{CheckForInterfaceCrossings()}{CheckForInterfaceCrossings()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Check\+For\+Interface\+Crossings (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$}]{,  }\item[{const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}



Function that checks if interfaces have been crossed (different for each F\+FS flavor) 

Number of trials to attemt from each interface Note \+\_\+M\mbox{[}0\mbox{]} sets the number of \textquotesingle{}branches\textquotesingle{} for R\+B\+F\+FS and B\+G\+F\+FS? 

Implements \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ab29defb5bcbaca0c7c33d7ecb91184f6}{S\+S\+A\+G\+E\+S\+::\+Forward\+Flux}}.



Definition at line 67 of file Direct\+Forward\+Flux.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{68     \{}
\DoxyCodeLine{69         \textcolor{comment}{//This is the main FFS method. The magic happens here!}}
\DoxyCodeLine{70         \textcolor{keyword}{auto} cvs = cvmanager.GetCVs(\mbox{\hyperlink{classSSAGES_1_1Method_a24b0ac53b1fabcab0a5f3bd6cde26909}{cvmask\_}});}
\DoxyCodeLine{71         }
\DoxyCodeLine{72         \textcolor{comment}{//QUESTION: Whats the difference between world\_ and \_comm?}}
\DoxyCodeLine{73         \textcolor{comment}{//For now I'll use world\_ for everything. But if each driver uses multiple procs then I suspect that this will be wrong.}}
\DoxyCodeLine{74         \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac40d1ade8599276bf048d7ff693cfbcf}{\_cvvalue}} = cvs[0]-\/>GetValue();}
\DoxyCodeLine{75         }
\DoxyCodeLine{77         \textcolor{comment}{//if ((myFFSConfigID.l == 2) \&\& (myFFSConfigID.n == 20) \&\& (myFFSConfigID.a ==1))\{}}
\DoxyCodeLine{78         \textcolor{comment}{//    std::cout << "stop here\(\backslash\)n";}}
\DoxyCodeLine{79         \textcolor{comment}{//\}}}
\DoxyCodeLine{80         \textcolor{comment}{//if (myFFSConfigID.l != \_current\_interface)\{}}
\DoxyCodeLine{81         \textcolor{comment}{//    std::cout << "stop here\(\backslash\)n";}}
\DoxyCodeLine{82         \textcolor{comment}{//\}}}
\DoxyCodeLine{83 }
\DoxyCodeLine{84         \textcolor{comment}{//check if I've crossed the next interface}}
\DoxyCodeLine{85         \textcolor{keywordtype}{bool} hasreturned = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ae7c156e7bbb5e4d70c59c09587deb553}{HasReturnedToA}}(\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac40d1ade8599276bf048d7ff693cfbcf}{\_cvvalue}});}
\DoxyCodeLine{86         \textcolor{keywordtype}{int} hascrossed = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ad503e21a587cbac6536538de35d9e872}{HasCrossedInterface}}(\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac40d1ade8599276bf048d7ff693cfbcf}{\_cvvalue}}, \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a3dafbb3b76d1de95fcf94538c6d7edcb}{\_cvvalue\_previous}}, \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}} + 1);}
\DoxyCodeLine{87         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} fail\_local=\textcolor{keyword}{false},success\_local=\textcolor{keyword}{false};}
\DoxyCodeLine{88         \textcolor{comment}{//std::vector<bool> in MPI were strange, ended up using std::vector<unsigned int>}}
\DoxyCodeLine{89         std::vector<unsigned int> successes (\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}}.size());}
\DoxyCodeLine{90         std::vector<unsigned int> failures (\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}}.size());}
\DoxyCodeLine{91 }
\DoxyCodeLine{92         \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a24bce6318d9821293945a32620ffc7b6}{\_pop\_tried\_but\_empty\_queue}})}
\DoxyCodeLine{93         \{ }
\DoxyCodeLine{94             \textcolor{comment}{// make sure this isnt a zombie trajectory that previously failed or succeeded and is just waiting for the queue to get more jobs}}
\DoxyCodeLine{95             \textcolor{keywordflow}{if} (hasreturned)}
\DoxyCodeLine{96                 fail\_local=\textcolor{keyword}{true};}
\DoxyCodeLine{97             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (hascrossed == 1)}
\DoxyCodeLine{98                 success\_local=\textcolor{keyword}{true};}
\DoxyCodeLine{99             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (hascrossed == -\/1)}
\DoxyCodeLine{100             \{}
\DoxyCodeLine{101               \textcolor{comment}{//this should never happen if the interfaces are non-\/intersecting, it would be wise to throw an error here though}}
\DoxyCodeLine{102               std::cerr << \textcolor{stringliteral}{"Trajectory l"}<<\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}{myFFSConfigID}}.\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID_afe91617771b2c2e7c2fee6976e0c6be4}{l}}<<\textcolor{stringliteral}{"-\/n"}<<\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}{myFFSConfigID}}.\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID_abdf33a2779455d7ab7cffbe791145739}{n}}<<\textcolor{stringliteral}{"-\/a"}<<\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}{myFFSConfigID}}.\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID_ab05bd46242e1c1b8d82428562467d68e}{a}}<<\textcolor{stringliteral}{" crossed backwards! This shouldnt happen!"} << std::endl;}
\DoxyCodeLine{103               \textcolor{comment}{//world\_.abort(EXIT\_FAILURE);}}
\DoxyCodeLine{104             \}}
\DoxyCodeLine{105             \textcolor{keywordflow}{else}}
\DoxyCodeLine{106             \{}
\DoxyCodeLine{107               \textcolor{comment}{//not sure if anything should needs to be done here        }}
\DoxyCodeLine{108             \}}
\DoxyCodeLine{109         \}}
\DoxyCodeLine{110 }
\DoxyCodeLine{111         \textcolor{comment}{//for each traj that crossed to lambda+1 need to write it to disk (FFSConfigurationFile)}}
\DoxyCodeLine{112         \textcolor{comment}{//MPIAllgather success\_local into successes}}
\DoxyCodeLine{113         MPI\_Allgather(\&success\_local,1,MPI\_UNSIGNED,successes.data(),1,MPI\_UNSIGNED,\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}});}
\DoxyCodeLine{114         MPI\_Allgather(\&fail\_local,1,MPI\_UNSIGNED,failures.data(),1,MPI\_UNSIGNED,\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}});}
\DoxyCodeLine{115        }
\DoxyCodeLine{116         \textcolor{keywordtype}{int} success\_count = 0, fail\_count = 0;}
\DoxyCodeLine{117         \textcolor{comment}{// I dont pass the queue information between procs but I do syncronize 'successes' and 'failures'}}
\DoxyCodeLine{118         \textcolor{comment}{//   as a reuslt all proc should have the same queue throughout the simulation}}
\DoxyCodeLine{119         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}}.size();i++)}
\DoxyCodeLine{120         \{}
\DoxyCodeLine{121             \textcolor{keywordtype}{int} l,n,a,lprev,nprev,aprev;}
\DoxyCodeLine{122             \textcolor{comment}{// write config to lambda+1}}
\DoxyCodeLine{123             lprev = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}{myFFSConfigID}}.\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID_afe91617771b2c2e7c2fee6976e0c6be4}{l}};}
\DoxyCodeLine{124             nprev = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}{myFFSConfigID}}.\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID_abdf33a2779455d7ab7cffbe791145739}{n}};}
\DoxyCodeLine{125             aprev = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}{myFFSConfigID}}.\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID_ab05bd46242e1c1b8d82428562467d68e}{a}};}
\DoxyCodeLine{126 }
\DoxyCodeLine{127             \textcolor{keywordflow}{if} (successes[i] == \textcolor{keyword}{true})}
\DoxyCodeLine{128             \{ }
\DoxyCodeLine{129                 \textcolor{keywordflow}{if} (i == \mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}}.rank())}
\DoxyCodeLine{130                 \{}
\DoxyCodeLine{131                     \textcolor{comment}{//update ffsconfigid's l,n,a}}
\DoxyCodeLine{132                     l = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}} + 1;}
\DoxyCodeLine{133                     n = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ab306e381420317cb8b25ce506e2564a0}{\_S}}[\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}] + success\_count;}
\DoxyCodeLine{134                     a = 0;}
\DoxyCodeLine{135                     FFSConfigID newid = FFSConfigID(l,n,a,lprev,nprev,aprev);}
\DoxyCodeLine{136                     \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a8f3da6706283040f7adf33399bdb2376}{WriteFFSConfiguration}}(snapshot,newid,1);}
\DoxyCodeLine{137                 \}}
\DoxyCodeLine{138                 success\_count++;}
\DoxyCodeLine{139             \}}
\DoxyCodeLine{140             \textcolor{keywordflow}{if} (failures[i] == \textcolor{keyword}{true})}
\DoxyCodeLine{141             \{ }
\DoxyCodeLine{142                 \textcolor{keywordflow}{if} (i == \mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}}.rank())}
\DoxyCodeLine{143                 \{}
\DoxyCodeLine{144                     \textcolor{comment}{//update ffsconfigid's l,n,a}}
\DoxyCodeLine{145                     l = 0; \textcolor{comment}{//only fail at lambda 0, }}
\DoxyCodeLine{146                     n = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a4e11c0ee989ab0a7f89ecaa8cb1b50af}{\_nfailure\_total}} + fail\_count;}
\DoxyCodeLine{147                     a = 0;}
\DoxyCodeLine{148                     FFSConfigID newid = FFSConfigID(l,n,a,lprev,nprev,aprev);}
\DoxyCodeLine{149                     \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a8f3da6706283040f7adf33399bdb2376}{WriteFFSConfiguration}}(snapshot,newid,0);}
\DoxyCodeLine{150                 \}}
\DoxyCodeLine{151                 fail\_count++;}
\DoxyCodeLine{152             \}}
\DoxyCodeLine{153         \}}
\DoxyCodeLine{154 }
\DoxyCodeLine{155         \textcolor{comment}{//update trajectories}}
\DoxyCodeLine{156         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a737e0bfd8bf851bc3423b7178862c2dc}{\_saveTrajectories}})}
\DoxyCodeLine{157         \{}
\DoxyCodeLine{158             \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a24bce6318d9821293945a32620ffc7b6}{\_pop\_tried\_but\_empty\_queue}}) \textcolor{comment}{//dont update trajectory if zombie job}}
\DoxyCodeLine{159                 \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a28017e532afacbc0c2bee398a5aeabd1}{AppendTrajectoryFile}}(snapshot,\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a9869778ef4203d8383ff970a9373c68f}{\_trajectory\_file}});}
\DoxyCodeLine{160             \textcolor{keywordflow}{if} (success\_local || fail\_local) \textcolor{comment}{//if finished then close it}}
\DoxyCodeLine{161                 \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a9869778ef4203d8383ff970a9373c68f}{\_trajectory\_file}}.close();}
\DoxyCodeLine{162         \}}
\DoxyCodeLine{163         }
\DoxyCodeLine{164         \textcolor{comment}{//update the number of successes and attempts, same for all proc since Allgathered 'successes' and 'failures'}}
\DoxyCodeLine{165         \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ab306e381420317cb8b25ce506e2564a0}{\_S}}[\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}] += success\_count;}
\DoxyCodeLine{166         \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_afed0593963a178677403c88acd2afb66}{\_A}}[\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}] += success\_count + fail\_count;}
\DoxyCodeLine{167         \textcolor{comment}{// \string^ I dont like storing attempts this way (as is its only when they finish). \_A should also include jobs in progress (i.e. jobs currently running). THINK ABOUT THIS!.}}
\DoxyCodeLine{168         \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a4e11c0ee989ab0a7f89ecaa8cb1b50af}{\_nfailure\_total}} += fail\_count;}
\DoxyCodeLine{169 }
\DoxyCodeLine{170         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{171         \textcolor{comment}{//print info}}
\DoxyCodeLine{172         \textcolor{keywordflow}{if} ((success\_local) || (fail\_local))}
\DoxyCodeLine{173         \{}
\DoxyCodeLine{174             std::cout << \textcolor{stringliteral}{"Iteration: "}<< \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5ae20c5bdab1ddf824a744e6faf4cbea}{iteration\_}} << \textcolor{stringliteral}{", proc "} << \mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}}.rank() << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{175             \textcolor{keywordflow}{if} (success\_local)}
\DoxyCodeLine{176             \{}
\DoxyCodeLine{177                 std::cout << \textcolor{stringliteral}{"Successful attempt from interface "} << \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}} }
\DoxyCodeLine{178                         << \textcolor{stringliteral}{" l"}<<\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}{myFFSConfigID}}.\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID_afe91617771b2c2e7c2fee6976e0c6be4}{l}}<<\textcolor{stringliteral}{"-\/n"}<<\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}{myFFSConfigID}}.\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID_abdf33a2779455d7ab7cffbe791145739}{n}}<<\textcolor{stringliteral}{"-\/a"}<<\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}{myFFSConfigID}}.\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID_ab05bd46242e1c1b8d82428562467d68e}{a}}}
\DoxyCodeLine{179                         << \textcolor{stringliteral}{" (cvvalue\_previous: "} << \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a3dafbb3b76d1de95fcf94538c6d7edcb}{\_cvvalue\_previous}} << \textcolor{stringliteral}{" cvvalue "} << \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac40d1ade8599276bf048d7ff693cfbcf}{\_cvvalue}} << \textcolor{stringliteral}{" interface["}<<\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}+1<<\textcolor{stringliteral}{"] = "} << \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5104c9611f7eda4e7c8ec013de246a1a}{\_interfaces}}[\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}+1] << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{180             \}}
\DoxyCodeLine{181             \textcolor{keywordflow}{if} (fail\_local)}
\DoxyCodeLine{182             \{}
\DoxyCodeLine{183                 std::cout << \textcolor{stringliteral}{"Failed attempt from interface "} << \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}} }
\DoxyCodeLine{184                         << \textcolor{stringliteral}{" l"}<<\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}{myFFSConfigID}}.\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID_afe91617771b2c2e7c2fee6976e0c6be4}{l}}<<\textcolor{stringliteral}{"-\/n"}<<\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}{myFFSConfigID}}.\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID_abdf33a2779455d7ab7cffbe791145739}{n}}<<\textcolor{stringliteral}{"-\/a"}<<\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}{myFFSConfigID}}.\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID_ab05bd46242e1c1b8d82428562467d68e}{a}}}
\DoxyCodeLine{185                         << \textcolor{stringliteral}{" (cvvalue\_previous: "} << \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a3dafbb3b76d1de95fcf94538c6d7edcb}{\_cvvalue\_previous}} << \textcolor{stringliteral}{" cvvalue "} << \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac40d1ade8599276bf048d7ff693cfbcf}{\_cvvalue}} << \textcolor{stringliteral}{" interface[0] = "}<< \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5104c9611f7eda4e7c8ec013de246a1a}{\_interfaces}}[0] << \textcolor{stringliteral}{"\(\backslash\)n"}}
\DoxyCodeLine{186                         << \textcolor{stringliteral}{"nfailuretotal: "} << \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a4e11c0ee989ab0a7f89ecaa8cb1b50af}{\_nfailure\_total}} << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{187             \}}
\DoxyCodeLine{188             }
\DoxyCodeLine{189             std::cout << \textcolor{stringliteral}{"A: "};}
\DoxyCodeLine{190             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} a : \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_afed0593963a178677403c88acd2afb66}{\_A}})}
\DoxyCodeLine{191                 std::cout << a << \textcolor{stringliteral}{" "}; }
\DoxyCodeLine{192             std::cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{193 }
\DoxyCodeLine{194             std::cout << \textcolor{stringliteral}{"S: "};}
\DoxyCodeLine{195             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} s : \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ab306e381420317cb8b25ce506e2564a0}{\_S}})}
\DoxyCodeLine{196                 std::cout << s << \textcolor{stringliteral}{" "};}
\DoxyCodeLine{197             std::cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{198             }
\DoxyCodeLine{199             std::cout << \textcolor{stringliteral}{"M: "};}
\DoxyCodeLine{200             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} m : \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5f0d531dfdc3347990b2c645af61b15f}{\_M}})}
\DoxyCodeLine{201                 std::cout << m << \textcolor{stringliteral}{" "};}
\DoxyCodeLine{202             std::cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{203         \}}
\DoxyCodeLine{204         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{205        }
\DoxyCodeLine{206         \textcolor{comment}{//create new funciton here? (call it SetupNextInterface()}}
\DoxyCodeLine{207         \textcolor{comment}{// Check if this interface is finished, if so add new tasks to queue, and increment \_current\_interface}}
\DoxyCodeLine{208         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_afed0593963a178677403c88acd2afb66}{\_A}}[\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}] >= \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5f0d531dfdc3347990b2c645af61b15f}{\_M}}[\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}])}
\DoxyCodeLine{209         \{}
\DoxyCodeLine{210             \textcolor{comment}{//set N and P}}
\DoxyCodeLine{211             \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a87bd6d104bc29a6d11b61a09a9a152f9}{\_N}}[\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}+1] = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ab306e381420317cb8b25ce506e2564a0}{\_S}}[\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}];}
\DoxyCodeLine{212             \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_aba89ee2a376c8b46e17d83e6dd6b9255}{\_P}}[\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}] = (double) \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ab306e381420317cb8b25ce506e2564a0}{\_S}}[\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}] / \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_afed0593963a178677403c88acd2afb66}{\_A}}[\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}];}
\DoxyCodeLine{213 }
\DoxyCodeLine{214             \textcolor{keywordflow}{if} (\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}+2 < \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a0c80fe955a8b1cb8dacca0d1a3c9f2dd}{\_ninterfaces}})}
\DoxyCodeLine{215             \{}
\DoxyCodeLine{216                 \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}} += 1;}
\DoxyCodeLine{217                 \textcolor{comment}{//\_N[\_current\_interface] = \_S[\_current\_interface-\/1];}}
\DoxyCodeLine{218 }
\DoxyCodeLine{219                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a87bd6d104bc29a6d11b61a09a9a152f9}{\_N}}[\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}] == 0)}
\DoxyCodeLine{220                 \{}
\DoxyCodeLine{221                     std::cerr << \textcolor{stringliteral}{"Error! No successes from interface "} << \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}-\/1 << \textcolor{stringliteral}{" to "} << \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}} <<\textcolor{stringliteral}{"! Try turning up M["}<<\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}-\/1<<\textcolor{stringliteral}{"] or spacing interfaces closer together.\(\backslash\)n"};}
\DoxyCodeLine{222                     MPI\_Abort(\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}}, EXIT\_FAILURE);}
\DoxyCodeLine{223                 \}}
\DoxyCodeLine{224 }
\DoxyCodeLine{225                 \textcolor{comment}{//for DFFS}}
\DoxyCodeLine{226                 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} npicks = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5f0d531dfdc3347990b2c645af61b15f}{\_M}}[\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}];}
\DoxyCodeLine{227                 std::vector<unsigned int> picks;}
\DoxyCodeLine{228                 picks.resize(npicks);}
\DoxyCodeLine{229                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{classSSAGES_1_1EventListener_af9666daacfb047c1dd279ea339524d07}{IsMasterRank}}(\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}}))}
\DoxyCodeLine{230                 \{}
\DoxyCodeLine{231                     std::uniform\_int\_distribution<int> distribution(0,\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a87bd6d104bc29a6d11b61a09a9a152f9}{\_N}}[\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}]-\/1);}
\DoxyCodeLine{232                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i=0; i < npicks ; i++)}
\DoxyCodeLine{233                         picks[i] = distribution(\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac19692d0a59c4375fe84698783baaee2}{\_generator}});}
\DoxyCodeLine{234                 \}}
\DoxyCodeLine{235                 MPI\_Bcast(picks.data(),npicks,MPI\_UNSIGNED,0,\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}});}
\DoxyCodeLine{236 }
\DoxyCodeLine{237                 \textcolor{comment}{//each proc adds to the queue}}
\DoxyCodeLine{238                 \textcolor{comment}{//set correct attempt index if a given ID is picked twice}}
\DoxyCodeLine{239                 std::vector<unsigned int> attempt\_count;}
\DoxyCodeLine{240                 attempt\_count.resize(\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a87bd6d104bc29a6d11b61a09a9a152f9}{\_N}}[\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}}],0);}
\DoxyCodeLine{241 }
\DoxyCodeLine{242                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i=0; i < npicks ; i++)}
\DoxyCodeLine{243                 \{}
\DoxyCodeLine{244                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} mypick = picks[i];}
\DoxyCodeLine{245                     \textcolor{keywordtype}{int} l,n,a,lprev,nprev,aprev;}
\DoxyCodeLine{246                     lprev = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}{myFFSConfigID}}.\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID_afe91617771b2c2e7c2fee6976e0c6be4}{l}};}
\DoxyCodeLine{247                     nprev = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}{myFFSConfigID}}.\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID_abdf33a2779455d7ab7cffbe791145739}{n}};}
\DoxyCodeLine{248                     aprev = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a6c49c23271152837a76a8de904eaa1b0}{myFFSConfigID}}.\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_1_1FFSConfigID_ab05bd46242e1c1b8d82428562467d68e}{a}};}
\DoxyCodeLine{249                     \textcolor{comment}{//update ffsconfigid's l,n,a}}
\DoxyCodeLine{250                     l = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac30a33dac5344d881339bbcc0d26de0d}{\_current\_interface}};}
\DoxyCodeLine{251                     n = mypick;}
\DoxyCodeLine{252                     a = attempt\_count[mypick]; }
\DoxyCodeLine{253                     attempt\_count[mypick]++; \textcolor{comment}{//this updates attempt number if same config is picked twice}}
\DoxyCodeLine{254 }
\DoxyCodeLine{255                     \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_aca7da062aee9a5e3a1e8a173d50447a7}{FFSConfigIDQueue}}.emplace\_back(l,n,a,lprev,nprev,aprev);}
\DoxyCodeLine{256                 \}}
\DoxyCodeLine{257             \}}
\DoxyCodeLine{258             \textcolor{keywordflow}{else}}
\DoxyCodeLine{259             \{}
\DoxyCodeLine{260                 std::cout << \textcolor{stringliteral}{"DFFS should be finished here, do something special? like exit?\(\backslash\)n"};}
\DoxyCodeLine{261                 \textcolor{comment}{//Hythem said this is "acceptable" until the code is changed}}
\DoxyCodeLine{262                 \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a36b935ebdb93f80be3cd8f43684662f1}{PostSimulation}}(snapshot, cvmanager);}
\DoxyCodeLine{263             \}}
\DoxyCodeLine{264         \}}
\DoxyCodeLine{265 }
\DoxyCodeLine{266         \textcolor{comment}{// if succeeded or failed (or zombie job), get a new config from the queue...but need to be careful that no two procs get the same config}}
\DoxyCodeLine{267 }
\DoxyCodeLine{268         \textcolor{comment}{// Need to account for zombie jobs that are waiting for a new config}}
\DoxyCodeLine{269         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} shouldpop\_local = \textcolor{keyword}{false};        }
\DoxyCodeLine{270         std::vector<unsigned int> shouldpop(\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}}.size(),0);}
\DoxyCodeLine{271 }
\DoxyCodeLine{272         \textcolor{keywordflow}{if} (success\_local || fail\_local || \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a24bce6318d9821293945a32620ffc7b6}{\_pop\_tried\_but\_empty\_queue}})}
\DoxyCodeLine{273           shouldpop\_local = \textcolor{keyword}{true};}
\DoxyCodeLine{274         }
\DoxyCodeLine{275         \textcolor{comment}{//Pop the queue}}
\DoxyCodeLine{276         \textcolor{comment}{// Need to perform mpi call so that all proc pop the queue in the same way}}
\DoxyCodeLine{277         \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac5227afa53bf05d387b480850ef4bb77}{PopQueueMPI}}(snapshot,cvs, shouldpop\_local);}
\DoxyCodeLine{278                 }
\DoxyCodeLine{279         \textcolor{comment}{//Anything else to update across mpi?}}
\DoxyCodeLine{280         \textcolor{comment}{//clean up}}
\DoxyCodeLine{281         \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a3dafbb3b76d1de95fcf94538c6d7edcb}{\_cvvalue\_previous}} = \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ac40d1ade8599276bf048d7ff693cfbcf}{\_cvvalue}};}
\DoxyCodeLine{282         \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5ae20c5bdab1ddf824a744e6faf4cbea}{iteration\_}}++;}
\DoxyCodeLine{283     \}}

\end{DoxyCode}


References S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+A, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+current\+\_\+interface, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+cvvalue, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+cvvalue\+\_\+previous, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+generator, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+interfaces, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+M, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+N, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+nfailure\+\_\+total, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+ninterfaces, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+P, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+pop\+\_\+tried\+\_\+but\+\_\+empty\+\_\+queue, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+S, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+save\+Trajectories, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+trajectory\+\_\+file, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+F\+F\+S\+Config\+I\+D\+::a, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Append\+Trajectory\+File(), S\+S\+A\+G\+E\+S\+::\+Method\+::cvmask\+\_\+, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+F\+F\+S\+Config\+I\+D\+Queue, S\+S\+A\+G\+E\+S\+::\+C\+V\+Manager\+::\+Get\+C\+Vs(), S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Has\+Crossed\+Interface(), S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Has\+Returned\+To\+A(), S\+S\+A\+G\+E\+S\+::\+Event\+Listener\+::\+Is\+Master\+Rank(), S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::iteration\+\_\+, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+F\+F\+S\+Config\+I\+D\+::l, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::my\+F\+F\+S\+Config\+ID, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+F\+F\+S\+Config\+I\+D\+::n, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Pop\+Queue\+M\+P\+I(), S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Post\+Simulation(), S\+S\+A\+G\+E\+S\+::\+Method\+::world\+\_\+, and S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Write\+F\+F\+S\+Configuration().



Referenced by Post\+Integration().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1DirectForwardFlux_a2be13ab9b33d4cb90aa22ca9d71077e9_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1DirectForwardFlux_a2be13ab9b33d4cb90aa22ca9d71077e9_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1DirectForwardFlux_a5491cd537f737524f5fc295236eefb85}\label{classSSAGES_1_1DirectForwardFlux_a5491cd537f737524f5fc295236eefb85}} 
\index{SSAGES::DirectForwardFlux@{SSAGES::DirectForwardFlux}!PostIntegration@{PostIntegration}}
\index{PostIntegration@{PostIntegration}!SSAGES::DirectForwardFlux@{SSAGES::DirectForwardFlux}}
\doxysubsubsection{\texorpdfstring{PostIntegration()}{PostIntegration()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+Direct\+Forward\+Flux\+::\+Post\+Integration (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$}]{snapshot,  }\item[{const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&}]{cvmanager }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Post-\/integration hook. 


\begin{DoxyParams}{Parameters}
{\em snapshot} & Current simulation snapshot. \\
\hline
{\em cvmanager} & Collective variable manager. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_ad001fc1bc419967f3c9679cac04820f2}{S\+S\+A\+G\+E\+S\+::\+Forward\+Flux}}.



Definition at line 32 of file Direct\+Forward\+Flux.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{33     \{}
\DoxyCodeLine{34         \textcolor{comment}{//check if we want to check FFS interfaces this timestep}}
\DoxyCodeLine{35         \textcolor{comment}{//for now, do it every time step}}
\DoxyCodeLine{36         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5ae20c5bdab1ddf824a744e6faf4cbea}{iteration\_}} \% 1 != 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{37         }
\DoxyCodeLine{38         \textcolor{keyword}{auto} cvs = cvmanager.GetCVs(\mbox{\hyperlink{classSSAGES_1_1Method_a24b0ac53b1fabcab0a5f3bd6cde26909}{cvmask\_}});}
\DoxyCodeLine{39         \textcolor{comment}{// check the structure at the beginning of the simulation}}
\DoxyCodeLine{40         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a5ae20c5bdab1ddf824a744e6faf4cbea}{iteration\_}} == 0)}
\DoxyCodeLine{41             \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_aa0c07d4738ea73ed1d3589c3eb42c258}{CheckInitialStructure}}(cvs);}
\DoxyCodeLine{42 }
\DoxyCodeLine{43         \textcolor{comment}{// if \_computefluxA0}}
\DoxyCodeLine{44         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a868a0b2256841b47073b0db6f8ab265b}{\_initialFluxFlag}})}
\DoxyCodeLine{45         \{}
\DoxyCodeLine{46             \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a7406bdfbded69fca48c675d69949626d}{ComputeInitialFlux}}(snapshot,cvs); }
\DoxyCodeLine{47             \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a868a0b2256841b47073b0db6f8ab265b}{\_initialFluxFlag}})}
\DoxyCodeLine{48             \{ \textcolor{comment}{//only enter here once}}
\DoxyCodeLine{49                 \mbox{\hyperlink{classSSAGES_1_1DirectForwardFlux_af14a27e7176c4cd6fca5479dfef17358}{InitializeQueue}}(snapshot,cvs);}
\DoxyCodeLine{50                 \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a7f814e3f300b0567e8b134364f882d58}{PrintQueue}}();}
\DoxyCodeLine{51             \}}
\DoxyCodeLine{52         \}}
\DoxyCodeLine{53         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{classSSAGES_1_1ForwardFlux_abaa1b2c8e2bfb290ad526d8c15ea7634}{initializeQueueFlag}})}
\DoxyCodeLine{54         \{}
\DoxyCodeLine{55             \mbox{\hyperlink{classSSAGES_1_1DirectForwardFlux_af14a27e7176c4cd6fca5479dfef17358}{InitializeQueue}}(snapshot,cvs);}
\DoxyCodeLine{56             \mbox{\hyperlink{classSSAGES_1_1ForwardFlux_a7f814e3f300b0567e8b134364f882d58}{PrintQueue}}();}
\DoxyCodeLine{57         \}}
\DoxyCodeLine{58         \textcolor{comment}{// Else check the FFS interfaces}}
\DoxyCodeLine{59         \textcolor{keywordflow}{else}}
\DoxyCodeLine{60         \{}
\DoxyCodeLine{61             \mbox{\hyperlink{classSSAGES_1_1DirectForwardFlux_a2be13ab9b33d4cb90aa22ca9d71077e9}{CheckForInterfaceCrossings}}(snapshot, cvmanager);}
\DoxyCodeLine{62             \textcolor{comment}{//FluxBruteForce(snapshot,cvs);}}
\DoxyCodeLine{63         \}}
\DoxyCodeLine{64         \textcolor{comment}{// Other modes?}}
\DoxyCodeLine{65     \}}

\end{DoxyCode}


References S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+\_\+initial\+Flux\+Flag, Check\+For\+Interface\+Crossings(), S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Check\+Initial\+Structure(), S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Compute\+Initial\+Flux(), S\+S\+A\+G\+E\+S\+::\+Method\+::cvmask\+\_\+, S\+S\+A\+G\+E\+S\+::\+C\+V\+Manager\+::\+Get\+C\+Vs(), Initialize\+Queue(), S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::initialize\+Queue\+Flag, S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::iteration\+\_\+, and S\+S\+A\+G\+E\+S\+::\+Forward\+Flux\+::\+Print\+Queue().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1DirectForwardFlux_a5491cd537f737524f5fc295236eefb85_cgraph}
\end{center}
\end{figure}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/michael/development/\+S\+S\+A\+G\+E\+S/src/\+Methods/Direct\+Forward\+Flux.\+h\item 
/home/michael/development/\+S\+S\+A\+G\+E\+S/src/\+Methods/Direct\+Forward\+Flux.\+cpp\end{DoxyCompactItemize}
