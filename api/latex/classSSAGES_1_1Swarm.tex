\hypertarget{classSSAGES_1_1Swarm}{}\doxysection{S\+S\+A\+G\+ES\+::Swarm Class Reference}
\label{classSSAGES_1_1Swarm}\index{SSAGES::Swarm@{SSAGES::Swarm}}


\mbox{\hyperlink{classSSAGES_1_1Swarm}{Swarm}} of Trajectories String \mbox{\hyperlink{classSSAGES_1_1Method}{Method}}.  




{\ttfamily \#include $<$Swarm.\+h$>$}



Inheritance diagram for S\+S\+A\+G\+ES\+::Swarm\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=204pt]{classSSAGES_1_1Swarm__inherit__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classSSAGES_1_1Swarm_a775304060a72dcae60bdd5718a485976}{Swarm}} (const M\+P\+I\+\_\+\+Comm \&world, const M\+P\+I\+\_\+\+Comm \&comm, const std\+::vector$<$ double $>$ \&centers, unsigned int maxiterations, const std\+::vector$<$ double $>$ cvspring, unsigned int frequency, unsigned int Initial\+Steps, unsigned int Harvest\+Length, unsigned int Number\+Trajectories, unsigned int Swarm\+Length)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1Swarm_aae8fbacf2c51b84a5a333387116dda0d}{Post\+Integration}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$snapshot, const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&cvmanager) override
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{classSSAGES_1_1Method}{Method}} call post integration. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1Swarm_aed3d57b4ac6fc9f484dcb2ebc4a0aa47}\label{classSSAGES_1_1Swarm_aed3d57b4ac6fc9f484dcb2ebc4a0aa47}} 
\mbox{\hyperlink{classSSAGES_1_1Swarm_aed3d57b4ac6fc9f484dcb2ebc4a0aa47}{$\sim$\+Swarm}} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classSSAGES_1_1Swarm_a0ee007f404408c59c7217cd8fb6b7c1c}\label{classSSAGES_1_1Swarm_a0ee007f404408c59c7217cd8fb6b7c1c}} 
void \mbox{\hyperlink{classSSAGES_1_1Swarm_a0ee007f404408c59c7217cd8fb6b7c1c}{String\+Update}} () override
\begin{DoxyCompactList}\small\item\em Updates the positions of the string. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classSSAGES_1_1Swarm_a6e23dbcbe88170778a7c6788474e45ab}{C\+V\+Initialized}} (const \mbox{\hyperlink{namespaceSSAGES_acddea47426ac0a643b048f870ddd2907}{C\+V\+List}} \&cvs)
\begin{DoxyCompactList}\small\item\em Helper function check if C\+Vs are initialized correctly. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classSSAGES_1_1Swarm_af28af23d7954d79b7c8820763315ca7e}\label{classSSAGES_1_1Swarm_af28af23d7954d79b7c8820763315ca7e}} 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classSSAGES_1_1Swarm_af28af23d7954d79b7c8820763315ca7e}{cv\+\_\+drift\+\_\+}}
\begin{DoxyCompactList}\small\item\em Drift of C\+Vs for one iteration. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1Swarm_affe9f14ebc64f8e6a153bfa4d72f9f55}\label{classSSAGES_1_1Swarm_affe9f14ebc64f8e6a153bfa4d72f9f55}} 
unsigned int \mbox{\hyperlink{classSSAGES_1_1Swarm_affe9f14ebc64f8e6a153bfa4d72f9f55}{initialize\+\_\+steps\+\_\+}}
\begin{DoxyCompactList}\small\item\em Total number of MD steps for initialization for one iteration. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1Swarm_a0c1f8ecda790d89724a4ca49467ea6d7}\label{classSSAGES_1_1Swarm_a0c1f8ecda790d89724a4ca49467ea6d7}} 
unsigned int \mbox{\hyperlink{classSSAGES_1_1Swarm_a0c1f8ecda790d89724a4ca49467ea6d7}{harvest\+\_\+length\+\_\+}}
\begin{DoxyCompactList}\small\item\em Length to run before harvesting a trajectory for unrestrained sampling. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1Swarm_a4ae35c195e1dd5f1bc07c6dcf2c65857}\label{classSSAGES_1_1Swarm_a4ae35c195e1dd5f1bc07c6dcf2c65857}} 
unsigned int \mbox{\hyperlink{classSSAGES_1_1Swarm_a4ae35c195e1dd5f1bc07c6dcf2c65857}{restrained\+\_\+steps\+\_\+}}
\begin{DoxyCompactList}\small\item\em Total number of restrained MD steps for one iteration. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1Swarm_ab812af26dec6866acaa7468d76be977a}\label{classSSAGES_1_1Swarm_ab812af26dec6866acaa7468d76be977a}} 
unsigned int \mbox{\hyperlink{classSSAGES_1_1Swarm_ab812af26dec6866acaa7468d76be977a}{number\+\_\+trajectories\+\_\+}}
\begin{DoxyCompactList}\small\item\em Number of trajectories per swarm. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1Swarm_a151b6b95dc5795326d90e09122741752}\label{classSSAGES_1_1Swarm_a151b6b95dc5795326d90e09122741752}} 
unsigned int \mbox{\hyperlink{classSSAGES_1_1Swarm_a151b6b95dc5795326d90e09122741752}{swarm\+\_\+length\+\_\+}}
\begin{DoxyCompactList}\small\item\em Length of unrestrained trajectories. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1Swarm_a87d05b081f563d506ced1ad7779b5194}\label{classSSAGES_1_1Swarm_a87d05b081f563d506ced1ad7779b5194}} 
unsigned int \mbox{\hyperlink{classSSAGES_1_1Swarm_a87d05b081f563d506ced1ad7779b5194}{unrestrained\+\_\+steps\+\_\+}}
\begin{DoxyCompactList}\small\item\em Total number of unrestrained MD steps for one iteration. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}\label{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}} 
unsigned int \mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\+\_\+}}
\begin{DoxyCompactList}\small\item\em For indexing trajectory vectors. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1Swarm_a493fbfab21ec8ef48ba261ee701b3781}\label{classSSAGES_1_1Swarm_a493fbfab21ec8ef48ba261ee701b3781}} 
std\+::vector$<$ \mbox{\hyperlink{namespaceSSAGES_afbb26053e292f94ea83b1c441ce6df74}{Label}} $>$ \mbox{\hyperlink{classSSAGES_1_1Swarm_a493fbfab21ec8ef48ba261ee701b3781}{traj\+\_\+atomids\+\_\+}}
\begin{DoxyCompactList}\small\item\em Store atom I\+Ds for starting trajecotires. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1Swarm_a32ae88031572228e2346080b85462667}\label{classSSAGES_1_1Swarm_a32ae88031572228e2346080b85462667}} 
bool \mbox{\hyperlink{classSSAGES_1_1Swarm_a32ae88031572228e2346080b85462667}{sampling\+\_\+started}}
\begin{DoxyCompactList}\small\item\em Flag for determing whether to perform initialization or not. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1Swarm_aa3e1dbbf5f37d6a3d90b9939be9629af}\label{classSSAGES_1_1Swarm_aa3e1dbbf5f37d6a3d90b9939be9629af}} 
bool \mbox{\hyperlink{classSSAGES_1_1Swarm_aa3e1dbbf5f37d6a3d90b9939be9629af}{snapshot\+\_\+stored}}
\begin{DoxyCompactList}\small\item\em Flag for whether a snapshot was stored in the umbrella sampling. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1Swarm_a3dd72ab1119f41d6f83e70ba2b9d47a3}\label{classSSAGES_1_1Swarm_a3dd72ab1119f41d6f83e70ba2b9d47a3}} 
int \mbox{\hyperlink{classSSAGES_1_1Swarm_a3dd72ab1119f41d6f83e70ba2b9d47a3}{initialized}}
\begin{DoxyCompactList}\small\item\em Flag for whether a system is initialized at a given iteration. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1Swarm_a65b8782f926da3c5dfc4ae4c45523ce1}\label{classSSAGES_1_1Swarm_a65b8782f926da3c5dfc4ae4c45523ce1}} 
bool \mbox{\hyperlink{classSSAGES_1_1Swarm_a65b8782f926da3c5dfc4ae4c45523ce1}{original\+\_\+initialized}}
\begin{DoxyCompactList}\small\item\em Flag for whether a system was initialized before it checked whether other systems were. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
\mbox{\hyperlink{classSSAGES_1_1Swarm}{Swarm}} of Trajectories String \mbox{\hyperlink{classSSAGES_1_1Method}{Method}}. 

Implementation of the swarm of trajectories string method. 

Definition at line 32 of file Swarm.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classSSAGES_1_1Swarm_a775304060a72dcae60bdd5718a485976}\label{classSSAGES_1_1Swarm_a775304060a72dcae60bdd5718a485976}} 
\index{SSAGES::Swarm@{SSAGES::Swarm}!Swarm@{Swarm}}
\index{Swarm@{Swarm}!SSAGES::Swarm@{SSAGES::Swarm}}
\doxysubsubsection{\texorpdfstring{Swarm()}{Swarm()}}
{\footnotesize\ttfamily S\+S\+A\+G\+E\+S\+::\+Swarm\+::\+Swarm (\begin{DoxyParamCaption}\item[{const M\+P\+I\+\_\+\+Comm \&}]{world,  }\item[{const M\+P\+I\+\_\+\+Comm \&}]{comm,  }\item[{const std\+::vector$<$ double $>$ \&}]{centers,  }\item[{unsigned int}]{maxiterations,  }\item[{const std\+::vector$<$ double $>$}]{cvspring,  }\item[{unsigned int}]{frequency,  }\item[{unsigned int}]{Initial\+Steps,  }\item[{unsigned int}]{Harvest\+Length,  }\item[{unsigned int}]{Number\+Trajectories,  }\item[{unsigned int}]{Swarm\+Length }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em world} & M\+PI global communicator. \\
\hline
{\em comm} & M\+PI local communicator. \\
\hline
{\em centers} & List of centers. \\
\hline
{\em maxiterations} & Maximum number of iterations. \\
\hline
{\em cvspring} & Spring constants for C\+Vs. \\
\hline
{\em frequency} & Aplly method with this frequency. \\
\hline
{\em Initial\+Steps} & Number of initial steps. \\
\hline
{\em Harvest\+Length} & Length of trajectory before weighing. \\
\hline
{\em Number\+Trajectories} & Number of trajectories. \\
\hline
{\em Swarm\+Length} & Lengt of the swarms.\\
\hline
\end{DoxyParams}
Constructs an instance of the swarm of trajectories method. 

Definition at line 103 of file Swarm.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{112                                             : }
\DoxyCodeLine{113             \mbox{\hyperlink{classSSAGES_1_1StringMethod_a52e179be14386a48b0d6e84e1f100fb7}{StringMethod}}(world, comm, centers, maxiterations, cvspring, frequency),                 }
\DoxyCodeLine{114             \mbox{\hyperlink{classSSAGES_1_1Swarm_af28af23d7954d79b7c8820763315ca7e}{cv\_drift\_}}(), }
\DoxyCodeLine{115             \mbox{\hyperlink{classSSAGES_1_1Swarm_affe9f14ebc64f8e6a153bfa4d72f9f55}{initialize\_steps\_}}(InitialSteps), }
\DoxyCodeLine{116             \mbox{\hyperlink{classSSAGES_1_1Swarm_a0c1f8ecda790d89724a4ca49467ea6d7}{harvest\_length\_}}(HarvestLength), }
\DoxyCodeLine{117             \mbox{\hyperlink{classSSAGES_1_1Swarm_ab812af26dec6866acaa7468d76be977a}{number\_trajectories\_}}(NumberTrajectories), }
\DoxyCodeLine{118             \mbox{\hyperlink{classSSAGES_1_1Swarm_a151b6b95dc5795326d90e09122741752}{swarm\_length\_}}(SwarmLength)}
\DoxyCodeLine{119             \{}
\DoxyCodeLine{120                 \mbox{\hyperlink{classSSAGES_1_1Swarm_af28af23d7954d79b7c8820763315ca7e}{cv\_drift\_}}.resize(\mbox{\hyperlink{classSSAGES_1_1StringMethod_a8f5e8ddc90a86dc363d3323c31f8e3b7}{centers\_}}.size(), 0);}
\DoxyCodeLine{121                 \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad0f30a4bda9ab52fbf1a2fd6d82898e6}{prev\_positions\_}}.resize(\mbox{\hyperlink{classSSAGES_1_1Swarm_ab812af26dec6866acaa7468d76be977a}{number\_trajectories\_}});}
\DoxyCodeLine{122                 \mbox{\hyperlink{classSSAGES_1_1StringMethod_a882f74a324641a449216d0edbc5fdb5d}{prev\_velocities\_}}.resize(\mbox{\hyperlink{classSSAGES_1_1Swarm_ab812af26dec6866acaa7468d76be977a}{number\_trajectories\_}});}
\DoxyCodeLine{123                 \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad3ff83869b7ef597d3641f0eb1649c82}{prev\_IDs\_}}.resize(\mbox{\hyperlink{classSSAGES_1_1Swarm_ab812af26dec6866acaa7468d76be977a}{number\_trajectories\_}});}
\DoxyCodeLine{124                 \textcolor{comment}{//Additional initializing}}
\DoxyCodeLine{125 }
\DoxyCodeLine{126                 \mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}} = 0;  }
\DoxyCodeLine{127                 \mbox{\hyperlink{classSSAGES_1_1Swarm_a4ae35c195e1dd5f1bc07c6dcf2c65857}{restrained\_steps\_}} = \mbox{\hyperlink{classSSAGES_1_1Swarm_a0c1f8ecda790d89724a4ca49467ea6d7}{harvest\_length\_}}*\mbox{\hyperlink{classSSAGES_1_1Swarm_ab812af26dec6866acaa7468d76be977a}{number\_trajectories\_}}; }
\DoxyCodeLine{128                 \mbox{\hyperlink{classSSAGES_1_1Swarm_a87d05b081f563d506ced1ad7779b5194}{unrestrained\_steps\_}} = \mbox{\hyperlink{classSSAGES_1_1Swarm_a151b6b95dc5795326d90e09122741752}{swarm\_length\_}}*\mbox{\hyperlink{classSSAGES_1_1Swarm_ab812af26dec6866acaa7468d76be977a}{number\_trajectories\_}};}
\DoxyCodeLine{129                 \mbox{\hyperlink{classSSAGES_1_1Swarm_a32ae88031572228e2346080b85462667}{sampling\_started}} = \textcolor{keyword}{false};}
\DoxyCodeLine{130                 \mbox{\hyperlink{classSSAGES_1_1Swarm_aa3e1dbbf5f37d6a3d90b9939be9629af}{snapshot\_stored}} = \textcolor{keyword}{false};}
\DoxyCodeLine{131 }
\DoxyCodeLine{132                 \mbox{\hyperlink{classSSAGES_1_1StringMethod_ae1214f174d34de4481f639f7aab4b8c5}{iterator\_}} = 0; \textcolor{comment}{//Override default StringMethod.h initializing}}
\DoxyCodeLine{133             \}}

\end{DoxyCode}


References S\+S\+A\+G\+E\+S\+::\+String\+Method\+::centers\+\_\+, cv\+\_\+drift\+\_\+, harvest\+\_\+length\+\_\+, index\+\_\+, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::iterator\+\_\+, number\+\_\+trajectories\+\_\+, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::prev\+\_\+\+I\+Ds\+\_\+, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::prev\+\_\+positions\+\_\+, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::prev\+\_\+velocities\+\_\+, restrained\+\_\+steps\+\_\+, sampling\+\_\+started, snapshot\+\_\+stored, swarm\+\_\+length\+\_\+, and unrestrained\+\_\+steps\+\_\+.



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classSSAGES_1_1Swarm_a6e23dbcbe88170778a7c6788474e45ab}\label{classSSAGES_1_1Swarm_a6e23dbcbe88170778a7c6788474e45ab}} 
\index{SSAGES::Swarm@{SSAGES::Swarm}!CVInitialized@{CVInitialized}}
\index{CVInitialized@{CVInitialized}!SSAGES::Swarm@{SSAGES::Swarm}}
\doxysubsubsection{\texorpdfstring{CVInitialized()}{CVInitialized()}}
{\footnotesize\ttfamily bool S\+S\+A\+G\+E\+S\+::\+Swarm\+::\+C\+V\+Initialized (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{namespaceSSAGES_acddea47426ac0a643b048f870ddd2907}{C\+V\+List}} \&}]{cvs }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Helper function check if C\+Vs are initialized correctly. 


\begin{DoxyParams}{Parameters}
{\em cvs} & List of C\+Vs to check\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Boolean if C\+Vs are initialized correctly 
\end{DoxyReturn}


Definition at line 35 of file Swarm.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{36     \{}
\DoxyCodeLine{37         \textcolor{keywordtype}{double} threshold = 0.2;}
\DoxyCodeLine{38         \textcolor{keyword}{const} \textcolor{keywordtype}{double} eps = 0.0000000001;}
\DoxyCodeLine{39         \textcolor{keywordtype}{double} diff;}
\DoxyCodeLine{40 }
\DoxyCodeLine{41         \textcolor{comment}{//On the first iteration, check that the CVs are within (threshold*100)\% of the center value they're associated to}}
\DoxyCodeLine{42         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < cvs.size(); i++)}
\DoxyCodeLine{43         \{}
\DoxyCodeLine{44             \textcolor{keywordflow}{if}(std::abs(\mbox{\hyperlink{classSSAGES_1_1StringMethod_a8f5e8ddc90a86dc363d3323c31f8e3b7}{centers\_}}[i]) <= eps)}
\DoxyCodeLine{45             \{\textcolor{comment}{//e.g. if centers\_[i] = 0.0}}
\DoxyCodeLine{46                 \textcolor{keywordflow}{if}(std::abs(cvs[i]-\/>GetValue()) <= threshold)}
\DoxyCodeLine{47                 \{}
\DoxyCodeLine{48                     diff = 0; \textcolor{comment}{//If current value is approximately zero then go ahead}}
\DoxyCodeLine{49                 \}}
\DoxyCodeLine{50                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{51                 \{}
\DoxyCodeLine{52                     diff = 2*threshold; \textcolor{comment}{//Will always be greater than threshold}}
\DoxyCodeLine{53                 \}}
\DoxyCodeLine{54                 \textcolor{comment}{//diff = std::abs((cvs[i]-\/>GetValue() -\/ (centers\_[i]+eps))) / ((cvs[i]-\/>GetValue() + (eps + centers\_[i]))/2.0);}}
\DoxyCodeLine{55                 \textcolor{comment}{//std::cout << "MPIID = " << mpiid\_ << " and center[" << i << "] = 0.0 and diff = " << diff << std::endl; }}
\DoxyCodeLine{56             \}}
\DoxyCodeLine{57             \textcolor{keywordflow}{else}}
\DoxyCodeLine{58             \{}
\DoxyCodeLine{59                 diff = std::abs((cvs[i]-\/>GetValue() -\/ (\mbox{\hyperlink{classSSAGES_1_1StringMethod_a8f5e8ddc90a86dc363d3323c31f8e3b7}{centers\_}}[i]))) / ((cvs[i]-\/>GetValue() + (\mbox{\hyperlink{classSSAGES_1_1StringMethod_a8f5e8ddc90a86dc363d3323c31f8e3b7}{centers\_}}[i]))/2.0);}
\DoxyCodeLine{60                 \textcolor{comment}{//std::cout << "MPIID = " << mpiid\_ << " and center[" << i << "] != 0.0 and diff = " << diff << std::endl; }}
\DoxyCodeLine{61             \}}
\DoxyCodeLine{62             \textcolor{keywordflow}{if}(std::abs(diff) >= threshold)}
\DoxyCodeLine{63             \{}
\DoxyCodeLine{64                 \textcolor{keywordflow}{return} \textcolor{keyword}{false}; \textcolor{comment}{//proceed to initialize again}}
\DoxyCodeLine{65             \}}
\DoxyCodeLine{66         \} }
\DoxyCodeLine{67         \textcolor{keywordflow}{return} \textcolor{keyword}{true}; \textcolor{comment}{//OK to move on to regular sampling}}
\DoxyCodeLine{68     \}}

\end{DoxyCode}


References S\+S\+A\+G\+E\+S\+::\+String\+Method\+::centers\+\_\+.



Referenced by Post\+Integration().

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1Swarm_a6e23dbcbe88170778a7c6788474e45ab_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1Swarm_aae8fbacf2c51b84a5a333387116dda0d}\label{classSSAGES_1_1Swarm_aae8fbacf2c51b84a5a333387116dda0d}} 
\index{SSAGES::Swarm@{SSAGES::Swarm}!PostIntegration@{PostIntegration}}
\index{PostIntegration@{PostIntegration}!SSAGES::Swarm@{SSAGES::Swarm}}
\doxysubsubsection{\texorpdfstring{PostIntegration()}{PostIntegration()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+Swarm\+::\+Post\+Integration (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$}]{snapshot,  }\item[{const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&}]{cvmanager }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



\mbox{\hyperlink{classSSAGES_1_1Method}{Method}} call post integration. 

Post-\/integration hook 
\begin{DoxyParams}{Parameters}
{\em snapshot} & Pointer to the simulation snapshot. \\
\hline
{\em cvmanager} & Collective variable manager.\\
\hline
\end{DoxyParams}
This function will be called after each integration step. 

Implements \mbox{\hyperlink{classSSAGES_1_1StringMethod_a5e02e69fbe65d3064f9fe76c36be6ab5}{S\+S\+A\+G\+E\+S\+::\+String\+Method}}.



Definition at line 70 of file Swarm.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{71     \{}
\DoxyCodeLine{72         \textcolor{keyword}{auto} cvs = cvmanager.GetCVs(\mbox{\hyperlink{classSSAGES_1_1Method_a24b0ac53b1fabcab0a5f3bd6cde26909}{cvmask\_}});}
\DoxyCodeLine{73         \textcolor{keyword}{auto}\& forces = snapshot-\/>GetForces();}
\DoxyCodeLine{74         \textcolor{keyword}{auto}\& positions = snapshot-\/>GetPositions();}
\DoxyCodeLine{75         \textcolor{keyword}{auto}\& velocities = snapshot-\/>GetVelocities();}
\DoxyCodeLine{76 }
\DoxyCodeLine{77         \textcolor{comment}{//First check if a previous snapshot was stored; the system is definitely initialized if so}}
\DoxyCodeLine{78         \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1Swarm_aa3e1dbbf5f37d6a3d90b9939be9629af}{snapshot\_stored}})}
\DoxyCodeLine{79         \{}
\DoxyCodeLine{80             \mbox{\hyperlink{classSSAGES_1_1Swarm_a3dd72ab1119f41d6f83e70ba2b9d47a3}{initialized}} = \textcolor{keyword}{true};}
\DoxyCodeLine{81         \}}
\DoxyCodeLine{82         \textcolor{keywordflow}{else}}
\DoxyCodeLine{83         \{}
\DoxyCodeLine{84             \mbox{\hyperlink{classSSAGES_1_1Swarm_a3dd72ab1119f41d6f83e70ba2b9d47a3}{initialized}} = \mbox{\hyperlink{classSSAGES_1_1Swarm_a6e23dbcbe88170778a7c6788474e45ab}{CVInitialized}}(cvs); \textcolor{comment}{//If no snapshot stored, evalute whether the system finish initializing}}
\DoxyCodeLine{85         \}}
\DoxyCodeLine{86         }
\DoxyCodeLine{87         \mbox{\hyperlink{classSSAGES_1_1Swarm_a65b8782f926da3c5dfc4ae4c45523ce1}{original\_initialized}} = \mbox{\hyperlink{classSSAGES_1_1Swarm_a3dd72ab1119f41d6f83e70ba2b9d47a3}{initialized}}; \textcolor{comment}{//Will remember whether this system was initialized before the MPI call overrides it}}
\DoxyCodeLine{88 }
\DoxyCodeLine{89         \textcolor{comment}{//If system finished initializing and hadn't entered the sampling blocks, check if a snapshot was stored.  If not, store one and don't store any future snapshots.}}
\DoxyCodeLine{90         \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1Swarm_a3dd72ab1119f41d6f83e70ba2b9d47a3}{initialized}} \&\& !\mbox{\hyperlink{classSSAGES_1_1Swarm_a32ae88031572228e2346080b85462667}{sampling\_started}})}
\DoxyCodeLine{91         \{}
\DoxyCodeLine{92             \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classSSAGES_1_1Swarm_aa3e1dbbf5f37d6a3d90b9939be9629af}{snapshot\_stored}})}
\DoxyCodeLine{93             \{}
\DoxyCodeLine{94                 \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad0f30a4bda9ab52fbf1a2fd6d82898e6}{prev\_positions\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}] = snapshot-\/>SerializePositions();}
\DoxyCodeLine{95                 \mbox{\hyperlink{classSSAGES_1_1StringMethod_a882f74a324641a449216d0edbc5fdb5d}{prev\_velocities\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}] = snapshot-\/>SerializeVelocities();}
\DoxyCodeLine{96                 \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad3ff83869b7ef597d3641f0eb1649c82}{prev\_IDs\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}] = snapshot-\/>SerializeIDs();}
\DoxyCodeLine{97                 \mbox{\hyperlink{classSSAGES_1_1Swarm_aa3e1dbbf5f37d6a3d90b9939be9629af}{snapshot\_stored}} = \textcolor{keyword}{true};}
\DoxyCodeLine{98             \}}
\DoxyCodeLine{99         \} }
\DoxyCodeLine{100         MPI\_Allreduce(MPI\_IN\_PLACE, \&\mbox{\hyperlink{classSSAGES_1_1Swarm_a3dd72ab1119f41d6f83e70ba2b9d47a3}{initialized}}, 1, MPI\_INT, MPI\_LAND, \mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}}); \textcolor{comment}{//Check if all systems are initialized; initialize is only true if everything node finished initializing}}
\DoxyCodeLine{101         \textcolor{comment}{//If any system wasn't initialized and the sampling block were not entered, begin restraining each node}}
\DoxyCodeLine{102         \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classSSAGES_1_1Swarm_a3dd72ab1119f41d6f83e70ba2b9d47a3}{initialized}} \&\& !\mbox{\hyperlink{classSSAGES_1_1Swarm_a32ae88031572228e2346080b85462667}{sampling\_started}})}
\DoxyCodeLine{103         \{}
\DoxyCodeLine{104             \textcolor{comment}{//Do restrained sampling; NO trajectory harvesting }}
\DoxyCodeLine{105             \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classSSAGES_1_1Swarm_a65b8782f926da3c5dfc4ae4c45523ce1}{original\_initialized}})}
\DoxyCodeLine{106             \{}
\DoxyCodeLine{107                 \textcolor{comment}{//If the system was not initialized originally, restrain it}}
\DoxyCodeLine{108                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < cvs.size(); i++)}
\DoxyCodeLine{109                 \{}
\DoxyCodeLine{110                     \textcolor{comment}{//Get current CV and gradient}}
\DoxyCodeLine{111                     \textcolor{keyword}{auto}\& cv = cvs[i];}
\DoxyCodeLine{112                     \textcolor{keyword}{auto}\& grad = cv-\/>GetGradient();}
\DoxyCodeLine{113 }
\DoxyCodeLine{114                     \textcolor{comment}{//Compute dV/dCV}}
\DoxyCodeLine{115                     \textcolor{keyword}{auto} D = \mbox{\hyperlink{classSSAGES_1_1StringMethod_a51f68bc9e02055a96375617626240a79}{cvspring\_}}[i]*(cv-\/>GetDifference(\mbox{\hyperlink{classSSAGES_1_1StringMethod_a8f5e8ddc90a86dc363d3323c31f8e3b7}{centers\_}}[i]));}
\DoxyCodeLine{116 }
\DoxyCodeLine{117                     \textcolor{comment}{//Update forces}}
\DoxyCodeLine{118                     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < forces.size(); j++)}
\DoxyCodeLine{119                     \{}
\DoxyCodeLine{120                         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k = 0; k < forces[j].size(); k++)}
\DoxyCodeLine{121                         \{}
\DoxyCodeLine{122                             forces[j][k] -\/= (double)D*grad[j][k];}
\DoxyCodeLine{123                         \}}
\DoxyCodeLine{124                     \}}
\DoxyCodeLine{125                 \}}
\DoxyCodeLine{126             \}}
\DoxyCodeLine{127             \textcolor{keywordflow}{else}}
\DoxyCodeLine{128             \{}
\DoxyCodeLine{129                 \textcolor{comment}{//If the system was already initialized, simply reset the positions and velocities; this keeps them in their initialized states}}
\DoxyCodeLine{130                 \mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}} = 0;}
\DoxyCodeLine{131                 \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& force: forces)}
\DoxyCodeLine{132                     force.setZero();}
\DoxyCodeLine{133 }
\DoxyCodeLine{134                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad3ff83869b7ef597d3641f0eb1649c82}{prev\_IDs\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}].size(); i++)}
\DoxyCodeLine{135                 \{}
\DoxyCodeLine{136                     \textcolor{keyword}{auto} localindex = snapshot-\/>GetLocalIndex(\mbox{\hyperlink{classSSAGES_1_1StringMethod_ad3ff83869b7ef597d3641f0eb1649c82}{prev\_IDs\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i]);}
\DoxyCodeLine{137                     \textcolor{keywordflow}{if}(localindex!= -\/1)}
\DoxyCodeLine{138                     \{}
\DoxyCodeLine{139                         positions[localindex][0] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad0f30a4bda9ab52fbf1a2fd6d82898e6}{prev\_positions\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3];}
\DoxyCodeLine{140                         positions[localindex][1] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad0f30a4bda9ab52fbf1a2fd6d82898e6}{prev\_positions\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3 + 1];}
\DoxyCodeLine{141                         positions[localindex][2] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad0f30a4bda9ab52fbf1a2fd6d82898e6}{prev\_positions\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3 + 2];}
\DoxyCodeLine{142 }
\DoxyCodeLine{143                         velocities[localindex][0] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_a882f74a324641a449216d0edbc5fdb5d}{prev\_velocities\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3];}
\DoxyCodeLine{144                         velocities[localindex][1] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_a882f74a324641a449216d0edbc5fdb5d}{prev\_velocities\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3 + 1];}
\DoxyCodeLine{145                         velocities[localindex][2] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_a882f74a324641a449216d0edbc5fdb5d}{prev\_velocities\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3 + 2];}
\DoxyCodeLine{146 }
\DoxyCodeLine{147                     \}}
\DoxyCodeLine{148                 \}}
\DoxyCodeLine{149             \}}
\DoxyCodeLine{150         \}}
\DoxyCodeLine{151         \textcolor{keywordflow}{else}}
\DoxyCodeLine{152         \{}
\DoxyCodeLine{153             \textcolor{comment}{//Enter this block is every node was done initializing, or the sampling had already begun}}
\DoxyCodeLine{154             \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classSSAGES_1_1Swarm_a32ae88031572228e2346080b85462667}{sampling\_started}})}
\DoxyCodeLine{155             \{}
\DoxyCodeLine{156                 \mbox{\hyperlink{classSSAGES_1_1Swarm_a32ae88031572228e2346080b85462667}{sampling\_started}} = \textcolor{keyword}{true}; \textcolor{comment}{//If the node got here right after initializing, set the flag that sampling has begun (preventing unneeded initializing in the future)}}
\DoxyCodeLine{157             \}}
\DoxyCodeLine{158             \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1StringMethod_ae1214f174d34de4481f639f7aab4b8c5}{iterator\_}} <= \mbox{\hyperlink{classSSAGES_1_1Swarm_affe9f14ebc64f8e6a153bfa4d72f9f55}{initialize\_steps\_}} + \mbox{\hyperlink{classSSAGES_1_1Swarm_a4ae35c195e1dd5f1bc07c6dcf2c65857}{restrained\_steps\_}})}
\DoxyCodeLine{159             \{}
\DoxyCodeLine{160                 \textcolor{comment}{//Do restrained sampling, and do harvest trajectories}}
\DoxyCodeLine{161                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < cvs.size(); i++)}
\DoxyCodeLine{162                 \{}
\DoxyCodeLine{163                     \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1StringMethod_ae1214f174d34de4481f639f7aab4b8c5}{iterator\_}} == 0)}
\DoxyCodeLine{164                     \{}
\DoxyCodeLine{165                         \mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}} = 0; \textcolor{comment}{//Reset index when starting}}
\DoxyCodeLine{166                     \}}
\DoxyCodeLine{167                     \textcolor{comment}{//Get current CV and gradient}}
\DoxyCodeLine{168                     \textcolor{keyword}{auto}\& cv = cvs[i];}
\DoxyCodeLine{169                     \textcolor{keyword}{auto}\& grad = cv-\/>GetGradient();}
\DoxyCodeLine{170 }
\DoxyCodeLine{171                     \textcolor{comment}{//Compute dV/dCV}}
\DoxyCodeLine{172                     \textcolor{keyword}{auto} D = \mbox{\hyperlink{classSSAGES_1_1StringMethod_a51f68bc9e02055a96375617626240a79}{cvspring\_}}[i]*(cv-\/>GetDifference(\mbox{\hyperlink{classSSAGES_1_1StringMethod_a8f5e8ddc90a86dc363d3323c31f8e3b7}{centers\_}}[i]));}
\DoxyCodeLine{173 }
\DoxyCodeLine{174                     \textcolor{comment}{//Update forces}}
\DoxyCodeLine{175                     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < forces.size(); j++)}
\DoxyCodeLine{176                     \{}
\DoxyCodeLine{177                         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k = 0; k < forces[j].size(); k++)}
\DoxyCodeLine{178                         \{}
\DoxyCodeLine{179                             forces[j][k] -\/= (double)D*grad[j][k]; }
\DoxyCodeLine{180                         \}}
\DoxyCodeLine{181                     \}}
\DoxyCodeLine{182                 \}}
\DoxyCodeLine{183                 \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1StringMethod_ae1214f174d34de4481f639f7aab4b8c5}{iterator\_}} > \mbox{\hyperlink{classSSAGES_1_1Swarm_affe9f14ebc64f8e6a153bfa4d72f9f55}{initialize\_steps\_}})}
\DoxyCodeLine{184                 \{}
\DoxyCodeLine{185                     \textcolor{comment}{//Harvest a trajectory every harvest\_length\_ steps}}
\DoxyCodeLine{186                     \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1StringMethod_ae1214f174d34de4481f639f7aab4b8c5}{iterator\_}} \% \mbox{\hyperlink{classSSAGES_1_1Swarm_a0c1f8ecda790d89724a4ca49467ea6d7}{harvest\_length\_}} == 0)}
\DoxyCodeLine{187                     \{}
\DoxyCodeLine{188                         \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad0f30a4bda9ab52fbf1a2fd6d82898e6}{prev\_positions\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}] = snapshot-\/>SerializePositions();}
\DoxyCodeLine{189                         \mbox{\hyperlink{classSSAGES_1_1StringMethod_a882f74a324641a449216d0edbc5fdb5d}{prev\_velocities\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}] = snapshot-\/>SerializeVelocities();}
\DoxyCodeLine{190                         \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad3ff83869b7ef597d3641f0eb1649c82}{prev\_IDs\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}] = snapshot-\/>SerializeIDs();}
\DoxyCodeLine{191                         \mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}++;}
\DoxyCodeLine{192                     \}}
\DoxyCodeLine{193                 \}}
\DoxyCodeLine{194                 \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1StringMethod_ae1214f174d34de4481f639f7aab4b8c5}{iterator\_}} == \mbox{\hyperlink{classSSAGES_1_1Swarm_affe9f14ebc64f8e6a153bfa4d72f9f55}{initialize\_steps\_}} + \mbox{\hyperlink{classSSAGES_1_1Swarm_a4ae35c195e1dd5f1bc07c6dcf2c65857}{restrained\_steps\_}})}
\DoxyCodeLine{195                 \{}
\DoxyCodeLine{196                     \textcolor{comment}{//Reset positions and forces before first call to unrestrained sampling}}
\DoxyCodeLine{197                     \mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}} = 0;}
\DoxyCodeLine{198                     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& force: forces)}
\DoxyCodeLine{199                         force.setZero();}
\DoxyCodeLine{200 }
\DoxyCodeLine{201                     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad3ff83869b7ef597d3641f0eb1649c82}{prev\_IDs\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}].size(); i++)}
\DoxyCodeLine{202                     \{}
\DoxyCodeLine{203                         \textcolor{keyword}{auto} localindex = snapshot-\/>GetLocalIndex(\mbox{\hyperlink{classSSAGES_1_1StringMethod_ad3ff83869b7ef597d3641f0eb1649c82}{prev\_IDs\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i]);}
\DoxyCodeLine{204                         \textcolor{keywordflow}{if}(localindex!= -\/1)}
\DoxyCodeLine{205                         \{}
\DoxyCodeLine{206                             positions[localindex][0] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad0f30a4bda9ab52fbf1a2fd6d82898e6}{prev\_positions\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3];}
\DoxyCodeLine{207                             positions[localindex][1] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad0f30a4bda9ab52fbf1a2fd6d82898e6}{prev\_positions\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3 + 1];}
\DoxyCodeLine{208                             positions[localindex][2] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad0f30a4bda9ab52fbf1a2fd6d82898e6}{prev\_positions\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3 + 2];}
\DoxyCodeLine{209 }
\DoxyCodeLine{210                             velocities[localindex][0] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_a882f74a324641a449216d0edbc5fdb5d}{prev\_velocities\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3];}
\DoxyCodeLine{211                             velocities[localindex][1] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_a882f74a324641a449216d0edbc5fdb5d}{prev\_velocities\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3 + 1];}
\DoxyCodeLine{212                             velocities[localindex][2] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_a882f74a324641a449216d0edbc5fdb5d}{prev\_velocities\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3 + 2];}
\DoxyCodeLine{213 }
\DoxyCodeLine{214                         \}}
\DoxyCodeLine{215                     \}}
\DoxyCodeLine{216                 \}}
\DoxyCodeLine{217                 \mbox{\hyperlink{classSSAGES_1_1StringMethod_ae1214f174d34de4481f639f7aab4b8c5}{iterator\_}}++;}
\DoxyCodeLine{218             \}}
\DoxyCodeLine{219             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1StringMethod_ae1214f174d34de4481f639f7aab4b8c5}{iterator\_}} <= \mbox{\hyperlink{classSSAGES_1_1Swarm_affe9f14ebc64f8e6a153bfa4d72f9f55}{initialize\_steps\_}} + \mbox{\hyperlink{classSSAGES_1_1Swarm_a4ae35c195e1dd5f1bc07c6dcf2c65857}{restrained\_steps\_}} + \mbox{\hyperlink{classSSAGES_1_1Swarm_a87d05b081f563d506ced1ad7779b5194}{unrestrained\_steps\_}})}
\DoxyCodeLine{220             \{}
\DoxyCodeLine{221                 \textcolor{comment}{//Launch unrestrained trajectories}}
\DoxyCodeLine{222                 \textcolor{keywordflow}{if}((\mbox{\hyperlink{classSSAGES_1_1StringMethod_ae1214f174d34de4481f639f7aab4b8c5}{iterator\_}} -\/ \mbox{\hyperlink{classSSAGES_1_1Swarm_affe9f14ebc64f8e6a153bfa4d72f9f55}{initialize\_steps\_}} -\/ \mbox{\hyperlink{classSSAGES_1_1Swarm_a4ae35c195e1dd5f1bc07c6dcf2c65857}{restrained\_steps\_}}) \% \mbox{\hyperlink{classSSAGES_1_1Swarm_a151b6b95dc5795326d90e09122741752}{swarm\_length\_}} == 0)}
\DoxyCodeLine{223                 \{}
\DoxyCodeLine{224                     \textcolor{comment}{//End of trajectory, harvest drift}}
\DoxyCodeLine{225                     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < \mbox{\hyperlink{classSSAGES_1_1Swarm_af28af23d7954d79b7c8820763315ca7e}{cv\_drift\_}}.size(); i++)}
\DoxyCodeLine{226                     \{ }
\DoxyCodeLine{227                         \mbox{\hyperlink{classSSAGES_1_1Swarm_af28af23d7954d79b7c8820763315ca7e}{cv\_drift\_}}[i] = (\mbox{\hyperlink{classSSAGES_1_1Swarm_af28af23d7954d79b7c8820763315ca7e}{cv\_drift\_}}[i]*\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}} + cvs[i]-\/>GetMinimumImage(\mbox{\hyperlink{classSSAGES_1_1StringMethod_a8f5e8ddc90a86dc363d3323c31f8e3b7}{centers\_}}[i])  -\/ \mbox{\hyperlink{classSSAGES_1_1StringMethod_a8f5e8ddc90a86dc363d3323c31f8e3b7}{centers\_}}[i]) / (\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}+1); \textcolor{comment}{//Calculate running average of drifts }}
\DoxyCodeLine{228                     \}}
\DoxyCodeLine{229                     \textcolor{comment}{//Set up for next trajectory}}
\DoxyCodeLine{230                     \mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}++;}
\DoxyCodeLine{231 }
\DoxyCodeLine{232                     \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}} < \mbox{\hyperlink{classSSAGES_1_1Swarm_ab812af26dec6866acaa7468d76be977a}{number\_trajectories\_}})}
\DoxyCodeLine{233                     \{}
\DoxyCodeLine{234                         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& force: forces)}
\DoxyCodeLine{235                             force.setZero();}
\DoxyCodeLine{236 }
\DoxyCodeLine{237                         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad3ff83869b7ef597d3641f0eb1649c82}{prev\_IDs\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}].size(); i++)}
\DoxyCodeLine{238                         \{}
\DoxyCodeLine{239                             \textcolor{keyword}{auto} localindex = snapshot-\/>GetLocalIndex(\mbox{\hyperlink{classSSAGES_1_1StringMethod_ad3ff83869b7ef597d3641f0eb1649c82}{prev\_IDs\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i]);}
\DoxyCodeLine{240                             \textcolor{keywordflow}{if}(localindex!= -\/1)}
\DoxyCodeLine{241                             \{}
\DoxyCodeLine{242                                 positions[localindex][0] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad0f30a4bda9ab52fbf1a2fd6d82898e6}{prev\_positions\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3];}
\DoxyCodeLine{243                                 positions[localindex][1] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad0f30a4bda9ab52fbf1a2fd6d82898e6}{prev\_positions\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3 + 1];}
\DoxyCodeLine{244                                 positions[localindex][2] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_ad0f30a4bda9ab52fbf1a2fd6d82898e6}{prev\_positions\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3 + 2];}
\DoxyCodeLine{245 }
\DoxyCodeLine{246                                 velocities[localindex][0] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_a882f74a324641a449216d0edbc5fdb5d}{prev\_velocities\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3];}
\DoxyCodeLine{247                                 velocities[localindex][1] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_a882f74a324641a449216d0edbc5fdb5d}{prev\_velocities\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3 + 1];}
\DoxyCodeLine{248                                 velocities[localindex][2] = \mbox{\hyperlink{classSSAGES_1_1StringMethod_a882f74a324641a449216d0edbc5fdb5d}{prev\_velocities\_}}[\mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}}][i*3 + 2];}
\DoxyCodeLine{249 }
\DoxyCodeLine{250                             \}}
\DoxyCodeLine{251                         \}}
\DoxyCodeLine{252                     \}}
\DoxyCodeLine{253                 \}}
\DoxyCodeLine{254                 \mbox{\hyperlink{classSSAGES_1_1StringMethod_ae1214f174d34de4481f639f7aab4b8c5}{iterator\_}}++;}
\DoxyCodeLine{255             \}}
\DoxyCodeLine{256             \textcolor{keywordflow}{else}}
\DoxyCodeLine{257             \{}
\DoxyCodeLine{258                 \textcolor{comment}{//Evolve CVs, reparametrize, and reset vectors}}
\DoxyCodeLine{259                 \mbox{\hyperlink{classSSAGES_1_1StringMethod_a9aa61a19b2ad38d4890e53cb97176d58}{iteration\_}}++;}
\DoxyCodeLine{260                 }
\DoxyCodeLine{261                 MPI\_Barrier(\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}});}
\DoxyCodeLine{262                 \mbox{\hyperlink{classSSAGES_1_1Swarm_a0ee007f404408c59c7217cd8fb6b7c1c}{StringUpdate}}();}
\DoxyCodeLine{263                 \mbox{\hyperlink{classSSAGES_1_1StringMethod_a98d6840cc33ad30c2e9a4311e57ea2de}{CheckEnd}}(cvs);}
\DoxyCodeLine{264                 MPI\_Barrier(\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}});}
\DoxyCodeLine{265                 \mbox{\hyperlink{classSSAGES_1_1StringMethod_a538a83e6f944a2b37ae9cc6207c970f5}{UpdateWorldString}}(cvs); }
\DoxyCodeLine{266                 \mbox{\hyperlink{classSSAGES_1_1StringMethod_aaac8b878af3574e7da1c109e5d2bfaf0}{PrintString}}(cvs);}
\DoxyCodeLine{267 }
\DoxyCodeLine{268                 \mbox{\hyperlink{classSSAGES_1_1StringMethod_ae1214f174d34de4481f639f7aab4b8c5}{iterator\_}} = 0;}
\DoxyCodeLine{269                 \mbox{\hyperlink{classSSAGES_1_1Swarm_a12f21f3b64a61e45a4e86c7a1c3e5354}{index\_}} = 0;}
\DoxyCodeLine{270                 \mbox{\hyperlink{classSSAGES_1_1Swarm_aa3e1dbbf5f37d6a3d90b9939be9629af}{snapshot\_stored}} = \textcolor{keyword}{false};}
\DoxyCodeLine{271 }
\DoxyCodeLine{272                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < \mbox{\hyperlink{classSSAGES_1_1Swarm_af28af23d7954d79b7c8820763315ca7e}{cv\_drift\_}}.size(); i++)}
\DoxyCodeLine{273                 \{}
\DoxyCodeLine{274                     \mbox{\hyperlink{classSSAGES_1_1Swarm_af28af23d7954d79b7c8820763315ca7e}{cv\_drift\_}}[i] = 0; }
\DoxyCodeLine{275                 \}}
\DoxyCodeLine{276             \}}
\DoxyCodeLine{277         \} }
\DoxyCodeLine{278     \}}

\end{DoxyCode}


References S\+S\+A\+G\+E\+S\+::\+String\+Method\+::centers\+\_\+, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::\+Check\+End(), cv\+\_\+drift\+\_\+, C\+V\+Initialized(), S\+S\+A\+G\+E\+S\+::\+Method\+::cvmask\+\_\+, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::cvspring\+\_\+, S\+S\+A\+G\+E\+S\+::\+C\+V\+Manager\+::\+Get\+C\+Vs(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Forces(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Local\+Index(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Positions(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Velocities(), harvest\+\_\+length\+\_\+, index\+\_\+, initialize\+\_\+steps\+\_\+, initialized, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::iteration\+\_\+, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::iterator\+\_\+, number\+\_\+trajectories\+\_\+, original\+\_\+initialized, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::prev\+\_\+\+I\+Ds\+\_\+, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::prev\+\_\+positions\+\_\+, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::prev\+\_\+velocities\+\_\+, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::\+Print\+String(), restrained\+\_\+steps\+\_\+, sampling\+\_\+started, S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Serialize\+I\+Ds(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Serialize\+Positions(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Serialize\+Velocities(), snapshot\+\_\+stored, String\+Update(), swarm\+\_\+length\+\_\+, unrestrained\+\_\+steps\+\_\+, S\+S\+A\+G\+E\+S\+::\+String\+Method\+::\+Update\+World\+String(), and S\+S\+A\+G\+E\+S\+::\+Method\+::world\+\_\+.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1Swarm_aae8fbacf2c51b84a5a333387116dda0d_cgraph}
\end{center}
\end{figure}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/michael/development/\+S\+S\+A\+G\+E\+S/src/\+Methods/Swarm.\+h\item 
/home/michael/development/\+S\+S\+A\+G\+E\+S/src/\+Methods/Swarm.\+cpp\end{DoxyCompactItemize}
