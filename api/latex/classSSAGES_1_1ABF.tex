\hypertarget{classSSAGES_1_1ABF}{}\doxysection{S\+S\+A\+G\+ES\+::A\+BF Class Reference}
\label{classSSAGES_1_1ABF}\index{SSAGES::ABF@{SSAGES::ABF}}


Adaptive Biasing Force Algorithm.  




{\ttfamily \#include $<$A\+B\+F.\+h$>$}



Inheritance diagram for S\+S\+A\+G\+ES\+::A\+BF\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=204pt]{classSSAGES_1_1ABF__inherit__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classSSAGES_1_1ABF_a7071f09b2810b388ff6eabdc49fab005}{A\+BF}} (const M\+P\+I\+\_\+\+Comm \&world, const M\+P\+I\+\_\+\+Comm \&comm, \mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ int $>$ $\ast$N, \mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ int $>$ $\ast$Nworld, std\+::vector$<$ \mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ double $>$ $\ast$ $>$ F, std\+::vector$<$ \mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ double $>$ $\ast$ $>$ Fworld, std\+::vector$<$ std\+::vector$<$ double $>$$>$ restraint, std\+::vector$<$ bool $>$ isperiodic, std\+::vector$<$ std\+::vector$<$ double $>$$>$ periodicboundaries, double min, bool massweigh, std\+::string filename, std\+::string Nworld\+\_\+filename, std\+::string Fworld\+\_\+filename, const std\+::vector$<$ std\+::vector$<$ double $>$$>$ \&histdetails, int F\+Backup\+Interv, double unitconv, double timestep, unsigned int frequency)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1ABF_a27d1b2f056d32066d7c62a037836948c}{Pre\+Simulation}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$snapshot, const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&cvmanager) override
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{classSSAGES_1_1Method}{Method}} call prior to simulation initiation. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1ABF_ad2007ce8bb539072a97d4d02d268c638}{Post\+Integration}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$snapshot, const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&cvmanager) override
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{classSSAGES_1_1Method}{Method}} call post integration. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1ABF_a02fae49d009dcf405d82144a2d123faa}{Post\+Simulation}} (\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$snapshot, const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&cvmanager) override
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{classSSAGES_1_1Method}{Method}} call prior to simulation initiation. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSSAGES_1_1ABF_ac206ccf90c29d11d6abdebeae44b033f}{Set\+Iteration}} (const int iter)
\begin{DoxyCompactList}\small\item\em Set iteration of the method. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ABF_aa683e1d8a8df3522bc64529ea5e80a78}\label{classSSAGES_1_1ABF_aa683e1d8a8df3522bc64529ea5e80a78}} 
\mbox{\hyperlink{classSSAGES_1_1ABF_aa683e1d8a8df3522bc64529ea5e80a78}{$\sim$\+A\+BF}} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{classSSAGES_1_1ABF}{A\+BF}} $\ast$ \mbox{\hyperlink{classSSAGES_1_1ABF_aa131b026ddb40941889c8bde7840ac6a}{Build}} (const Json\+::\+Value \&json, const M\+P\+I\+\_\+\+Comm \&world, const M\+P\+I\+\_\+\+Comm \&comm, const std\+::string \&path)
\begin{DoxyCompactList}\small\item\em Build a derived method from \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} node. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classSSAGES_1_1ABF_aa2200677359f582d73f095c42ec5ad83}{Calc\+Bias\+Force}} (const \mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$snapshot, const \mbox{\hyperlink{namespaceSSAGES_acddea47426ac0a643b048f870ddd2907}{C\+V\+List}} \&cvs, const std\+::vector$<$ double $>$ \&cv\+Vals)
\begin{DoxyCompactList}\small\item\em Computes the bias force. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ABF_ab63434a1cefe80372e2555e1128e39d2}\label{classSSAGES_1_1ABF_ab63434a1cefe80372e2555e1128e39d2}} 
void \mbox{\hyperlink{classSSAGES_1_1ABF_ab63434a1cefe80372e2555e1128e39d2}{Write\+Data}} ()
\begin{DoxyCompactList}\small\item\em Writes out data to file. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classSSAGES_1_1ABF_ae223e09cc686522073fd881088edb8ac}{bounds\+Check}} (const std\+::vector$<$ double $>$ \&C\+Vs)
\begin{DoxyCompactList}\small\item\em Checks whether the local walker is within CV bounds. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ int $>$ $\ast$ \mbox{\hyperlink{classSSAGES_1_1ABF_a45daad9b41bac9009f1c2f09da10f58e}{N\+\_\+}}
\begin{DoxyCompactList}\small\item\em To store number of local hits at a given CV bin. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ int $>$ $\ast$ \mbox{\hyperlink{classSSAGES_1_1ABF_ae2306049903c2ed6e6fb07eaee71e9ae}{Nworld\+\_\+}}
\begin{DoxyCompactList}\small\item\em To store number of global hits at a given CV bin. \end{DoxyCompactList}\item 
std\+::vector$<$ \mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ double $>$ $\ast$ $>$ \mbox{\hyperlink{classSSAGES_1_1ABF_a47453516b73e968060821c57d67b44ff}{F\+\_\+}}
\begin{DoxyCompactList}\small\item\em To store running total of the local walker. \end{DoxyCompactList}\item 
std\+::vector$<$ \mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ double $>$ $\ast$ $>$ \mbox{\hyperlink{classSSAGES_1_1ABF_a7df76c30aa32223fb74f3fbdb9202706}{Fworld\+\_\+}}
\begin{DoxyCompactList}\small\item\em Will hold the global total, synced across walkers at every time step. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \mbox{\hyperlink{classSSAGES_1_1ABF_a7e2b1995149d50d1b1e9d05e6a44c1b6}{restraint\+\_\+}}
\begin{DoxyCompactList}\small\item\em Information for a harmonic restraint to keep CV in the region of interest. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ABF_aa575ad59d0bbaac2709de9c481d4db30}\label{classSSAGES_1_1ABF_aa575ad59d0bbaac2709de9c481d4db30}} 
std\+::vector$<$ bool $>$ \mbox{\hyperlink{classSSAGES_1_1ABF_aa575ad59d0bbaac2709de9c481d4db30}{isperiodic\+\_\+}}
\begin{DoxyCompactList}\small\item\em For each CV, holds whether that CV has periodic boundaries or not. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \mbox{\hyperlink{classSSAGES_1_1ABF_a85f39957134c0d27298aff5ad306cbd9}{periodicboundaries\+\_\+}}
\begin{DoxyCompactList}\small\item\em Holds periodic boundaries of C\+Vs. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classSSAGES_1_1ABF_a88322f13d3424be20d46cf68a3c8ce28}{min\+\_\+}}
\item 
\mbox{\Hypertarget{classSSAGES_1_1ABF_a7c882e37a3676cb3e33776621929c3b7}\label{classSSAGES_1_1ABF_a7c882e37a3676cb3e33776621929c3b7}} 
Eigen\+::\+Vector\+Xd \mbox{\hyperlink{classSSAGES_1_1ABF_a7c882e37a3676cb3e33776621929c3b7}{wdotp1\+\_\+}}
\begin{DoxyCompactList}\small\item\em To hold last iteration wdotp value for numerical derivative. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ABF_a1a0082f17ab10382191cbf39046e7052}\label{classSSAGES_1_1ABF_a1a0082f17ab10382191cbf39046e7052}} 
Eigen\+::\+Vector\+Xd \mbox{\hyperlink{classSSAGES_1_1ABF_a1a0082f17ab10382191cbf39046e7052}{wdotp2\+\_\+}}
\begin{DoxyCompactList}\small\item\em To hold second to last iteration wdotp value for numerical derivative. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ABF_a0158dff5be22bf287e22aab2eadd4e25}\label{classSSAGES_1_1ABF_a0158dff5be22bf287e22aab2eadd4e25}} 
Eigen\+::\+Vector\+Xd \mbox{\hyperlink{classSSAGES_1_1ABF_a0158dff5be22bf287e22aab2eadd4e25}{Fold\+\_\+}}
\begin{DoxyCompactList}\small\item\em To hold last iterations F\+\_\+ value for removing bias. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ABF_aa792d019aee0f614a2a0935405244e91}\label{classSSAGES_1_1ABF_aa792d019aee0f614a2a0935405244e91}} 
bool \mbox{\hyperlink{classSSAGES_1_1ABF_aa792d019aee0f614a2a0935405244e91}{massweigh\+\_\+}}
\begin{DoxyCompactList}\small\item\em Mass weighing of bias enabled/disabled. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ABF_ae88ce69e6e7fcb15b8db68d5530f6a1e}\label{classSSAGES_1_1ABF_ae88ce69e6e7fcb15b8db68d5530f6a1e}} 
std\+::vector$<$ \mbox{\hyperlink{namespaceSSAGES_a630084a0a5e185e89e21b3735f8f8b2e}{Vector3}} $>$ \mbox{\hyperlink{classSSAGES_1_1ABF_ae88ce69e6e7fcb15b8db68d5530f6a1e}{biases\+\_\+}}
\begin{DoxyCompactList}\small\item\em Biases applied to atoms each timestep. ~\newline
 \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}\label{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}} 
unsigned int \mbox{\hyperlink{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}{dim\+\_\+}}
\begin{DoxyCompactList}\small\item\em Number of C\+Vs in system. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ABF_a528906f35295ab1a4bf7ed638fbd1973}\label{classSSAGES_1_1ABF_a528906f35295ab1a4bf7ed638fbd1973}} 
std\+::ofstream \mbox{\hyperlink{classSSAGES_1_1ABF_a528906f35295ab1a4bf7ed638fbd1973}{worldout\+\_\+}}
\begin{DoxyCompactList}\small\item\em Output stream for F/N world data. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classSSAGES_1_1ABF_a86e220cdd655537e95b97b97384b506a}{filename\+\_\+}}
\item 
\mbox{\Hypertarget{classSSAGES_1_1ABF_a51e4b0b53add40a74dc4152b402092c6}\label{classSSAGES_1_1ABF_a51e4b0b53add40a74dc4152b402092c6}} 
std\+::string \mbox{\hyperlink{classSSAGES_1_1ABF_a51e4b0b53add40a74dc4152b402092c6}{Nworld\+\_\+filename\+\_\+}}
\begin{DoxyCompactList}\small\item\em Nworld print out filename, for restarts. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ABF_afb8eed7ac7b199b96c277991f9ca58e1}\label{classSSAGES_1_1ABF_afb8eed7ac7b199b96c277991f9ca58e1}} 
std\+::string \mbox{\hyperlink{classSSAGES_1_1ABF_afb8eed7ac7b199b96c277991f9ca58e1}{Fworld\+\_\+filename\+\_\+}}
\begin{DoxyCompactList}\small\item\em Fworld print out filename, for restarts. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \mbox{\hyperlink{classSSAGES_1_1ABF_a060acb9e57d66e702de14ff8a5d36ee6}{histdetails\+\_\+}}
\begin{DoxyCompactList}\small\item\em Histogram details. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classSSAGES_1_1ABF_acc2ac53b0342d31bce16cce64448830f}{F\+Backup\+Interv\+\_\+}}
\begin{DoxyCompactList}\small\item\em Integer to hold F estimate backup information. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSSAGES_1_1ABF_a012104abf51fd7fe050a31fddc3c7180}{unitconv\+\_\+}}
\begin{DoxyCompactList}\small\item\em Unit Conversion Constant from W dot P to Force. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ABF_a2c0bbf27d10f6f773a7215f5df4f78c9}\label{classSSAGES_1_1ABF_a2c0bbf27d10f6f773a7215f5df4f78c9}} 
double \mbox{\hyperlink{classSSAGES_1_1ABF_a2c0bbf27d10f6f773a7215f5df4f78c9}{timestep\+\_\+}}
\begin{DoxyCompactList}\small\item\em Timestep of integration. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ABF_aa420af8834a588aff0f16d344cf7a43e}\label{classSSAGES_1_1ABF_aa420af8834a588aff0f16d344cf7a43e}} 
unsigned int \mbox{\hyperlink{classSSAGES_1_1ABF_aa420af8834a588aff0f16d344cf7a43e}{iteration\+\_\+}}
\begin{DoxyCompactList}\small\item\em Iteration counter. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classSSAGES_1_1ABF_ac4ad4bbc8a1796f32a93987c5879a695}\label{classSSAGES_1_1ABF_ac4ad4bbc8a1796f32a93987c5879a695}} 
Eigen\+::\+Vector\+Xd \mbox{\hyperlink{classSSAGES_1_1ABF_ac4ad4bbc8a1796f32a93987c5879a695}{mass\+\_\+}}
\begin{DoxyCompactList}\small\item\em Mass vector. Empty unless required. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
Adaptive Biasing Force Algorithm. 

Implementation of the Adaptive Biasing Force algorithm based on \cite{DARVE2008144120} 

Definition at line 40 of file A\+B\+F.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classSSAGES_1_1ABF_a7071f09b2810b388ff6eabdc49fab005}\label{classSSAGES_1_1ABF_a7071f09b2810b388ff6eabdc49fab005}} 
\index{SSAGES::ABF@{SSAGES::ABF}!ABF@{ABF}}
\index{ABF@{ABF}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{ABF()}{ABF()}}
{\footnotesize\ttfamily S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::\+A\+BF (\begin{DoxyParamCaption}\item[{const M\+P\+I\+\_\+\+Comm \&}]{world,  }\item[{const M\+P\+I\+\_\+\+Comm \&}]{comm,  }\item[{\mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ int $>$ $\ast$}]{N,  }\item[{\mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ int $>$ $\ast$}]{Nworld,  }\item[{std\+::vector$<$ \mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ double $>$ $\ast$ $>$}]{F,  }\item[{std\+::vector$<$ \mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$ double $>$ $\ast$ $>$}]{Fworld,  }\item[{std\+::vector$<$ std\+::vector$<$ double $>$$>$}]{restraint,  }\item[{std\+::vector$<$ bool $>$}]{isperiodic,  }\item[{std\+::vector$<$ std\+::vector$<$ double $>$$>$}]{periodicboundaries,  }\item[{double}]{min,  }\item[{bool}]{massweigh,  }\item[{std\+::string}]{filename,  }\item[{std\+::string}]{Nworld\+\_\+filename,  }\item[{std\+::string}]{Fworld\+\_\+filename,  }\item[{const std\+::vector$<$ std\+::vector$<$ double $>$$>$ \&}]{histdetails,  }\item[{int}]{F\+Backup\+Interv,  }\item[{double}]{unitconv,  }\item[{double}]{timestep,  }\item[{unsigned int}]{frequency }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em world} & M\+PI global communicator. \\
\hline
{\em comm} & M\+PI local communicator. \\
\hline
{\em N} & Local CV histogram. \\
\hline
{\em Nworld} & Global CV histogram. \\
\hline
{\em F} & Vector of grids holding local raw generalized force totals per bin per CV. \\
\hline
{\em Fworld} & Vector of grids holding global raw generalized force totals per bin per CV. \\
\hline
{\em restraint} & Minimum, maximum and spring constant for CV restraints. \\
\hline
{\em isperiodic} & Vector of bools that holds whether each CV is periodic or not. \\
\hline
{\em periodicboundaries} & Periodic boundaries of each CV. \\
\hline
{\em min} & Minimum number of hist in a histogram bin before biasing is applied. \\
\hline
{\em massweigh} & Turn mass weighing on/off. \\
\hline
{\em filename} & Name for output file. \\
\hline
{\em Nworld\+\_\+filename} & Name to read/write CV histogram. \\
\hline
{\em Fworld\+\_\+filename} & Name to read/write raw generalized force histograms. \\
\hline
{\em histdetails} & Minimum, maximum and number of bins for each CV. \\
\hline
{\em F\+Backup\+Interv} & Set how often the adaptive force histograms are backed up. \\
\hline
{\em unitconv} & Unit conversion from d(momentum)/d(time) to force. \\
\hline
{\em timestep} & Simulation time step. \\
\hline
{\em frequency} & Frequency with which this method is invoked.\\
\hline
\end{DoxyParams}
Constructs an instance of Adaptive Biasing Force method. \begin{DoxyNote}{Note}
The restraints should be outside of the range defined in histdetails\+\_\+ by at least one bin size on each side. 
\end{DoxyNote}


Definition at line 213 of file A\+B\+F.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{231                                     :}
\DoxyCodeLine{232         \mbox{\hyperlink{classSSAGES_1_1Method_ad751450ecd30e8ab40024c6f5e870d30}{Method}}(frequency, world, comm), \mbox{\hyperlink{classSSAGES_1_1ABF_a45daad9b41bac9009f1c2f09da10f58e}{N\_}}(N), \mbox{\hyperlink{classSSAGES_1_1ABF_ae2306049903c2ed6e6fb07eaee71e9ae}{Nworld\_}}(Nworld), \mbox{\hyperlink{classSSAGES_1_1ABF_a47453516b73e968060821c57d67b44ff}{F\_}}(F), \mbox{\hyperlink{classSSAGES_1_1ABF_a7df76c30aa32223fb74f3fbdb9202706}{Fworld\_}}(Fworld),  \mbox{\hyperlink{classSSAGES_1_1ABF_a7e2b1995149d50d1b1e9d05e6a44c1b6}{restraint\_}}(restraint), \mbox{\hyperlink{classSSAGES_1_1ABF_aa575ad59d0bbaac2709de9c481d4db30}{isperiodic\_}}(isperiodic), \mbox{\hyperlink{classSSAGES_1_1ABF_a85f39957134c0d27298aff5ad306cbd9}{periodicboundaries\_}}(periodicboundaries),}
\DoxyCodeLine{233         \mbox{\hyperlink{classSSAGES_1_1ABF_a88322f13d3424be20d46cf68a3c8ce28}{min\_}}(min), \mbox{\hyperlink{classSSAGES_1_1ABF_a7c882e37a3676cb3e33776621929c3b7}{wdotp1\_}}(), \mbox{\hyperlink{classSSAGES_1_1ABF_a1a0082f17ab10382191cbf39046e7052}{wdotp2\_}}(), \mbox{\hyperlink{classSSAGES_1_1ABF_a0158dff5be22bf287e22aab2eadd4e25}{Fold\_}}(), \mbox{\hyperlink{classSSAGES_1_1ABF_aa792d019aee0f614a2a0935405244e91}{massweigh\_}}(massweigh),}
\DoxyCodeLine{234         \mbox{\hyperlink{classSSAGES_1_1ABF_ae88ce69e6e7fcb15b8db68d5530f6a1e}{biases\_}}(), \mbox{\hyperlink{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}{dim\_}}(0), \mbox{\hyperlink{classSSAGES_1_1ABF_a86e220cdd655537e95b97b97384b506a}{filename\_}}(filename), \mbox{\hyperlink{classSSAGES_1_1ABF_a51e4b0b53add40a74dc4152b402092c6}{Nworld\_filename\_}}(Nworld\_filename), \mbox{\hyperlink{classSSAGES_1_1ABF_afb8eed7ac7b199b96c277991f9ca58e1}{Fworld\_filename\_}}(Fworld\_filename),}
\DoxyCodeLine{235         \mbox{\hyperlink{classSSAGES_1_1ABF_a060acb9e57d66e702de14ff8a5d36ee6}{histdetails\_}}(histdetails), }
\DoxyCodeLine{236         \mbox{\hyperlink{classSSAGES_1_1ABF_acc2ac53b0342d31bce16cce64448830f}{FBackupInterv\_}}(FBackupInterv), \mbox{\hyperlink{classSSAGES_1_1ABF_a012104abf51fd7fe050a31fddc3c7180}{unitconv\_}}(unitconv), \mbox{\hyperlink{classSSAGES_1_1ABF_a2c0bbf27d10f6f773a7215f5df4f78c9}{timestep\_}}(timestep),}
\DoxyCodeLine{237         \mbox{\hyperlink{classSSAGES_1_1ABF_aa420af8834a588aff0f16d344cf7a43e}{iteration\_}}(0)}
\DoxyCodeLine{238         \{}
\DoxyCodeLine{239         \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classSSAGES_1_1ABF_ae223e09cc686522073fd881088edb8ac}\label{classSSAGES_1_1ABF_ae223e09cc686522073fd881088edb8ac}} 
\index{SSAGES::ABF@{SSAGES::ABF}!boundsCheck@{boundsCheck}}
\index{boundsCheck@{boundsCheck}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{boundsCheck()}{boundsCheck()}}
{\footnotesize\ttfamily bool S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::bounds\+Check (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ double $>$ \&}]{C\+Vs }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Checks whether the local walker is within CV bounds. 


\begin{DoxyParams}{Parameters}
{\em C\+Vs} & Current values of C\+Vs. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Whether the walker is in bounds or not. 
\end{DoxyReturn}


Definition at line 284 of file A\+B\+F.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{285     \{}
\DoxyCodeLine{286         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < \mbox{\hyperlink{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}{dim\_}} ; ++i)}
\DoxyCodeLine{287         \{}
\DoxyCodeLine{288             \textcolor{keywordflow}{if}((CVs[i] < \mbox{\hyperlink{classSSAGES_1_1ABF_a45daad9b41bac9009f1c2f09da10f58e}{N\_}}-\/>\mbox{\hyperlink{classSSAGES_1_1GridBase_a2270a9233a9dc2d341e8ab88ce6655c9}{GetLower}}(i)) || (CVs[i] > \mbox{\hyperlink{classSSAGES_1_1ABF_a45daad9b41bac9009f1c2f09da10f58e}{N\_}}-\/>\mbox{\hyperlink{classSSAGES_1_1GridBase_a875feace8fff4743b103147c4193eca0}{GetUpper}}(i)))}
\DoxyCodeLine{289             \{}
\DoxyCodeLine{290                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{291             \}}
\DoxyCodeLine{292         \}}
\DoxyCodeLine{293         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{294     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSSAGES_1_1ABF_aa131b026ddb40941889c8bde7840ac6a}\label{classSSAGES_1_1ABF_aa131b026ddb40941889c8bde7840ac6a}} 
\index{SSAGES::ABF@{SSAGES::ABF}!Build@{Build}}
\index{Build@{Build}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{Build()}{Build()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classSSAGES_1_1ABF}{A\+BF}} $\ast$ S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::\+Build (\begin{DoxyParamCaption}\item[{const Json\+::\+Value \&}]{json,  }\item[{const M\+P\+I\+\_\+\+Comm \&}]{world,  }\item[{const M\+P\+I\+\_\+\+Comm \&}]{comm,  }\item[{const std\+::string \&}]{path }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Build a derived method from \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} node. 


\begin{DoxyParams}{Parameters}
{\em json} & \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} Value containing all input information. \\
\hline
{\em world} & M\+PI global communicator. \\
\hline
{\em comm} & M\+PI local communicator. \\
\hline
{\em path} & Path for \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} path specification. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to the \mbox{\hyperlink{classSSAGES_1_1Method}{Method}} built. nullptr if an unknown error occurred.
\end{DoxyReturn}
This function builds a registered method from a \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} node. The difference between this function and \char`\"{}\+Build\char`\"{} is that this automatically determines the appropriate derived type based on the \mbox{\hyperlink{namespaceJSON}{J\+S\+ON}} node information.

\begin{DoxyNote}{Note}
Object lifetime is the caller\textquotesingle{}s responsibility. 
\end{DoxyNote}


Definition at line 297 of file A\+B\+F.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{301     \{}
\DoxyCodeLine{302         \mbox{\hyperlink{classJson_1_1ObjectRequirement}{ObjectRequirement}} validator;}
\DoxyCodeLine{303         Value schema;}
\DoxyCodeLine{304         CharReaderBuilder rbuilder;}
\DoxyCodeLine{305         CharReader* reader = rbuilder.newCharReader();}
\DoxyCodeLine{306 }
\DoxyCodeLine{307         reader-\/>parse(JsonSchema::ABFMethod.c\_str(),}
\DoxyCodeLine{308                       JsonSchema::ABFMethod.c\_str() + JsonSchema::ABFMethod.size(),}
\DoxyCodeLine{309                       \&schema, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{310         validator.\mbox{\hyperlink{classJson_1_1ObjectRequirement_a4ed02ae1d612a5efba1688fcdd2df092}{Parse}}(schema, path);}
\DoxyCodeLine{311 }
\DoxyCodeLine{312         \textcolor{comment}{// Validate inputs.}}
\DoxyCodeLine{313         validator.\mbox{\hyperlink{classJson_1_1ObjectRequirement_a9ac3b920001a35bc70580035d8d802b7}{Validate}}(json, path);}
\DoxyCodeLine{314         \textcolor{keywordflow}{if}(validator.\mbox{\hyperlink{classJson_1_1Requirement_adfaec336a9f051d6f6b9a6d7f1d97b75}{HasErrors}}())}
\DoxyCodeLine{315             \textcolor{keywordflow}{throw} BuildException(validator.\mbox{\hyperlink{classJson_1_1Requirement_a60bc275c366eb59f192fa2e621268480}{GetErrors}}());}
\DoxyCodeLine{316 }
\DoxyCodeLine{317         \textcolor{comment}{//bool multiwalkerinput = false;}}
\DoxyCodeLine{318 }
\DoxyCodeLine{319         \textcolor{comment}{// Obtain lower bound for each CV.}}
\DoxyCodeLine{320         std::vector<double> minsCV;}
\DoxyCodeLine{321         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& mins : json[\textcolor{stringliteral}{"CV\_lower\_bounds"}])}
\DoxyCodeLine{322             \textcolor{keywordflow}{if}(mins.isArray())}
\DoxyCodeLine{323                 \{}
\DoxyCodeLine{324                 \textcolor{keywordflow}{throw} BuildException(\{\textcolor{stringliteral}{"Separate inputs for multi-\/walker not fully implemented. Please use global entries for CV ranges"}\});}
\DoxyCodeLine{325                 \textcolor{comment}{//multiwalkerinput = true;}}
\DoxyCodeLine{326                 \textcolor{comment}{//for(auto\& bound : mins)}}
\DoxyCodeLine{327                 \textcolor{comment}{//  minsCV.push\_back(bound.asDouble());}}
\DoxyCodeLine{328                 \}}
\DoxyCodeLine{329             \textcolor{keywordflow}{else}}
\DoxyCodeLine{330                 minsCV.push\_back(mins.asDouble());}
\DoxyCodeLine{331             }
\DoxyCodeLine{332         \textcolor{comment}{// Obtain upper bound for each CV.}}
\DoxyCodeLine{333         std::vector<double> maxsCV;}
\DoxyCodeLine{334         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& maxs : json[\textcolor{stringliteral}{"CV\_upper\_bounds"}])}
\DoxyCodeLine{335             \textcolor{comment}{/*if(maxs.isArray())}}
\DoxyCodeLine{336 \textcolor{comment}{                \{}}
\DoxyCodeLine{337 \textcolor{comment}{                for(auto\& bound : maxs)}}
\DoxyCodeLine{338 \textcolor{comment}{                    maxsCV.push\_back(bound.asDouble());}}
\DoxyCodeLine{339 \textcolor{comment}{                \}*/}}
\DoxyCodeLine{340             \textcolor{comment}{//else}}
\DoxyCodeLine{341                 maxsCV.push\_back(maxs.asDouble());}
\DoxyCodeLine{342 }
\DoxyCodeLine{343         \textcolor{comment}{// Obtain number of bins for each CV dimension.}}
\DoxyCodeLine{344         std::vector<int> binsCV;}
\DoxyCodeLine{345         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& bins : json[\textcolor{stringliteral}{"CV\_bins"}])}
\DoxyCodeLine{346             binsCV.push\_back(bins.asInt());}
\DoxyCodeLine{347 }
\DoxyCodeLine{348         \textcolor{comment}{// Obtain lower bounds for restraints for each CV.}}
\DoxyCodeLine{349         std::vector<double> minsrestCV;}
\DoxyCodeLine{350         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& mins : json[\textcolor{stringliteral}{"CV\_restraint\_minimums"}])}
\DoxyCodeLine{351             \textcolor{comment}{/*if(mins.isArray())}}
\DoxyCodeLine{352 \textcolor{comment}{                \{}}
\DoxyCodeLine{353 \textcolor{comment}{                for(auto\& bound : mins)}}
\DoxyCodeLine{354 \textcolor{comment}{                    minsrestCV.push\_back(bound.asDouble());}}
\DoxyCodeLine{355 \textcolor{comment}{                \}*/}}
\DoxyCodeLine{356             \textcolor{comment}{//else}}
\DoxyCodeLine{357                 minsrestCV.push\_back(mins.asDouble());}
\DoxyCodeLine{358 }
\DoxyCodeLine{359         \textcolor{comment}{// Obtain upper bounds for restraints for each CV.      }}
\DoxyCodeLine{360         std::vector<double> maxsrestCV;}
\DoxyCodeLine{361         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& maxs : json[\textcolor{stringliteral}{"CV\_restraint\_maximums"}])}
\DoxyCodeLine{362             \textcolor{comment}{/*if(maxs.isArray())}}
\DoxyCodeLine{363 \textcolor{comment}{                \{}}
\DoxyCodeLine{364 \textcolor{comment}{                for(auto\& bound : maxs)}}
\DoxyCodeLine{365 \textcolor{comment}{                    maxsrestCV.push\_back(bound.asDouble());}}
\DoxyCodeLine{366 \textcolor{comment}{                \}*/}}
\DoxyCodeLine{367             \textcolor{comment}{//else}}
\DoxyCodeLine{368                 maxsrestCV.push\_back(maxs.asDouble());}
\DoxyCodeLine{369         }
\DoxyCodeLine{370         \textcolor{comment}{// Obtain harmonic spring constant for restraints for each CV.}}
\DoxyCodeLine{371         std::vector<double> springkrestCV;}
\DoxyCodeLine{372         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& springkrest : json[\textcolor{stringliteral}{"CV\_restraint\_spring\_constants"}])}
\DoxyCodeLine{373         \{}
\DoxyCodeLine{374             \textcolor{keywordflow}{if}(springkrest.asDouble() < 0)}
\DoxyCodeLine{375             \{}
\DoxyCodeLine{376                 \textcolor{keywordflow}{throw} BuildException(\{\textcolor{stringliteral}{"Restraint spring constants must be non-\/negative."}\});}
\DoxyCodeLine{377             \}}
\DoxyCodeLine{378             springkrestCV.push\_back(springkrest.asDouble());}
\DoxyCodeLine{379         \}}
\DoxyCodeLine{380 }
\DoxyCodeLine{381         \textcolor{comment}{// Obtain periodicity information for restraints for each CV for the purpose of correctly applying restraints through periodic boundaries.}}
\DoxyCodeLine{382         std::vector<bool> isperiodic;}
\DoxyCodeLine{383         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& isperCV : json[\textcolor{stringliteral}{"CV\_isperiodic"}])}
\DoxyCodeLine{384             isperiodic.push\_back(isperCV.asBool());}
\DoxyCodeLine{385         }
\DoxyCodeLine{386         \textcolor{comment}{// Obtain lower periodic boundary for each CV.}}
\DoxyCodeLine{387         std::vector<double> minperboundaryCV;}
\DoxyCodeLine{388         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& minsperCV : json[\textcolor{stringliteral}{"CV\_periodic\_boundary\_lower\_bounds"}])}
\DoxyCodeLine{389             minperboundaryCV.push\_back(minsperCV.asDouble());}
\DoxyCodeLine{390 }
\DoxyCodeLine{391         \textcolor{comment}{// Obtain upper periodic boundary for each CV.}}
\DoxyCodeLine{392         std::vector<double> maxperboundaryCV;}
\DoxyCodeLine{393         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& maxsperCV : json[\textcolor{stringliteral}{"CV\_periodic\_boundary\_upper\_bounds"}])}
\DoxyCodeLine{394             maxperboundaryCV.push\_back(maxsperCV.asDouble());}
\DoxyCodeLine{395 }
\DoxyCodeLine{396         \textcolor{comment}{// Verify inputs are all correct lengths.}}
\DoxyCodeLine{397         \textcolor{keywordflow}{if}(!((   minsCV.size() == maxsCV.size() \&\& }
\DoxyCodeLine{398              maxsCV.size() == minsrestCV.size() \&\&}
\DoxyCodeLine{399              minsrestCV.size() == maxsrestCV.size()) \&\&}
\DoxyCodeLine{400             (binsCV.size() == springkrestCV.size() \&\&}
\DoxyCodeLine{401              springkrestCV.size() == isperiodic.size())))       }
\DoxyCodeLine{402             \textcolor{keywordflow}{throw} BuildException(\{\textcolor{stringliteral}{"CV lower bounds, upper bounds, restrain minimums, restrains maximums must match in size. Bins, spring constants and periodicity info must match in size."}\});}
\DoxyCodeLine{403 }
\DoxyCodeLine{404         \textcolor{comment}{// Verify that all periodicity information is provided if CVs are periodic.}}
\DoxyCodeLine{405         \textcolor{keywordtype}{bool} anyperiodic=\textcolor{keyword}{false};}
\DoxyCodeLine{406         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i<isperiodic.size(); ++i)}
\DoxyCodeLine{407             \textcolor{keywordflow}{if}(isperiodic[i])}
\DoxyCodeLine{408             \{}
\DoxyCodeLine{409                 anyperiodic = \textcolor{keyword}{true};}
\DoxyCodeLine{410                 \textcolor{keywordflow}{if}(!(isperiodic.size() == minperboundaryCV.size() \&\&}
\DoxyCodeLine{411                      minperboundaryCV.size() == maxperboundaryCV.size()))}
\DoxyCodeLine{412                     \textcolor{keywordflow}{throw} BuildException(\{\textcolor{stringliteral}{"If any CV is defined as periodic, please define the full upper and lower bound vectors. They should both have the same number of entries as CV lower bounds, upper bounds... Entries corresponding to non-\/periodic CVs will not be used."}\});}
\DoxyCodeLine{413             \}}
\DoxyCodeLine{414 }
\DoxyCodeLine{415         \textcolor{keywordtype}{size\_t} dim = binsCV.size();}
\DoxyCodeLine{416         }
\DoxyCodeLine{417         \textcolor{comment}{// Read in JSON info.}}
\DoxyCodeLine{418         \textcolor{keyword}{auto} FBackupInterv = json.get(\textcolor{stringliteral}{"output\_frequency"}, 1000).asInt();}
\DoxyCodeLine{419         \textcolor{keyword}{auto} unitconv = json.get(\textcolor{stringliteral}{"unit\_conversion"}, 0).asDouble();}
\DoxyCodeLine{420         \textcolor{keyword}{auto} timestep = json.get(\textcolor{stringliteral}{"timestep"}, 2).asDouble();}
\DoxyCodeLine{421         \textcolor{keyword}{auto} min = json.get(\textcolor{stringliteral}{"minimum\_count"}, 200).asDouble();}
\DoxyCodeLine{422         \textcolor{keyword}{auto} massweigh = json.get(\textcolor{stringliteral}{"mass\_weighing"},\textcolor{keyword}{false}).asBool();          }
\DoxyCodeLine{423 }
\DoxyCodeLine{424         std::vector<std::vector<double>> histdetails;}
\DoxyCodeLine{425         std::vector<std::vector<double>> restraint;}
\DoxyCodeLine{426         std::vector<std::vector<double>> periodicboundaries;}
\DoxyCodeLine{427         std::vector<double> temp1(3);}
\DoxyCodeLine{428         std::vector<double> temp2(3);}
\DoxyCodeLine{429         std::vector<double> temp3(2);}
\DoxyCodeLine{430 }
\DoxyCodeLine{431         \textcolor{keyword}{auto} freq = json.get(\textcolor{stringliteral}{"frequency"}, 1).asInt();}
\DoxyCodeLine{432         \textcolor{keyword}{auto} filename = json.get(\textcolor{stringliteral}{"output\_file"}, \textcolor{stringliteral}{"F\_out"}).asString();}
\DoxyCodeLine{433         \textcolor{keyword}{auto} Nworld\_filename = json.get(\textcolor{stringliteral}{"Nworld\_output\_file"}, \textcolor{stringliteral}{"Nworld"}).asString();}
\DoxyCodeLine{434         \textcolor{keyword}{auto} Fworld\_filename = json.get(\textcolor{stringliteral}{"Fworld\_output\_file"}, \textcolor{stringliteral}{"Fworld\_cv"}).asString();}
\DoxyCodeLine{435 }
\DoxyCodeLine{436         \textcolor{comment}{// Generate the grids based on JSON.}}
\DoxyCodeLine{437         Grid<int> *N;}
\DoxyCodeLine{438         Grid<int> *Nworld;}
\DoxyCodeLine{439         std::vector<Grid<double>*> F(dim);}
\DoxyCodeLine{440         std::vector<Grid<double>*> Fworld(dim);}
\DoxyCodeLine{441 }
\DoxyCodeLine{442         \textcolor{comment}{//unsigned int wid = GetWalkerID(world, comm);}}
\DoxyCodeLine{443 }
\DoxyCodeLine{444         \textcolor{comment}{// This feature is disabled for now.}}
\DoxyCodeLine{445 }
\DoxyCodeLine{446         \textcolor{comment}{/*if(multiwalkerinput)}}
\DoxyCodeLine{447 \textcolor{comment}{        \{}}
\DoxyCodeLine{448 \textcolor{comment}{            for(size\_t i=0; i<dim; ++i)}}
\DoxyCodeLine{449 \textcolor{comment}{            \{}}
\DoxyCodeLine{450 \textcolor{comment}{                temp1 = \{minsCV[i+wid*dim], maxsCV[i+wid*dim], binsCV[i]\};}}
\DoxyCodeLine{451 \textcolor{comment}{                temp2 = \{minsrestCV[i+wid*dim], maxsrestCV[i+wid*dim], springkrestCV[i]\};}}
\DoxyCodeLine{452 \textcolor{comment}{                histdetails.push\_back(temp1);}}
\DoxyCodeLine{453 \textcolor{comment}{                restraint.push\_back(temp2);}}
\DoxyCodeLine{454 \textcolor{comment}{                if(anyperiodic)}}
\DoxyCodeLine{455 \textcolor{comment}{                \{}}
\DoxyCodeLine{456 \textcolor{comment}{                    temp3 = \{minperboundaryCV[i], maxperboundaryCV[i]\};}}
\DoxyCodeLine{457 \textcolor{comment}{                    periodicboundaries.push\_back(temp3);}}
\DoxyCodeLine{458 \textcolor{comment}{                \}}}
\DoxyCodeLine{459 \textcolor{comment}{            \}}}
\DoxyCodeLine{460 \textcolor{comment}{            for(size\_t i=0; i<dim; ++i)}}
\DoxyCodeLine{461 \textcolor{comment}{            \{}}
\DoxyCodeLine{462 \textcolor{comment}{                minsCVperwalker[i] = histdetails[i][0];}}
\DoxyCodeLine{463 \textcolor{comment}{                maxsCVperwalker[i] = histdetails[i][1];}}
\DoxyCodeLine{464 \textcolor{comment}{            \}}}
\DoxyCodeLine{465 \textcolor{comment}{}}
\DoxyCodeLine{466 \textcolor{comment}{            N= new Grid<int>(binsCV, minsCVperwalker, maxsCVperwalker, isperiodic);}}
\DoxyCodeLine{467 \textcolor{comment}{            Nworld= new Grid<int>(binsCV, minsCVperwalker, maxsCVperwalker, isperiodic);}}
\DoxyCodeLine{468 \textcolor{comment}{            }}
\DoxyCodeLine{469 \textcolor{comment}{            for(auto\& grid : F)}}
\DoxyCodeLine{470 \textcolor{comment}{            \{}}
\DoxyCodeLine{471 \textcolor{comment}{                grid= new Grid<double>(binsCV, minsCVperwalker, maxsCVperwalker, isperiodic);}}
\DoxyCodeLine{472 \textcolor{comment}{            \}}}
\DoxyCodeLine{473 \textcolor{comment}{            for(auto\& grid : Fworld)}}
\DoxyCodeLine{474 \textcolor{comment}{            \{}}
\DoxyCodeLine{475 \textcolor{comment}{                grid= new Grid<double>(binsCV, minsCVperwalker, maxsCVperwalker, isperiodic);}}
\DoxyCodeLine{476 \textcolor{comment}{            \}}}
\DoxyCodeLine{477 \textcolor{comment}{            }}
\DoxyCodeLine{478 \textcolor{comment}{        \}}}
\DoxyCodeLine{479 \textcolor{comment}{        */}}
\DoxyCodeLine{480         \textcolor{comment}{//else}}
\DoxyCodeLine{481         \textcolor{comment}{//\{}}
\DoxyCodeLine{482         }
\DoxyCodeLine{483         \textcolor{comment}{// Appropriately size the grids.}}
\DoxyCodeLine{484         }
\DoxyCodeLine{485             N = \textcolor{keyword}{new} Grid<int>(binsCV, minsCV, maxsCV, isperiodic);}
\DoxyCodeLine{486             Nworld = \textcolor{keyword}{new} Grid<int>(binsCV, minsCV, maxsCV, isperiodic);}
\DoxyCodeLine{487             }
\DoxyCodeLine{488             \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& grid : F)}
\DoxyCodeLine{489             \{}
\DoxyCodeLine{490                 grid = \textcolor{keyword}{new} Grid<double>(binsCV, minsCV, maxsCV, isperiodic);}
\DoxyCodeLine{491             \}}
\DoxyCodeLine{492             \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& grid : Fworld)}
\DoxyCodeLine{493             \{}
\DoxyCodeLine{494                 grid = \textcolor{keyword}{new} Grid<double>(binsCV, minsCV, maxsCV, isperiodic);}
\DoxyCodeLine{495             \}}
\DoxyCodeLine{496 }
\DoxyCodeLine{497             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < dim; ++i)}
\DoxyCodeLine{498             \{}
\DoxyCodeLine{499                 temp1 = \{minsCV[i], maxsCV[i], double(binsCV[i])\};}
\DoxyCodeLine{500                 temp2 = \{minsrestCV[i], maxsrestCV[i], springkrestCV[i]\};}
\DoxyCodeLine{501                 histdetails.push\_back(temp1);}
\DoxyCodeLine{502                 restraint.push\_back(temp2);}
\DoxyCodeLine{503                 \textcolor{keywordflow}{if}(anyperiodic)}
\DoxyCodeLine{504                 \{}
\DoxyCodeLine{505                     temp3 = \{minperboundaryCV[i], maxperboundaryCV[i]\};}
\DoxyCodeLine{506                     periodicboundaries.push\_back(temp3);}
\DoxyCodeLine{507                 \}}
\DoxyCodeLine{508             \}}
\DoxyCodeLine{509         \textcolor{comment}{//\}}}
\DoxyCodeLine{510 }
\DoxyCodeLine{511         \textcolor{comment}{// Check if a restart is requested.}}
\DoxyCodeLine{512         \textcolor{keywordtype}{bool} restart = json.get(\textcolor{stringliteral}{"restart"},\textcolor{keyword}{false}).asBool();}
\DoxyCodeLine{513 }
\DoxyCodeLine{514         \textcolor{comment}{// Either load previous grid, or back it up.}}
\DoxyCodeLine{515         \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1EventListener_af9666daacfb047c1dd279ea339524d07}{IsMasterRank}}(world))}
\DoxyCodeLine{516         \{}
\DoxyCodeLine{517             \textcolor{keywordflow}{if}(restart)}
\DoxyCodeLine{518             \{}
\DoxyCodeLine{519                 std::cout << \textcolor{stringliteral}{"Attempting to load data from a previous run of ABF..."} << std::endl;}
\DoxyCodeLine{520                 N-\/>LoadFromFile(Nworld\_filename);}
\DoxyCodeLine{521                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < dim; ++i)}
\DoxyCodeLine{522                 \{}
\DoxyCodeLine{523                     F[i]-\/>LoadFromFile(Fworld\_filename+std::to\_string(i));}
\DoxyCodeLine{524                 \}}
\DoxyCodeLine{525             \}}
\DoxyCodeLine{526             \textcolor{keywordflow}{else}}
\DoxyCodeLine{527             \{}
\DoxyCodeLine{528                 std::ifstream Nworldbackupsource(Nworld\_filename, std::ios::binary);}
\DoxyCodeLine{529                 \textcolor{keywordflow}{if}(Nworldbackupsource)}
\DoxyCodeLine{530                 \{}
\DoxyCodeLine{531                     std::cout << \textcolor{stringliteral}{"Backing up previous copy of Nworld."} << std::endl;}
\DoxyCodeLine{532                     std::ofstream Nworldbackuptarget(Nworld\_filename+\textcolor{stringliteral}{"\_backup"}, std::ios::binary);}
\DoxyCodeLine{533                     Nworldbackuptarget << Nworldbackupsource.rdbuf();}
\DoxyCodeLine{534                 \}}
\DoxyCodeLine{535                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < dim; ++i)}
\DoxyCodeLine{536                 \{}
\DoxyCodeLine{537                     std::ifstream Fworldbackupsource(Fworld\_filename+std::to\_string(i), std::ios::binary);}
\DoxyCodeLine{538                     \textcolor{keywordflow}{if}(Fworldbackupsource)}
\DoxyCodeLine{539                     \{}
\DoxyCodeLine{540                         std::cout << \textcolor{stringliteral}{"Backing up previous copy of Fworld\_cv"}+std::to\_string(i)+\textcolor{stringliteral}{"."} << std::endl;}
\DoxyCodeLine{541                         std::ofstream Fworldbackuptarget(Fworld\_filename+std::to\_string(i)+\textcolor{stringliteral}{"\_backup"}, std::ios::binary);}
\DoxyCodeLine{542                         Fworldbackuptarget << Fworldbackupsource.rdbuf();}
\DoxyCodeLine{543                     \}}
\DoxyCodeLine{544                 \}}
\DoxyCodeLine{545             \}}
\DoxyCodeLine{546         \}}
\DoxyCodeLine{547 }
\DoxyCodeLine{548         \textcolor{keyword}{auto}* m = \textcolor{keyword}{new} \mbox{\hyperlink{classSSAGES_1_1ABF_a7071f09b2810b388ff6eabdc49fab005}{ABF}}(world, comm, N, Nworld, F, Fworld, restraint, isperiodic, periodicboundaries, min, massweigh, filename, Nworld\_filename, Fworld\_filename, histdetails, FBackupInterv, unitconv, timestep, freq);}
\DoxyCodeLine{549 }
\DoxyCodeLine{550         \textcolor{keywordflow}{if}(json.isMember(\textcolor{stringliteral}{"iteration"}))}
\DoxyCodeLine{551             m-\/>SetIteration(json.get(\textcolor{stringliteral}{"iteration"},0).asInt());}
\DoxyCodeLine{552 }
\DoxyCodeLine{553         \textcolor{keywordflow}{return} m;}
\DoxyCodeLine{554 }
\DoxyCodeLine{555     \}}

\end{DoxyCode}


References Json\+::\+Requirement\+::\+Get\+Errors(), Json\+::\+Requirement\+::\+Has\+Errors(), S\+S\+A\+G\+E\+S\+::\+Grid$<$ T $>$\+::\+Load\+From\+File(), Json\+::\+Object\+Requirement\+::\+Parse(), and Json\+::\+Object\+Requirement\+::\+Validate().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1ABF_aa131b026ddb40941889c8bde7840ac6a_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1ABF_aa2200677359f582d73f095c42ec5ad83}\label{classSSAGES_1_1ABF_aa2200677359f582d73f095c42ec5ad83}} 
\index{SSAGES::ABF@{SSAGES::ABF}!CalcBiasForce@{CalcBiasForce}}
\index{CalcBiasForce@{CalcBiasForce}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{CalcBiasForce()}{CalcBiasForce()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::\+Calc\+Bias\+Force (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$}]{snapshot,  }\item[{const \mbox{\hyperlink{namespaceSSAGES_acddea47426ac0a643b048f870ddd2907}{C\+V\+List}} \&}]{cvs,  }\item[{const std\+::vector$<$ double $>$ \&}]{cv\+Vals }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Computes the bias force. 


\begin{DoxyParams}{Parameters}
{\em snapshot} & Current simulation snapshot. \\
\hline
{\em cvs} & Details of C\+Vs. \\
\hline
{\em cv\+Vals} & Current values of C\+Vs. \\
\hline
\end{DoxyParams}


Definition at line 176 of file A\+B\+F.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{177     \{}
\DoxyCodeLine{178         \textcolor{comment}{// Reset the bias.}}
\DoxyCodeLine{179         \mbox{\hyperlink{classSSAGES_1_1ABF_ae88ce69e6e7fcb15b8db68d5530f6a1e}{biases\_}}.resize(snapshot-\/>GetNumAtoms(), \mbox{\hyperlink{namespaceSSAGES_a630084a0a5e185e89e21b3735f8f8b2e}{Vector3}}\{0,0,0\});}
\DoxyCodeLine{180         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\& b : \mbox{\hyperlink{classSSAGES_1_1ABF_ae88ce69e6e7fcb15b8db68d5530f6a1e}{biases\_}})}
\DoxyCodeLine{181             b.setZero();}
\DoxyCodeLine{182         }
\DoxyCodeLine{183         \textcolor{comment}{// Compute bias if within bounds.}}
\DoxyCodeLine{184         \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1ABF_ae223e09cc686522073fd881088edb8ac}{boundsCheck}}(cvVals))}
\DoxyCodeLine{185         \{}
\DoxyCodeLine{186             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < \mbox{\hyperlink{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}{dim\_}}; ++i)}
\DoxyCodeLine{187             \{}
\DoxyCodeLine{188                 \textcolor{keyword}{auto}\& grad = cvs[i]-\/>GetGradient();}
\DoxyCodeLine{189                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < \mbox{\hyperlink{classSSAGES_1_1ABF_ae88ce69e6e7fcb15b8db68d5530f6a1e}{biases\_}}.size(); ++j)}
\DoxyCodeLine{190                     \mbox{\hyperlink{classSSAGES_1_1ABF_ae88ce69e6e7fcb15b8db68d5530f6a1e}{biases\_}}[j] -\/= (\mbox{\hyperlink{classSSAGES_1_1ABF_a7df76c30aa32223fb74f3fbdb9202706}{Fworld\_}}[i]-\/>at(cvVals))*grad[j]/std::max(\mbox{\hyperlink{classSSAGES_1_1ABF_a88322f13d3424be20d46cf68a3c8ce28}{min\_}},\mbox{\hyperlink{classSSAGES_1_1ABF_ae2306049903c2ed6e6fb07eaee71e9ae}{Nworld\_}}-\/>\mbox{\hyperlink{classSSAGES_1_1GridBase_a7da01557a9b85498c2acd975c152403a}{at}}(cvVals));}
\DoxyCodeLine{191             \}}
\DoxyCodeLine{192         \}}
\DoxyCodeLine{193         \textcolor{comment}{// Otherwise, apply harmonic restraint if enabled.}}
\DoxyCodeLine{194         \textcolor{keywordflow}{else}}
\DoxyCodeLine{195         \{}
\DoxyCodeLine{196             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < \mbox{\hyperlink{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}{dim\_}}; ++i)}
\DoxyCodeLine{197             \{}
\DoxyCodeLine{198                 \textcolor{keywordtype}{double} cvVal = cvs[i]-\/>GetValue();}
\DoxyCodeLine{199                 \textcolor{keyword}{auto} k = 0.;}
\DoxyCodeLine{200                 \textcolor{keyword}{auto} x0 = 0.;}
\DoxyCodeLine{201                 }
\DoxyCodeLine{202                 \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1ABF_aa575ad59d0bbaac2709de9c481d4db30}{isperiodic\_}}[i])}
\DoxyCodeLine{203                 \{}
\DoxyCodeLine{204                     \textcolor{keywordtype}{double} periodsize = \mbox{\hyperlink{classSSAGES_1_1ABF_a85f39957134c0d27298aff5ad306cbd9}{periodicboundaries\_}}[i][1]-\/\mbox{\hyperlink{classSSAGES_1_1ABF_a85f39957134c0d27298aff5ad306cbd9}{periodicboundaries\_}}[i][0];}
\DoxyCodeLine{205                     \textcolor{keywordtype}{double} cvRestrMidpoint = (\mbox{\hyperlink{classSSAGES_1_1ABF_a7e2b1995149d50d1b1e9d05e6a44c1b6}{restraint\_}}[i][1]+\mbox{\hyperlink{classSSAGES_1_1ABF_a7e2b1995149d50d1b1e9d05e6a44c1b6}{restraint\_}}[i][0])/2;}
\DoxyCodeLine{206                     \textcolor{keywordflow}{while}((cvVal-\/cvRestrMidpoint) > periodsize/2)}
\DoxyCodeLine{207                         cvVal -\/= periodsize;}
\DoxyCodeLine{208                     \textcolor{keywordflow}{while}((cvVal-\/cvRestrMidpoint) < -\/periodsize/2)}
\DoxyCodeLine{209                         cvVal += periodsize;}
\DoxyCodeLine{210                 \}}
\DoxyCodeLine{211 }
\DoxyCodeLine{212                 \textcolor{keywordflow}{if}(cvVal < \mbox{\hyperlink{classSSAGES_1_1ABF_a7e2b1995149d50d1b1e9d05e6a44c1b6}{restraint\_}}[i][0])}
\DoxyCodeLine{213                 \{}
\DoxyCodeLine{214                     k = \mbox{\hyperlink{classSSAGES_1_1ABF_a7e2b1995149d50d1b1e9d05e6a44c1b6}{restraint\_}}[i][2];}
\DoxyCodeLine{215                     x0 = \mbox{\hyperlink{classSSAGES_1_1ABF_a7e2b1995149d50d1b1e9d05e6a44c1b6}{restraint\_}}[i][0];}
\DoxyCodeLine{216                 \}}
\DoxyCodeLine{217                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (cvVal > \mbox{\hyperlink{classSSAGES_1_1ABF_a7e2b1995149d50d1b1e9d05e6a44c1b6}{restraint\_}}[i][1])}
\DoxyCodeLine{218                 \{}
\DoxyCodeLine{219                     k = \mbox{\hyperlink{classSSAGES_1_1ABF_a7e2b1995149d50d1b1e9d05e6a44c1b6}{restraint\_}}[i][2];}
\DoxyCodeLine{220                     x0 = \mbox{\hyperlink{classSSAGES_1_1ABF_a7e2b1995149d50d1b1e9d05e6a44c1b6}{restraint\_}}[i][1];}
\DoxyCodeLine{221                 \}}
\DoxyCodeLine{222 }
\DoxyCodeLine{223                 \textcolor{keyword}{auto}\& grad = cvs[i]-\/>GetGradient();}
\DoxyCodeLine{224                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < \mbox{\hyperlink{classSSAGES_1_1ABF_ae88ce69e6e7fcb15b8db68d5530f6a1e}{biases\_}}.size(); ++j)}
\DoxyCodeLine{225                     \mbox{\hyperlink{classSSAGES_1_1ABF_ae88ce69e6e7fcb15b8db68d5530f6a1e}{biases\_}}[j] -\/= (cvVal -\/ x0)*k*grad[j];}
\DoxyCodeLine{226             \}   }
\DoxyCodeLine{227         \}}
\DoxyCodeLine{228     \}}

\end{DoxyCode}


References S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Num\+Atoms().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1ABF_aa2200677359f582d73f095c42ec5ad83_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1ABF_ad2007ce8bb539072a97d4d02d268c638}\label{classSSAGES_1_1ABF_ad2007ce8bb539072a97d4d02d268c638}} 
\index{SSAGES::ABF@{SSAGES::ABF}!PostIntegration@{PostIntegration}}
\index{PostIntegration@{PostIntegration}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{PostIntegration()}{PostIntegration()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::\+Post\+Integration (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$}]{snapshot,  }\item[{const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&}]{cvmanager }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



\mbox{\hyperlink{classSSAGES_1_1Method}{Method}} call post integration. 

Post-\/integration hook.


\begin{DoxyParams}{Parameters}
{\em snapshot} & Pointer to the simulation snapshot. \\
\hline
{\em cvmanager} & Collective variable manager.\\
\hline
\end{DoxyParams}
This function will be called after each integration step.

Post-\/integration hook is where processes carried out every timestep happen. First, information from current snapshot is retrieved and stored in variables as necessary. Then, coordinates in CV space are determined. Then, for each CV, the time derivative of w.\+p is calculated. Then, information is printed out if its enabled. Finally, bias is applied from current estimate of generalized force. Coord holds where we are in CV space in current timestep.

Eigen\+::\+Matrix\+Xd to hold the CV gradient.

std\+::vector$<$double$>$ to hold CV values to address grid.

Implements \mbox{\hyperlink{classSSAGES_1_1Method_af2f33dfaa758c5cd505477f4767fb339}{S\+S\+A\+G\+E\+S\+::\+Method}}.



Definition at line 72 of file A\+B\+F.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{73     \{}
\DoxyCodeLine{74         }
\DoxyCodeLine{75         ++\mbox{\hyperlink{classSSAGES_1_1ABF_aa420af8834a588aff0f16d344cf7a43e}{iteration\_}};}
\DoxyCodeLine{76 }
\DoxyCodeLine{77         \textcolor{comment}{// Gather information.}}
\DoxyCodeLine{78         \textcolor{keyword}{auto} cvs = cvmanager.GetCVs(\mbox{\hyperlink{classSSAGES_1_1Method_a24b0ac53b1fabcab0a5f3bd6cde26909}{cvmask\_}});}
\DoxyCodeLine{79         \textcolor{keyword}{auto}\& vels = snapshot-\/>GetVelocities();}
\DoxyCodeLine{80         \textcolor{keyword}{auto}\& mass = snapshot-\/>GetMasses();}
\DoxyCodeLine{81         \textcolor{keyword}{auto}\& forces = snapshot-\/>GetForces();}
\DoxyCodeLine{82         \textcolor{keyword}{auto} n = snapshot-\/>GetNumAtoms();}
\DoxyCodeLine{83         }
\DoxyCodeLine{84 }
\DoxyCodeLine{86         \textcolor{comment}{//int coord = histCoords(cvs);}}
\DoxyCodeLine{87 }
\DoxyCodeLine{89         Eigen::MatrixXd J(\mbox{\hyperlink{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}{dim\_}}, 3*n);}
\DoxyCodeLine{90         }
\DoxyCodeLine{92         std::vector<double> cvVals(\mbox{\hyperlink{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}{dim\_}});}
\DoxyCodeLine{93 }
\DoxyCodeLine{94         \textcolor{comment}{// Fill J and CV. Each column represents grad(CV) with flattened Cartesian elements. }}
\DoxyCodeLine{95         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < \mbox{\hyperlink{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}{dim\_}}; ++i)}
\DoxyCodeLine{96         \{}
\DoxyCodeLine{97             \textcolor{keyword}{auto}\& grad = cvs[i]-\/>GetGradient();}
\DoxyCodeLine{98             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < n; ++j)}
\DoxyCodeLine{99                 J.block<1, 3>(i,3*j) = grad[j];}
\DoxyCodeLine{100             cvVals[i] = cvs[i]-\/>GetValue();}
\DoxyCodeLine{101         \}}
\DoxyCodeLine{102 }
\DoxyCodeLine{103         \textcolor{comment}{//* Calculate W using Darve's approach (http://mc.stanford.edu/cgi-\/bin/images/0/06/Darve\_2008.pdf).}}
\DoxyCodeLine{104         Eigen::MatrixXd Jmass = J.transpose();}
\DoxyCodeLine{105         \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1ABF_aa792d019aee0f614a2a0935405244e91}{massweigh\_}})}
\DoxyCodeLine{106         \{}
\DoxyCodeLine{107             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < forces.size(); ++i)}
\DoxyCodeLine{108                 Jmass.block(3*i, 0, 3, \mbox{\hyperlink{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}{dim\_}}) = Jmass.block(3*i, 0, 3, \mbox{\hyperlink{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}{dim\_}})/mass[i];}
\DoxyCodeLine{109         \}}
\DoxyCodeLine{110 }
\DoxyCodeLine{111         Eigen::MatrixXd Minv = J*Jmass;}
\DoxyCodeLine{112         MPI\_Allreduce(MPI\_IN\_PLACE, Minv.data(), Minv.size(), MPI\_DOUBLE, MPI\_SUM, \mbox{\hyperlink{classSSAGES_1_1Method_a1118666d61dbf3bc7606e3b61aa3a460}{comm\_}});}
\DoxyCodeLine{113         Eigen::MatrixXd Wt = Minv.inverse()*Jmass.transpose();  }
\DoxyCodeLine{114         \textcolor{comment}{// Fill momenta.}}
\DoxyCodeLine{115         Eigen::VectorXd momenta(3*vels.size());}
\DoxyCodeLine{116         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < vels.size(); ++i)}
\DoxyCodeLine{117             momenta.segment<3>(3*i) = mass[i]*vels[i];}
\DoxyCodeLine{118         }
\DoxyCodeLine{119         \textcolor{comment}{// Compute dot(w,p)}}
\DoxyCodeLine{120         Eigen::VectorXd wdotp = Wt*momenta;}
\DoxyCodeLine{121 }
\DoxyCodeLine{122         }
\DoxyCodeLine{123         \textcolor{comment}{// Reduce dot product across processors.}}
\DoxyCodeLine{124         MPI\_Allreduce(MPI\_IN\_PLACE, wdotp.data(), wdotp.size(), MPI\_DOUBLE, MPI\_SUM, \mbox{\hyperlink{classSSAGES_1_1Method_a1118666d61dbf3bc7606e3b61aa3a460}{comm\_}});}
\DoxyCodeLine{125         }
\DoxyCodeLine{126     }
\DoxyCodeLine{127         \textcolor{comment}{// Compute d(wdotp)/dt second order backwards finite difference. }}
\DoxyCodeLine{128         \textcolor{comment}{// Adding old force removes bias. }}
\DoxyCodeLine{129         Eigen::VectorXd dwdotpdt = \mbox{\hyperlink{classSSAGES_1_1ABF_a012104abf51fd7fe050a31fddc3c7180}{unitconv\_}}*(1.5*wdotp -\/ 2.0*\mbox{\hyperlink{classSSAGES_1_1ABF_a7c882e37a3676cb3e33776621929c3b7}{wdotp1\_}} + 0.5*\mbox{\hyperlink{classSSAGES_1_1ABF_a1a0082f17ab10382191cbf39046e7052}{wdotp2\_}})/\mbox{\hyperlink{classSSAGES_1_1ABF_a2c0bbf27d10f6f773a7215f5df4f78c9}{timestep\_}} + \mbox{\hyperlink{classSSAGES_1_1ABF_a0158dff5be22bf287e22aab2eadd4e25}{Fold\_}};}
\DoxyCodeLine{130 }
\DoxyCodeLine{131         \textcolor{comment}{// If we are in bounds, sum force into running total.}}
\DoxyCodeLine{132         \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1ABF_ae223e09cc686522073fd881088edb8ac}{boundsCheck}}(cvVals) \&\& \mbox{\hyperlink{classSSAGES_1_1EventListener_af9666daacfb047c1dd279ea339524d07}{IsMasterRank}}(\mbox{\hyperlink{classSSAGES_1_1Method_a1118666d61dbf3bc7606e3b61aa3a460}{comm\_}}))}
\DoxyCodeLine{133         \{}
\DoxyCodeLine{134             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < \mbox{\hyperlink{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}{dim\_}}; ++i)}
\DoxyCodeLine{135                 \mbox{\hyperlink{classSSAGES_1_1ABF_a47453516b73e968060821c57d67b44ff}{F\_}}[i]-\/>at(cvVals) += dwdotpdt[i];}
\DoxyCodeLine{136             \mbox{\hyperlink{classSSAGES_1_1ABF_a45daad9b41bac9009f1c2f09da10f58e}{N\_}}-\/>\mbox{\hyperlink{classSSAGES_1_1GridBase_a7da01557a9b85498c2acd975c152403a}{at}}(cvVals)++;               }
\DoxyCodeLine{137         \}}
\DoxyCodeLine{138         }
\DoxyCodeLine{139         \textcolor{comment}{// Reduce data across processors.}}
\DoxyCodeLine{140         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < \mbox{\hyperlink{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}{dim\_}}; ++i)                }
\DoxyCodeLine{141             MPI\_Allreduce(\mbox{\hyperlink{classSSAGES_1_1ABF_a47453516b73e968060821c57d67b44ff}{F\_}}[i]-\/>data(), \mbox{\hyperlink{classSSAGES_1_1ABF_a7df76c30aa32223fb74f3fbdb9202706}{Fworld\_}}[i]-\/>data(), (\mbox{\hyperlink{classSSAGES_1_1ABF_a47453516b73e968060821c57d67b44ff}{F\_}}[i]-\/>size()), MPI\_DOUBLE, MPI\_SUM, \mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}});    }
\DoxyCodeLine{142         MPI\_Allreduce(\mbox{\hyperlink{classSSAGES_1_1ABF_a45daad9b41bac9009f1c2f09da10f58e}{N\_}}-\/>\mbox{\hyperlink{classSSAGES_1_1GridBase_a52e519b13f9b53c0767957d86015b0a1}{data}}(), \mbox{\hyperlink{classSSAGES_1_1ABF_ae2306049903c2ed6e6fb07eaee71e9ae}{Nworld\_}}-\/>\mbox{\hyperlink{classSSAGES_1_1GridBase_a52e519b13f9b53c0767957d86015b0a1}{data}}(), \mbox{\hyperlink{classSSAGES_1_1ABF_a45daad9b41bac9009f1c2f09da10f58e}{N\_}}-\/>\mbox{\hyperlink{classSSAGES_1_1GridBase_a4f8abb752ae6ec51ebcf24b599bf4896}{size}}(), MPI\_INT, MPI\_SUM, \mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}});}
\DoxyCodeLine{143 }
\DoxyCodeLine{144         \textcolor{comment}{// If we are in bounds, store the old summed force.}}
\DoxyCodeLine{145         \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1ABF_ae223e09cc686522073fd881088edb8ac}{boundsCheck}}(cvVals))}
\DoxyCodeLine{146         \{}
\DoxyCodeLine{147             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i < \mbox{\hyperlink{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}{dim\_}}; ++i)}
\DoxyCodeLine{148                 \mbox{\hyperlink{classSSAGES_1_1ABF_a0158dff5be22bf287e22aab2eadd4e25}{Fold\_}}[i] = \mbox{\hyperlink{classSSAGES_1_1ABF_a7df76c30aa32223fb74f3fbdb9202706}{Fworld\_}}[i]-\/>at(cvVals)/std::max(\mbox{\hyperlink{classSSAGES_1_1ABF_a88322f13d3424be20d46cf68a3c8ce28}{min\_}}, \mbox{\hyperlink{classSSAGES_1_1ABF_ae2306049903c2ed6e6fb07eaee71e9ae}{Nworld\_}}-\/>\mbox{\hyperlink{classSSAGES_1_1GridBase_a7da01557a9b85498c2acd975c152403a}{at}}(cvVals));}
\DoxyCodeLine{149         \}}
\DoxyCodeLine{150     }
\DoxyCodeLine{151         \textcolor{comment}{// Update finite difference time derivatives.}}
\DoxyCodeLine{152         \mbox{\hyperlink{classSSAGES_1_1ABF_a1a0082f17ab10382191cbf39046e7052}{wdotp2\_}} = \mbox{\hyperlink{classSSAGES_1_1ABF_a7c882e37a3676cb3e33776621929c3b7}{wdotp1\_}};}
\DoxyCodeLine{153         \mbox{\hyperlink{classSSAGES_1_1ABF_a7c882e37a3676cb3e33776621929c3b7}{wdotp1\_}} = wdotp;     }
\DoxyCodeLine{154 }
\DoxyCodeLine{155         \textcolor{comment}{// Write out data to file.}}
\DoxyCodeLine{156         \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1ABF_aa420af8834a588aff0f16d344cf7a43e}{iteration\_}} \% \mbox{\hyperlink{classSSAGES_1_1ABF_acc2ac53b0342d31bce16cce64448830f}{FBackupInterv\_}} == 0)\{}
\DoxyCodeLine{157             \mbox{\hyperlink{classSSAGES_1_1ABF_ab63434a1cefe80372e2555e1128e39d2}{WriteData}}();}
\DoxyCodeLine{158         \}}
\DoxyCodeLine{159 }
\DoxyCodeLine{160         \textcolor{comment}{// Calculate the bias from averaged F at current CV coordinates.}}
\DoxyCodeLine{161         \textcolor{comment}{// Or apply harmonic restraints to return CVs back in bounds.}}
\DoxyCodeLine{162         \mbox{\hyperlink{classSSAGES_1_1ABF_aa2200677359f582d73f095c42ec5ad83}{CalcBiasForce}}(snapshot, cvs, cvVals);      }
\DoxyCodeLine{163 }
\DoxyCodeLine{164         \textcolor{comment}{// Update the forces in snapshot by adding in the force bias from each}}
\DoxyCodeLine{165         \textcolor{comment}{// CV to each atom based on the gradient of the CV.}}
\DoxyCodeLine{166         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} j = 0; j < forces.size(); ++j)}
\DoxyCodeLine{167             forces[j] += \mbox{\hyperlink{classSSAGES_1_1ABF_ae88ce69e6e7fcb15b8db68d5530f6a1e}{biases\_}}[j]; }
\DoxyCodeLine{168     \}}

\end{DoxyCode}


References S\+S\+A\+G\+E\+S\+::\+C\+V\+Manager\+::\+Get\+C\+Vs(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Forces(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Masses(), S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Num\+Atoms(), and S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Velocities().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1ABF_ad2007ce8bb539072a97d4d02d268c638_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1ABF_a02fae49d009dcf405d82144a2d123faa}\label{classSSAGES_1_1ABF_a02fae49d009dcf405d82144a2d123faa}} 
\index{SSAGES::ABF@{SSAGES::ABF}!PostSimulation@{PostSimulation}}
\index{PostSimulation@{PostSimulation}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{PostSimulation()}{PostSimulation()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::\+Post\+Simulation (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$}]{snapshot,  }\item[{const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&}]{cvmanager }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



\mbox{\hyperlink{classSSAGES_1_1Method}{Method}} call prior to simulation initiation. 


\begin{DoxyParams}{Parameters}
{\em snapshot} & Pointer to the simulation snapshot. \\
\hline
{\em cvmanager} & Collective variable manager.\\
\hline
\end{DoxyParams}
This function will be called before the simulation is started. 

Implements \mbox{\hyperlink{classSSAGES_1_1Method_a7d18226669c88bc76b9b758f2d29e3c9}{S\+S\+A\+G\+E\+S\+::\+Method}}.



Definition at line 171 of file A\+B\+F.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{172     \{}
\DoxyCodeLine{173         \mbox{\hyperlink{classSSAGES_1_1ABF_ab63434a1cefe80372e2555e1128e39d2}{WriteData}}();}
\DoxyCodeLine{174     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSSAGES_1_1ABF_a27d1b2f056d32066d7c62a037836948c}\label{classSSAGES_1_1ABF_a27d1b2f056d32066d7c62a037836948c}} 
\index{SSAGES::ABF@{SSAGES::ABF}!PreSimulation@{PreSimulation}}
\index{PreSimulation@{PreSimulation}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{PreSimulation()}{PreSimulation()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::\+Pre\+Simulation (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classSSAGES_1_1Snapshot}{Snapshot}} $\ast$}]{snapshot,  }\item[{const class \mbox{\hyperlink{classSSAGES_1_1CVManager}{C\+V\+Manager}} \&}]{cvmanager }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



\mbox{\hyperlink{classSSAGES_1_1Method}{Method}} call prior to simulation initiation. 


\begin{DoxyParams}{Parameters}
{\em snapshot} & Pointer to the simulation snapshot. \\
\hline
{\em cvmanager} & Collective variable manager.\\
\hline
\end{DoxyParams}
This function will be called before the simulation is started. 

Implements \mbox{\hyperlink{classSSAGES_1_1Method_a7d840d2b5f6dbf9ec75a7909ccf13ef7}{S\+S\+A\+G\+E\+S\+::\+Method}}.



Definition at line 39 of file A\+B\+F.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{40     \{}
\DoxyCodeLine{41         \textcolor{comment}{// Open/close outfile to create it fresh. }}
\DoxyCodeLine{42         \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSSAGES_1_1EventListener_af9666daacfb047c1dd279ea339524d07}{IsMasterRank}}(\mbox{\hyperlink{classSSAGES_1_1Method_a8471b11097a1018a9635bc578bf22f61}{world\_}}))}
\DoxyCodeLine{43         \{}
\DoxyCodeLine{44             \mbox{\hyperlink{classSSAGES_1_1ABF_a528906f35295ab1a4bf7ed638fbd1973}{worldout\_}}.open(\mbox{\hyperlink{classSSAGES_1_1ABF_a86e220cdd655537e95b97b97384b506a}{filename\_}});}
\DoxyCodeLine{45             \mbox{\hyperlink{classSSAGES_1_1ABF_a528906f35295ab1a4bf7ed638fbd1973}{worldout\_}}.close();}
\DoxyCodeLine{46         \}}
\DoxyCodeLine{47         }
\DoxyCodeLine{48         \textcolor{comment}{// Convenience. Number of CVs.}}
\DoxyCodeLine{49         \textcolor{keyword}{auto} cvs = cvmanager.GetCVs(\mbox{\hyperlink{classSSAGES_1_1Method_a24b0ac53b1fabcab0a5f3bd6cde26909}{cvmask\_}});}
\DoxyCodeLine{50         \mbox{\hyperlink{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}{dim\_}} = cvs.size();}
\DoxyCodeLine{51 }
\DoxyCodeLine{52         \textcolor{comment}{// Size and initialize Fold\_}}
\DoxyCodeLine{53         \mbox{\hyperlink{classSSAGES_1_1ABF_a0158dff5be22bf287e22aab2eadd4e25}{Fold\_}}.setZero(\mbox{\hyperlink{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}{dim\_}});}
\DoxyCodeLine{54 }
\DoxyCodeLine{55         \textcolor{comment}{// Initialize biases.}}
\DoxyCodeLine{56         \mbox{\hyperlink{classSSAGES_1_1ABF_ae88ce69e6e7fcb15b8db68d5530f6a1e}{biases\_}}.resize(snapshot-\/>GetPositions().size(), \mbox{\hyperlink{namespaceSSAGES_a630084a0a5e185e89e21b3735f8f8b2e}{Vector3}}\{0, 0, 0\});}
\DoxyCodeLine{57         }
\DoxyCodeLine{58         \textcolor{comment}{// Initialize w \(\backslash\)dot p's for finite difference. }}
\DoxyCodeLine{59         \mbox{\hyperlink{classSSAGES_1_1ABF_a7c882e37a3676cb3e33776621929c3b7}{wdotp1\_}}.setZero(\mbox{\hyperlink{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}{dim\_}});}
\DoxyCodeLine{60         \mbox{\hyperlink{classSSAGES_1_1ABF_a1a0082f17ab10382191cbf39046e7052}{wdotp2\_}}.setZero(\mbox{\hyperlink{classSSAGES_1_1ABF_a9f9514efb13e9a86b4557ae081274ce1}{dim\_}});   }
\DoxyCodeLine{61     \}}

\end{DoxyCode}


References S\+S\+A\+G\+E\+S\+::\+C\+V\+Manager\+::\+Get\+C\+Vs(), and S\+S\+A\+G\+E\+S\+::\+Snapshot\+::\+Get\+Positions().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSSAGES_1_1ABF_a27d1b2f056d32066d7c62a037836948c_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classSSAGES_1_1ABF_ac206ccf90c29d11d6abdebeae44b033f}\label{classSSAGES_1_1ABF_ac206ccf90c29d11d6abdebeae44b033f}} 
\index{SSAGES::ABF@{SSAGES::ABF}!SetIteration@{SetIteration}}
\index{SetIteration@{SetIteration}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{SetIteration()}{SetIteration()}}
{\footnotesize\ttfamily void S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::\+Set\+Iteration (\begin{DoxyParamCaption}\item[{const int}]{iter }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set iteration of the method. 


\begin{DoxyParams}{Parameters}
{\em iter} & New value for the iteration counter. \\
\hline
\end{DoxyParams}


Definition at line 254 of file A\+B\+F.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{255         \{}
\DoxyCodeLine{256             \mbox{\hyperlink{classSSAGES_1_1ABF_aa420af8834a588aff0f16d344cf7a43e}{iteration\_}} = iter;}
\DoxyCodeLine{257         \}}

\end{DoxyCode}


References iteration\+\_\+.



\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classSSAGES_1_1ABF_a47453516b73e968060821c57d67b44ff}\label{classSSAGES_1_1ABF_a47453516b73e968060821c57d67b44ff}} 
\index{SSAGES::ABF@{SSAGES::ABF}!F\_@{F\_}}
\index{F\_@{F\_}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{F\_}{F\_}}
{\footnotesize\ttfamily std\+::vector$<$\mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$double$>$$\ast$$>$ S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::\+F\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



To store running total of the local walker. 

This is a grid that holds d\+F/d\+C\+Vx where x is one of the C\+Vs. For N C\+Vs, there will be N grids, and thus this vector will be N long. 

Definition at line 62 of file A\+B\+F.\+h.

\mbox{\Hypertarget{classSSAGES_1_1ABF_acc2ac53b0342d31bce16cce64448830f}\label{classSSAGES_1_1ABF_acc2ac53b0342d31bce16cce64448830f}} 
\index{SSAGES::ABF@{SSAGES::ABF}!FBackupInterv\_@{FBackupInterv\_}}
\index{FBackupInterv\_@{FBackupInterv\_}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{FBackupInterv\_}{FBackupInterv\_}}
{\footnotesize\ttfamily int S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::\+F\+Backup\+Interv\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Integer to hold F estimate backup information. 

Print every how many timesteps? ; -\/1\+: Do not backup during simulation 

Definition at line 146 of file A\+B\+F.\+h.

\mbox{\Hypertarget{classSSAGES_1_1ABF_a86e220cdd655537e95b97b97384b506a}\label{classSSAGES_1_1ABF_a86e220cdd655537e95b97b97384b506a}} 
\index{SSAGES::ABF@{SSAGES::ABF}!filename\_@{filename\_}}
\index{filename\_@{filename\_}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{filename\_}{filename\_}}
{\footnotesize\ttfamily std\+::string S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::filename\+\_\+\hspace{0.3cm}{\ttfamily [private]}}

File name for world data. Principal output of the method. 

Definition at line 123 of file A\+B\+F.\+h.

\mbox{\Hypertarget{classSSAGES_1_1ABF_a7df76c30aa32223fb74f3fbdb9202706}\label{classSSAGES_1_1ABF_a7df76c30aa32223fb74f3fbdb9202706}} 
\index{SSAGES::ABF@{SSAGES::ABF}!Fworld\_@{Fworld\_}}
\index{Fworld\_@{Fworld\_}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{Fworld\_}{Fworld\_}}
{\footnotesize\ttfamily std\+::vector$<$\mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$double$>$$\ast$$>$ S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::\+Fworld\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Will hold the global total, synced across walkers at every time step. 

This is a grid that holds d\+F/d\+C\+Vx where x is one of the C\+Vs. For N C\+Vs, there will be N grids, and thus this vector will be N long. Global version. 

Definition at line 70 of file A\+B\+F.\+h.

\mbox{\Hypertarget{classSSAGES_1_1ABF_a060acb9e57d66e702de14ff8a5d36ee6}\label{classSSAGES_1_1ABF_a060acb9e57d66e702de14ff8a5d36ee6}} 
\index{SSAGES::ABF@{SSAGES::ABF}!histdetails\_@{histdetails\_}}
\index{histdetails\_@{histdetails\_}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{histdetails\_}{histdetails\_}}
{\footnotesize\ttfamily std\+::vector$<$std\+::vector$<$double$>$ $>$ S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::histdetails\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Histogram details. 

This is a 2 Dimensional object set up as the following\+: Histdetails is a vector of (nr of CV) vectors, ordered in CV order. Each of those vectors are 3 long. First entry of each vector holds the lower bound for that CV. Second entry of each vector holds the upper bound for that CV. Third entry of each vector holds the nr of bins for that CV dimension. 

Definition at line 140 of file A\+B\+F.\+h.

\mbox{\Hypertarget{classSSAGES_1_1ABF_a88322f13d3424be20d46cf68a3c8ce28}\label{classSSAGES_1_1ABF_a88322f13d3424be20d46cf68a3c8ce28}} 
\index{SSAGES::ABF@{SSAGES::ABF}!min\_@{min\_}}
\index{min\_@{min\_}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{min\_}{min\_}}
{\footnotesize\ttfamily int S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::min\+\_\+\hspace{0.3cm}{\ttfamily [private]}}

The minimum number of hits required before full biasing, bias is F\+\_\+\mbox{[}i\mbox{]}/max(N\+\_\+\mbox{[}i\mbox{]},min\+\_\+). 

Definition at line 98 of file A\+B\+F.\+h.

\mbox{\Hypertarget{classSSAGES_1_1ABF_a45daad9b41bac9009f1c2f09da10f58e}\label{classSSAGES_1_1ABF_a45daad9b41bac9009f1c2f09da10f58e}} 
\index{SSAGES::ABF@{SSAGES::ABF}!N\_@{N\_}}
\index{N\_@{N\_}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{N\_}{N\_}}
{\footnotesize\ttfamily \mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$int$>$$\ast$ S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::\+N\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



To store number of local hits at a given CV bin. 

Stores the number of times each bin was visited in CV space. 

Definition at line 48 of file A\+B\+F.\+h.

\mbox{\Hypertarget{classSSAGES_1_1ABF_ae2306049903c2ed6e6fb07eaee71e9ae}\label{classSSAGES_1_1ABF_ae2306049903c2ed6e6fb07eaee71e9ae}} 
\index{SSAGES::ABF@{SSAGES::ABF}!Nworld\_@{Nworld\_}}
\index{Nworld\_@{Nworld\_}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{Nworld\_}{Nworld\_}}
{\footnotesize\ttfamily \mbox{\hyperlink{classSSAGES_1_1Grid}{Grid}}$<$int$>$$\ast$ S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::\+Nworld\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



To store number of global hits at a given CV bin. 

Stores the number of times each bin was visited in CV space. Global version. 

Definition at line 55 of file A\+B\+F.\+h.

\mbox{\Hypertarget{classSSAGES_1_1ABF_a85f39957134c0d27298aff5ad306cbd9}\label{classSSAGES_1_1ABF_a85f39957134c0d27298aff5ad306cbd9}} 
\index{SSAGES::ABF@{SSAGES::ABF}!periodicboundaries\_@{periodicboundaries\_}}
\index{periodicboundaries\_@{periodicboundaries\_}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{periodicboundaries\_}{periodicboundaries\_}}
{\footnotesize\ttfamily std\+::vector$<$std\+::vector$<$double$>$ $>$ S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::periodicboundaries\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Holds periodic boundaries of C\+Vs. 

This is a 2 Dimensional object set up as the following\+: periodicboundaries\+\_\+ is a vector of (nr of CV) vectors, ordered in CV order. Each of those vectors are 2 long. First entry of each vector holds the lower bound for that CV periodic boundary. Second entry of each vector holds the upper bound for that CV periodic boundary. 

Definition at line 94 of file A\+B\+F.\+h.

\mbox{\Hypertarget{classSSAGES_1_1ABF_a7e2b1995149d50d1b1e9d05e6a44c1b6}\label{classSSAGES_1_1ABF_a7e2b1995149d50d1b1e9d05e6a44c1b6}} 
\index{SSAGES::ABF@{SSAGES::ABF}!restraint\_@{restraint\_}}
\index{restraint\_@{restraint\_}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{restraint\_}{restraint\_}}
{\footnotesize\ttfamily std\+::vector$<$std\+::vector$<$double$>$ $>$ S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::restraint\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Information for a harmonic restraint to keep CV in the region of interest. 

This is a 2 Dimensional object set up as the following\+: restraint\+\_\+ is a vector of (nr of CV) vectors, ordered in CV order. Each of those vectors are 3 long. First entry of each vector holds the lower bound for that CV restraint. Second entry of each vector holds the upper bound for that CV restraint. Third entry of each vector holds the spring constant for that CV restraint. 

Definition at line 81 of file A\+B\+F.\+h.

\mbox{\Hypertarget{classSSAGES_1_1ABF_a012104abf51fd7fe050a31fddc3c7180}\label{classSSAGES_1_1ABF_a012104abf51fd7fe050a31fddc3c7180}} 
\index{SSAGES::ABF@{SSAGES::ABF}!unitconv\_@{unitconv\_}}
\index{unitconv\_@{unitconv\_}!SSAGES::ABF@{SSAGES::ABF}}
\doxysubsubsection{\texorpdfstring{unitconv\_}{unitconv\_}}
{\footnotesize\ttfamily double S\+S\+A\+G\+E\+S\+::\+A\+B\+F\+::unitconv\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Unit Conversion Constant from W dot P to Force. 

It is crucial that unit conversion is entered correctly. Unit conversion from d(momentum)/d(time) to force for the simulation. For L\+A\+M\+M\+PS using units real, this is 2390.\+06 (gram.\+angstrom/mole.femtosecond$^\wedge$2 -\/$>$ kcal/mole.\+angstrom) 

Definition at line 155 of file A\+B\+F.\+h.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/michael/development/\+S\+S\+A\+G\+E\+S/src/\+Methods/A\+B\+F.\+h\item 
/home/michael/development/\+S\+S\+A\+G\+E\+S/src/\+Methods/A\+B\+F.\+cpp\end{DoxyCompactItemize}
