<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>SSAGES: SSAGES::ABF Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SSAGES
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">A MetaDynamics Package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceSSAGES.html">SSAGES</a></li><li class="navelem"><a class="el" href="classSSAGES_1_1ABF.html">ABF</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classSSAGES_1_1ABF-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">SSAGES::ABF Class Reference<div class="ingroups"><a class="el" href="group__Methods.html">Methods</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Adaptive Biasing Force Algorithm.  
 <a href="classSSAGES_1_1ABF.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ABF_8h_source.html">ABF.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for SSAGES::ABF:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1ABF__inherit__graph.png" border="0" usemap="#SSAGES_1_1ABF_inherit__map" alt="Inheritance graph"/></div>
<map name="SSAGES_1_1ABF_inherit__map" id="SSAGES_1_1ABF_inherit__map">
<area shape="rect" id="node2" href="classSSAGES_1_1Method.html" title="Interface for Method implementations. " alt="" coords="115,80,243,107"/><area shape="rect" id="node3" href="classSSAGES_1_1EventListener.html" title="Base abstract class for listening in to events fired by &quot;Hook&quot;. " alt="" coords="5,5,169,32"/><area shape="rect" id="node4" href="classSSAGES_1_1Serializable.html" title="Base class for all serializable objects. " alt="" coords="195,5,347,32"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aafb9b70a7843e4d954330bbe2233876e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#aafb9b70a7843e4d954330bbe2233876e">ABF</a> (boost::mpi::communicator &amp;world, boost::mpi::communicator &amp;comm, std::vector&lt; std::vector&lt; double &gt;&gt; restraint, std::vector&lt; bool &gt; isperiodic, std::vector&lt; std::vector&lt; double &gt;&gt; periodicboundaries, double min, bool massweigh, std::string filename, const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;histdetails, int FBackupInterv, double unitconv, double timestep, unsigned int frequency)</td></tr>
<tr class="memdesc:aafb9b70a7843e4d954330bbe2233876e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#aafb9b70a7843e4d954330bbe2233876e">More...</a><br /></td></tr>
<tr class="separator:aafb9b70a7843e4d954330bbe2233876e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a323024ab4c9c5d186b35af35f00bb5fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a323024ab4c9c5d186b35af35f00bb5fb">PreSimulation</a> (<a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *snapshot, const <a class="el" href="namespaceSSAGES.html#acddea47426ac0a643b048f870ddd2907">CVList</a> &amp;cvs) override</td></tr>
<tr class="memdesc:a323024ab4c9c5d186b35af35f00bb5fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pre-simulation hook.  <a href="#a323024ab4c9c5d186b35af35f00bb5fb">More...</a><br /></td></tr>
<tr class="separator:a323024ab4c9c5d186b35af35f00bb5fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb9553ca7874df2ea8adc8b26e2d4b11"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#aeb9553ca7874df2ea8adc8b26e2d4b11">PostIntegration</a> (<a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *snapshot, const <a class="el" href="namespaceSSAGES.html#acddea47426ac0a643b048f870ddd2907">CVList</a> &amp;cvs) override</td></tr>
<tr class="memdesc:aeb9553ca7874df2ea8adc8b26e2d4b11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Post-integration hook.  <a href="#aeb9553ca7874df2ea8adc8b26e2d4b11">More...</a><br /></td></tr>
<tr class="separator:aeb9553ca7874df2ea8adc8b26e2d4b11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37afd7c4322d155c741b1a0f36e2a5cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a37afd7c4322d155c741b1a0f36e2a5cd">PostSimulation</a> (<a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *snapshot, const <a class="el" href="namespaceSSAGES.html#acddea47426ac0a643b048f870ddd2907">CVList</a> &amp;cvs) override</td></tr>
<tr class="memdesc:a37afd7c4322d155c741b1a0f36e2a5cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Post-simulation hook.  <a href="#a37afd7c4322d155c741b1a0f36e2a5cd">More...</a><br /></td></tr>
<tr class="separator:a37afd7c4322d155c741b1a0f36e2a5cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace0de3fa44c9cad64655538451de7da8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#ace0de3fa44c9cad64655538451de7da8">SetHistogram</a> (const Eigen::VectorXd &amp;F, const std::vector&lt; int &gt; &amp;N)</td></tr>
<tr class="memdesc:ace0de3fa44c9cad64655538451de7da8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set biasing histogram.  <a href="#ace0de3fa44c9cad64655538451de7da8">More...</a><br /></td></tr>
<tr class="separator:ace0de3fa44c9cad64655538451de7da8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac206ccf90c29d11d6abdebeae44b033f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#ac206ccf90c29d11d6abdebeae44b033f">SetIteration</a> (const int iter)</td></tr>
<tr class="memdesc:ac206ccf90c29d11d6abdebeae44b033f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set iteration of the method.  <a href="#ac206ccf90c29d11d6abdebeae44b033f">More...</a><br /></td></tr>
<tr class="separator:ac206ccf90c29d11d6abdebeae44b033f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add6c1cacf2a4dc9b26fb305b88283e09"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#add6c1cacf2a4dc9b26fb305b88283e09">Serialize</a> (Json::Value &amp;json) const override</td></tr>
<tr class="memdesc:add6c1cacf2a4dc9b26fb305b88283e09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serialize the class.  <a href="#add6c1cacf2a4dc9b26fb305b88283e09">More...</a><br /></td></tr>
<tr class="separator:add6c1cacf2a4dc9b26fb305b88283e09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa683e1d8a8df3522bc64529ea5e80a78"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa683e1d8a8df3522bc64529ea5e80a78"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#aa683e1d8a8df3522bc64529ea5e80a78">~ABF</a> ()</td></tr>
<tr class="memdesc:aa683e1d8a8df3522bc64529ea5e80a78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:aa683e1d8a8df3522bc64529ea5e80a78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classSSAGES_1_1Method"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classSSAGES_1_1Method')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classSSAGES_1_1Method.html">SSAGES::Method</a></td></tr>
<tr class="memitem:a7b4995b0fde5ed802f6a3a9b371fe9ad inherit pub_methods_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a7b4995b0fde5ed802f6a3a9b371fe9ad">Method</a> (unsigned int frequency, boost::mpi::communicator &amp;world, boost::mpi::communicator &amp;comm)</td></tr>
<tr class="memdesc:a7b4995b0fde5ed802f6a3a9b371fe9ad inherit pub_methods_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a7b4995b0fde5ed802f6a3a9b371fe9ad">More...</a><br /></td></tr>
<tr class="separator:a7b4995b0fde5ed802f6a3a9b371fe9ad inherit pub_methods_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa13579541a8c5946b825ee1617258571 inherit pub_methods_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#aa13579541a8c5946b825ee1617258571">SetIteration</a> (int iter)</td></tr>
<tr class="memdesc:aa13579541a8c5946b825ee1617258571 inherit pub_methods_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set <a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations. ">Method</a>'s iteration.  <a href="#aa13579541a8c5946b825ee1617258571">More...</a><br /></td></tr>
<tr class="separator:aa13579541a8c5946b825ee1617258571 inherit pub_methods_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86b979a552970f63a8edf160387f6ff9 inherit pub_methods_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a86b979a552970f63a8edf160387f6ff9"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a86b979a552970f63a8edf160387f6ff9">~Method</a> ()</td></tr>
<tr class="memdesc:a86b979a552970f63a8edf160387f6ff9 inherit pub_methods_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:a86b979a552970f63a8edf160387f6ff9 inherit pub_methods_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classSSAGES_1_1EventListener"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classSSAGES_1_1EventListener')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classSSAGES_1_1EventListener.html">SSAGES::EventListener</a></td></tr>
<tr class="memitem:a4a4d51653806e0348e9d1c99890bb87b inherit pub_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#a4a4d51653806e0348e9d1c99890bb87b">EventListener</a> (unsigned int frequency)</td></tr>
<tr class="memdesc:a4a4d51653806e0348e9d1c99890bb87b inherit pub_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a4a4d51653806e0348e9d1c99890bb87b">More...</a><br /></td></tr>
<tr class="separator:a4a4d51653806e0348e9d1c99890bb87b inherit pub_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dcfbba4a4f23ca1a3ad9671a40d3221 inherit pub_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#a2dcfbba4a4f23ca1a3ad9671a40d3221">GetFrequency</a> () const </td></tr>
<tr class="memdesc:a2dcfbba4a4f23ca1a3ad9671a40d3221 inherit pub_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get frequency of event listener.  <a href="#a2dcfbba4a4f23ca1a3ad9671a40d3221">More...</a><br /></td></tr>
<tr class="separator:a2dcfbba4a4f23ca1a3ad9671a40d3221 inherit pub_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cadffb0e82186a12023dd5963c3c5b1 inherit pub_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7cadffb0e82186a12023dd5963c3c5b1"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#a7cadffb0e82186a12023dd5963c3c5b1">~EventListener</a> ()</td></tr>
<tr class="memdesc:a7cadffb0e82186a12023dd5963c3c5b1 inherit pub_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:a7cadffb0e82186a12023dd5963c3c5b1 inherit pub_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classSSAGES_1_1Serializable"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classSSAGES_1_1Serializable')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classSSAGES_1_1Serializable.html">SSAGES::Serializable</a></td></tr>
<tr class="memitem:a29df19339b8f94609477e76b6081e075 inherit pub_methods_classSSAGES_1_1Serializable"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a29df19339b8f94609477e76b6081e075"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Serializable.html#a29df19339b8f94609477e76b6081e075">~Serializable</a> ()</td></tr>
<tr class="memdesc:a29df19339b8f94609477e76b6081e075 inherit pub_methods_classSSAGES_1_1Serializable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:a29df19339b8f94609477e76b6081e075 inherit pub_methods_classSSAGES_1_1Serializable"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aca2d887ed5572ab60dec5000b5262e31"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#aca2d887ed5572ab60dec5000b5262e31">histCoords</a> (const <a class="el" href="namespaceSSAGES.html#acddea47426ac0a643b048f870ddd2907">CVList</a> &amp;cvs)</td></tr>
<tr class="memdesc:aca2d887ed5572ab60dec5000b5262e31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get coordinates of histogram bin corresponding to given list of CVs.  <a href="#aca2d887ed5572ab60dec5000b5262e31">More...</a><br /></td></tr>
<tr class="separator:aca2d887ed5572ab60dec5000b5262e31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf6a6d7de8b1317b68280ad213f1e896"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abf6a6d7de8b1317b68280ad213f1e896"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#abf6a6d7de8b1317b68280ad213f1e896">CalcBiasForce</a> (const <a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *snapshot, const <a class="el" href="namespaceSSAGES.html#acddea47426ac0a643b048f870ddd2907">CVList</a> &amp;cvs, int coord)</td></tr>
<tr class="memdesc:abf6a6d7de8b1317b68280ad213f1e896"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the bias force. <br /></td></tr>
<tr class="separator:abf6a6d7de8b1317b68280ad213f1e896"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab63434a1cefe80372e2555e1128e39d2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab63434a1cefe80372e2555e1128e39d2"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#ab63434a1cefe80372e2555e1128e39d2">WriteData</a> ()</td></tr>
<tr class="memdesc:ab63434a1cefe80372e2555e1128e39d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes out data to file. <br /></td></tr>
<tr class="separator:ab63434a1cefe80372e2555e1128e39d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a2760c0378a097c481029dcb9db3a469f"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a2760c0378a097c481029dcb9db3a469f">_F</a></td></tr>
<tr class="memdesc:a2760c0378a097c481029dcb9db3a469f"><td class="mdescLeft">&#160;</td><td class="mdescRight">To store running total.  <a href="#a2760c0378a097c481029dcb9db3a469f">More...</a><br /></td></tr>
<tr class="separator:a2760c0378a097c481029dcb9db3a469f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9840f3256100510e585e0dc1ee450a42"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a9840f3256100510e585e0dc1ee450a42">Fworld_</a></td></tr>
<tr class="memdesc:a9840f3256100510e585e0dc1ee450a42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Will hold the global total, synced to every time step.  <a href="#a9840f3256100510e585e0dc1ee450a42">More...</a><br /></td></tr>
<tr class="separator:a9840f3256100510e585e0dc1ee450a42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1638ba5a491140b9750ecdcfe5b033ed"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a1638ba5a491140b9750ecdcfe5b033ed">_N</a></td></tr>
<tr class="memdesc:a1638ba5a491140b9750ecdcfe5b033ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">To store number of hits at a given CV bin.  <a href="#a1638ba5a491140b9750ecdcfe5b033ed">More...</a><br /></td></tr>
<tr class="separator:a1638ba5a491140b9750ecdcfe5b033ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50aa7ebf9920347d4d61382ba1b91234"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a50aa7ebf9920347d4d61382ba1b91234">Nworld_</a></td></tr>
<tr class="memdesc:a50aa7ebf9920347d4d61382ba1b91234"><td class="mdescLeft">&#160;</td><td class="mdescRight">To store number of hits at a given CV bin.  <a href="#a50aa7ebf9920347d4d61382ba1b91234">More...</a><br /></td></tr>
<tr class="separator:a50aa7ebf9920347d4d61382ba1b91234"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e2b1995149d50d1b1e9d05e6a44c1b6"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak" />
&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a></td></tr>
<tr class="memdesc:a7e2b1995149d50d1b1e9d05e6a44c1b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Information for a harmonic restraint to keep CV in the region of interest.  <a href="#a7e2b1995149d50d1b1e9d05e6a44c1b6">More...</a><br /></td></tr>
<tr class="separator:a7e2b1995149d50d1b1e9d05e6a44c1b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa575ad59d0bbaac2709de9c481d4db30"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa575ad59d0bbaac2709de9c481d4db30"></a>
std::vector&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#aa575ad59d0bbaac2709de9c481d4db30">isperiodic_</a></td></tr>
<tr class="memdesc:aa575ad59d0bbaac2709de9c481d4db30"><td class="mdescLeft">&#160;</td><td class="mdescRight">For each CV, holds whether that CV has periodic boundaries or not. <br /></td></tr>
<tr class="separator:aa575ad59d0bbaac2709de9c481d4db30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85f39957134c0d27298aff5ad306cbd9"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak" />
&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a85f39957134c0d27298aff5ad306cbd9">periodicboundaries_</a></td></tr>
<tr class="memdesc:a85f39957134c0d27298aff5ad306cbd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds periodic boundaries of CVs.  <a href="#a85f39957134c0d27298aff5ad306cbd9">More...</a><br /></td></tr>
<tr class="separator:a85f39957134c0d27298aff5ad306cbd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88322f13d3424be20d46cf68a3c8ce28"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a88322f13d3424be20d46cf68a3c8ce28">min_</a></td></tr>
<tr class="separator:a88322f13d3424be20d46cf68a3c8ce28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c882e37a3676cb3e33776621929c3b7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7c882e37a3676cb3e33776621929c3b7"></a>
Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">wdotp1_</a></td></tr>
<tr class="memdesc:a7c882e37a3676cb3e33776621929c3b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">To hold last two iterations wdotp value for derivative. <br /></td></tr>
<tr class="separator:a7c882e37a3676cb3e33776621929c3b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a0082f17ab10382191cbf39046e7052"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1a0082f17ab10382191cbf39046e7052"></a>
Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><b>wdotp2_</b></td></tr>
<tr class="separator:a1a0082f17ab10382191cbf39046e7052"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0158dff5be22bf287e22aab2eadd4e25"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0158dff5be22bf287e22aab2eadd4e25"></a>
Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a0158dff5be22bf287e22aab2eadd4e25">Fold_</a></td></tr>
<tr class="memdesc:a0158dff5be22bf287e22aab2eadd4e25"><td class="mdescLeft">&#160;</td><td class="mdescRight">To hold last iterations _F value for removing bias. <br /></td></tr>
<tr class="separator:a0158dff5be22bf287e22aab2eadd4e25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa792d019aee0f614a2a0935405244e91"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa792d019aee0f614a2a0935405244e91"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#aa792d019aee0f614a2a0935405244e91">massweigh_</a></td></tr>
<tr class="memdesc:aa792d019aee0f614a2a0935405244e91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mass weighing of bias enabled/disabled. <br /></td></tr>
<tr class="separator:aa792d019aee0f614a2a0935405244e91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae88ce69e6e7fcb15b8db68d5530f6a1e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae88ce69e6e7fcb15b8db68d5530f6a1e"></a>
std::vector&lt; <a class="el" href="namespaceSSAGES.html#a630084a0a5e185e89e21b3735f8f8b2e">Vector3</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#ae88ce69e6e7fcb15b8db68d5530f6a1e">biases_</a></td></tr>
<tr class="memdesc:ae88ce69e6e7fcb15b8db68d5530f6a1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Biases. <br /></td></tr>
<tr class="separator:ae88ce69e6e7fcb15b8db68d5530f6a1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f9514efb13e9a86b4557ae081274ce1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9f9514efb13e9a86b4557ae081274ce1"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">dim_</a></td></tr>
<tr class="memdesc:a9f9514efb13e9a86b4557ae081274ce1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of CVs in system. <br /></td></tr>
<tr class="separator:a9f9514efb13e9a86b4557ae081274ce1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acca996a147f7cbec730d7606c8dd8f8d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acca996a147f7cbec730d7606c8dd8f8d"></a>
std::ofstream&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#acca996a147f7cbec730d7606c8dd8f8d">walkerout_</a></td></tr>
<tr class="memdesc:acca996a147f7cbec730d7606c8dd8f8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output stream for walker-specific data. <br /></td></tr>
<tr class="separator:acca996a147f7cbec730d7606c8dd8f8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a528906f35295ab1a4bf7ed638fbd1973"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a528906f35295ab1a4bf7ed638fbd1973"></a>
std::ofstream&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a528906f35295ab1a4bf7ed638fbd1973">worldout_</a></td></tr>
<tr class="memdesc:a528906f35295ab1a4bf7ed638fbd1973"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output stream for world data. <br /></td></tr>
<tr class="separator:a528906f35295ab1a4bf7ed638fbd1973"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86e220cdd655537e95b97b97384b506a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a86e220cdd655537e95b97b97384b506a"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a86e220cdd655537e95b97b97384b506a">filename_</a></td></tr>
<tr class="memdesc:a86e220cdd655537e95b97b97384b506a"><td class="mdescLeft">&#160;</td><td class="mdescRight">File name for world data. <br /></td></tr>
<tr class="separator:a86e220cdd655537e95b97b97384b506a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa35d3497105792982fb09d4c1d19aec5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa35d3497105792982fb09d4c1d19aec5"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#aa35d3497105792982fb09d4c1d19aec5">mpiid_</a></td></tr>
<tr class="memdesc:aa35d3497105792982fb09d4c1d19aec5"><td class="mdescLeft">&#160;</td><td class="mdescRight">The node this belongs to. <br /></td></tr>
<tr class="separator:aa35d3497105792982fb09d4c1d19aec5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a060acb9e57d66e702de14ff8a5d36ee6"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak" />
&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">histdetails_</a></td></tr>
<tr class="memdesc:a060acb9e57d66e702de14ff8a5d36ee6"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classSSAGES_1_1Histogram.html" title="Basic Histogram. ">Histogram</a> details.  <a href="#a060acb9e57d66e702de14ff8a5d36ee6">More...</a><br /></td></tr>
<tr class="separator:a060acb9e57d66e702de14ff8a5d36ee6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc2ac53b0342d31bce16cce64448830f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#acc2ac53b0342d31bce16cce64448830f">FBackupInterv_</a></td></tr>
<tr class="memdesc:acc2ac53b0342d31bce16cce64448830f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integer to hold F estimate backup information.  <a href="#acc2ac53b0342d31bce16cce64448830f">More...</a><br /></td></tr>
<tr class="separator:acc2ac53b0342d31bce16cce64448830f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a012104abf51fd7fe050a31fddc3c7180"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a012104abf51fd7fe050a31fddc3c7180">unitconv_</a></td></tr>
<tr class="memdesc:a012104abf51fd7fe050a31fddc3c7180"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unit Conversion Constant from W dot P to Force.  <a href="#a012104abf51fd7fe050a31fddc3c7180">More...</a><br /></td></tr>
<tr class="separator:a012104abf51fd7fe050a31fddc3c7180"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c0bbf27d10f6f773a7215f5df4f78c9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2c0bbf27d10f6f773a7215f5df4f78c9"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a2c0bbf27d10f6f773a7215f5df4f78c9">timestep_</a></td></tr>
<tr class="memdesc:a2c0bbf27d10f6f773a7215f5df4f78c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timestep of integration. <br /></td></tr>
<tr class="separator:a2c0bbf27d10f6f773a7215f5df4f78c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c3e501e2a5837131beaf41b86e14ff3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1c3e501e2a5837131beaf41b86e14ff3"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a1c3e501e2a5837131beaf41b86e14ff3">ncv_</a> = 0</td></tr>
<tr class="memdesc:a1c3e501e2a5837131beaf41b86e14ff3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of cvs. <br /></td></tr>
<tr class="separator:a1c3e501e2a5837131beaf41b86e14ff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4ad4bbc8a1796f32a93987c5879a695"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac4ad4bbc8a1796f32a93987c5879a695"></a>
Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#ac4ad4bbc8a1796f32a93987c5879a695">mass_</a></td></tr>
<tr class="memdesc:ac4ad4bbc8a1796f32a93987c5879a695"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mass vector. Empty unless required. <br /></td></tr>
<tr class="separator:ac4ad4bbc8a1796f32a93987c5879a695"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_static_methods_classSSAGES_1_1Method"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classSSAGES_1_1Method')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classSSAGES_1_1Method.html">SSAGES::Method</a></td></tr>
<tr class="memitem:a4440bebe9b649e17e83d1959362091c3 inherit pub_static_methods_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSSAGES_1_1Method.html">Method</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a4440bebe9b649e17e83d1959362091c3">BuildMethod</a> (const Json::Value &amp;json, boost::mpi::communicator &amp;world, boost::mpi::communicator &amp;comm, const std::string &amp;path)</td></tr>
<tr class="memdesc:a4440bebe9b649e17e83d1959362091c3 inherit pub_static_methods_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up the <a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations. ">Method</a>.  <a href="#a4440bebe9b649e17e83d1959362091c3">More...</a><br /></td></tr>
<tr class="separator:a4440bebe9b649e17e83d1959362091c3 inherit pub_static_methods_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classSSAGES_1_1Method"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classSSAGES_1_1Method')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classSSAGES_1_1Method.html">SSAGES::Method</a></td></tr>
<tr class="memitem:a9bbdc5a2592ff76cfe71364ad4d2ce68 inherit pro_attribs_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9bbdc5a2592ff76cfe71364ad4d2ce68"></a>
boost::mpi::communicator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a9bbdc5a2592ff76cfe71364ad4d2ce68">world_</a></td></tr>
<tr class="memdesc:a9bbdc5a2592ff76cfe71364ad4d2ce68 inherit pro_attribs_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global MPI communicator. <br /></td></tr>
<tr class="separator:a9bbdc5a2592ff76cfe71364ad4d2ce68 inherit pro_attribs_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae497980d1720c38b65d47fd4e65897b0 inherit pro_attribs_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae497980d1720c38b65d47fd4e65897b0"></a>
boost::mpi::communicator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#ae497980d1720c38b65d47fd4e65897b0">comm_</a></td></tr>
<tr class="memdesc:ae497980d1720c38b65d47fd4e65897b0 inherit pro_attribs_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local MPI communicator. <br /></td></tr>
<tr class="separator:ae497980d1720c38b65d47fd4e65897b0 inherit pro_attribs_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b83499833edfa7a5ecf5bb4f2de9a62 inherit pro_attribs_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1b83499833edfa7a5ecf5bb4f2de9a62"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a1b83499833edfa7a5ecf5bb4f2de9a62">iteration_</a></td></tr>
<tr class="memdesc:a1b83499833edfa7a5ecf5bb4f2de9a62 inherit pro_attribs_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of the method iteration. <br /></td></tr>
<tr class="separator:a1b83499833edfa7a5ecf5bb4f2de9a62 inherit pro_attribs_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Adaptive Biasing Force Algorithm. </p>
<p>Implementation of the Adaptive Biasing Force algorithm based on <a class="el" href="citelist.html#CITEREF_DARVE2008144120">[2]</a> </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00044">44</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aafb9b70a7843e4d954330bbe2233876e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SSAGES::ABF::ABF </td>
          <td>(</td>
          <td class="paramtype">boost::mpi::communicator &amp;&#160;</td>
          <td class="paramname"><em>world</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::mpi::communicator &amp;&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; double &gt;&gt;&#160;</td>
          <td class="paramname"><em>restraint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; bool &gt;&#160;</td>
          <td class="paramname"><em>isperiodic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; double &gt;&gt;&#160;</td>
          <td class="paramname"><em>periodicboundaries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>massweigh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>histdetails</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>FBackupInterv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>unitconv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>frequency</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">world</td><td>MPI global communicator. </td></tr>
    <tr><td class="paramname">comm</td><td>MPI local communicator. </td></tr>
    <tr><td class="paramname">histdetails</td><td>Minimum, maximum and number of bins for each CV. </td></tr>
    <tr><td class="paramname">restraint</td><td>Minimum, maximum and spring constant for CV restraints. </td></tr>
    <tr><td class="paramname">timestep</td><td><a class="el" href="classSSAGES_1_1Simulation.html" title="Simulation class for creating simulation and a driver object. ">Simulation</a> time step. </td></tr>
    <tr><td class="paramname">min</td><td>Minimum number of hist in a histogram bin before biasing is applied. </td></tr>
    <tr><td class="paramname">filename</td><td>Name for output file. </td></tr>
    <tr><td class="paramname">printdetails</td><td>Set up what information to print and frequency of printing. </td></tr>
    <tr><td class="paramname">FBackupInterv</td><td>Set how often the adaptive force histogram is saved. </td></tr>
    <tr><td class="paramname">unitconv</td><td>Unit conversion from d(momentum)/d(time) to force. </td></tr>
    <tr><td class="paramname">Orthogonalization</td><td>Flag to turn on or off Gram-Schmidt Orthogonalization. </td></tr>
    <tr><td class="paramname">frequency</td><td>Frequency with which this method is invoked.</td></tr>
  </table>
  </dd>
</dl>
<p>Constructs an instance of Adaptive Biasing Force method. </p><dl class="section note"><dt>Note</dt><dd>The restraints should be outside of the range defined in histdetails_ by at least one bin size on each side. </dd></dl>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00202">202</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                    :</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <a class="code" href="classSSAGES_1_1Method.html#a7b4995b0fde5ed802f6a3a9b371fe9ad">Method</a>(frequency, world, comm), <a class="code" href="classSSAGES_1_1ABF.html#a2760c0378a097c481029dcb9db3a469f">_F</a>(), <a class="code" href="classSSAGES_1_1ABF.html#a9840f3256100510e585e0dc1ee450a42">Fworld_</a>(), <a class="code" href="classSSAGES_1_1ABF.html#a1638ba5a491140b9750ecdcfe5b033ed">_N</a>(0), <a class="code" href="classSSAGES_1_1ABF.html#a50aa7ebf9920347d4d61382ba1b91234">Nworld_</a>(0),</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a>(restraint), <a class="code" href="classSSAGES_1_1ABF.html#aa575ad59d0bbaac2709de9c481d4db30">isperiodic_</a>(isperiodic), <a class="code" href="classSSAGES_1_1ABF.html#a85f39957134c0d27298aff5ad306cbd9">periodicboundaries_</a>(periodicboundaries),</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;         <a class="code" href="classSSAGES_1_1ABF.html#a88322f13d3424be20d46cf68a3c8ce28">min_</a>(min), <a class="code" href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">wdotp1_</a>(), wdotp2_(), <a class="code" href="classSSAGES_1_1ABF.html#a0158dff5be22bf287e22aab2eadd4e25">Fold_</a>(), <a class="code" href="classSSAGES_1_1ABF.html#aa792d019aee0f614a2a0935405244e91">massweigh_</a>(massweigh),</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#ae88ce69e6e7fcb15b8db68d5530f6a1e">biases_</a>(), <a class="code" href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">dim_</a>(0), <a class="code" href="classSSAGES_1_1ABF.html#a86e220cdd655537e95b97b97384b506a">filename_</a>(filename), <a class="code" href="classSSAGES_1_1ABF.html#aa35d3497105792982fb09d4c1d19aec5">mpiid_</a>(0), <a class="code" href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">histdetails_</a>(histdetails), </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#acc2ac53b0342d31bce16cce64448830f">FBackupInterv_</a>(FBackupInterv), <a class="code" href="classSSAGES_1_1ABF.html#a012104abf51fd7fe050a31fddc3c7180">unitconv_</a>(unitconv), <a class="code" href="classSSAGES_1_1ABF.html#a2c0bbf27d10f6f773a7215f5df4f78c9">timestep_</a>(timestep)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        }</div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a86e220cdd655537e95b97b97384b506a"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a86e220cdd655537e95b97b97384b506a">SSAGES::ABF::filename_</a></div><div class="ttdeci">std::string filename_</div><div class="ttdoc">File name for world data. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00136">ABF.h:136</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a2760c0378a097c481029dcb9db3a469f"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a2760c0378a097c481029dcb9db3a469f">SSAGES::ABF::_F</a></div><div class="ttdeci">Eigen::VectorXd _F</div><div class="ttdoc">To store running total. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00052">ABF.h:52</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_aa35d3497105792982fb09d4c1d19aec5"><div class="ttname"><a href="classSSAGES_1_1ABF.html#aa35d3497105792982fb09d4c1d19aec5">SSAGES::ABF::mpiid_</a></div><div class="ttdeci">unsigned int mpiid_</div><div class="ttdoc">The node this belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00139">ABF.h:139</a></div></div>
<div class="ttc" id="classSSAGES_1_1Method_html_a7b4995b0fde5ed802f6a3a9b371fe9ad"><div class="ttname"><a href="classSSAGES_1_1Method.html#a7b4995b0fde5ed802f6a3a9b371fe9ad">SSAGES::Method::Method</a></div><div class="ttdeci">Method(unsigned int frequency, boost::mpi::communicator &amp;world, boost::mpi::communicator &amp;comm)</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00059">Method.h:59</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a012104abf51fd7fe050a31fddc3c7180"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a012104abf51fd7fe050a31fddc3c7180">SSAGES::ABF::unitconv_</a></div><div class="ttdeci">double unitconv_</div><div class="ttdoc">Unit Conversion Constant from W dot P to Force. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00165">ABF.h:165</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a060acb9e57d66e702de14ff8a5d36ee6"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">SSAGES::ABF::histdetails_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; histdetails_</div><div class="ttdoc">Histogram details. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00150">ABF.h:150</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_aa792d019aee0f614a2a0935405244e91"><div class="ttname"><a href="classSSAGES_1_1ABF.html#aa792d019aee0f614a2a0935405244e91">SSAGES::ABF::massweigh_</a></div><div class="ttdeci">bool massweigh_</div><div class="ttdoc">Mass weighing of bias enabled/disabled. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00121">ABF.h:121</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a0158dff5be22bf287e22aab2eadd4e25"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a0158dff5be22bf287e22aab2eadd4e25">SSAGES::ABF::Fold_</a></div><div class="ttdeci">Eigen::VectorXd Fold_</div><div class="ttdoc">To hold last iterations _F value for removing bias. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00107">ABF.h:107</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_aa575ad59d0bbaac2709de9c481d4db30"><div class="ttname"><a href="classSSAGES_1_1ABF.html#aa575ad59d0bbaac2709de9c481d4db30">SSAGES::ABF::isperiodic_</a></div><div class="ttdeci">std::vector&lt; bool &gt; isperiodic_</div><div class="ttdoc">For each CV, holds whether that CV has periodic boundaries or not. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00087">ABF.h:87</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ae88ce69e6e7fcb15b8db68d5530f6a1e"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ae88ce69e6e7fcb15b8db68d5530f6a1e">SSAGES::ABF::biases_</a></div><div class="ttdeci">std::vector&lt; Vector3 &gt; biases_</div><div class="ttdoc">Biases. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00124">ABF.h:124</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a7e2b1995149d50d1b1e9d05e6a44c1b6"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">SSAGES::ABF::restraint_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; restraint_</div><div class="ttdoc">Information for a harmonic restraint to keep CV in the region of interest. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00084">ABF.h:84</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a9f9514efb13e9a86b4557ae081274ce1"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">SSAGES::ABF::dim_</a></div><div class="ttdeci">unsigned int dim_</div><div class="ttdoc">Number of CVs in system. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00127">ABF.h:127</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a1638ba5a491140b9750ecdcfe5b033ed"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a1638ba5a491140b9750ecdcfe5b033ed">SSAGES::ABF::_N</a></div><div class="ttdeci">std::vector&lt; int &gt; _N</div><div class="ttdoc">To store number of hits at a given CV bin. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00066">ABF.h:66</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a50aa7ebf9920347d4d61382ba1b91234"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a50aa7ebf9920347d4d61382ba1b91234">SSAGES::ABF::Nworld_</a></div><div class="ttdeci">std::vector&lt; int &gt; Nworld_</div><div class="ttdoc">To store number of hits at a given CV bin. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00073">ABF.h:73</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a88322f13d3424be20d46cf68a3c8ce28"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a88322f13d3424be20d46cf68a3c8ce28">SSAGES::ABF::min_</a></div><div class="ttdeci">int min_</div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00101">ABF.h:101</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_acc2ac53b0342d31bce16cce64448830f"><div class="ttname"><a href="classSSAGES_1_1ABF.html#acc2ac53b0342d31bce16cce64448830f">SSAGES::ABF::FBackupInterv_</a></div><div class="ttdeci">int FBackupInterv_</div><div class="ttdoc">Integer to hold F estimate backup information. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00156">ABF.h:156</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a9840f3256100510e585e0dc1ee450a42"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a9840f3256100510e585e0dc1ee450a42">SSAGES::ABF::Fworld_</a></div><div class="ttdeci">Eigen::VectorXd Fworld_</div><div class="ttdoc">Will hold the global total, synced to every time step. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00059">ABF.h:59</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a2c0bbf27d10f6f773a7215f5df4f78c9"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a2c0bbf27d10f6f773a7215f5df4f78c9">SSAGES::ABF::timestep_</a></div><div class="ttdeci">double timestep_</div><div class="ttdoc">Timestep of integration. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00174">ABF.h:174</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a85f39957134c0d27298aff5ad306cbd9"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a85f39957134c0d27298aff5ad306cbd9">SSAGES::ABF::periodicboundaries_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; periodicboundaries_</div><div class="ttdoc">Holds periodic boundaries of CVs. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00097">ABF.h:97</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a7c882e37a3676cb3e33776621929c3b7"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">SSAGES::ABF::wdotp1_</a></div><div class="ttdeci">Eigen::VectorXd wdotp1_</div><div class="ttdoc">To hold last two iterations wdotp value for derivative. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00104">ABF.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aca2d887ed5572ab60dec5000b5262e31"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SSAGES::ABF::histCoords </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceSSAGES.html#acddea47426ac0a643b048f870ddd2907">CVList</a> &amp;&#160;</td>
          <td class="paramname"><em>cvs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get coordinates of histogram bin corresponding to given list of CVs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cvs</td><td>List of CVs.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Index of histogram bin.</dd></dl>
<p>Function to return bin coordinate to address _F and _N, given a vector [CV1,CV2..] values. </p>

<p>Definition at line <a class="el" href="ABF_8cpp_source.html#l00047">47</a> of file <a class="el" href="ABF_8cpp_source.html">ABF.cpp</a>.</p>

<p>References <a class="el" href="ABF_8h_source.html#l00150">histdetails_</a>.</p>

<p>Referenced by <a class="el" href="ABF_8cpp_source.html#l00143">PostIntegration()</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="comment">// Histogram details: This is a 2 Dimensional object set up as the following:</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="comment">// Histdetails is a vector of three vectors, each of those three vectors are (Number of CVs) long.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="comment">// First of these vectors hold the lower bound for the CVs in order.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="comment">// Second vector holds the upper bound for the CVs in order.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="comment">// Third vector holds number of histogram bins for the CVs in order.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="comment">// The first mapping starts here.</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">histdetails_</a>.size(); ++i)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <span class="comment">// Check if CV is in bounds for each CV.</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="keywordflow">if</span> ((cvs[i]-&gt;GetValue()&lt;<a class="code" href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">histdetails_</a>[i][0]) || (cvs[i]-&gt;GetValue()&gt;<a class="code" href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">histdetails_</a>[i][1]))</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="comment">// This vector holds the CV coordinates in the fictitious object.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        std::vector&lt;int&gt; coords(cvs.size());</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="comment">// Loop over each CV dimension.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">histdetails_</a>.size(); ++i)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="comment">// Loop over all bins in each CV dimensions</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">histdetails_</a>[i][2] ; ++j)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                <span class="keywordflow">if</span>((histdetails_[i][0] + j*((histdetails_[i][1]-histdetails_[i][0])/histdetails_[i][2]) &lt; cvs[i]-&gt;GetValue()) &amp;&amp; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                   (histdetails_[i][0] + (j+1)*((histdetails_[i][1]-histdetails_[i][0])/histdetails_[i][2]) &gt; cvs[i]-&gt;GetValue()))</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                    coords[i] = j;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        } <span class="comment">//First mapping ends here. </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="comment">// Second mapping starts here.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordtype">int</span> finalcoord = 0;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordtype">int</span> indexer = 1;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="comment">// Loop over each CV dimension.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; histdetails_.size(); ++i)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            indexer = 1;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> j = i+1; j &lt; histdetails_.size(); ++j)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                indexer = indexer*histdetails_[j][2];</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            finalcoord += coords[i]*indexer;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">return</span> finalcoord;          </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a060acb9e57d66e702de14ff8a5d36ee6"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">SSAGES::ABF::histdetails_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; histdetails_</div><div class="ttdoc">Histogram details. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00150">ABF.h:150</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1ABF_aca2d887ed5572ab60dec5000b5262e31_icgraph.png" border="0" usemap="#classSSAGES_1_1ABF_aca2d887ed5572ab60dec5000b5262e31_icgraph" alt=""/></div>
<map name="classSSAGES_1_1ABF_aca2d887ed5572ab60dec5000b5262e31_icgraph" id="classSSAGES_1_1ABF_aca2d887ed5572ab60dec5000b5262e31_icgraph">
<area shape="rect" id="node2" href="classSSAGES_1_1ABF.html#aeb9553ca7874df2ea8adc8b26e2d4b11" title="Post&#45;integration hook. " alt="" coords="238,5,445,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aeb9553ca7874df2ea8adc8b26e2d4b11"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ABF::PostIntegration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *&#160;</td>
          <td class="paramname"><em>snapshot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceSSAGES.html#acddea47426ac0a643b048f870ddd2907">CVList</a> &amp;&#160;</td>
          <td class="paramname"><em>cvs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Post-integration hook. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">snapshot</td><td>Current simulation snapshot. </td></tr>
    <tr><td class="paramname">cvs</td><td>List of CVs.</td></tr>
  </table>
  </dd>
</dl>
<p>Post-integration hook is where processes carried out every timestep happen. First, information from current snapshot is retrieved and stored in variables as necessary. Then, coordinates in CV space are determined. Then, for each CV, the time derivative of w.p is calculated. Then, information is printed out if its enabled. Finally, bias is applied from current estimate of generalized force. </p>
<p>Coord holds where we are in CV space in current timestep.</p>
<p>Eigen::MatrixXd to hold the CV gradient. </p>

<p>Implements <a class="el" href="classSSAGES_1_1Method.html#a4da2e92262fe76a086cbf8d282e9b396">SSAGES::Method</a>.</p>

<p>Definition at line <a class="el" href="ABF_8cpp_source.html#l00143">143</a> of file <a class="el" href="ABF_8cpp_source.html">ABF.cpp</a>.</p>

<p>References <a class="el" href="ABF_8h_source.html#l00052">_F</a>, <a class="el" href="ABF_8h_source.html#l00066">_N</a>, <a class="el" href="ABF_8h_source.html#l00124">biases_</a>, <a class="el" href="ABF_8cpp_source.html#l00236">CalcBiasForce()</a>, <a class="el" href="Method_8h_source.html#l00045">SSAGES::Method::comm_</a>, <a class="el" href="ABF_8h_source.html#l00156">FBackupInterv_</a>, <a class="el" href="ABF_8h_source.html#l00107">Fold_</a>, <a class="el" href="ABF_8h_source.html#l00059">Fworld_</a>, <a class="el" href="Snapshot_8h_source.html#l00364">SSAGES::Snapshot::GetForces()</a>, <a class="el" href="Snapshot_8h_source.html#l00380">SSAGES::Snapshot::GetMasses()</a>, <a class="el" href="Snapshot_8h_source.html#l00202">SSAGES::Snapshot::GetNumAtoms()</a>, <a class="el" href="Snapshot_8h_source.html#l00351">SSAGES::Snapshot::GetVelocities()</a>, <a class="el" href="ABF_8cpp_source.html#l00047">histCoords()</a>, <a class="el" href="Method_8h_source.html#l00048">SSAGES::Method::iteration_</a>, <a class="el" href="ABF_8h_source.html#l00121">massweigh_</a>, <a class="el" href="ABF_8h_source.html#l00101">min_</a>, <a class="el" href="ABF_8h_source.html#l00177">ncv_</a>, <a class="el" href="ABF_8h_source.html#l00073">Nworld_</a>, <a class="el" href="ABF_8h_source.html#l00174">timestep_</a>, <a class="el" href="ABF_8h_source.html#l00165">unitconv_</a>, <a class="el" href="ABF_8h_source.html#l00104">wdotp1_</a>, <a class="el" href="Method_8h_source.html#l00044">SSAGES::Method::world_</a>, and <a class="el" href="ABF_8cpp_source.html#l00289">WriteData()</a>.</p>
<div class="fragment"><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        ++<a class="code" href="classSSAGES_1_1Method.html#a1b83499833edfa7a5ecf5bb4f2de9a62">iteration_</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">// Gather information.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keyword">auto</span>&amp; vels = snapshot-&gt;GetVelocities();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keyword">auto</span>&amp; mass = snapshot-&gt;GetMasses();</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keyword">auto</span>&amp; forces = snapshot-&gt;GetForces();</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keyword">auto</span> n = snapshot-&gt;GetNumAtoms();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordtype">int</span> coord = <a class="code" href="classSSAGES_1_1ABF.html#aca2d887ed5572ab60dec5000b5262e31">histCoords</a>(cvs);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        Eigen::MatrixXd J(<a class="code" href="classSSAGES_1_1ABF.html#a1c3e501e2a5837131beaf41b86e14ff3">ncv_</a>, 3*n);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="comment">// Fill J. Each column represents grad(CV) with flattened Cartesian elements. </span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1ABF.html#a1c3e501e2a5837131beaf41b86e14ff3">ncv_</a>; ++i)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="keyword">auto</span>&amp; grad = cvs[i]-&gt;GetGradient();</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                J.block&lt;1, 3&gt;(i,3*j) = grad[j];</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="comment">//* Calculate W using Darve&#39;s approach (http://mc.stanford.edu/cgi-bin/images/0/06/Darve_2008.pdf).</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        Eigen::MatrixXd Jmass = J.transpose();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1ABF.html#aa792d019aee0f614a2a0935405244e91">massweigh_</a>)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; forces.size(); ++i)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                Jmass.block(3*i, 0, 3, ncv_) = Jmass.block(3*i, 0, 3, ncv_)/mass[i];</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                            </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        Eigen::MatrixXd Minv = J*Jmass;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        MPI_Allreduce(MPI_IN_PLACE, Minv.data(), Minv.size(), MPI_DOUBLE, MPI_SUM, <a class="code" href="classSSAGES_1_1Method.html#ae497980d1720c38b65d47fd4e65897b0">comm_</a>);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        Eigen::MatrixXd Wt = Minv.inverse()*Jmass.transpose();  </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="comment">// Fill momenta.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        Eigen::VectorXd momenta(3*vels.size());</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; vels.size(); ++i)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            momenta.segment&lt;3&gt;(3*i) = mass[i]*vels[i];</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="comment">// Compute dot(w,p).</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        Eigen::VectorXd wdotp = Wt*momenta;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="comment">// Reduce dot product across processors.</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        MPI_Allreduce(MPI_IN_PLACE, wdotp.data(), wdotp.size(), MPI_DOUBLE, MPI_SUM, <a class="code" href="classSSAGES_1_1Method.html#ae497980d1720c38b65d47fd4e65897b0">comm_</a>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="comment">// Compute d(wdotp)/dt second order backwards finite difference. </span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="comment">// Adding old force removes bias. </span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        Eigen::VectorXd dwdotpdt = <a class="code" href="classSSAGES_1_1ABF.html#a012104abf51fd7fe050a31fddc3c7180">unitconv_</a>*(1.5*wdotp - 2.0*<a class="code" href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">wdotp1_</a> + 0.5*wdotp2_)/<a class="code" href="classSSAGES_1_1ABF.html#a2c0bbf27d10f6f773a7215f5df4f78c9">timestep_</a> + <a class="code" href="classSSAGES_1_1ABF.html#a0158dff5be22bf287e22aab2eadd4e25">Fold_</a>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="comment">// If we are in bounds, sum force into running total.</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">if</span>(coord != -1)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <a class="code" href="classSSAGES_1_1ABF.html#a2760c0378a097c481029dcb9db3a469f">_F</a>.segment(ncv_*coord, ncv_) += dwdotpdt;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            ++<a class="code" href="classSSAGES_1_1ABF.html#a1638ba5a491140b9750ecdcfe5b033ed">_N</a>[coord];</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="comment">// Reduce data across processors.</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        MPI_Allreduce(<a class="code" href="classSSAGES_1_1ABF.html#a2760c0378a097c481029dcb9db3a469f">_F</a>.data(), <a class="code" href="classSSAGES_1_1ABF.html#a9840f3256100510e585e0dc1ee450a42">Fworld_</a>.data(), <a class="code" href="classSSAGES_1_1ABF.html#a2760c0378a097c481029dcb9db3a469f">_F</a>.size(), MPI_DOUBLE, MPI_SUM, <a class="code" href="classSSAGES_1_1Method.html#a9bbdc5a2592ff76cfe71364ad4d2ce68">world_</a>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        MPI_Allreduce(<a class="code" href="classSSAGES_1_1ABF.html#a1638ba5a491140b9750ecdcfe5b033ed">_N</a>.data(), <a class="code" href="classSSAGES_1_1ABF.html#a50aa7ebf9920347d4d61382ba1b91234">Nworld_</a>.data(), <a class="code" href="classSSAGES_1_1ABF.html#a1638ba5a491140b9750ecdcfe5b033ed">_N</a>.size(), MPI_INT, MPI_SUM, <a class="code" href="classSSAGES_1_1Method.html#a9bbdc5a2592ff76cfe71364ad4d2ce68">world_</a>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="comment">// If we are in bounds, store the old summed force.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">if</span>(coord != -1)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <a class="code" href="classSSAGES_1_1ABF.html#a0158dff5be22bf287e22aab2eadd4e25">Fold_</a> = <a class="code" href="classSSAGES_1_1ABF.html#a9840f3256100510e585e0dc1ee450a42">Fworld_</a>.segment(ncv_*coord, ncv_)/std::max(<a class="code" href="classSSAGES_1_1ABF.html#a88322f13d3424be20d46cf68a3c8ce28">min_</a>, <a class="code" href="classSSAGES_1_1ABF.html#a50aa7ebf9920347d4d61382ba1b91234">Nworld_</a>[coord]);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="comment">// Update finite difference time derivatives.</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        wdotp2_ = <a class="code" href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">wdotp1_</a>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">wdotp1_</a> = wdotp;        </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="comment">// Write out data to file.</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1Method.html#a1b83499833edfa7a5ecf5bb4f2de9a62">iteration_</a> % <a class="code" href="classSSAGES_1_1ABF.html#acc2ac53b0342d31bce16cce64448830f">FBackupInterv_</a> == 0)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <a class="code" href="classSSAGES_1_1ABF.html#ab63434a1cefe80372e2555e1128e39d2">WriteData</a>();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="comment">// Calculate the bias from averaged F at current CV coordinates</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#abf6a6d7de8b1317b68280ad213f1e896">CalcBiasForce</a>(snapshot, cvs, coord);        </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="comment">// Update the forces in snapshot by adding in the force bias from each</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="comment">// CV to each atom based on the gradient of the CV.</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; forces.size(); ++j)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            forces[j] += <a class="code" href="classSSAGES_1_1ABF.html#ae88ce69e6e7fcb15b8db68d5530f6a1e">biases_</a>[j];    </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a1c3e501e2a5837131beaf41b86e14ff3"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a1c3e501e2a5837131beaf41b86e14ff3">SSAGES::ABF::ncv_</a></div><div class="ttdeci">int ncv_</div><div class="ttdoc">Number of cvs. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00177">ABF.h:177</a></div></div>
<div class="ttc" id="classSSAGES_1_1Method_html_a1b83499833edfa7a5ecf5bb4f2de9a62"><div class="ttname"><a href="classSSAGES_1_1Method.html#a1b83499833edfa7a5ecf5bb4f2de9a62">SSAGES::Method::iteration_</a></div><div class="ttdeci">unsigned int iteration_</div><div class="ttdoc">Number of the method iteration. </div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00048">Method.h:48</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a2760c0378a097c481029dcb9db3a469f"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a2760c0378a097c481029dcb9db3a469f">SSAGES::ABF::_F</a></div><div class="ttdeci">Eigen::VectorXd _F</div><div class="ttdoc">To store running total. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00052">ABF.h:52</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ab63434a1cefe80372e2555e1128e39d2"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ab63434a1cefe80372e2555e1128e39d2">SSAGES::ABF::WriteData</a></div><div class="ttdeci">void WriteData()</div><div class="ttdoc">Writes out data to file. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8cpp_source.html#l00289">ABF.cpp:289</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a012104abf51fd7fe050a31fddc3c7180"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a012104abf51fd7fe050a31fddc3c7180">SSAGES::ABF::unitconv_</a></div><div class="ttdeci">double unitconv_</div><div class="ttdoc">Unit Conversion Constant from W dot P to Force. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00165">ABF.h:165</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_aa792d019aee0f614a2a0935405244e91"><div class="ttname"><a href="classSSAGES_1_1ABF.html#aa792d019aee0f614a2a0935405244e91">SSAGES::ABF::massweigh_</a></div><div class="ttdeci">bool massweigh_</div><div class="ttdoc">Mass weighing of bias enabled/disabled. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00121">ABF.h:121</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a0158dff5be22bf287e22aab2eadd4e25"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a0158dff5be22bf287e22aab2eadd4e25">SSAGES::ABF::Fold_</a></div><div class="ttdeci">Eigen::VectorXd Fold_</div><div class="ttdoc">To hold last iterations _F value for removing bias. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00107">ABF.h:107</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ae88ce69e6e7fcb15b8db68d5530f6a1e"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ae88ce69e6e7fcb15b8db68d5530f6a1e">SSAGES::ABF::biases_</a></div><div class="ttdeci">std::vector&lt; Vector3 &gt; biases_</div><div class="ttdoc">Biases. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00124">ABF.h:124</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_abf6a6d7de8b1317b68280ad213f1e896"><div class="ttname"><a href="classSSAGES_1_1ABF.html#abf6a6d7de8b1317b68280ad213f1e896">SSAGES::ABF::CalcBiasForce</a></div><div class="ttdeci">void CalcBiasForce(const Snapshot *snapshot, const CVList &amp;cvs, int coord)</div><div class="ttdoc">Computes the bias force. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8cpp_source.html#l00236">ABF.cpp:236</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_aca2d887ed5572ab60dec5000b5262e31"><div class="ttname"><a href="classSSAGES_1_1ABF.html#aca2d887ed5572ab60dec5000b5262e31">SSAGES::ABF::histCoords</a></div><div class="ttdeci">int histCoords(const CVList &amp;cvs)</div><div class="ttdoc">Get coordinates of histogram bin corresponding to given list of CVs. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8cpp_source.html#l00047">ABF.cpp:47</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a1638ba5a491140b9750ecdcfe5b033ed"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a1638ba5a491140b9750ecdcfe5b033ed">SSAGES::ABF::_N</a></div><div class="ttdeci">std::vector&lt; int &gt; _N</div><div class="ttdoc">To store number of hits at a given CV bin. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00066">ABF.h:66</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a50aa7ebf9920347d4d61382ba1b91234"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a50aa7ebf9920347d4d61382ba1b91234">SSAGES::ABF::Nworld_</a></div><div class="ttdeci">std::vector&lt; int &gt; Nworld_</div><div class="ttdoc">To store number of hits at a given CV bin. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00073">ABF.h:73</a></div></div>
<div class="ttc" id="classSSAGES_1_1Method_html_ae497980d1720c38b65d47fd4e65897b0"><div class="ttname"><a href="classSSAGES_1_1Method.html#ae497980d1720c38b65d47fd4e65897b0">SSAGES::Method::comm_</a></div><div class="ttdeci">boost::mpi::communicator comm_</div><div class="ttdoc">Local MPI communicator. </div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00045">Method.h:45</a></div></div>
<div class="ttc" id="classSSAGES_1_1Method_html_a9bbdc5a2592ff76cfe71364ad4d2ce68"><div class="ttname"><a href="classSSAGES_1_1Method.html#a9bbdc5a2592ff76cfe71364ad4d2ce68">SSAGES::Method::world_</a></div><div class="ttdeci">boost::mpi::communicator world_</div><div class="ttdoc">Global MPI communicator. </div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00044">Method.h:44</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a88322f13d3424be20d46cf68a3c8ce28"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a88322f13d3424be20d46cf68a3c8ce28">SSAGES::ABF::min_</a></div><div class="ttdeci">int min_</div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00101">ABF.h:101</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_acc2ac53b0342d31bce16cce64448830f"><div class="ttname"><a href="classSSAGES_1_1ABF.html#acc2ac53b0342d31bce16cce64448830f">SSAGES::ABF::FBackupInterv_</a></div><div class="ttdeci">int FBackupInterv_</div><div class="ttdoc">Integer to hold F estimate backup information. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00156">ABF.h:156</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a9840f3256100510e585e0dc1ee450a42"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a9840f3256100510e585e0dc1ee450a42">SSAGES::ABF::Fworld_</a></div><div class="ttdeci">Eigen::VectorXd Fworld_</div><div class="ttdoc">Will hold the global total, synced to every time step. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00059">ABF.h:59</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a2c0bbf27d10f6f773a7215f5df4f78c9"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a2c0bbf27d10f6f773a7215f5df4f78c9">SSAGES::ABF::timestep_</a></div><div class="ttdeci">double timestep_</div><div class="ttdoc">Timestep of integration. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00174">ABF.h:174</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a7c882e37a3676cb3e33776621929c3b7"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">SSAGES::ABF::wdotp1_</a></div><div class="ttdeci">Eigen::VectorXd wdotp1_</div><div class="ttdoc">To hold last two iterations wdotp value for derivative. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00104">ABF.h:104</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1ABF_aeb9553ca7874df2ea8adc8b26e2d4b11_cgraph.png" border="0" usemap="#classSSAGES_1_1ABF_aeb9553ca7874df2ea8adc8b26e2d4b11_cgraph" alt=""/></div>
<map name="classSSAGES_1_1ABF_aeb9553ca7874df2ea8adc8b26e2d4b11_cgraph" id="classSSAGES_1_1ABF_aeb9553ca7874df2ea8adc8b26e2d4b11_cgraph">
<area shape="rect" id="node2" href="classSSAGES_1_1ABF.html#abf6a6d7de8b1317b68280ad213f1e896" title="Computes the bias force. " alt="" coords="272,5,477,32"/><area shape="rect" id="node3" href="classSSAGES_1_1Snapshot.html#ae05879b78672cd4899a06ae2d6a140fd" title="Get number of atoms in this snapshot. " alt="" coords="536,23,733,65"/><area shape="rect" id="node4" href="classSSAGES_1_1Snapshot.html#a2533f7b900bc33185424eb94d6996edf" title="Access the per&#45;particle forces. " alt="" coords="270,107,479,133"/><area shape="rect" id="node5" href="classSSAGES_1_1Snapshot.html#a035ed6fb2cd46d4f66d1614bd90ad14b" title="Const access to the particle masses. " alt="" coords="267,157,482,184"/><area shape="rect" id="node6" href="classSSAGES_1_1Snapshot.html#aeadc50cebd62e3fcbdc17511f781de19" title="Access the particle velocities. " alt="" coords="261,208,488,235"/><area shape="rect" id="node7" href="classSSAGES_1_1ABF.html#aca2d887ed5572ab60dec5000b5262e31" title="Get coordinates of histogram bin corresponding to given list of CVs. " alt="" coords="283,259,466,285"/><area shape="rect" id="node8" href="classSSAGES_1_1ABF.html#ab63434a1cefe80372e2555e1128e39d2" title="Writes out data to file. " alt="" coords="285,309,464,336"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a37afd7c4322d155c741b1a0f36e2a5cd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ABF::PostSimulation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *&#160;</td>
          <td class="paramname"><em>snapshot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceSSAGES.html#acddea47426ac0a643b048f870ddd2907">CVList</a> &amp;&#160;</td>
          <td class="paramname"><em>cvs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Post-simulation hook. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">snapshot</td><td>Current simulation snapshot. </td></tr>
    <tr><td class="paramname">cvs</td><td>List of CVs. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classSSAGES_1_1Method.html#a6e0aab2ac9e7d737e03f0be942292ba6">SSAGES::Method</a>.</p>

<p>Definition at line <a class="el" href="ABF_8cpp_source.html#l00229">229</a> of file <a class="el" href="ABF_8cpp_source.html">ABF.cpp</a>.</p>

<p>References <a class="el" href="ABF_8h_source.html#l00130">walkerout_</a>, <a class="el" href="ABF_8h_source.html#l00133">worldout_</a>, and <a class="el" href="ABF_8cpp_source.html#l00289">WriteData()</a>.</p>
<div class="fragment"><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#ab63434a1cefe80372e2555e1128e39d2">WriteData</a>();</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#a528906f35295ab1a4bf7ed638fbd1973">worldout_</a>.close();      </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#acca996a147f7cbec730d7606c8dd8f8d">walkerout_</a>.close();</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    }</div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a528906f35295ab1a4bf7ed638fbd1973"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a528906f35295ab1a4bf7ed638fbd1973">SSAGES::ABF::worldout_</a></div><div class="ttdeci">std::ofstream worldout_</div><div class="ttdoc">Output stream for world data. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00133">ABF.h:133</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ab63434a1cefe80372e2555e1128e39d2"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ab63434a1cefe80372e2555e1128e39d2">SSAGES::ABF::WriteData</a></div><div class="ttdeci">void WriteData()</div><div class="ttdoc">Writes out data to file. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8cpp_source.html#l00289">ABF.cpp:289</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_acca996a147f7cbec730d7606c8dd8f8d"><div class="ttname"><a href="classSSAGES_1_1ABF.html#acca996a147f7cbec730d7606c8dd8f8d">SSAGES::ABF::walkerout_</a></div><div class="ttdeci">std::ofstream walkerout_</div><div class="ttdoc">Output stream for walker-specific data. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00130">ABF.h:130</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1ABF_a37afd7c4322d155c741b1a0f36e2a5cd_cgraph.png" border="0" usemap="#classSSAGES_1_1ABF_a37afd7c4322d155c741b1a0f36e2a5cd_cgraph" alt=""/></div>
<map name="classSSAGES_1_1ABF_a37afd7c4322d155c741b1a0f36e2a5cd_cgraph" id="classSSAGES_1_1ABF_a37afd7c4322d155c741b1a0f36e2a5cd_cgraph">
<area shape="rect" id="node2" href="classSSAGES_1_1ABF.html#ab63434a1cefe80372e2555e1128e39d2" title="Writes out data to file. " alt="" coords="261,5,440,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a323024ab4c9c5d186b35af35f00bb5fb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ABF::PreSimulation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *&#160;</td>
          <td class="paramname"><em>snapshot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceSSAGES.html#acddea47426ac0a643b048f870ddd2907">CVList</a> &amp;&#160;</td>
          <td class="paramname"><em>cvs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pre-simulation hook. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">snapshot</td><td>Current simulation snapshot. </td></tr>
    <tr><td class="paramname">cvs</td><td>List of CVs. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classSSAGES_1_1Method.html#abd585b587de1aba4870840820e6ca4fd">SSAGES::Method</a>.</p>

<p>Definition at line <a class="el" href="ABF_8cpp_source.html#l00097">97</a> of file <a class="el" href="ABF_8cpp_source.html">ABF.cpp</a>.</p>

<p>References <a class="el" href="ABF_8h_source.html#l00052">_F</a>, <a class="el" href="ABF_8h_source.html#l00066">_N</a>, <a class="el" href="ABF_8h_source.html#l00124">biases_</a>, <a class="el" href="ABF_8h_source.html#l00136">filename_</a>, <a class="el" href="ABF_8h_source.html#l00107">Fold_</a>, <a class="el" href="ABF_8h_source.html#l00059">Fworld_</a>, <a class="el" href="Snapshot_8h_source.html#l00325">SSAGES::Snapshot::GetPositions()</a>, <a class="el" href="Snapshot_8h_source.html#l00195">SSAGES::Snapshot::GetWalkerID()</a>, <a class="el" href="ABF_8h_source.html#l00150">histdetails_</a>, <a class="el" href="ABF_8h_source.html#l00139">mpiid_</a>, <a class="el" href="ABF_8h_source.html#l00177">ncv_</a>, <a class="el" href="ABF_8h_source.html#l00073">Nworld_</a>, <a class="el" href="ABF_8h_source.html#l00130">walkerout_</a>, <a class="el" href="ABF_8h_source.html#l00104">wdotp1_</a>, and <a class="el" href="ABF_8h_source.html#l00133">worldout_</a>.</p>
<div class="fragment"><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#aa35d3497105792982fb09d4c1d19aec5">mpiid_</a> = snapshot-&gt;GetWalkerID();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordtype">char</span> file[1024];</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        sprintf(file, <span class="stringliteral">&quot;node-%04d.log&quot;</span>,<a class="code" href="classSSAGES_1_1ABF.html#aa35d3497105792982fb09d4c1d19aec5">mpiid_</a>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#acca996a147f7cbec730d7606c8dd8f8d">walkerout_</a>.open(file);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1ABF.html#aa35d3497105792982fb09d4c1d19aec5">mpiid_</a> == 0)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <a class="code" href="classSSAGES_1_1ABF.html#a528906f35295ab1a4bf7ed638fbd1973">worldout_</a>.open(<a class="code" href="classSSAGES_1_1ABF.html#a86e220cdd655537e95b97b97384b506a">filename_</a>.c_str());</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">// Convenience. Number of CVs.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#a1c3e501e2a5837131beaf41b86e14ff3">ncv_</a> = cvs.size();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="comment">// Size and initialize Fold_</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#a0158dff5be22bf287e22aab2eadd4e25">Fold_</a>.setZero(<a class="code" href="classSSAGES_1_1ABF.html#a1c3e501e2a5837131beaf41b86e14ff3">ncv_</a>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="comment">// Size and initialize Fworld_ and Nworld_      </span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keyword">auto</span> nel = 1;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1ABF.html#a1c3e501e2a5837131beaf41b86e14ff3">ncv_</a>; ++i)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            nel *= <a class="code" href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">histdetails_</a>[i][2];</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#a9840f3256100510e585e0dc1ee450a42">Fworld_</a>.setZero(nel*ncv_);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#a50aa7ebf9920347d4d61382ba1b91234">Nworld_</a>.resize(nel, 0);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="comment">// If F or N are empty, size appropriately. </span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1ABF.html#a2760c0378a097c481029dcb9db3a469f">_F</a>.size() == 0) <a class="code" href="classSSAGES_1_1ABF.html#a2760c0378a097c481029dcb9db3a469f">_F</a>.setZero(nel*ncv_);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1ABF.html#a1638ba5a491140b9750ecdcfe5b033ed">_N</a>.size() == 0) <a class="code" href="classSSAGES_1_1ABF.html#a1638ba5a491140b9750ecdcfe5b033ed">_N</a>.resize(nel, 0);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="comment">// Initialize biases.</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#ae88ce69e6e7fcb15b8db68d5530f6a1e">biases_</a>.resize(snapshot-&gt;GetPositions().size(), <a class="code" href="namespaceSSAGES.html#a630084a0a5e185e89e21b3735f8f8b2e">Vector3</a>{0, 0, 0});</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="comment">// Initialize w \dot p&#39;s for finite difference. </span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">wdotp1_</a>.setZero(ncv_);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        wdotp2_.setZero(ncv_);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a86e220cdd655537e95b97b97384b506a"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a86e220cdd655537e95b97b97384b506a">SSAGES::ABF::filename_</a></div><div class="ttdeci">std::string filename_</div><div class="ttdoc">File name for world data. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00136">ABF.h:136</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a1c3e501e2a5837131beaf41b86e14ff3"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a1c3e501e2a5837131beaf41b86e14ff3">SSAGES::ABF::ncv_</a></div><div class="ttdeci">int ncv_</div><div class="ttdoc">Number of cvs. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00177">ABF.h:177</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a528906f35295ab1a4bf7ed638fbd1973"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a528906f35295ab1a4bf7ed638fbd1973">SSAGES::ABF::worldout_</a></div><div class="ttdeci">std::ofstream worldout_</div><div class="ttdoc">Output stream for world data. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00133">ABF.h:133</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a2760c0378a097c481029dcb9db3a469f"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a2760c0378a097c481029dcb9db3a469f">SSAGES::ABF::_F</a></div><div class="ttdeci">Eigen::VectorXd _F</div><div class="ttdoc">To store running total. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00052">ABF.h:52</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_aa35d3497105792982fb09d4c1d19aec5"><div class="ttname"><a href="classSSAGES_1_1ABF.html#aa35d3497105792982fb09d4c1d19aec5">SSAGES::ABF::mpiid_</a></div><div class="ttdeci">unsigned int mpiid_</div><div class="ttdoc">The node this belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00139">ABF.h:139</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a060acb9e57d66e702de14ff8a5d36ee6"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">SSAGES::ABF::histdetails_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; histdetails_</div><div class="ttdoc">Histogram details. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00150">ABF.h:150</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_acca996a147f7cbec730d7606c8dd8f8d"><div class="ttname"><a href="classSSAGES_1_1ABF.html#acca996a147f7cbec730d7606c8dd8f8d">SSAGES::ABF::walkerout_</a></div><div class="ttdeci">std::ofstream walkerout_</div><div class="ttdoc">Output stream for walker-specific data. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00130">ABF.h:130</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a0158dff5be22bf287e22aab2eadd4e25"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a0158dff5be22bf287e22aab2eadd4e25">SSAGES::ABF::Fold_</a></div><div class="ttdeci">Eigen::VectorXd Fold_</div><div class="ttdoc">To hold last iterations _F value for removing bias. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00107">ABF.h:107</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ae88ce69e6e7fcb15b8db68d5530f6a1e"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ae88ce69e6e7fcb15b8db68d5530f6a1e">SSAGES::ABF::biases_</a></div><div class="ttdeci">std::vector&lt; Vector3 &gt; biases_</div><div class="ttdoc">Biases. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00124">ABF.h:124</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a1638ba5a491140b9750ecdcfe5b033ed"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a1638ba5a491140b9750ecdcfe5b033ed">SSAGES::ABF::_N</a></div><div class="ttdeci">std::vector&lt; int &gt; _N</div><div class="ttdoc">To store number of hits at a given CV bin. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00066">ABF.h:66</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a50aa7ebf9920347d4d61382ba1b91234"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a50aa7ebf9920347d4d61382ba1b91234">SSAGES::ABF::Nworld_</a></div><div class="ttdeci">std::vector&lt; int &gt; Nworld_</div><div class="ttdoc">To store number of hits at a given CV bin. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00073">ABF.h:73</a></div></div>
<div class="ttc" id="namespaceSSAGES_html_a630084a0a5e185e89e21b3735f8f8b2e"><div class="ttname"><a href="namespaceSSAGES.html#a630084a0a5e185e89e21b3735f8f8b2e">SSAGES::Vector3</a></div><div class="ttdeci">Eigen::Vector3d Vector3</div><div class="ttdoc">Three-dimensional vector. </div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00033">types.h:33</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a9840f3256100510e585e0dc1ee450a42"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a9840f3256100510e585e0dc1ee450a42">SSAGES::ABF::Fworld_</a></div><div class="ttdeci">Eigen::VectorXd Fworld_</div><div class="ttdoc">Will hold the global total, synced to every time step. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00059">ABF.h:59</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a7c882e37a3676cb3e33776621929c3b7"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">SSAGES::ABF::wdotp1_</a></div><div class="ttdeci">Eigen::VectorXd wdotp1_</div><div class="ttdoc">To hold last two iterations wdotp value for derivative. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00104">ABF.h:104</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1ABF_a323024ab4c9c5d186b35af35f00bb5fb_cgraph.png" border="0" usemap="#classSSAGES_1_1ABF_a323024ab4c9c5d186b35af35f00bb5fb_cgraph" alt=""/></div>
<map name="classSSAGES_1_1ABF_a323024ab4c9c5d186b35af35f00bb5fb_cgraph" id="classSSAGES_1_1ABF_a323024ab4c9c5d186b35af35f00bb5fb_cgraph">
<area shape="rect" id="node2" href="classSSAGES_1_1Snapshot.html#aee2ceb317884bc5e0105b9824b5026d3" title="Access the particle positions. " alt="" coords="254,5,477,32"/><area shape="rect" id="node3" href="classSSAGES_1_1Snapshot.html#aacd28c6ce70534440930b7029167b3ae" title="Get walker ID. " alt="" coords="253,56,477,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="add6c1cacf2a4dc9b26fb305b88283e09"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ABF::Serialize </td>
          <td>(</td>
          <td class="paramtype">Json::Value &amp;&#160;</td>
          <td class="paramname"><em>json</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Serialize the class. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">json</td><td>JSON value to which the information is stored</td></tr>
  </table>
  </dd>
</dl>
<p>Store all information pertaining to this class in the given JSON value. The information can then be used to restart or analyze the simulation </p>

<p>Implements <a class="el" href="classSSAGES_1_1Serializable.html#aa4bc8d0ce033a025b0baa7cedccd8ebd">SSAGES::Serializable</a>.</p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00265">265</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

<p>References <a class="el" href="ABF_8h_source.html#l00052">_F</a>, <a class="el" href="ABF_8h_source.html#l00066">_N</a>, <a class="el" href="ABF_8h_source.html#l00156">FBackupInterv_</a>, <a class="el" href="ABF_8h_source.html#l00136">filename_</a>, <a class="el" href="ABF_8h_source.html#l00150">histdetails_</a>, <a class="el" href="Method_8h_source.html#l00048">SSAGES::Method::iteration_</a>, <a class="el" href="ABF_8h_source.html#l00101">min_</a>, <a class="el" href="ABF_8h_source.html#l00084">restraint_</a>, <a class="el" href="ABF_8h_source.html#l00174">timestep_</a>, and <a class="el" href="ABF_8h_source.html#l00165">unitconv_</a>.</p>
<div class="fragment"><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            json[<span class="stringliteral">&quot;type&quot;</span>] = <span class="stringliteral">&quot;ABF&quot;</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">histdetails_</a>.size(); ++i)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                json[<span class="stringliteral">&quot;CV_lower_bounds&quot;</span>].append(<a class="code" href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">histdetails_</a>[i][0]);             </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                json[<span class="stringliteral">&quot;CV_upper_bounds&quot;</span>].append(<a class="code" href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">histdetails_</a>[i][1]);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                json[<span class="stringliteral">&quot;CV_bins&quot;</span>].append(<a class="code" href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">histdetails_</a>[i][2]);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a>.size(); ++i)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                json[<span class="stringliteral">&quot;CV_restraint_minimums&quot;</span>].append(<a class="code" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a>[i][0]);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                json[<span class="stringliteral">&quot;CV_restraint_maximums&quot;</span>].append(<a class="code" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a>[i][1]);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                json[<span class="stringliteral">&quot;CV_restraint_spring_constants&quot;</span>].append(<a class="code" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a>[i][2]);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            json[<span class="stringliteral">&quot;timestep&quot;</span>] = <a class="code" href="classSSAGES_1_1ABF.html#a2c0bbf27d10f6f773a7215f5df4f78c9">timestep_</a>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            json[<span class="stringliteral">&quot;minimum_count&quot;</span>] = <a class="code" href="classSSAGES_1_1ABF.html#a88322f13d3424be20d46cf68a3c8ce28">min_</a>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            json[<span class="stringliteral">&quot;backup_frequency&quot;</span>] = <a class="code" href="classSSAGES_1_1ABF.html#acc2ac53b0342d31bce16cce64448830f">FBackupInterv_</a>;          </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            json[<span class="stringliteral">&quot;unit_conversion&quot;</span>] = <a class="code" href="classSSAGES_1_1ABF.html#a012104abf51fd7fe050a31fddc3c7180">unitconv_</a>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            json[<span class="stringliteral">&quot;iteration&quot;</span>] = <a class="code" href="classSSAGES_1_1Method.html#a1b83499833edfa7a5ecf5bb4f2de9a62">iteration_</a>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            json[<span class="stringliteral">&quot;filename&quot;</span>] = <a class="code" href="classSSAGES_1_1ABF.html#a86e220cdd655537e95b97b97384b506a">filename_</a>;       </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1ABF.html#a2760c0378a097c481029dcb9db3a469f">_F</a>.size(); ++i)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                json[<span class="stringliteral">&quot;F&quot;</span>].append(<a class="code" href="classSSAGES_1_1ABF.html#a2760c0378a097c481029dcb9db3a469f">_F</a>[i]);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1ABF.html#a1638ba5a491140b9750ecdcfe5b033ed">_N</a>.size(); ++i)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                json[<span class="stringliteral">&quot;N&quot;</span>].append(<a class="code" href="classSSAGES_1_1ABF.html#a1638ba5a491140b9750ecdcfe5b033ed">_N</a>[i]);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        }</div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a86e220cdd655537e95b97b97384b506a"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a86e220cdd655537e95b97b97384b506a">SSAGES::ABF::filename_</a></div><div class="ttdeci">std::string filename_</div><div class="ttdoc">File name for world data. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00136">ABF.h:136</a></div></div>
<div class="ttc" id="classSSAGES_1_1Method_html_a1b83499833edfa7a5ecf5bb4f2de9a62"><div class="ttname"><a href="classSSAGES_1_1Method.html#a1b83499833edfa7a5ecf5bb4f2de9a62">SSAGES::Method::iteration_</a></div><div class="ttdeci">unsigned int iteration_</div><div class="ttdoc">Number of the method iteration. </div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00048">Method.h:48</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a2760c0378a097c481029dcb9db3a469f"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a2760c0378a097c481029dcb9db3a469f">SSAGES::ABF::_F</a></div><div class="ttdeci">Eigen::VectorXd _F</div><div class="ttdoc">To store running total. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00052">ABF.h:52</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a012104abf51fd7fe050a31fddc3c7180"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a012104abf51fd7fe050a31fddc3c7180">SSAGES::ABF::unitconv_</a></div><div class="ttdeci">double unitconv_</div><div class="ttdoc">Unit Conversion Constant from W dot P to Force. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00165">ABF.h:165</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a060acb9e57d66e702de14ff8a5d36ee6"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">SSAGES::ABF::histdetails_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; histdetails_</div><div class="ttdoc">Histogram details. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00150">ABF.h:150</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a7e2b1995149d50d1b1e9d05e6a44c1b6"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">SSAGES::ABF::restraint_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; restraint_</div><div class="ttdoc">Information for a harmonic restraint to keep CV in the region of interest. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00084">ABF.h:84</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a1638ba5a491140b9750ecdcfe5b033ed"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a1638ba5a491140b9750ecdcfe5b033ed">SSAGES::ABF::_N</a></div><div class="ttdeci">std::vector&lt; int &gt; _N</div><div class="ttdoc">To store number of hits at a given CV bin. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00066">ABF.h:66</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a88322f13d3424be20d46cf68a3c8ce28"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a88322f13d3424be20d46cf68a3c8ce28">SSAGES::ABF::min_</a></div><div class="ttdeci">int min_</div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00101">ABF.h:101</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_acc2ac53b0342d31bce16cce64448830f"><div class="ttname"><a href="classSSAGES_1_1ABF.html#acc2ac53b0342d31bce16cce64448830f">SSAGES::ABF::FBackupInterv_</a></div><div class="ttdeci">int FBackupInterv_</div><div class="ttdoc">Integer to hold F estimate backup information. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00156">ABF.h:156</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a2c0bbf27d10f6f773a7215f5df4f78c9"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a2c0bbf27d10f6f773a7215f5df4f78c9">SSAGES::ABF::timestep_</a></div><div class="ttdeci">double timestep_</div><div class="ttdoc">Timestep of integration. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00174">ABF.h:174</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ace0de3fa44c9cad64655538451de7da8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ABF::SetHistogram </td>
          <td>(</td>
          <td class="paramtype">const Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>F</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set biasing histogram. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">F</td><td>Vector containing values for the running total. </td></tr>
    <tr><td class="paramname">N</td><td>Vector containing number of hits for bin intervals. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00249">249</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

<p>References <a class="el" href="ABF_8h_source.html#l00052">_F</a>, and <a class="el" href="ABF_8h_source.html#l00066">_N</a>.</p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <a class="code" href="classSSAGES_1_1ABF.html#a2760c0378a097c481029dcb9db3a469f">_F</a> = F;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <a class="code" href="classSSAGES_1_1ABF.html#a1638ba5a491140b9750ecdcfe5b033ed">_N</a> = N;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        }       </div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a2760c0378a097c481029dcb9db3a469f"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a2760c0378a097c481029dcb9db3a469f">SSAGES::ABF::_F</a></div><div class="ttdeci">Eigen::VectorXd _F</div><div class="ttdoc">To store running total. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00052">ABF.h:52</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a1638ba5a491140b9750ecdcfe5b033ed"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a1638ba5a491140b9750ecdcfe5b033ed">SSAGES::ABF::_N</a></div><div class="ttdeci">std::vector&lt; int &gt; _N</div><div class="ttdoc">To store number of hits at a given CV bin. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00066">ABF.h:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac206ccf90c29d11d6abdebeae44b033f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ABF::SetIteration </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iter</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set iteration of the method. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iter</td><td>New value for the iteration counter. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00259">259</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

<p>References <a class="el" href="Method_8h_source.html#l00048">SSAGES::Method::iteration_</a>.</p>
<div class="fragment"><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <a class="code" href="classSSAGES_1_1Method.html#a1b83499833edfa7a5ecf5bb4f2de9a62">iteration_</a> = iter;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        }           </div>
<div class="ttc" id="classSSAGES_1_1Method_html_a1b83499833edfa7a5ecf5bb4f2de9a62"><div class="ttname"><a href="classSSAGES_1_1Method.html#a1b83499833edfa7a5ecf5bb4f2de9a62">SSAGES::Method::iteration_</a></div><div class="ttdeci">unsigned int iteration_</div><div class="ttdoc">Number of the method iteration. </div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00048">Method.h:48</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a2760c0378a097c481029dcb9db3a469f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::VectorXd SSAGES::ABF::_F</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>To store running total. </p>
<p>A 1D vector, but will hold N-dimensional data, where N is number of CVs +1. This will be size (CVbinNr1*CVbinNr2*..)*3. </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00052">52</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

<p>Referenced by <a class="el" href="ABF_8cpp_source.html#l00143">PostIntegration()</a>, <a class="el" href="ABF_8cpp_source.html#l00097">PreSimulation()</a>, <a class="el" href="ABF_8h_source.html#l00265">Serialize()</a>, and <a class="el" href="ABF_8h_source.html#l00249">SetHistogram()</a>.</p>

</div>
</div>
<a class="anchor" id="a1638ba5a491140b9750ecdcfe5b033ed"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; SSAGES::ABF::_N</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>To store number of hits at a given CV bin. </p>
<p>A 1D vector, but will hold N-dimensional data, where N is number of CVs. This will be size (CVbinNr1*CVbinNr2*..). </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00066">66</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

<p>Referenced by <a class="el" href="ABF_8cpp_source.html#l00143">PostIntegration()</a>, <a class="el" href="ABF_8cpp_source.html#l00097">PreSimulation()</a>, <a class="el" href="ABF_8h_source.html#l00265">Serialize()</a>, <a class="el" href="ABF_8h_source.html#l00249">SetHistogram()</a>, and <a class="el" href="ABF_8cpp_source.html#l00289">WriteData()</a>.</p>

</div>
</div>
<a class="anchor" id="acc2ac53b0342d31bce16cce64448830f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SSAGES::ABF::FBackupInterv_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Integer to hold F estimate backup information. </p>
<p>Print every how many timesteps? ; -1: Do not backup during simulation </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00156">156</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

<p>Referenced by <a class="el" href="ABF_8cpp_source.html#l00143">PostIntegration()</a>, and <a class="el" href="ABF_8h_source.html#l00265">Serialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a9840f3256100510e585e0dc1ee450a42"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::VectorXd SSAGES::ABF::Fworld_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Will hold the global total, synced to every time step. </p>
<p>A 1D vector, but will hold N-dimensional data, where N is number of CVs +1. This will be size (CVbinNr1*CVbinNr2*..)*3. </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00059">59</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

<p>Referenced by <a class="el" href="ABF_8cpp_source.html#l00236">CalcBiasForce()</a>, <a class="el" href="ABF_8cpp_source.html#l00143">PostIntegration()</a>, <a class="el" href="ABF_8cpp_source.html#l00097">PreSimulation()</a>, and <a class="el" href="ABF_8cpp_source.html#l00289">WriteData()</a>.</p>

</div>
</div>
<a class="anchor" id="a060acb9e57d66e702de14ff8a5d36ee6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; SSAGES::ABF::histdetails_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classSSAGES_1_1Histogram.html" title="Basic Histogram. ">Histogram</a> details. </p>
<p>This is a 2 Dimensional object set up as the following: Histdetails is a vector of (nr of CV) vectors, ordered in CV order. Each of those vectors are 3 long. First entry of each vector holds the lower bound for that CV. Second entry of each vector holds the upper bound for that CV. Third entry of each vector holds the nr of bins for that CV dimension. </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00150">150</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

<p>Referenced by <a class="el" href="ABF_8cpp_source.html#l00047">histCoords()</a>, <a class="el" href="ABF_8cpp_source.html#l00097">PreSimulation()</a>, <a class="el" href="ABF_8h_source.html#l00265">Serialize()</a>, and <a class="el" href="ABF_8cpp_source.html#l00289">WriteData()</a>.</p>

</div>
</div>
<a class="anchor" id="a88322f13d3424be20d46cf68a3c8ce28"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SSAGES::ABF::min_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The minimum number of hits required before full biasing, bias is <em>F[i]/max(_N[i],min</em>). </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00101">101</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

<p>Referenced by <a class="el" href="ABF_8cpp_source.html#l00236">CalcBiasForce()</a>, <a class="el" href="ABF_8cpp_source.html#l00143">PostIntegration()</a>, <a class="el" href="ABF_8h_source.html#l00265">Serialize()</a>, and <a class="el" href="ABF_8cpp_source.html#l00289">WriteData()</a>.</p>

</div>
</div>
<a class="anchor" id="a50aa7ebf9920347d4d61382ba1b91234"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; SSAGES::ABF::Nworld_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>To store number of hits at a given CV bin. </p>
<p>A 1D vector, but will hold N-dimensional data, where N is number of CVs. This will be size (CVbinNr1*CVbinNr2*..). </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00073">73</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

<p>Referenced by <a class="el" href="ABF_8cpp_source.html#l00236">CalcBiasForce()</a>, <a class="el" href="ABF_8cpp_source.html#l00143">PostIntegration()</a>, <a class="el" href="ABF_8cpp_source.html#l00097">PreSimulation()</a>, and <a class="el" href="ABF_8cpp_source.html#l00289">WriteData()</a>.</p>

</div>
</div>
<a class="anchor" id="a85f39957134c0d27298aff5ad306cbd9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; SSAGES::ABF::periodicboundaries_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds periodic boundaries of CVs. </p>
<p>This is a 2 Dimensional object set up as the following: periodicboundaries_ is a vector of (nr of CV) vectors, ordered in CV order. Each of those vectors are 2 long. First entry of each vector holds the lower bound for that CV periodic boundary. Second entry of each vector holds the upper bound for that CV periodic boundary. </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00097">97</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

<p>Referenced by <a class="el" href="ABF_8cpp_source.html#l00236">CalcBiasForce()</a>.</p>

</div>
</div>
<a class="anchor" id="a7e2b1995149d50d1b1e9d05e6a44c1b6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; SSAGES::ABF::restraint_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Information for a harmonic restraint to keep CV in the region of interest. </p>
<p>This is a 2 Dimensional object set up as the following: restraint_ is a vector of (nr of CV) vectors, ordered in CV order. Each of those vectors are 3 long. First entry of each vector holds the lower bound for that CV restraint. Second entry of each vector holds the upper bound for that CV restraint. Third entry of each vector holds the spring constant for that CV restraint. </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00084">84</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

<p>Referenced by <a class="el" href="ABF_8cpp_source.html#l00236">CalcBiasForce()</a>, and <a class="el" href="ABF_8h_source.html#l00265">Serialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a012104abf51fd7fe050a31fddc3c7180"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SSAGES::ABF::unitconv_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Unit Conversion Constant from W dot P to Force. </p>
<p>It is crucial that unit conversion is entered correctly. Unit conversion from d(momentum)/d(time) to force for the simulation. For LAMMPS using units real, this is 2390.06 (gram.angstrom/mole.femtosecond^2 -&gt; kcal/mole.angstrom) </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00165">165</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

<p>Referenced by <a class="el" href="ABF_8cpp_source.html#l00143">PostIntegration()</a>, and <a class="el" href="ABF_8h_source.html#l00265">Serialize()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/cody/SSAGES/src/Methods/<a class="el" href="ABF_8h_source.html">ABF.h</a></li>
<li>/home/cody/SSAGES/src/Methods/<a class="el" href="ABF_8cpp_source.html">ABF.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jun 23 2017 15:44:19 for SSAGES by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
