<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SSAGES: SSAGES::ANN Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SSAGES
   &#160;<span id="projectnumber">0.9.3</span>
   </div>
   <div id="projectbrief">Software Suite for Advanced General Ensemble Simulations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceSSAGES.html">SSAGES</a></li><li class="navelem"><a class="el" href="classSSAGES_1_1ANN.html">ANN</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classSSAGES_1_1ANN-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">SSAGES::ANN Class Reference<div class="ingroups"><a class="el" href="group__Methods.html">Methods</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Artificial Neural Network <a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations.">Method</a>.  
 <a href="classSSAGES_1_1ANN.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ANN_8h_source.html">ANN.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for SSAGES::ANN:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1ANN__inherit__graph.png" border="0" usemap="#aSSAGES_1_1ANN_inherit__map" alt="Inheritance graph"/></div>
<map name="aSSAGES_1_1ANN_inherit__map" id="aSSAGES_1_1ANN_inherit__map">
<area shape="rect" title="Artificial Neural Network Method." alt="" coords="31,155,145,181"/>
<area shape="rect" href="classSSAGES_1_1Method.html" title="Interface for Method implementations." alt="" coords="24,80,152,107"/>
<area shape="rect" href="classSSAGES_1_1EventListener.html" title="Base abstract class for listening in to events fired by &quot;Hook&quot;." alt="" coords="5,5,171,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a95d94629470f17e50215ff378d7ecd91"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a95d94629470f17e50215ff378d7ecd91">ANN</a> (const MPI_Comm &amp;world, const MPI_Comm &amp;comm, const Eigen::VectorXi &amp;topol, <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; Eigen::VectorXd &gt; *fgrid, <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; unsigned int &gt; *hgrid, <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; *ugrid, const std::vector&lt; double &gt; &amp;lowerb, const std::vector&lt; double &gt; &amp;upperb, const std::vector&lt; double &gt; &amp;lowerk, const std::vector&lt; double &gt; &amp;upperk, double temperature, double weight, unsigned int nsweep)</td></tr>
<tr class="memdesc:a95d94629470f17e50215ff378d7ecd91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classSSAGES_1_1ANN.html#a95d94629470f17e50215ff378d7ecd91">More...</a><br /></td></tr>
<tr class="separator:a95d94629470f17e50215ff378d7ecd91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86e2611b4516c8a465014919139aae19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a86e2611b4516c8a465014919139aae19">PreSimulation</a> (<a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *snapshot, const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;cvmanager) override</td></tr>
<tr class="memdesc:a86e2611b4516c8a465014919139aae19"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations.">Method</a> call prior to simulation initiation.  <a href="classSSAGES_1_1ANN.html#a86e2611b4516c8a465014919139aae19">More...</a><br /></td></tr>
<tr class="separator:a86e2611b4516c8a465014919139aae19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad63d276efae1a266eb5d556bdf896a98"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#ad63d276efae1a266eb5d556bdf896a98">PostIntegration</a> (<a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *snapshot, const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;cvmanager) override</td></tr>
<tr class="memdesc:ad63d276efae1a266eb5d556bdf896a98"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations.">Method</a> call post integration.  <a href="classSSAGES_1_1ANN.html#ad63d276efae1a266eb5d556bdf896a98">More...</a><br /></td></tr>
<tr class="separator:ad63d276efae1a266eb5d556bdf896a98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a187df3448f650a0bb3452bf7c1c12fe8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a187df3448f650a0bb3452bf7c1c12fe8">PostSimulation</a> (<a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *snapshot, const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;cvmanager) override</td></tr>
<tr class="memdesc:a187df3448f650a0bb3452bf7c1c12fe8"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations.">Method</a> call post simulation.  <a href="classSSAGES_1_1ANN.html#a187df3448f650a0bb3452bf7c1c12fe8">More...</a><br /></td></tr>
<tr class="separator:a187df3448f650a0bb3452bf7c1c12fe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab39aaad92da34d5d11a10287feee53b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#ab39aaad92da34d5d11a10287feee53b3">SetPrevWeight</a> (double h)</td></tr>
<tr class="memdesc:ab39aaad92da34d5d11a10287feee53b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set previous history weight.  <a href="classSSAGES_1_1ANN.html#ab39aaad92da34d5d11a10287feee53b3">More...</a><br /></td></tr>
<tr class="separator:ab39aaad92da34d5d11a10287feee53b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45bb57007aa90bf3fc04a875b190145e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a45bb57007aa90bf3fc04a875b190145e">SetOutput</a> (const std::string &amp;outfile)</td></tr>
<tr class="memdesc:a45bb57007aa90bf3fc04a875b190145e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set name of output file.  <a href="classSSAGES_1_1ANN.html#a45bb57007aa90bf3fc04a875b190145e">More...</a><br /></td></tr>
<tr class="separator:a45bb57007aa90bf3fc04a875b190145e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af48fa9793d0b1df77f0f2681072e76d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#af48fa9793d0b1df77f0f2681072e76d2">SetOutputOverwrite</a> (bool overwrite)</td></tr>
<tr class="memdesc:af48fa9793d0b1df77f0f2681072e76d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set overwrite flag on output file.  <a href="classSSAGES_1_1ANN.html#af48fa9793d0b1df77f0f2681072e76d2">More...</a><br /></td></tr>
<tr class="separator:af48fa9793d0b1df77f0f2681072e76d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f33ebd17115c4a8f4ed3739931f85e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a2f33ebd17115c4a8f4ed3739931f85e5">SetConvergeIters</a> (unsigned int citers)</td></tr>
<tr class="memdesc:a2f33ebd17115c4a8f4ed3739931f85e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set number of iterations after which we turn on full weight.  <a href="classSSAGES_1_1ANN.html#a2f33ebd17115c4a8f4ed3739931f85e5">More...</a><br /></td></tr>
<tr class="separator:a2f33ebd17115c4a8f4ed3739931f85e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30e6d7784fff0ac842e67001f28bc784"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a30e6d7784fff0ac842e67001f28bc784">SetMaxIters</a> (unsigned int iters)</td></tr>
<tr class="memdesc:a30e6d7784fff0ac842e67001f28bc784"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set maximum number of training iterations per sweep.  <a href="classSSAGES_1_1ANN.html#a30e6d7784fff0ac842e67001f28bc784">More...</a><br /></td></tr>
<tr class="separator:a30e6d7784fff0ac842e67001f28bc784"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05554b5f5f718f20d772fabf814e3e4c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a05554b5f5f718f20d772fabf814e3e4c">SetMinLoss</a> (double loss)</td></tr>
<tr class="memdesc:a05554b5f5f718f20d772fabf814e3e4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set minimum loss function value (should be zero for production).  <a href="classSSAGES_1_1ANN.html#a05554b5f5f718f20d772fabf814e3e4c">More...</a><br /></td></tr>
<tr class="separator:a05554b5f5f718f20d772fabf814e3e4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab136bbdda45ca2672145e545f25c64f9"><td class="memItemLeft" align="right" valign="top"><a id="ab136bbdda45ca2672145e545f25c64f9"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#ab136bbdda45ca2672145e545f25c64f9">ReadBias</a> (const std::string &amp;, const std::string &amp;)</td></tr>
<tr class="memdesc:ab136bbdda45ca2672145e545f25c64f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load network state and bias from file. <br /></td></tr>
<tr class="separator:ab136bbdda45ca2672145e545f25c64f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classSSAGES_1_1Method"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classSSAGES_1_1Method')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classSSAGES_1_1Method.html">SSAGES::Method</a></td></tr>
<tr class="memitem:ad751450ecd30e8ab40024c6f5e870d30 inherit pub_methods_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#ad751450ecd30e8ab40024c6f5e870d30">Method</a> (unsigned int frequency, const MPI_Comm &amp;world, const MPI_Comm &amp;comm)</td></tr>
<tr class="memdesc:ad751450ecd30e8ab40024c6f5e870d30 inherit pub_methods_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classSSAGES_1_1Method.html#ad751450ecd30e8ab40024c6f5e870d30">More...</a><br /></td></tr>
<tr class="separator:ad751450ecd30e8ab40024c6f5e870d30 inherit pub_methods_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a701c90bfcddeb2099b78528fea850c07 inherit pub_methods_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a701c90bfcddeb2099b78528fea850c07">SetCVMask</a> (const std::vector&lt; unsigned int &gt; &amp;mask)</td></tr>
<tr class="memdesc:a701c90bfcddeb2099b78528fea850c07 inherit pub_methods_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the collective variable mask.  <a href="classSSAGES_1_1Method.html#a701c90bfcddeb2099b78528fea850c07">More...</a><br /></td></tr>
<tr class="separator:a701c90bfcddeb2099b78528fea850c07 inherit pub_methods_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86b979a552970f63a8edf160387f6ff9 inherit pub_methods_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top"><a id="a86b979a552970f63a8edf160387f6ff9"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a86b979a552970f63a8edf160387f6ff9">~Method</a> ()</td></tr>
<tr class="memdesc:a86b979a552970f63a8edf160387f6ff9 inherit pub_methods_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:a86b979a552970f63a8edf160387f6ff9 inherit pub_methods_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classSSAGES_1_1EventListener"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classSSAGES_1_1EventListener')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classSSAGES_1_1EventListener.html">SSAGES::EventListener</a></td></tr>
<tr class="memitem:a4a4d51653806e0348e9d1c99890bb87b inherit pub_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#a4a4d51653806e0348e9d1c99890bb87b">EventListener</a> (unsigned int frequency)</td></tr>
<tr class="memdesc:a4a4d51653806e0348e9d1c99890bb87b inherit pub_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classSSAGES_1_1EventListener.html#a4a4d51653806e0348e9d1c99890bb87b">More...</a><br /></td></tr>
<tr class="separator:a4a4d51653806e0348e9d1c99890bb87b inherit pub_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82dd6716f443cd24451e7355c2353614 inherit pub_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#a82dd6716f443cd24451e7355c2353614">GetFrequency</a> () const</td></tr>
<tr class="memdesc:a82dd6716f443cd24451e7355c2353614 inherit pub_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get frequency of event listener.  <a href="classSSAGES_1_1EventListener.html#a82dd6716f443cd24451e7355c2353614">More...</a><br /></td></tr>
<tr class="separator:a82dd6716f443cd24451e7355c2353614 inherit pub_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cadffb0e82186a12023dd5963c3c5b1 inherit pub_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top"><a id="a7cadffb0e82186a12023dd5963c3c5b1"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#a7cadffb0e82186a12023dd5963c3c5b1">~EventListener</a> ()</td></tr>
<tr class="memdesc:a7cadffb0e82186a12023dd5963c3c5b1 inherit pub_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:a7cadffb0e82186a12023dd5963c3c5b1 inherit pub_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a44c8469ee6fc94c4c2be239684a9bf14"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSSAGES_1_1ANN.html">ANN</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a44c8469ee6fc94c4c2be239684a9bf14">Build</a> (const Json::Value &amp;json, const MPI_Comm &amp;world, const MPI_Comm &amp;comm, const std::string &amp;path)</td></tr>
<tr class="memdesc:a44c8469ee6fc94c4c2be239684a9bf14"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build a derived method from <a class="el" href="namespaceJSON.html">JSON</a> node.  <a href="classSSAGES_1_1ANN.html#a44c8469ee6fc94c4c2be239684a9bf14">More...</a><br /></td></tr>
<tr class="separator:a44c8469ee6fc94c4c2be239684a9bf14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_classSSAGES_1_1Method"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classSSAGES_1_1Method')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classSSAGES_1_1Method.html">SSAGES::Method</a></td></tr>
<tr class="memitem:a1464579bb8b15653ccd0ffa834e15e93 inherit pub_static_methods_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSSAGES_1_1Method.html">Method</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a1464579bb8b15653ccd0ffa834e15e93">BuildMethod</a> (const Json::Value &amp;json, const MPI_Comm &amp;world, const MPI_Comm &amp;comm, const std::string &amp;path)</td></tr>
<tr class="memdesc:a1464579bb8b15653ccd0ffa834e15e93 inherit pub_static_methods_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build a derived method from <a class="el" href="namespaceJSON.html">JSON</a> node.  <a href="classSSAGES_1_1Method.html#a1464579bb8b15653ccd0ffa834e15e93">More...</a><br /></td></tr>
<tr class="separator:a1464579bb8b15653ccd0ffa834e15e93 inherit pub_static_methods_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_classSSAGES_1_1EventListener"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classSSAGES_1_1EventListener')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classSSAGES_1_1EventListener.html">SSAGES::EventListener</a></td></tr>
<tr class="memitem:affe4b9179e312192ba364d44f0638874 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top">static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#affe4b9179e312192ba364d44f0638874">GetWalkerID</a> (const MPI_Comm &amp;world, const MPI_Comm &amp;comm)</td></tr>
<tr class="memdesc:affe4b9179e312192ba364d44f0638874 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get walker ID number of specified communicator.  <a href="classSSAGES_1_1EventListener.html#affe4b9179e312192ba364d44f0638874">More...</a><br /></td></tr>
<tr class="separator:affe4b9179e312192ba364d44f0638874 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a917f9526b9adfa66166eafb5b9b34d54 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top">static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#a917f9526b9adfa66166eafb5b9b34d54">GetNumWalkers</a> (const MPI_Comm &amp;world, const MPI_Comm &amp;comm)</td></tr>
<tr class="memdesc:a917f9526b9adfa66166eafb5b9b34d54 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get total number of walkers in the simulation.  <a href="classSSAGES_1_1EventListener.html#a917f9526b9adfa66166eafb5b9b34d54">More...</a><br /></td></tr>
<tr class="separator:a917f9526b9adfa66166eafb5b9b34d54 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9666daacfb047c1dd279ea339524d07 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#af9666daacfb047c1dd279ea339524d07">IsMasterRank</a> (const MPI_Comm &amp;comm)</td></tr>
<tr class="memdesc:af9666daacfb047c1dd279ea339524d07 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if current processor is master.  <a href="classSSAGES_1_1EventListener.html#af9666daacfb047c1dd279ea339524d07">More...</a><br /></td></tr>
<tr class="separator:af9666daacfb047c1dd279ea339524d07 inherit pub_static_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a7091cb356fa05bc0b21a4e37144fb0b7"><td class="memItemLeft" align="right" valign="top"><a id="a7091cb356fa05bc0b21a4e37144fb0b7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a7091cb356fa05bc0b21a4e37144fb0b7">TrainNetwork</a> ()</td></tr>
<tr class="memdesc:a7091cb356fa05bc0b21a4e37144fb0b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trains the neural network. <br /></td></tr>
<tr class="separator:a7091cb356fa05bc0b21a4e37144fb0b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfdfae96fc9c752323828e2c222ef006"><td class="memItemLeft" align="right" valign="top"><a id="acfdfae96fc9c752323828e2c222ef006"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#acfdfae96fc9c752323828e2c222ef006">WriteBias</a> ()</td></tr>
<tr class="memdesc:acfdfae96fc9c752323828e2c222ef006"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes out the bias to file. <br /></td></tr>
<tr class="separator:acfdfae96fc9c752323828e2c222ef006"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:acde42146cf0a2e50851da4fe74b7d14f"><td class="memItemLeft" align="right" valign="top"><a id="acde42146cf0a2e50851da4fe74b7d14f"></a>
Eigen::VectorXi&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#acde42146cf0a2e50851da4fe74b7d14f">topol_</a></td></tr>
<tr class="memdesc:acde42146cf0a2e50851da4fe74b7d14f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Neural network topology. <br /></td></tr>
<tr class="separator:acde42146cf0a2e50851da4fe74b7d14f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac85a0999687739a805c0782e7421f2b1"><td class="memItemLeft" align="right" valign="top"><a id="ac85a0999687739a805c0782e7421f2b1"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#ac85a0999687739a805c0782e7421f2b1">citers_</a></td></tr>
<tr class="memdesc:ac85a0999687739a805c0782e7421f2b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of iterations after which we turn on full weight. <br /></td></tr>
<tr class="separator:ac85a0999687739a805c0782e7421f2b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8df5bc974f48135e0add44d77b91182a"><td class="memItemLeft" align="right" valign="top"><a id="a8df5bc974f48135e0add44d77b91182a"></a>
nnet::neural_net&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a8df5bc974f48135e0add44d77b91182a">net_</a></td></tr>
<tr class="memdesc:a8df5bc974f48135e0add44d77b91182a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Neural network. <br /></td></tr>
<tr class="separator:a8df5bc974f48135e0add44d77b91182a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b12b03e1b6585461b83264c9adf6e30"><td class="memItemLeft" align="right" valign="top"><a id="a8b12b03e1b6585461b83264c9adf6e30"></a>
<a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; Eigen::VectorXd &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a8b12b03e1b6585461b83264c9adf6e30">fgrid_</a></td></tr>
<tr class="memdesc:a8b12b03e1b6585461b83264c9adf6e30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force grid. <br /></td></tr>
<tr class="separator:a8b12b03e1b6585461b83264c9adf6e30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ec3000737e404aedce966587dc538ba"><td class="memItemLeft" align="right" valign="top"><a id="a1ec3000737e404aedce966587dc538ba"></a>
<a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; unsigned int &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a1ec3000737e404aedce966587dc538ba">hgrid_</a></td></tr>
<tr class="memdesc:a1ec3000737e404aedce966587dc538ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Histogram grid. <br /></td></tr>
<tr class="separator:a1ec3000737e404aedce966587dc538ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae925218647bd62eccf8d2983a87baad8"><td class="memItemLeft" align="right" valign="top"><a id="ae925218647bd62eccf8d2983a87baad8"></a>
<a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#ae925218647bd62eccf8d2983a87baad8">ugrid_</a></td></tr>
<tr class="memdesc:ae925218647bd62eccf8d2983a87baad8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unbiased histogram grid. <br /></td></tr>
<tr class="separator:ae925218647bd62eccf8d2983a87baad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad799d7e14579192477a450338f1cf330"><td class="memItemLeft" align="right" valign="top"><a id="ad799d7e14579192477a450338f1cf330"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#ad799d7e14579192477a450338f1cf330">outfile_</a></td></tr>
<tr class="memdesc:ad799d7e14579192477a450338f1cf330"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output filename. <br /></td></tr>
<tr class="separator:ad799d7e14579192477a450338f1cf330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e5bc5f5f6a8e2cf2be0f715099eb266"><td class="memItemLeft" align="right" valign="top"><a id="a6e5bc5f5f6a8e2cf2be0f715099eb266"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a6e5bc5f5f6a8e2cf2be0f715099eb266">preloaded_</a></td></tr>
<tr class="memdesc:a6e5bc5f5f6a8e2cf2be0f715099eb266"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is the network preloaded? <br /></td></tr>
<tr class="separator:a6e5bc5f5f6a8e2cf2be0f715099eb266"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae928d6e1f11b3a9aca40c7a473d4df91"><td class="memItemLeft" align="right" valign="top"><a id="ae928d6e1f11b3a9aca40c7a473d4df91"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#ae928d6e1f11b3a9aca40c7a473d4df91">overwrite_</a></td></tr>
<tr class="memdesc:ae928d6e1f11b3a9aca40c7a473d4df91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overwrite outputs? <br /></td></tr>
<tr class="separator:ae928d6e1f11b3a9aca40c7a473d4df91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a87307160193744fa3c445c8271c8678b"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a87307160193744fa3c445c8271c8678b">sweep_</a></td></tr>
<tr class="separator:a87307160193744fa3c445c8271c8678b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73f6776ff6c4656c5f910f113d558119"><td class="memItemLeft" align="right" valign="top"><a id="a73f6776ff6c4656c5f910f113d558119"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><b>nsweep_</b></td></tr>
<tr class="separator:a73f6776ff6c4656c5f910f113d558119"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:aa46e3420f46726cfa7766eaba5d53246"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#aa46e3420f46726cfa7766eaba5d53246">pweight_</a></td></tr>
<tr class="separator:aa46e3420f46726cfa7766eaba5d53246"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd7f3ff61f4e254881b3e26ea0ffab7a"><td class="memItemLeft" align="right" valign="top"><a id="abd7f3ff61f4e254881b3e26ea0ffab7a"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>weight_</b></td></tr>
<tr class="separator:abd7f3ff61f4e254881b3e26ea0ffab7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a1ef25a7766497d57498b194eb3d31b42"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a1ef25a7766497d57498b194eb3d31b42">temp_</a></td></tr>
<tr class="separator:a1ef25a7766497d57498b194eb3d31b42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29c406c4356896c11df23a003e38defb"><td class="memItemLeft" align="right" valign="top"><a id="a29c406c4356896c11df23a003e38defb"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>kbt_</b></td></tr>
<tr class="separator:a29c406c4356896c11df23a003e38defb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a5649c47eadcb28453c506587f83260f0"><td class="memItemLeft" align="right" valign="top">Eigen::MatrixXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a5649c47eadcb28453c506587f83260f0">hist_</a></td></tr>
<tr class="separator:a5649c47eadcb28453c506587f83260f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeaa3b34c92b1b85166e8bee495363a3"><td class="memItemLeft" align="right" valign="top"><a id="aaeaa3b34c92b1b85166e8bee495363a3"></a>
Eigen::MatrixXd&#160;</td><td class="memItemRight" valign="bottom"><b>bias_</b></td></tr>
<tr class="separator:aaeaa3b34c92b1b85166e8bee495363a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b56cf6b17dbcd6c85b15ec84e973d35"><td class="memItemLeft" align="right" valign="top"><a id="a4b56cf6b17dbcd6c85b15ec84e973d35"></a>
Eigen::MatrixXd&#160;</td><td class="memItemRight" valign="bottom"><b>rbias_</b></td></tr>
<tr class="separator:a4b56cf6b17dbcd6c85b15ec84e973d35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a022a5d90efc1c7d77f243bc6a30c2757"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a022a5d90efc1c7d77f243bc6a30c2757">lowerb_</a></td></tr>
<tr class="separator:a022a5d90efc1c7d77f243bc6a30c2757"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d66a5b43d97785dc138558a7e6d5f8a"><td class="memItemLeft" align="right" valign="top"><a id="a9d66a5b43d97785dc138558a7e6d5f8a"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>upperb_</b></td></tr>
<tr class="separator:a9d66a5b43d97785dc138558a7e6d5f8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a2d8da6902233c66212aecfe108aa08f7"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ANN.html#a2d8da6902233c66212aecfe108aa08f7">lowerk_</a></td></tr>
<tr class="separator:a2d8da6902233c66212aecfe108aa08f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2dff49ae14467657ed47781a7afc2c5"><td class="memItemLeft" align="right" valign="top"><a id="ab2dff49ae14467657ed47781a7afc2c5"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>upperk_</b></td></tr>
<tr class="separator:ab2dff49ae14467657ed47781a7afc2c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classSSAGES_1_1Method"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classSSAGES_1_1Method')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classSSAGES_1_1Method.html">SSAGES::Method</a></td></tr>
<tr class="memitem:a8471b11097a1018a9635bc578bf22f61 inherit pro_attribs_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top"><a id="a8471b11097a1018a9635bc578bf22f61"></a>
mxx::comm&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">world_</a></td></tr>
<tr class="memdesc:a8471b11097a1018a9635bc578bf22f61 inherit pro_attribs_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global MPI communicator. <br /></td></tr>
<tr class="separator:a8471b11097a1018a9635bc578bf22f61 inherit pro_attribs_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1118666d61dbf3bc7606e3b61aa3a460 inherit pro_attribs_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top"><a id="a1118666d61dbf3bc7606e3b61aa3a460"></a>
mxx::comm&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a1118666d61dbf3bc7606e3b61aa3a460">comm_</a></td></tr>
<tr class="memdesc:a1118666d61dbf3bc7606e3b61aa3a460 inherit pro_attribs_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local MPI communicator. <br /></td></tr>
<tr class="separator:a1118666d61dbf3bc7606e3b61aa3a460 inherit pro_attribs_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24b0ac53b1fabcab0a5f3bd6cde26909 inherit pro_attribs_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top"><a id="a24b0ac53b1fabcab0a5f3bd6cde26909"></a>
std::vector&lt; unsigned int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a24b0ac53b1fabcab0a5f3bd6cde26909">cvmask_</a></td></tr>
<tr class="memdesc:a24b0ac53b1fabcab0a5f3bd6cde26909 inherit pro_attribs_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mask which identifies which CVs to act on. <br /></td></tr>
<tr class="separator:a24b0ac53b1fabcab0a5f3bd6cde26909 inherit pro_attribs_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Artificial Neural Network <a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations.">Method</a>. </p>
<p>Implementation of the Artificial Neural Network <a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations.">Method</a> based on <a class="el" href="citelist.html#CITEREF_SIDKY2018104111">[3]</a> </p>

<p class="definition">Definition at line <a class="el" href="ANN_8h_source.html#l00035">35</a> of file <a class="el" href="ANN_8h_source.html">ANN.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a95d94629470f17e50215ff378d7ecd91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95d94629470f17e50215ff378d7ecd91">&#9670;&nbsp;</a></span>ANN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SSAGES::ANN::ANN </td>
          <td>(</td>
          <td class="paramtype">const MPI_Comm &amp;&#160;</td>
          <td class="paramname"><em>world</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MPI_Comm &amp;&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::VectorXi &amp;&#160;</td>
          <td class="paramname"><em>topol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; Eigen::VectorXd &gt; *&#160;</td>
          <td class="paramname"><em>fgrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; unsigned int &gt; *&#160;</td>
          <td class="paramname"><em>hgrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>ugrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>lowerb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>upperb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>lowerk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>upperk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>nsweep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">world</td><td>MPI global communicator. </td></tr>
    <tr><td class="paramname">comm</td><td>MPI local communicator. </td></tr>
    <tr><td class="paramname">topol</td><td>Topology of network. </td></tr>
    <tr><td class="paramname">fgrid</td><td><a class="el" href="classSSAGES_1_1Grid.html" title="Basic Grid.">Grid</a> containing biasing forces. </td></tr>
    <tr><td class="paramname">hgrid</td><td><a class="el" href="classSSAGES_1_1Grid.html" title="Basic Grid.">Grid</a> containing histogram. </td></tr>
    <tr><td class="paramname">ugrid</td><td><a class="el" href="classSSAGES_1_1Grid.html" title="Basic Grid.">Grid</a> containing unbiased histogram. </td></tr>
    <tr><td class="paramname">lowerb</td><td>Lower bounds for CVs. </td></tr>
    <tr><td class="paramname">upperb</td><td>Upper bounds for CVs. </td></tr>
    <tr><td class="paramname">lowerk</td><td>Lower bound restraints for CVs. </td></tr>
    <tr><td class="paramname">upperk</td><td>Upper bound restraints for CVs. </td></tr>
    <tr><td class="paramname">temperature</td><td>Temperature of the simulation. </td></tr>
    <tr><td class="paramname">weight</td><td>Relative weight of the statistics in sweep. </td></tr>
    <tr><td class="paramname">nsweep</td><td>Number of iterations in the sweep.</td></tr>
  </table>
  </dd>
</dl>
<p>Constructs an instance of Artificial Neural Network method. </p>

<p class="definition">Definition at line <a class="el" href="ANN_8cpp_source.html#l00034">34</a> of file <a class="el" href="ANN_8cpp_source.html">ANN.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                  :</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="classSSAGES_1_1Method.html#ad751450ecd30e8ab40024c6f5e870d30">Method</a>(1, world, comm), <a class="code" href="classSSAGES_1_1ANN.html#acde42146cf0a2e50851da4fe74b7d14f">topol_</a>(topol), <a class="code" href="classSSAGES_1_1ANN.html#a87307160193744fa3c445c8271c8678b">sweep_</a>(0), nsweep_(nsweep),</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="classSSAGES_1_1ANN.html#ac85a0999687739a805c0782e7421f2b1">citers_</a>(0), <a class="code" href="classSSAGES_1_1ANN.html#a8df5bc974f48135e0add44d77b91182a">net_</a>(topol), <a class="code" href="classSSAGES_1_1ANN.html#aa46e3420f46726cfa7766eaba5d53246">pweight_</a>(1.), weight_(weight), <a class="code" href="classSSAGES_1_1ANN.html#a1ef25a7766497d57498b194eb3d31b42">temp_</a>(temperature),</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    kbt_(0), <a class="code" href="classSSAGES_1_1ANN.html#a8b12b03e1b6585461b83264c9adf6e30">fgrid_</a>(fgrid), <a class="code" href="classSSAGES_1_1ANN.html#a1ec3000737e404aedce966587dc538ba">hgrid_</a>(hgrid), <a class="code" href="classSSAGES_1_1ANN.html#ae925218647bd62eccf8d2983a87baad8">ugrid_</a>(ugrid), <a class="code" href="classSSAGES_1_1ANN.html#a5649c47eadcb28453c506587f83260f0">hist_</a>(), bias_(),</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="classSSAGES_1_1ANN.html#a022a5d90efc1c7d77f243bc6a30c2757">lowerb_</a>(lowerb), upperb_(upperb), <a class="code" href="classSSAGES_1_1ANN.html#a2d8da6902233c66212aecfe108aa08f7">lowerk_</a>(lowerk), upperk_(upperk),</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="classSSAGES_1_1ANN.html#ad799d7e14579192477a450338f1cf330">outfile_</a>(<span class="stringliteral">&quot;ann.out&quot;</span>), <a class="code" href="classSSAGES_1_1ANN.html#a6e5bc5f5f6a8e2cf2be0f715099eb266">preloaded_</a>(<span class="keyword">false</span>), <a class="code" href="classSSAGES_1_1ANN.html#ae928d6e1f11b3a9aca40c7a473d4df91">overwrite_</a>(<span class="keyword">true</span>)</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="comment">// Create histogram grid matrix.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="classSSAGES_1_1ANN.html#a5649c47eadcb28453c506587f83260f0">hist_</a>.resize(<a class="code" href="classSSAGES_1_1ANN.html#a1ec3000737e404aedce966587dc538ba">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a4f8abb752ae6ec51ebcf24b599bf4896">size</a>(), <a class="code" href="classSSAGES_1_1ANN.html#a1ec3000737e404aedce966587dc538ba">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a72f98ef47da691b00823d612efbd46b8">GetDimension</a>());</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="comment">// Fill it up.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span> it = <a class="code" href="classSSAGES_1_1ANN.html#a1ec3000737e404aedce966587dc538ba">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1Grid.html#a709374b3cadf320347604077a2e45e5b">begin</a>(); it != <a class="code" href="classSSAGES_1_1ANN.html#a1ec3000737e404aedce966587dc538ba">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1Grid.html#ac4fcc9f0cd61476ce4fd880c768d9694">end</a>(); ++it)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            <span class="keyword">auto</span> coord = it.coordinates();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> j = 0; j &lt; coord.size(); ++j)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                <a class="code" href="classSSAGES_1_1ANN.html#a5649c47eadcb28453c506587f83260f0">hist_</a>(i, j) = coord[j];</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            ++i;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="comment">// Initialize restraint reweight vector.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        rbias_.resize(<a class="code" href="classSSAGES_1_1ANN.html#a1ec3000737e404aedce966587dc538ba">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a4f8abb752ae6ec51ebcf24b599bf4896">size</a>(), <a class="code" href="classSSAGES_1_1ANN.html#a1ec3000737e404aedce966587dc538ba">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a72f98ef47da691b00823d612efbd46b8">GetDimension</a>());</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        rbias_.fill(0);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="comment">// Initialize FES vector.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        bias_.resize(<a class="code" href="classSSAGES_1_1ANN.html#a1ec3000737e404aedce966587dc538ba">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a4f8abb752ae6ec51ebcf24b599bf4896">size</a>(), 1);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <a class="code" href="classSSAGES_1_1ANN.html#a8df5bc974f48135e0add44d77b91182a">net_</a>.forward_pass(<a class="code" href="classSSAGES_1_1ANN.html#a5649c47eadcb28453c506587f83260f0">hist_</a>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        bias_.array() = <a class="code" href="classSSAGES_1_1ANN.html#a8df5bc974f48135e0add44d77b91182a">net_</a>.get_activation().col(0).array();</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_a022a5d90efc1c7d77f243bc6a30c2757"><div class="ttname"><a href="classSSAGES_1_1ANN.html#a022a5d90efc1c7d77f243bc6a30c2757">SSAGES::ANN::lowerb_</a></div><div class="ttdeci">std::vector&lt; double &gt; lowerb_</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8h_source.html#l00078">ANN.h:78</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_a1ec3000737e404aedce966587dc538ba"><div class="ttname"><a href="classSSAGES_1_1ANN.html#a1ec3000737e404aedce966587dc538ba">SSAGES::ANN::hgrid_</a></div><div class="ttdeci">Grid&lt; unsigned int &gt; * hgrid_</div><div class="ttdoc">Histogram grid.</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8h_source.html#l00066">ANN.h:66</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_a1ef25a7766497d57498b194eb3d31b42"><div class="ttname"><a href="classSSAGES_1_1ANN.html#a1ef25a7766497d57498b194eb3d31b42">SSAGES::ANN::temp_</a></div><div class="ttdeci">double temp_</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8h_source.html#l00059">ANN.h:59</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_a2d8da6902233c66212aecfe108aa08f7"><div class="ttname"><a href="classSSAGES_1_1ANN.html#a2d8da6902233c66212aecfe108aa08f7">SSAGES::ANN::lowerk_</a></div><div class="ttdeci">std::vector&lt; double &gt; lowerk_</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8h_source.html#l00083">ANN.h:83</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_a5649c47eadcb28453c506587f83260f0"><div class="ttname"><a href="classSSAGES_1_1ANN.html#a5649c47eadcb28453c506587f83260f0">SSAGES::ANN::hist_</a></div><div class="ttdeci">Eigen::MatrixXd hist_</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8h_source.html#l00073">ANN.h:73</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_a6e5bc5f5f6a8e2cf2be0f715099eb266"><div class="ttname"><a href="classSSAGES_1_1ANN.html#a6e5bc5f5f6a8e2cf2be0f715099eb266">SSAGES::ANN::preloaded_</a></div><div class="ttdeci">bool preloaded_</div><div class="ttdoc">Is the network preloaded?</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8h_source.html#l00090">ANN.h:90</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_a87307160193744fa3c445c8271c8678b"><div class="ttname"><a href="classSSAGES_1_1ANN.html#a87307160193744fa3c445c8271c8678b">SSAGES::ANN::sweep_</a></div><div class="ttdeci">unsigned int sweep_</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8h_source.html#l00043">ANN.h:43</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_a8b12b03e1b6585461b83264c9adf6e30"><div class="ttname"><a href="classSSAGES_1_1ANN.html#a8b12b03e1b6585461b83264c9adf6e30">SSAGES::ANN::fgrid_</a></div><div class="ttdeci">Grid&lt; Eigen::VectorXd &gt; * fgrid_</div><div class="ttdoc">Force grid.</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8h_source.html#l00063">ANN.h:63</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_a8df5bc974f48135e0add44d77b91182a"><div class="ttname"><a href="classSSAGES_1_1ANN.html#a8df5bc974f48135e0add44d77b91182a">SSAGES::ANN::net_</a></div><div class="ttdeci">nnet::neural_net net_</div><div class="ttdoc">Neural network.</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8h_source.html#l00050">ANN.h:50</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_aa46e3420f46726cfa7766eaba5d53246"><div class="ttname"><a href="classSSAGES_1_1ANN.html#aa46e3420f46726cfa7766eaba5d53246">SSAGES::ANN::pweight_</a></div><div class="ttdeci">double pweight_</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8h_source.html#l00054">ANN.h:54</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_ac85a0999687739a805c0782e7421f2b1"><div class="ttname"><a href="classSSAGES_1_1ANN.html#ac85a0999687739a805c0782e7421f2b1">SSAGES::ANN::citers_</a></div><div class="ttdeci">unsigned int citers_</div><div class="ttdoc">Number of iterations after which we turn on full weight.</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8h_source.html#l00047">ANN.h:47</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_acde42146cf0a2e50851da4fe74b7d14f"><div class="ttname"><a href="classSSAGES_1_1ANN.html#acde42146cf0a2e50851da4fe74b7d14f">SSAGES::ANN::topol_</a></div><div class="ttdeci">Eigen::VectorXi topol_</div><div class="ttdoc">Neural network topology.</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8h_source.html#l00039">ANN.h:39</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_ad799d7e14579192477a450338f1cf330"><div class="ttname"><a href="classSSAGES_1_1ANN.html#ad799d7e14579192477a450338f1cf330">SSAGES::ANN::outfile_</a></div><div class="ttdeci">std::string outfile_</div><div class="ttdoc">Output filename.</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8h_source.html#l00087">ANN.h:87</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_ae925218647bd62eccf8d2983a87baad8"><div class="ttname"><a href="classSSAGES_1_1ANN.html#ae925218647bd62eccf8d2983a87baad8">SSAGES::ANN::ugrid_</a></div><div class="ttdeci">Grid&lt; double &gt; * ugrid_</div><div class="ttdoc">Unbiased histogram grid.</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8h_source.html#l00069">ANN.h:69</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_ae928d6e1f11b3a9aca40c7a473d4df91"><div class="ttname"><a href="classSSAGES_1_1ANN.html#ae928d6e1f11b3a9aca40c7a473d4df91">SSAGES::ANN::overwrite_</a></div><div class="ttdeci">bool overwrite_</div><div class="ttdoc">Overwrite outputs?</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8h_source.html#l00093">ANN.h:93</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1GridBase_html_a4f8abb752ae6ec51ebcf24b599bf4896"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#a4f8abb752ae6ec51ebcf24b599bf4896">SSAGES::GridBase::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdoc">Get the size of the internal storage vector.</div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00326">GridBase.h:326</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1GridBase_html_a72f98ef47da691b00823d612efbd46b8"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#a72f98ef47da691b00823d612efbd46b8">SSAGES::GridBase::GetDimension</a></div><div class="ttdeci">size_t GetDimension() const</div><div class="ttdoc">Get the dimension.</div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00195">GridBase.h:195</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1Grid_html_a709374b3cadf320347604077a2e45e5b"><div class="ttname"><a href="classSSAGES_1_1Grid.html#a709374b3cadf320347604077a2e45e5b">SSAGES::Grid::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdoc">Return iterator at first grid point.</div><div class="ttdef"><b>Definition:</b> <a href="Grid_8h_source.html#l00527">Grid.h:527</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1Grid_html_ac4fcc9f0cd61476ce4fd880c768d9694"><div class="ttname"><a href="classSSAGES_1_1Grid.html#ac4fcc9f0cd61476ce4fd880c768d9694">SSAGES::Grid::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdoc">Return iterator after last valid grid point.</div><div class="ttdef"><b>Definition:</b> <a href="Grid_8h_source.html#l00540">Grid.h:540</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1Method_html_ad751450ecd30e8ab40024c6f5e870d30"><div class="ttname"><a href="classSSAGES_1_1Method.html#ad751450ecd30e8ab40024c6f5e870d30">SSAGES::Method::Method</a></div><div class="ttdeci">Method(unsigned int frequency, const MPI_Comm &amp;world, const MPI_Comm &amp;comm)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00061">Method.h:61</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Grid_8h_source.html#l00527">SSAGES::Grid&lt; T &gt;::begin()</a>, <a class="el" href="Grid_8h_source.html#l00540">SSAGES::Grid&lt; T &gt;::end()</a>, <a class="el" href="GridBase_8h_source.html#l00195">SSAGES::GridBase&lt; T &gt;::GetDimension()</a>, <a class="el" href="ANN_8h_source.html#l00066">hgrid_</a>, <a class="el" href="ANN_8h_source.html#l00073">hist_</a>, <a class="el" href="ANN_8h_source.html#l00050">net_</a>, and <a class="el" href="GridBase_8h_source.html#l00326">SSAGES::GridBase&lt; T &gt;::size()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ANN_8cpp_source.html#l00287">Build()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1ANN_a95d94629470f17e50215ff378d7ecd91_cgraph.png" border="0" usemap="#aclassSSAGES_1_1ANN_a95d94629470f17e50215ff378d7ecd91_cgraph" alt=""/></div>
<map name="aclassSSAGES_1_1ANN_a95d94629470f17e50215ff378d7ecd91_cgraph" id="aclassSSAGES_1_1ANN_a95d94629470f17e50215ff378d7ecd91_cgraph">
<area shape="rect" title="Constructor." alt="" coords="5,81,156,108"/>
<area shape="rect" href="classSSAGES_1_1Grid.html#a709374b3cadf320347604077a2e45e5b" title="Return iterator at first grid point." alt="" coords="245,5,393,32"/>
<area shape="rect" href="classSSAGES_1_1Grid.html#ac4fcc9f0cd61476ce4fd880c768d9694" title="Return iterator after last valid grid point." alt="" coords="250,56,389,83"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a72f98ef47da691b00823d612efbd46b8" title="Get the dimension." alt="" coords="204,107,435,133"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a4f8abb752ae6ec51ebcf24b599bf4896" title="Get the size of the internal storage vector." alt="" coords="234,157,405,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1ANN_a95d94629470f17e50215ff378d7ecd91_icgraph.png" border="0" usemap="#aclassSSAGES_1_1ANN_a95d94629470f17e50215ff378d7ecd91_icgraph" alt=""/></div>
<map name="aclassSSAGES_1_1ANN_a95d94629470f17e50215ff378d7ecd91_icgraph" id="aclassSSAGES_1_1ANN_a95d94629470f17e50215ff378d7ecd91_icgraph">
<area shape="rect" title="Constructor." alt="" coords="204,5,355,32"/>
<area shape="rect" href="classSSAGES_1_1ANN.html#a44c8469ee6fc94c4c2be239684a9bf14" title="Build a derived method from JSON node." alt="" coords="5,5,156,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a44c8469ee6fc94c4c2be239684a9bf14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44c8469ee6fc94c4c2be239684a9bf14">&#9670;&nbsp;</a></span>Build()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSSAGES_1_1ANN.html">ANN</a> * SSAGES::ANN::Build </td>
          <td>(</td>
          <td class="paramtype">const Json::Value &amp;&#160;</td>
          <td class="paramname"><em>json</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MPI_Comm &amp;&#160;</td>
          <td class="paramname"><em>world</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MPI_Comm &amp;&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build a derived method from <a class="el" href="namespaceJSON.html">JSON</a> node. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">json</td><td><a class="el" href="namespaceJSON.html">JSON</a> Value containing all input information. </td></tr>
    <tr><td class="paramname">world</td><td>MPI global communicator. </td></tr>
    <tr><td class="paramname">comm</td><td>MPI local communicator. </td></tr>
    <tr><td class="paramname">path</td><td>Path for <a class="el" href="namespaceJSON.html">JSON</a> path specification. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the <a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations.">Method</a> built. nullptr if an unknown error occurred.</dd></dl>
<p>This function builds a registered method from a <a class="el" href="namespaceJSON.html">JSON</a> node. The difference between this function and "Build" is that this automatically determines the appropriate derived type based on the <a class="el" href="namespaceJSON.html">JSON</a> node information.</p>
<dl class="section note"><dt>Note</dt><dd>Object lifetime is the caller's responsibility. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ANN_8cpp_source.html#l00287">287</a> of file <a class="el" href="ANN_8cpp_source.html">ANN.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <a class="code" href="classJson_1_1ObjectRequirement.html">ObjectRequirement</a> validator;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        Value schema;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        CharReaderBuilder rbuilder;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        CharReader* reader = rbuilder.newCharReader();</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        reader-&gt;parse(JsonSchema::ANNMethod.c_str(),</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                      JsonSchema::ANNMethod.c_str() + JsonSchema::ANNMethod.size(),</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                      &amp;schema, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        validator.<a class="code" href="classJson_1_1ObjectRequirement.html#a4ed02ae1d612a5efba1688fcdd2df092">Parse</a>(schema, path);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment">// Validate inputs.</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        validator.<a class="code" href="classJson_1_1ObjectRequirement.html#a9ac3b920001a35bc70580035d8d802b7">Validate</a>(json, path);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">if</span>(validator.<a class="code" href="classJson_1_1Requirement.html#adfaec336a9f051d6f6b9a6d7f1d97b75">HasErrors</a>())</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordflow">throw</span> BuildException(validator.<a class="code" href="classJson_1_1Requirement.html#a60bc275c366eb59f192fa2e621268480">GetErrors</a>());</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="comment">// Grid. </span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keyword">auto</span>* fgrid = <a class="code" href="classSSAGES_1_1Grid.html#a24d2373042debae156618906637e819c">Grid&lt;VectorXd&gt;::BuildGrid</a>(json.get(<span class="stringliteral">&quot;grid&quot;</span>, Json::Value()));</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keyword">auto</span>* hgrid = <a class="code" href="classSSAGES_1_1Grid.html#a24d2373042debae156618906637e819c">Grid&lt;unsigned int&gt;::BuildGrid</a>(json.get(<span class="stringliteral">&quot;grid&quot;</span>, Json::Value()));</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keyword">auto</span>* ugrid = <a class="code" href="classSSAGES_1_1Grid.html#a24d2373042debae156618906637e819c">Grid&lt;double&gt;::BuildGrid</a>(json.get(<span class="stringliteral">&quot;grid&quot;</span>, Json::Value()));</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="comment">// Topology. </span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keyword">auto</span> nlayers = json[<span class="stringliteral">&quot;topology&quot;</span>].size() + 2;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        VectorXi topol(nlayers);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        topol[0] = fgrid-&gt;GetDimension();</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        topol[nlayers-1] = 1;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; static_cast&lt;int&gt;(json[<span class="stringliteral">&quot;topology&quot;</span>].size()); ++i)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            topol[i+1] = json[<span class="stringliteral">&quot;topology&quot;</span>][i].asInt();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keyword">auto</span> weight = json.get(<span class="stringliteral">&quot;weight&quot;</span>, 1.).asDouble();</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keyword">auto</span> temp = json[<span class="stringliteral">&quot;temperature&quot;</span>].asDouble();</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keyword">auto</span> nsweep = json[<span class="stringliteral">&quot;nsweep&quot;</span>].asUInt();</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">// Assume all vectors are the same size. </span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        std::vector&lt;double&gt; lowerb, upperb, lowerk, upperk;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; static_cast&lt;int&gt;(json[<span class="stringliteral">&quot;lower_bound_restraints&quot;</span>].size()); ++i)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            lowerk.push_back(json[<span class="stringliteral">&quot;lower_bound_restraints&quot;</span>][i].asDouble());</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            upperk.push_back(json[<span class="stringliteral">&quot;upper_bound_restraints&quot;</span>][i].asDouble());</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            lowerb.push_back(json[<span class="stringliteral">&quot;lower_bounds&quot;</span>][i].asDouble());</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            upperb.push_back(json[<span class="stringliteral">&quot;upper_bounds&quot;</span>][i].asDouble());</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keyword">auto</span>* m = <span class="keyword">new</span> <a class="code" href="classSSAGES_1_1ANN.html#a95d94629470f17e50215ff378d7ecd91">ANN</a>(world, comm, topol, fgrid, hgrid, ugrid, lowerb, upperb, lowerk, upperk, temp, weight, nsweep);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="comment">// Set optional params.</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        m-&gt;SetPrevWeight(json.get(<span class="stringliteral">&quot;prev_weight&quot;</span>, 1).asDouble());</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        m-&gt;SetOutput(json.get(<span class="stringliteral">&quot;output_file&quot;</span>, <span class="stringliteral">&quot;ann.out&quot;</span>).asString());</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        m-&gt;SetOutputOverwrite( json.get(<span class="stringliteral">&quot;overwrite_output&quot;</span>, <span class="keyword">true</span>).asBool());</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        m-&gt;SetConvergeIters(json.get(<span class="stringliteral">&quot;converge_iters&quot;</span>, 0).asUInt());</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        m-&gt;SetMaxIters(json.get(<span class="stringliteral">&quot;max_iters&quot;</span>, 1000).asUInt());</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        m-&gt;SetMinLoss(json.get(<span class="stringliteral">&quot;min_loss&quot;</span>, 0).asDouble());</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">if</span>(json.isMember(<span class="stringliteral">&quot;net_state&quot;</span>) &amp;&amp; json.isMember(<span class="stringliteral">&quot;load_bias&quot;</span>))</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            m-&gt;ReadBias(json[<span class="stringliteral">&quot;net_state&quot;</span>].asString(), json[<span class="stringliteral">&quot;load_bias&quot;</span>].asString());</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">return</span> m;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div>
<div class="ttc" id="aclassJson_1_1ObjectRequirement_html"><div class="ttname"><a href="classJson_1_1ObjectRequirement.html">Json::ObjectRequirement</a></div><div class="ttdoc">Requirements on an object.</div><div class="ttdef"><b>Definition:</b> <a href="ObjectRequirement_8h_source.html#l00046">ObjectRequirement.h:47</a></div></div>
<div class="ttc" id="aclassJson_1_1ObjectRequirement_html_a4ed02ae1d612a5efba1688fcdd2df092"><div class="ttname"><a href="classJson_1_1ObjectRequirement.html#a4ed02ae1d612a5efba1688fcdd2df092">Json::ObjectRequirement::Parse</a></div><div class="ttdeci">virtual void Parse(Value json, const std::string &amp;path) override</div><div class="ttdoc">Parse JSON value to generate Requirement(s).</div><div class="ttdef"><b>Definition:</b> <a href="ObjectRequirement_8h_source.html#l00142">ObjectRequirement.h:142</a></div></div>
<div class="ttc" id="aclassJson_1_1ObjectRequirement_html_a9ac3b920001a35bc70580035d8d802b7"><div class="ttname"><a href="classJson_1_1ObjectRequirement.html#a9ac3b920001a35bc70580035d8d802b7">Json::ObjectRequirement::Validate</a></div><div class="ttdeci">virtual void Validate(const Value &amp;json, const std::string &amp;path) override</div><div class="ttdoc">Validate JSON value.</div><div class="ttdef"><b>Definition:</b> <a href="ObjectRequirement_8h_source.html#l00239">ObjectRequirement.h:239</a></div></div>
<div class="ttc" id="aclassJson_1_1Requirement_html_a60bc275c366eb59f192fa2e621268480"><div class="ttname"><a href="classJson_1_1Requirement.html#a60bc275c366eb59f192fa2e621268480">Json::Requirement::GetErrors</a></div><div class="ttdeci">std::vector&lt; std::string &gt; GetErrors()</div><div class="ttdoc">Get list of error messages.</div><div class="ttdef"><b>Definition:</b> <a href="Requirement_8h_source.html#l00092">Requirement.h:92</a></div></div>
<div class="ttc" id="aclassJson_1_1Requirement_html_adfaec336a9f051d6f6b9a6d7f1d97b75"><div class="ttname"><a href="classJson_1_1Requirement.html#adfaec336a9f051d6f6b9a6d7f1d97b75">Json::Requirement::HasErrors</a></div><div class="ttdeci">bool HasErrors()</div><div class="ttdoc">Check if errors have occured.</div><div class="ttdef"><b>Definition:</b> <a href="Requirement_8h_source.html#l00086">Requirement.h:86</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_a95d94629470f17e50215ff378d7ecd91"><div class="ttname"><a href="classSSAGES_1_1ANN.html#a95d94629470f17e50215ff378d7ecd91">SSAGES::ANN::ANN</a></div><div class="ttdeci">ANN(const MPI_Comm &amp;world, const MPI_Comm &amp;comm, const Eigen::VectorXi &amp;topol, Grid&lt; Eigen::VectorXd &gt; *fgrid, Grid&lt; unsigned int &gt; *hgrid, Grid&lt; double &gt; *ugrid, const std::vector&lt; double &gt; &amp;lowerb, const std::vector&lt; double &gt; &amp;upperb, const std::vector&lt; double &gt; &amp;lowerk, const std::vector&lt; double &gt; &amp;upperk, double temperature, double weight, unsigned int nsweep)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8cpp_source.html#l00034">ANN.cpp:34</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1Grid_html_a24d2373042debae156618906637e819c"><div class="ttname"><a href="classSSAGES_1_1Grid.html#a24d2373042debae156618906637e819c">SSAGES::Grid::BuildGrid</a></div><div class="ttdeci">static Grid&lt; T &gt; * BuildGrid(const Json::Value &amp;json)</div><div class="ttdoc">Set up the grid.</div><div class="ttdef"><b>Definition:</b> <a href="Grid_8h_source.html#l00127">Grid.h:127</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ANN_8cpp_source.html#l00034">ANN()</a>, <a class="el" href="Grid_8h_source.html#l00127">SSAGES::Grid&lt; T &gt;::BuildGrid()</a>, <a class="el" href="Requirement_8h_source.html#l00092">Json::Requirement::GetErrors()</a>, <a class="el" href="Requirement_8h_source.html#l00086">Json::Requirement::HasErrors()</a>, <a class="el" href="ObjectRequirement_8h_source.html#l00142">Json::ObjectRequirement::Parse()</a>, and <a class="el" href="ObjectRequirement_8h_source.html#l00239">Json::ObjectRequirement::Validate()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1ANN_a44c8469ee6fc94c4c2be239684a9bf14_cgraph.png" border="0" usemap="#aclassSSAGES_1_1ANN_a44c8469ee6fc94c4c2be239684a9bf14_cgraph" alt=""/></div>
<map name="aclassSSAGES_1_1ANN_a44c8469ee6fc94c4c2be239684a9bf14_cgraph" id="aclassSSAGES_1_1ANN_a44c8469ee6fc94c4c2be239684a9bf14_cgraph">
<area shape="rect" title="Build a derived method from JSON node." alt="" coords="5,256,156,283"/>
<area shape="rect" href="classSSAGES_1_1ANN.html#a95d94629470f17e50215ff378d7ecd91" title="Constructor." alt="" coords="214,107,365,133"/>
<area shape="rect" href="classSSAGES_1_1Grid.html#a24d2373042debae156618906637e819c" title="Set up the grid." alt="" coords="204,180,375,207"/>
<area shape="rect" href="classJson_1_1Requirement.html#a60bc275c366eb59f192fa2e621268480" title="Get list of error messages." alt="" coords="468,209,608,250"/>
<area shape="rect" href="classJson_1_1Requirement.html#adfaec336a9f051d6f6b9a6d7f1d97b75" title="Check if errors have occured." alt="" coords="468,274,608,315"/>
<area shape="rect" href="classJson_1_1ObjectRequirement.html#a4ed02ae1d612a5efba1688fcdd2df092" title="Parse JSON value to generate Requirement(s)." alt="" coords="204,698,375,739"/>
<area shape="rect" href="classJson_1_1ObjectRequirement.html#a9ac3b920001a35bc70580035d8d802b7" title="Validate JSON value." alt="" coords="204,373,375,414"/>
<area shape="rect" href="classSSAGES_1_1Grid.html#a709374b3cadf320347604077a2e45e5b" title="Return iterator at first grid point." alt="" coords="464,107,612,133"/>
<area shape="rect" href="classSSAGES_1_1Grid.html#ac4fcc9f0cd61476ce4fd880c768d9694" title="Return iterator after last valid grid point." alt="" coords="469,157,607,184"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a72f98ef47da691b00823d612efbd46b8" title="Get the dimension." alt="" coords="423,5,653,32"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a4f8abb752ae6ec51ebcf24b599bf4896" title="Get the size of the internal storage vector." alt="" coords="453,56,623,83"/>
<area shape="rect" href="classJson_1_1RequirementLoader.html#a82857d029b7ebfeb315f5b1b32401291" title="Extended Requirement loader." alt="" coords="453,666,623,707"/>
<area shape="rect" href="classJson_1_1RequirementLoader.html#aeb1344919deda4bd8b8aa8a00cb50390" title="Load specific requirement." alt="" coords="453,731,623,773"/>
<area shape="rect" href="classJson_1_1ObjectRequirement.html#a4f2e76636df4f7b153aaac02a1b05e4f" title="Reset Requirement." alt="" coords="453,797,623,838"/>
<area shape="rect" href="classJson_1_1ObjectRequirement.html#aa8181c37cbe67db098bc2b82cdea71ef" title="Clear errors on all Requirements." alt="" coords="701,763,872,805"/>
<area shape="rect" href="classJson_1_1ObjectRequirement.html#a4fc797684496f4f0381d1388877c133d" title="Clear notices on all Requirements." alt="" coords="701,829,872,870"/>
<area shape="rect" href="classJson_1_1Requirement.html#ace71ebbbcc885f0c4c391a3807c80f33" title="Clear list of error messages." alt="" coords="920,763,1060,805"/>
<area shape="rect" href="classJson_1_1Requirement.html#a8a8a4020e4955be56dcacf4727ae5bc3" title="Clear list of notice messages." alt="" coords="920,829,1060,870"/>
<area shape="rect" href="classJson_1_1Requirement.html#a46a0056414100386541cd1cb899e0030" title="Get list of notices." alt="" coords="468,470,608,511"/>
<area shape="rect" href="classJson_1_1Requirement.html#ad407cff3cc37295c3b2a7ebe31798548" title="Check if notices have been queued." alt="" coords="468,535,608,577"/>
<area shape="rect" href="classJson_1_1Requirement.html#adeb9efa6cf271d9cea0599ff2d458a08" title="Add error to list of error messages." alt="" coords="468,601,608,642"/>
<area shape="rect" href="classJson_1_1Requirement.html#a00feadb29fa33f4f2cca7362f12aaed4" title="Add message to list of notices." alt="" coords="468,339,608,381"/>
<area shape="rect" href="classJson_1_1Requirement.html#aa97494b642414d00482745a0d5b2c2c3" title="Validate that JSON value meets requirements." alt="" coords="468,405,608,446"/>
</map>
</div>

</div>
</div>
<a id="ad63d276efae1a266eb5d556bdf896a98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad63d276efae1a266eb5d556bdf896a98">&#9670;&nbsp;</a></span>PostIntegration()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ANN::PostIntegration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *&#160;</td>
          <td class="paramname"><em>snapshot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;&#160;</td>
          <td class="paramname"><em>cvmanager</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations.">Method</a> call post integration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">snapshot</td><td>Pointer to the simulation snapshot. </td></tr>
    <tr><td class="paramname">cvmanager</td><td>Collective variable manager.</td></tr>
  </table>
  </dd>
</dl>
<p>This function will be called after each integration step. </p>

<p>Implements <a class="el" href="classSSAGES_1_1Method.html#af2f33dfaa758c5cd505477f4767fb339">SSAGES::Method</a>.</p>

<p class="definition">Definition at line <a class="el" href="ANN_8cpp_source.html#l00113">113</a> of file <a class="el" href="ANN_8cpp_source.html">ANN.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">if</span>(snapshot-&gt;GetIteration() &amp;&amp; snapshot-&gt;GetIteration() % nsweep_ == 0)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="comment">// Switch to full blast.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1ANN.html#ac85a0999687739a805c0782e7421f2b1">citers_</a> &amp;&amp; snapshot-&gt;GetIteration() &gt; <a class="code" href="classSSAGES_1_1ANN.html#ac85a0999687739a805c0782e7421f2b1">citers_</a>)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                <a class="code" href="classSSAGES_1_1ANN.html#aa46e3420f46726cfa7766eaba5d53246">pweight_</a> = 1.0;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <a class="code" href="classSSAGES_1_1ANN.html#a7091cb356fa05bc0b21a4e37144fb0b7">TrainNetwork</a>();</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1EventListener.html#af9666daacfb047c1dd279ea339524d07">IsMasterRank</a>(<a class="code" href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">world_</a>))</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                <a class="code" href="classSSAGES_1_1ANN.html#acfdfae96fc9c752323828e2c222ef006">WriteBias</a>();</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="comment">// Get CV vals.</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keyword">auto</span> cvs = cvmanager.GetCVs(<a class="code" href="classSSAGES_1_1Method.html#a24b0ac53b1fabcab0a5f3bd6cde26909">cvmask_</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keyword">auto</span> n = cvs.size();</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">// Determine if we are in bounds.</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        RowVectorXd vec(n);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        std::vector&lt;double&gt; val(n);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordtype">bool</span> inbounds = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            val[i] = cvs[i]-&gt;GetValue();</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            vec[i] = cvs[i]-&gt;GetValue();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordflow">if</span>(val[i] &lt; <a class="code" href="classSSAGES_1_1ANN.html#a1ec3000737e404aedce966587dc538ba">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a2270a9233a9dc2d341e8ab88ce6655c9">GetLower</a>(i) || val[i] &gt; <a class="code" href="classSSAGES_1_1ANN.html#a1ec3000737e404aedce966587dc538ba">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a875feace8fff4743b103147c4193eca0">GetUpper</a>(i))</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                inbounds = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="comment">// If in bounds, bias. </span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        VectorXd derivatives = VectorXd::Zero(n);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">if</span>(inbounds)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="comment">// Record histogram hit and get gradient. </span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <span class="comment">// Only record hits on master processes since we will </span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="comment">// reduce later. </span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1EventListener.html#af9666daacfb047c1dd279ea339524d07">IsMasterRank</a>(<a class="code" href="classSSAGES_1_1Method.html#a1118666d61dbf3bc7606e3b61aa3a460">comm_</a>))</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <a class="code" href="classSSAGES_1_1ANN.html#a1ec3000737e404aedce966587dc538ba">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a7da01557a9b85498c2acd975c152403a">at</a>(val) += 1;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="comment">//derivatives = (*fgrid_)[val];</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <a class="code" href="classSSAGES_1_1ANN.html#a8df5bc974f48135e0add44d77b91182a">net_</a>.forward_pass(vec);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            derivatives = <a class="code" href="classSSAGES_1_1ANN.html#a8df5bc974f48135e0add44d77b91182a">net_</a>.get_gradient(0);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1EventListener.html#af9666daacfb047c1dd279ea339524d07">IsMasterRank</a>(<a class="code" href="classSSAGES_1_1Method.html#a1118666d61dbf3bc7606e3b61aa3a460">comm_</a>))</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                std::cerr &lt;&lt; <span class="stringliteral">&quot;ANN (&quot;</span> &lt;&lt; snapshot-&gt;GetIteration() &lt;&lt; <span class="stringliteral">&quot;): out of bounds ( &quot;</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; v : val)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                    std::cerr &lt;&lt; v &lt;&lt; <span class="stringliteral">&quot; &quot;</span>; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                std::cerr &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">// Restraints.</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keyword">auto</span> cval = cvs[i]-&gt;GetValue();</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">if</span>(cval &lt; <a class="code" href="classSSAGES_1_1ANN.html#a022a5d90efc1c7d77f243bc6a30c2757">lowerb_</a>[i])</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                derivatives[i] += <a class="code" href="classSSAGES_1_1ANN.html#a2d8da6902233c66212aecfe108aa08f7">lowerk_</a>[i]*cvs[i]-&gt;GetDifference(<a class="code" href="classSSAGES_1_1ANN.html#a022a5d90efc1c7d77f243bc6a30c2757">lowerb_</a>[i]);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(cval &gt; upperb_[i])</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                derivatives[i] += upperk_[i]*cvs[i]-&gt;GetDifference(upperb_[i]);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="comment">// Apply bias to atoms. </span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keyword">auto</span>&amp; forces = snapshot-&gt;GetForces(); </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keyword">auto</span>&amp; virial = snapshot-&gt;GetVirial();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; cvs.size(); ++i)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keyword">auto</span>&amp; grad = cvs[i]-&gt;GetGradient();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keyword">auto</span>&amp; boxgrad = cvs[i]-&gt;GetBoxGradient();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="comment">// Update the forces in snapshot by adding in the force bias from each</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="comment">// CV to each atom based on the gradient of the CV.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; forces.size(); ++j)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                forces[j] -= derivatives[i]*grad[j];</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            virial += derivatives[i]*boxgrad;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    }</div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_a7091cb356fa05bc0b21a4e37144fb0b7"><div class="ttname"><a href="classSSAGES_1_1ANN.html#a7091cb356fa05bc0b21a4e37144fb0b7">SSAGES::ANN::TrainNetwork</a></div><div class="ttdeci">void TrainNetwork()</div><div class="ttdoc">Trains the neural network.</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8cpp_source.html#l00198">ANN.cpp:198</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1ANN_html_acfdfae96fc9c752323828e2c222ef006"><div class="ttname"><a href="classSSAGES_1_1ANN.html#acfdfae96fc9c752323828e2c222ef006">SSAGES::ANN::WriteBias</a></div><div class="ttdeci">void WriteBias()</div><div class="ttdoc">Writes out the bias to file.</div><div class="ttdef"><b>Definition:</b> <a href="ANN_8cpp_source.html#l00245">ANN.cpp:245</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1EventListener_html_af9666daacfb047c1dd279ea339524d07"><div class="ttname"><a href="classSSAGES_1_1EventListener.html#af9666daacfb047c1dd279ea339524d07">SSAGES::EventListener::IsMasterRank</a></div><div class="ttdeci">static bool IsMasterRank(const MPI_Comm &amp;comm)</div><div class="ttdoc">Check if current processor is master.</div><div class="ttdef"><b>Definition:</b> <a href="EventListener_8h_source.html#l00110">EventListener.h:110</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1GridBase_html_a2270a9233a9dc2d341e8ab88ce6655c9"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#a2270a9233a9dc2d341e8ab88ce6655c9">SSAGES::GridBase::GetLower</a></div><div class="ttdeci">const std::vector&lt; double &gt; GetLower() const</div><div class="ttdoc">Return the lower edges of the Grid.</div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00231">GridBase.h:231</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1GridBase_html_a7da01557a9b85498c2acd975c152403a"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#a7da01557a9b85498c2acd975c152403a">SSAGES::GridBase::at</a></div><div class="ttdeci">const T &amp; at(const std::vector&lt; int &gt; &amp;indices) const</div><div class="ttdoc">Access Grid element read-only.</div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00546">GridBase.h:546</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1GridBase_html_a875feace8fff4743b103147c4193eca0"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#a875feace8fff4743b103147c4193eca0">SSAGES::GridBase::GetUpper</a></div><div class="ttdeci">const std::vector&lt; double &gt; GetUpper() const</div><div class="ttdoc">Return the upper edges of the Grid.</div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00262">GridBase.h:262</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1Method_html_a1118666d61dbf3bc7606e3b61aa3a460"><div class="ttname"><a href="classSSAGES_1_1Method.html#a1118666d61dbf3bc7606e3b61aa3a460">SSAGES::Method::comm_</a></div><div class="ttdeci">mxx::comm comm_</div><div class="ttdoc">Local MPI communicator.</div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00047">Method.h:47</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1Method_html_a24b0ac53b1fabcab0a5f3bd6cde26909"><div class="ttname"><a href="classSSAGES_1_1Method.html#a24b0ac53b1fabcab0a5f3bd6cde26909">SSAGES::Method::cvmask_</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; cvmask_</div><div class="ttdoc">Mask which identifies which CVs to act on.</div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00050">Method.h:50</a></div></div>
<div class="ttc" id="aclassSSAGES_1_1Method_html_a8471b11097a1018a9635bc578bf22f61"><div class="ttname"><a href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">SSAGES::Method::world_</a></div><div class="ttdeci">mxx::comm world_</div><div class="ttdoc">Global MPI communicator.</div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00046">Method.h:46</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="GridBase_8h_source.html#l00546">SSAGES::GridBase&lt; T &gt;::at()</a>, <a class="el" href="ANN_8h_source.html#l00047">citers_</a>, <a class="el" href="Method_8h_source.html#l00047">SSAGES::Method::comm_</a>, <a class="el" href="Method_8h_source.html#l00050">SSAGES::Method::cvmask_</a>, <a class="el" href="CVManager_8h_source.html#l00081">SSAGES::CVManager::GetCVs()</a>, <a class="el" href="Snapshot_8h_source.html#l00351">SSAGES::Snapshot::GetForces()</a>, <a class="el" href="Snapshot_8h_source.html#l00105">SSAGES::Snapshot::GetIteration()</a>, <a class="el" href="GridBase_8h_source.html#l00231">SSAGES::GridBase&lt; T &gt;::GetLower()</a>, <a class="el" href="GridBase_8h_source.html#l00262">SSAGES::GridBase&lt; T &gt;::GetUpper()</a>, <a class="el" href="Snapshot_8h_source.html#l00135">SSAGES::Snapshot::GetVirial()</a>, <a class="el" href="ANN_8h_source.html#l00066">hgrid_</a>, <a class="el" href="EventListener_8h_source.html#l00110">SSAGES::EventListener::IsMasterRank()</a>, <a class="el" href="ANN_8h_source.html#l00078">lowerb_</a>, <a class="el" href="ANN_8h_source.html#l00083">lowerk_</a>, <a class="el" href="ANN_8h_source.html#l00050">net_</a>, <a class="el" href="ANN_8h_source.html#l00054">pweight_</a>, <a class="el" href="ANN_8cpp_source.html#l00198">TrainNetwork()</a>, <a class="el" href="Method_8h_source.html#l00046">SSAGES::Method::world_</a>, and <a class="el" href="ANN_8cpp_source.html#l00245">WriteBias()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1ANN_ad63d276efae1a266eb5d556bdf896a98_cgraph.png" border="0" usemap="#aclassSSAGES_1_1ANN_ad63d276efae1a266eb5d556bdf896a98_cgraph" alt=""/></div>
<map name="aclassSSAGES_1_1ANN_ad63d276efae1a266eb5d556bdf896a98_cgraph" id="aclassSSAGES_1_1ANN_ad63d276efae1a266eb5d556bdf896a98_cgraph">
<area shape="rect" title="Method call post integration." alt="" coords="5,262,216,289"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a7da01557a9b85498c2acd975c152403a" title="Access Grid element read&#45;only." alt="" coords="791,73,949,99"/>
<area shape="rect" href="classSSAGES_1_1CVManager.html#ad2a31c91a0298b4e80ca5ba720c5eee3" title="Get CV iterator." alt="" coords="291,225,453,267"/>
<area shape="rect" href="classSSAGES_1_1Snapshot.html#a2d195c04efbc7d7d1c3dd4ccd4b9a5bc" title="Access the per&#45;particle forces." alt="" coords="267,291,477,318"/>
<area shape="rect" href="classSSAGES_1_1Snapshot.html#ab38cbf3c463820d1b8bbd733759bfa32" title="Get the current iteration." alt="" coords="264,342,480,369"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a2270a9233a9dc2d341e8ab88ce6655c9" title="Return the lower edges of the Grid." alt="" coords="271,393,473,419"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a875feace8fff4743b103147c4193eca0" title="Return the upper edges of the Grid." alt="" coords="271,443,473,470"/>
<area shape="rect" href="classSSAGES_1_1Snapshot.html#a02b7418ade9d06c64d1c074a95783635" title="Get box virial." alt="" coords="273,494,471,521"/>
<area shape="rect" href="classSSAGES_1_1EventListener.html#af9666daacfb047c1dd279ea339524d07" title="Check if current processor is master." alt="" coords="553,57,718,99"/>
<area shape="rect" href="classSSAGES_1_1ANN.html#a7091cb356fa05bc0b21a4e37144fb0b7" title="Trains the neural network." alt="" coords="272,123,472,150"/>
<area shape="rect" href="classSSAGES_1_1ANN.html#acfdfae96fc9c752323828e2c222ef006" title="Writes out the bias to file." alt="" coords="283,174,461,201"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a72f98ef47da691b00823d612efbd46b8" title="Get the dimension." alt="" coords="997,123,1228,150"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a1f7bae14a777239968ae9445d19af823" title="This function needs to be implemented by child classes." alt="" coords="1013,73,1213,99"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#ab4ff38d7e0ca60dfebd82c36d89cbede" title="Return the periodicity of the Grid." alt="" coords="528,418,743,445"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a52e519b13f9b53c0767957d86015b0a1" title="Get pointer to the internal data storage vector." alt="" coords="549,225,721,251"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a4f8abb752ae6ec51ebcf24b599bf4896" title="Get the size of the internal storage vector." alt="" coords="550,174,721,201"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#ab52bfd510cd1dffb2d91f516c9266c4b" title="Sync the grid." alt="" coords="536,123,735,150"/>
</map>
</div>

</div>
</div>
<a id="a187df3448f650a0bb3452bf7c1c12fe8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a187df3448f650a0bb3452bf7c1c12fe8">&#9670;&nbsp;</a></span>PostSimulation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ANN::PostSimulation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *&#160;</td>
          <td class="paramname"><em>snapshot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;&#160;</td>
          <td class="paramname"><em>cvmanager</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations.">Method</a> call post simulation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">snapshot</td><td>Pointer to the simulation snapshot. </td></tr>
    <tr><td class="paramname">cvmanager</td><td>Collective variable manager.</td></tr>
  </table>
  </dd>
</dl>
<p>This function will be called after the end of the simulation run. </p>

<p>Implements <a class="el" href="classSSAGES_1_1Method.html#a7d18226669c88bc76b9b758f2d29e3c9">SSAGES::Method</a>.</p>

<p class="definition">Definition at line <a class="el" href="ANN_8cpp_source.html#l00194">194</a> of file <a class="el" href="ANN_8cpp_source.html">ANN.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a86e2611b4516c8a465014919139aae19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86e2611b4516c8a465014919139aae19">&#9670;&nbsp;</a></span>PreSimulation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ANN::PreSimulation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *&#160;</td>
          <td class="paramname"><em>snapshot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;&#160;</td>
          <td class="paramname"><em>cvmanager</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classSSAGES_1_1Method.html" title="Interface for Method implementations.">Method</a> call prior to simulation initiation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">snapshot</td><td>Pointer to the simulation snapshot. </td></tr>
    <tr><td class="paramname">cvmanager</td><td>Collective variable manager.</td></tr>
  </table>
  </dd>
</dl>
<p>This function will be called before the simulation is started. </p>

<p>Implements <a class="el" href="classSSAGES_1_1Method.html#a7d840d2b5f6dbf9ec75a7909ccf13ef7">SSAGES::Method</a>.</p>

<p class="definition">Definition at line <a class="el" href="ANN_8cpp_source.html#l00076">76</a> of file <a class="el" href="ANN_8cpp_source.html">ANN.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keyword">auto</span> ndim = <a class="code" href="classSSAGES_1_1ANN.html#a1ec3000737e404aedce966587dc538ba">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a72f98ef47da691b00823d612efbd46b8">GetDimension</a>();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        kbt_ = snapshot-&gt;GetKb()*<a class="code" href="classSSAGES_1_1ANN.html#a1ef25a7766497d57498b194eb3d31b42">temp_</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">// Zero out forces and histogram. </span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        VectorXd vec = VectorXd::Zero(ndim);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        std::fill(<a class="code" href="classSSAGES_1_1ANN.html#a1ec3000737e404aedce966587dc538ba">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1Grid.html#a709374b3cadf320347604077a2e45e5b">begin</a>(), <a class="code" href="classSSAGES_1_1ANN.html#a1ec3000737e404aedce966587dc538ba">hgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1Grid.html#ac4fcc9f0cd61476ce4fd880c768d9694">end</a>(), 0);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1ANN.html#a6e5bc5f5f6a8e2cf2be0f715099eb266">preloaded_</a>)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <a class="code" href="classSSAGES_1_1ANN.html#a8df5bc974f48135e0add44d77b91182a">net_</a>.forward_pass(<a class="code" href="classSSAGES_1_1ANN.html#a5649c47eadcb28453c506587f83260f0">hist_</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            bias_.array() = <a class="code" href="classSSAGES_1_1ANN.html#a8df5bc974f48135e0add44d77b91182a">net_</a>.get_activation().col(0).array();</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <a class="code" href="classSSAGES_1_1ANN.html#a7091cb356fa05bc0b21a4e37144fb0b7">TrainNetwork</a>();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            std::fill(<a class="code" href="classSSAGES_1_1ANN.html#ae925218647bd62eccf8d2983a87baad8">ugrid_</a>-&gt;<a class="code" href="classSSAGES_1_1Grid.html#a709374b3cadf320347604077a2e45e5b">begin</a>(), <a class="code" href="classSSAGES_1_1ANN.html#ae925218647bd62eccf8d2983a87baad8">ugrid_</a>-&gt;<a class="code" href="classSSAGES_1_1Grid.html#ac4fcc9f0cd61476ce4fd880c768d9694">end</a>(), 1.0);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="comment">// Fill in the reweighting matrix for restraints.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keyword">auto</span> cvs = cvmanager.GetCVs(<a class="code" href="classSSAGES_1_1Method.html#a24b0ac53b1fabcab0a5f3bd6cde26909">cvmask_</a>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keyword">auto</span> ncvs = cvs.size();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1ANN.html#a5649c47eadcb28453c506587f83260f0">hist_</a>.rows(); ++i)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keyword">auto</span> cval = <a class="code" href="classSSAGES_1_1ANN.html#a5649c47eadcb28453c506587f83260f0">hist_</a>.row(i);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> j = 0; j &lt; ncvs; ++j)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                <span class="keywordflow">if</span>(cval[j] &lt; <a class="code" href="classSSAGES_1_1ANN.html#a022a5d90efc1c7d77f243bc6a30c2757">lowerb_</a>[j])</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                    rbias_(i,j) = <a class="code" href="classSSAGES_1_1ANN.html#a2d8da6902233c66212aecfe108aa08f7">lowerk_</a>[j]*(cval[j] - <a class="code" href="classSSAGES_1_1ANN.html#a022a5d90efc1c7d77f243bc6a30c2757">lowerb_</a>[j])*(cval[j] - <a class="code" href="classSSAGES_1_1ANN.html#a022a5d90efc1c7d77f243bc6a30c2757">lowerb_</a>[j]);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(cval[j] &gt; upperb_[j])</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                    rbias_(i,j) = upperk_[j]*(cval[j] - upperb_[j])*(cval[j] - upperb_[j]);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        std::fill(<a class="code" href="classSSAGES_1_1ANN.html#a8b12b03e1b6585461b83264c9adf6e30">fgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1Grid.html#a709374b3cadf320347604077a2e45e5b">begin</a>(), <a class="code" href="classSSAGES_1_1ANN.html#a8b12b03e1b6585461b83264c9adf6e30">fgrid_</a>-&gt;<a class="code" href="classSSAGES_1_1Grid.html#ac4fcc9f0cd61476ce4fd880c768d9694">end</a>(), vec);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Grid_8h_source.html#l00527">SSAGES::Grid&lt; T &gt;::begin()</a>, <a class="el" href="Method_8h_source.html#l00050">SSAGES::Method::cvmask_</a>, <a class="el" href="Grid_8h_source.html#l00540">SSAGES::Grid&lt; T &gt;::end()</a>, <a class="el" href="ANN_8h_source.html#l00063">fgrid_</a>, <a class="el" href="CVManager_8h_source.html#l00081">SSAGES::CVManager::GetCVs()</a>, <a class="el" href="GridBase_8h_source.html#l00195">SSAGES::GridBase&lt; T &gt;::GetDimension()</a>, <a class="el" href="Snapshot_8h_source.html#l00165">SSAGES::Snapshot::GetKb()</a>, <a class="el" href="ANN_8h_source.html#l00066">hgrid_</a>, <a class="el" href="ANN_8h_source.html#l00073">hist_</a>, <a class="el" href="ANN_8h_source.html#l00078">lowerb_</a>, <a class="el" href="ANN_8h_source.html#l00083">lowerk_</a>, <a class="el" href="ANN_8h_source.html#l00050">net_</a>, <a class="el" href="ANN_8h_source.html#l00090">preloaded_</a>, <a class="el" href="ANN_8h_source.html#l00059">temp_</a>, <a class="el" href="ANN_8cpp_source.html#l00198">TrainNetwork()</a>, and <a class="el" href="ANN_8h_source.html#l00069">ugrid_</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1ANN_a86e2611b4516c8a465014919139aae19_cgraph.png" border="0" usemap="#aclassSSAGES_1_1ANN_a86e2611b4516c8a465014919139aae19_cgraph" alt=""/></div>
<map name="aclassSSAGES_1_1ANN_a86e2611b4516c8a465014919139aae19_cgraph" id="aclassSSAGES_1_1ANN_a86e2611b4516c8a465014919139aae19_cgraph">
<area shape="rect" title="Method call prior to simulation initiation." alt="" coords="5,144,208,171"/>
<area shape="rect" href="classSSAGES_1_1Grid.html#a709374b3cadf320347604077a2e45e5b" title="Return iterator at first grid point." alt="" coords="282,5,430,32"/>
<area shape="rect" href="classSSAGES_1_1Grid.html#ac4fcc9f0cd61476ce4fd880c768d9694" title="Return iterator after last valid grid point." alt="" coords="287,56,425,83"/>
<area shape="rect" href="classSSAGES_1_1CVManager.html#ad2a31c91a0298b4e80ca5ba720c5eee3" title="Get CV iterator." alt="" coords="275,107,437,149"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a72f98ef47da691b00823d612efbd46b8" title="Get the dimension." alt="" coords="957,341,1188,368"/>
<area shape="rect" href="classSSAGES_1_1Snapshot.html#a00e9e35fb3f541b61a39acb142470a61" title="Get system Kb." alt="" coords="263,224,449,251"/>
<area shape="rect" href="classSSAGES_1_1ANN.html#a7091cb356fa05bc0b21a4e37144fb0b7" title="Trains the neural network." alt="" coords="256,283,456,309"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a52e519b13f9b53c0767957d86015b0a1" title="Get pointer to the internal data storage vector." alt="" coords="517,224,689,251"/>
<area shape="rect" href="classSSAGES_1_1EventListener.html#af9666daacfb047c1dd279ea339524d07" title="Check if current processor is master." alt="" coords="521,275,686,317"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a4f8abb752ae6ec51ebcf24b599bf4896" title="Get the size of the internal storage vector." alt="" coords="518,341,689,368"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#ab52bfd510cd1dffb2d91f516c9266c4b" title="Sync the grid." alt="" coords="504,392,703,419"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a7da01557a9b85498c2acd975c152403a" title="Access Grid element read&#45;only." alt="" coords="751,392,909,419"/>
<area shape="rect" href="classSSAGES_1_1GridBase.html#a1f7bae14a777239968ae9445d19af823" title="This function needs to be implemented by child classes." alt="" coords="973,392,1173,419"/>
</map>
</div>

</div>
</div>
<a id="a2f33ebd17115c4a8f4ed3739931f85e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f33ebd17115c4a8f4ed3739931f85e5">&#9670;&nbsp;</a></span>SetConvergeIters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ANN::SetConvergeIters </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>citers</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set number of iterations after which we turn on full weight. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">citers</td><td>Number of iterations before full weight </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ANN_8h_source.html#l00175">175</a> of file <a class="el" href="ANN_8h_source.html">ANN.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <a class="code" href="classSSAGES_1_1ANN.html#ac85a0999687739a805c0782e7421f2b1">citers_</a> = citers;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ANN_8h_source.html#l00047">citers_</a>.</p>

</div>
</div>
<a id="a30e6d7784fff0ac842e67001f28bc784"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30e6d7784fff0ac842e67001f28bc784">&#9670;&nbsp;</a></span>SetMaxIters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ANN::SetMaxIters </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>iters</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set maximum number of training iterations per sweep. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iters</td><td>Maximum iterations per sweep </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ANN_8h_source.html#l00184">184</a> of file <a class="el" href="ANN_8h_source.html">ANN.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="keyword">auto</span> params = <a class="code" href="classSSAGES_1_1ANN.html#a8df5bc974f48135e0add44d77b91182a">net_</a>.get_train_params();</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            params.max_iter = iters;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <a class="code" href="classSSAGES_1_1ANN.html#a8df5bc974f48135e0add44d77b91182a">net_</a>.set_train_params(params);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ANN_8h_source.html#l00050">net_</a>.</p>

</div>
</div>
<a id="a05554b5f5f718f20d772fabf814e3e4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05554b5f5f718f20d772fabf814e3e4c">&#9670;&nbsp;</a></span>SetMinLoss()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ANN::SetMinLoss </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>loss</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set minimum loss function value (should be zero for production). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">loss</td><td>Minimum loss function value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ANN_8h_source.html#l00195">195</a> of file <a class="el" href="ANN_8h_source.html">ANN.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="keyword">auto</span> params = <a class="code" href="classSSAGES_1_1ANN.html#a8df5bc974f48135e0add44d77b91182a">net_</a>.get_train_params();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            params.min_loss = loss; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <a class="code" href="classSSAGES_1_1ANN.html#a8df5bc974f48135e0add44d77b91182a">net_</a>.set_train_params(params);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ANN_8h_source.html#l00050">net_</a>.</p>

</div>
</div>
<a id="a45bb57007aa90bf3fc04a875b190145e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45bb57007aa90bf3fc04a875b190145e">&#9670;&nbsp;</a></span>SetOutput()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ANN::SetOutput </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>outfile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set name of output file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">outfile</td><td>Output file </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ANN_8h_source.html#l00157">157</a> of file <a class="el" href="ANN_8h_source.html">ANN.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <a class="code" href="classSSAGES_1_1ANN.html#ad799d7e14579192477a450338f1cf330">outfile_</a> = outfile;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ANN_8h_source.html#l00087">outfile_</a>.</p>

</div>
</div>
<a id="af48fa9793d0b1df77f0f2681072e76d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af48fa9793d0b1df77f0f2681072e76d2">&#9670;&nbsp;</a></span>SetOutputOverwrite()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ANN::SetOutputOverwrite </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>overwrite</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set overwrite flag on output file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">overwrite</td><td>Boolean if output file should be overwritten </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ANN_8h_source.html#l00166">166</a> of file <a class="el" href="ANN_8h_source.html">ANN.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <a class="code" href="classSSAGES_1_1ANN.html#ae928d6e1f11b3a9aca40c7a473d4df91">overwrite_</a> = overwrite;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ANN_8h_source.html#l00093">overwrite_</a>.</p>

</div>
</div>
<a id="ab39aaad92da34d5d11a10287feee53b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab39aaad92da34d5d11a10287feee53b3">&#9670;&nbsp;</a></span>SetPrevWeight()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ANN::SetPrevWeight </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set previous history weight. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>History weight </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ANN_8h_source.html#l00148">148</a> of file <a class="el" href="ANN_8h_source.html">ANN.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <a class="code" href="classSSAGES_1_1ANN.html#aa46e3420f46726cfa7766eaba5d53246">pweight_</a> = h;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ANN_8h_source.html#l00054">pweight_</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a5649c47eadcb28453c506587f83260f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5649c47eadcb28453c506587f83260f0">&#9670;&nbsp;</a></span>hist_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::MatrixXd SSAGES::ANN::hist_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Eigen matrices of grids. </p>

<p class="definition">Definition at line <a class="el" href="ANN_8h_source.html#l00073">73</a> of file <a class="el" href="ANN_8h_source.html">ANN.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ANN_8cpp_source.html#l00034">ANN()</a>, <a class="el" href="ANN_8cpp_source.html#l00076">PreSimulation()</a>, <a class="el" href="ANN_8cpp_source.html#l00264">ReadBias()</a>, <a class="el" href="ANN_8cpp_source.html#l00198">TrainNetwork()</a>, and <a class="el" href="ANN_8cpp_source.html#l00245">WriteBias()</a>.</p>

</div>
</div>
<a id="a022a5d90efc1c7d77f243bc6a30c2757"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a022a5d90efc1c7d77f243bc6a30c2757">&#9670;&nbsp;</a></span>lowerb_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SSAGES::ANN::lowerb_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Bounds </p>

<p class="definition">Definition at line <a class="el" href="ANN_8h_source.html#l00078">78</a> of file <a class="el" href="ANN_8h_source.html">ANN.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ANN_8cpp_source.html#l00113">PostIntegration()</a>, and <a class="el" href="ANN_8cpp_source.html#l00076">PreSimulation()</a>.</p>

</div>
</div>
<a id="a2d8da6902233c66212aecfe108aa08f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d8da6902233c66212aecfe108aa08f7">&#9670;&nbsp;</a></span>lowerk_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SSAGES::ANN::lowerk_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Bound restraints. </p>

<p class="definition">Definition at line <a class="el" href="ANN_8h_source.html#l00083">83</a> of file <a class="el" href="ANN_8h_source.html">ANN.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ANN_8cpp_source.html#l00113">PostIntegration()</a>, and <a class="el" href="ANN_8cpp_source.html#l00076">PreSimulation()</a>.</p>

</div>
</div>
<a id="aa46e3420f46726cfa7766eaba5d53246"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa46e3420f46726cfa7766eaba5d53246">&#9670;&nbsp;</a></span>pweight_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SSAGES::ANN::pweight_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Previous and current histogram weight. </p>

<p class="definition">Definition at line <a class="el" href="ANN_8h_source.html#l00054">54</a> of file <a class="el" href="ANN_8h_source.html">ANN.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ANN_8cpp_source.html#l00113">PostIntegration()</a>, <a class="el" href="ANN_8h_source.html#l00148">SetPrevWeight()</a>, and <a class="el" href="ANN_8cpp_source.html#l00198">TrainNetwork()</a>.</p>

</div>
</div>
<a id="a87307160193744fa3c445c8271c8678b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87307160193744fa3c445c8271c8678b">&#9670;&nbsp;</a></span>sweep_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int SSAGES::ANN::sweep_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Number of iterations per sweep. </p>

<p class="definition">Definition at line <a class="el" href="ANN_8h_source.html#l00043">43</a> of file <a class="el" href="ANN_8h_source.html">ANN.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ANN_8cpp_source.html#l00198">TrainNetwork()</a>, and <a class="el" href="ANN_8cpp_source.html#l00245">WriteBias()</a>.</p>

</div>
</div>
<a id="a1ef25a7766497d57498b194eb3d31b42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ef25a7766497d57498b194eb3d31b42">&#9670;&nbsp;</a></span>temp_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SSAGES::ANN::temp_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>System temperature and energy units. </p>

<p class="definition">Definition at line <a class="el" href="ANN_8h_source.html#l00059">59</a> of file <a class="el" href="ANN_8h_source.html">ANN.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ANN_8cpp_source.html#l00076">PreSimulation()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/michael/development/SSAGES/src/Methods/<a class="el" href="ANN_8h_source.html">ANN.h</a></li>
<li>/home/michael/development/SSAGES/src/Methods/<a class="el" href="ANN_8cpp_source.html">ANN.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jun 4 2021 17:28:53 for SSAGES by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
