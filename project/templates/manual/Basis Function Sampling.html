

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Basis Function Sampling &mdash; SSAGES v0.5.0-alpha-217-g4053fbf documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="SSAGES v0.5.0-alpha-217-g4053fbf documentation" href="index.html"/>
        <link rel="up" title="Advanced Sampling Methods" href="Advanced Sampling Methods.html"/>
        <link rel="next" title="Elastic Band" href="Elastic Band.html"/>
        <link rel="prev" title="Adaptive Biasing Force Algorithm" href="Adaptive Biasing Force Algorithm.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> SSAGES
          

          
          </a>

          
            
            
              <div class="version">
                0.6.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Getting Started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Advanced Sampling Methods.html">Advanced Sampling Methods</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Adaptive Biasing Force Algorithm.html">Adaptive Biasing Force Algorithm</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Basis Function Sampling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#options-parameters">Options &amp; Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#required-to-run-bfs">Required to Run BFS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#guidelines-for-running-bfs">Guidelines for running BFS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tutorial">Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#basis-out">basis.out</a></li>
<li class="toctree-l4"><a class="reference internal" href="#coeff-out">coeff.out</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#developer">Developer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Elastic Band.html">Elastic Band</a></li>
<li class="toctree-l2"><a class="reference internal" href="Finite Temperature String.html">Finite Temperature String</a></li>
<li class="toctree-l2"><a class="reference internal" href="Forward-Flux.html">Forward-Flux</a></li>
<li class="toctree-l2"><a class="reference internal" href="Metadynamics.html">Metadynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="Image Method.html">Image Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="Replica Exchange.html">Replica Exchange</a></li>
<li class="toctree-l2"><a class="reference internal" href="Swarm of Trajectories.html">Swarm of Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="Umbrella Sampling.html">Umbrella Sampling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Write your own Methods and CVs.html">Write your own Methods and CVs</a></li>
<li class="toctree-l1"><a class="reference internal" href="Contribute to SSAGES.html">Contribute to SSAGES</a></li>
<li class="toctree-l1"><a class="reference internal" href="The SSAGES Cookbook.html">The SSAGES cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="Acknowledgements.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="License.html">Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="License.html#id1">License information</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SSAGES</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="Advanced Sampling Methods.html">Advanced Sampling Methods</a> &raquo;</li>
        
      <li>Basis Function Sampling</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Basis Function Sampling.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="basis-function-sampling">
<span id="id1"></span><h1>Basis Function Sampling<a class="headerlink" href="#basis-function-sampling" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Basis Function enhanced sampling method is a variant of the Continuous
Wang-Landau Sampling method developed by Whitmer et al, which biases a PMF
through the summation of Kronecker deltas. In this method, the Kronecker delta
is approximated by projection of a locally biased histogram to a truncated set
of orthogonal basis functions.</p>
<div class="math">
\[\int_\Xi f_{i}(\vec{\xi})f_{j}(\vec{\xi})w(\vec{\xi})d\vec{\xi} = \delta_{i}c_{i}\]</div>
<p>By projecting a basis set, the system resolves the same properties as the
Kronecker deltas, but in a continuous and differentiable manner that lends well
towards MD simulations. Currently in SSAGES, Legendre Polynomials have been
implemented to work with BFS. These have the property where the weight
<span class="math">\(w(\xi) = 1\)</span> and are defined on the interval <span class="math">\([-1, 1]\)</span>.</p>
<p>The method applies its bias in sweeps of $N$ through a histogram (<span class="math">\(H_{i}\)</span>)
that is updated at every <span class="math">\(j\)</span> microstate or timestep. This histogram is
then modified to an unbiased partition function estimate (<span class="math">\(\tilde{H_{i}}\)</span>)
by convolution with the current bias potential (<span class="math">\(\Phi_{i}\)</span>).</p>
<div class="math">
\[\tilde{H}_{i}(\xi) = H_{i}(\xi)e^{\beta \Phi_{i}}\]</div>
<p>In order to account for sampling history into this partition function estimate,
a simple weight function (<span class="math">\(W(t_{j})\)</span>) is added.</p>
<div class="math">
\[Z_{i}(\xi) = \sum_{j} W(t_{j})\tilde{H_{j}}(\xi)\]</div>
<p>This final estimate is then projected to the truncated basis set. After this set
is evaluated, the coefficients of the basis set are evaluated. This process is
iterated until the surface converges, which is determined by the overall update
of the coefficients.</p>
<div class="math">
\[\begin{split}\beta \Phi_{i+1}(\xi) = \sum_j^N \alpha^i_j L_j(\xi)\\
\alpha^i_j = \frac{2j + 1}{2} \int_{-1}^1 \log(Z_i(\xi))L_j(\xi)d\xi\end{split}\]</div>
</div>
<div class="section" id="options-parameters">
<h2>Options &amp; Parameters<a class="headerlink" href="#options-parameters" title="Permalink to this headline">¶</a></h2>
<p>These are all the options that SSAGES provides for running Basis Function
Sampling. In order to add BFS to the JSON file, the method should be labeled as
&#8220;Basis&#8221;.</p>
<dl class="docutils">
<dt>CV coefficients</dt>
<dd>The order of the polynomial to be projected for each collective variable. If
the order of this array doesn&#8217;t match the number of CVs, the system assumes
the first number for all of the CVs</dd>
<dt>CV restraint spring constants</dt>
<dd>The strength of the springs keeping the system in bounds in a non-periodic
system.</dd>
<dt>CV restraint maximums</dt>
<dd>The upper bounds of each CV in a non-periodic system.</dd>
<dt>CV restraint minimums</dt>
<dd>The lower bounds of each CV in a non-periodic system.</dd>
<dt>cycle frequency</dt>
<dd>The frequency of updating the projection bias.</dd>
<dt>frequency</dt>
<dd>The frequency of each integration step. This should almost always be set to 1.</dd>
<dt>weight</dt>
<dd>The weight of each visited histogram step. Should be kept at 1.0, but the
option is available to make it slightly greater. The system has a higher
chance of exploding at higher weight values.</dd>
<dt>basis filename</dt>
<dd>A suffix to name the output file. If not specified the output will be
&#8220;basis.out&#8221;</dd>
<dt>coeff filename</dt>
<dd>A suffix to name the coefficient file.</dd>
<dt>temperature</dt>
<dd>Only should be used if the MD engine cannot produce a good temperature
value. (ie: LAMMPS with 1 particle)</dd>
<dt>tolerance</dt>
<dd>Convergence criteria. The sum of the difference in subsequent updates of the
coefficients squared must be less than this for convergence to work.</dd>
<dt>convergence exit</dt>
<dd>A boolean option to let the user choose if the system should exit once the
convergence is met.</dd>
</dl>
</div>
<div class="section" id="required-to-run-bfs">
<h2>Required to Run BFS<a class="headerlink" href="#required-to-run-bfs" title="Permalink to this headline">¶</a></h2>
<p>In order to use the method properly a few things must be put in the JSON file. A
grid is required to run Basis Function Sampling. Refer to the Grid section in
order to understand options available for the grid implementation.
The only inputs required to run the method:</p>
<ul class="simple">
<li>cyclefrequency</li>
<li>frequency</li>
<li>CV coefficients</li>
</ul>
</div>
<div class="section" id="guidelines-for-running-bfs">
<h2>Guidelines for running BFS<a class="headerlink" href="#guidelines-for-running-bfs" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>It is generally a good idea to use polynomials of order at least 25.</li>
<li>For higher order polynomials, the error in projection is less, but the number
of bins must increase in order to accurately project the surface.</li>
<li>A good rule of thumb for these simulations is to do at least one order of
magnitude more bins than polynomial order.</li>
</ul>
<p>If the system that is to be used requires a non-periodic boundary condition,
then it is typically a good idea to place the bounds approximately 0.1 - 0.2
units outside the grid boundaries.</p>
<p>The convergence exit option is available if the user chooses to continue running
past convergence, but a good heuristic for tolerance is around
<span class="math">\(1\mathrm{e}{-6}\)</span>.</p>
</div>
<div class="section" id="tutorial">
<span id="bfs-tutorial"></span><h2>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h2>
<p>This tutorial will provide a reference for running BFS in SSAGES. There are
multiple examples provided in the Examples/User directory of SSAGES, but this
tutorial will cover the Alanine Dipeptide example.
In the ADP subdirectory of the <code class="docutils literal"><span class="pre">Examples/User</span> <span class="pre">section</span></code> there should be a
LAMMPS input file (titled <code class="docutils literal"><span class="pre">in.BFS_ADP_shake</span></code>) and two JSON input files.
Both of these files will work for SSAGES, but the one titled <code class="docutils literal"><span class="pre">BFS_AdP_rst.json</span></code>
makes use of the restart capability in SSAGES.</p>
<p>After compiling SSAGES with the user&#8217;s version of LAMMPS with the
<code class="docutils literal"><span class="pre">make</span> <span class="pre">rigid=yes</span></code> option chosen, the user can elect to run the example.</p>
<p>(NOTE: if the user did not compile lammps with the rigid option, then the other
lammps file can be used. Just change the input file variable in the json file to
<code class="docutils literal"><span class="pre">in.BFS_ADP</span></code>)
Use the following command to run the example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>mpiexec -np <span class="m">1</span> /path/to/SSAGES/build/dir/ssages BFS_AdP_rst.json
</pre></div>
</div>
<p>This should prompt SSAGES to begin an alanine dipeptide run. If the run is
successful, the console will output the current sweep number on each node.
At this point the user can elect to read the output information after each sweep.
If at any point during the run, the user elects to stop running and then pickup
where the simulation was left off, simply execute SSAGES with the newly generated
restart file (<code class="docutils literal"><span class="pre">BFS_AdP_restart.json</span></code>).</p>
<div class="section" id="basis-out">
<h3>basis.out<a class="headerlink" href="#basis-out" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">basis.out</span></code> file outputs in at least 4 columns. These columns refer to the
CV values, the ultimate projected PMF, the unprojected PMF, and the biased
histogram values. Depending on the number of CVs chosen for a simulation, the
number of CV columns will also correspond. Only the first CV column should be
labeled.</p>
<p>The important line for graphing purposes is the projected PMF, which is the
basis set projection from taking the log of the biased histogram. The biased
histgram is printed so that it can be read in for doing restart runs (subject to
change). For plotting the PMF, a simple plotting tool over the CV value and
projected PMF columns will result in the free energy surface of the simulation.
The free energy surface will return a crude estimate within the first few
sweeps, and then will take a longer period of time to retrieve the fully
converged surface. A reference image of the converged  alanine dipeptide example
is provided in the same directory as the LAMMPS and JSON input files.</p>
</div>
<div class="section" id="coeff-out">
<h3>coeff.out<a class="headerlink" href="#coeff-out" title="Permalink to this headline">¶</a></h3>
<p>This holds all the coefficient values after each bias projection update. This
file is entirely used for restart runs.</p>
</div>
</div>
<div class="section" id="developer">
<h2>Developer<a class="headerlink" href="#developer" title="Permalink to this headline">¶</a></h2>
<p>Joshua Moller.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Elastic Band.html" class="btn btn-neutral float-right" title="Elastic Band" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Adaptive Biasing Force Algorithm.html" class="btn btn-neutral" title="Adaptive Biasing Force Algorithm" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, the SSAGES Team.
      Last updated on Jun 07, 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'v0.5.0-alpha-217-g4053fbf',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>