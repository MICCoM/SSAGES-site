

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Elastic Band &mdash; SSAGES 0.9 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="SSAGES 0.9 documentation" href="index.html"/>
        <link rel="up" title="Meta-Dynamics Methods" href="Meta-Dynamics Methods.html"/>
        <link rel="next" title="Finite Temperature String" href="Finite Temperature String.html"/>
        <link rel="prev" title="Basis Function Sampling" href="Basis Function Sampling.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> SSAGES
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Getting Started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Meta-Dynamics Methods.html">Meta-Dynamics Methods</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Adaptive Biasing Force Algorithm.html">Adaptive Biasing Force Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="Basis Function Sampling.html">Basis Function Sampling</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Elastic Band</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#options-parameters">Options &amp; Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tutorial">Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="#developer">Developer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic-band-references">References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Finite Temperature String.html">Finite Temperature String</a></li>
<li class="toctree-l2"><a class="reference internal" href="Forward-Flux.html">Forward-Flux</a></li>
<li class="toctree-l2"><a class="reference internal" href="Generic Metadynamics.html">Generic Metadynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="Image Method.html">Image Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="Replica Exchange.html">Replica Exchange</a></li>
<li class="toctree-l2"><a class="reference internal" href="Swarm of Trajectories.html">Swarm of Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="Umbrella Sampling.html">Umbrella Sampling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Write your own Methods and CVs.html">Write your own Methods and CVs</a></li>
<li class="toctree-l1"><a class="reference internal" href="Contribute to SSAGES.html">Contribute to SSAGES</a></li>
<li class="toctree-l1"><a class="reference internal" href="The SSAGES Cookbook.html">The SSAGES cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="Acknowledgements.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="License.html">Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="License.html#id1">License information</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">SSAGES</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="Meta-Dynamics Methods.html">Meta-Dynamics Methods</a> &raquo;</li>
      
    <li>Elastic Band</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/Elastic Band.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="elastic-band">
<span id="id1"></span><h1>Elastic Band<a class="headerlink" href="#elastic-band" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>There are many methods, several of which are included in SSAGES, to calculate
transition pathways between metastable states.  One kind of pathway between
states in the <em>minimum energy pathway</em> (MEP), quite simply the lowest energy
pathway a system can take between these states.  An MEP has the condition that
the force everywhere along the pathway points only along the path, that is, it
has no perpendicular component.  By finding the MEP, one also finds the saddle
points of the potential energy surface, as they are by definition the maxima of
the MEP.  The <em>nudged elastic band</em> (NEB) method is a popular and efficient
method to calculate the MEP between the initial and final state of a transition
<a class="footnote-reference" href="#id6" id="id2">[1]</a> <a class="footnote-reference" href="#id7" id="id3">[2]</a>.</p>
<p>The method involves the evolution of a series of images connected by a spring
interaction (hence the “elastic” nature of the band).  The force acting on the
images (a combination of the spring force along the band and the true force
acting perpendicular to the band) is minimized to ensure convergence to the MEP.
The <strong>nudged</strong> nature of NEB refers to a force projection that ensures the
spring forces do not interfere with the elastic band converging to the MEP, as
well as that the true force does not alter the distribution of images along the
band (that is, it ensures all the images do not fall into the metastable states).
This projection is accomplished by using the parallel portion of the spring
force and the perpendicular portion of the true force.  In this way, the spring
forces act similarly to reparameterization schemes common to the string method.</p>
<p>Full mathematical background is available in the
<a class="reference external" href="elastic-band-references">references</a>, but a brief overview is given here. The
band is discretized as a series of N+1 images, and the force on each image is
given by:</p>
<div class="math">
\[F_{i} = F_{i,\parallel}^{s} - \nabla E(R_{i})_{\perp}\]</div>
<p>Where <span class="math">\(F_{i}\)</span> is the total force on the image, <span class="math">\(F_{i,\parallel}^{s}\)</span>
refers to the parallel component of the spring force on the ith image, and
<span class="math">\(\nabla E(R_{i})_{\perp}\)</span> is the perpendicular component of the gradient
of the energy evaluated at each image <span class="math">\(R_{i}\)</span>. The second term on the
right hand side is the “true force” and is evaluated as:</p>
<div class="math">
\[\nabla E(R_{i})_{\perp} = \nabla E(R_{i}) - \nabla E(R_{i})\cdot\hat{\tau_{i}}\]</div>
<p>The term <span class="math">\(\hat{\tau_{i}}\)</span> represents the normalized local tangent at the
ith image, and thus this equation states simply that the perpendicular component
of the gradient is the full gradient minus the parallel portion of the gradient.
There are different schemes available in literature to evaluate the tangent
vector <a class="footnote-reference" href="#id7" id="id4">[2]</a>. The “spring force” is calculated as:</p>
<div class="math">
\[F_{i,\parallel}^{s} = k \left( \lvert R_{i+1} - R_{i} \rvert -
                               \lvert R_{i} - R_{i-1} \rvert \right) \cdot \hat{\tau_{i}}\]</div>
<p>Where <span class="math">\(k\)</span> is the spring constant, which can be different for each image of
the band.  One can evolve the images with these forces according to any number
of schemes - a straightforward Verlet integration scheme is used in the SSAGES
implementation, described below.</p>
<p>Algorithmically, the NEB method is implemented in SSAGES as follows:</p>
<ol class="arabic simple">
<li>An initial band is defined between the two states of interest.  This can be
defined however one wishes; often it is simply a linear interpolation through
the space of the collective variables.  In fact, the ends of the band need
not necessarily be in the basins of interest; the method should allow the
ends to naturally fall into nearby metastable basins.</li>
<li>For each image of the band, a molecular system with atomic coordinates that
roughly correspond to the collective variables of that image is constructed.
A period of equilibration is performed to ensure that the underlying systems&#8217;
CVs match their respective band images.</li>
<li>The gradient is sampled over a user-defined period of time and intervals,
this being the only quantity with statistical variance that needs to be
averaged over.</li>
<li>When sufficient sampling of the gradient is done, the band is updated one
time-step forward with a simple Verlet scheme.</li>
</ol>
<p>Steps two through four are iterated upon, leading to convergence of the method
and the MEP.</p>
</div>
<div class="section" id="options-parameters">
<h2>Options &amp; Parameters<a class="headerlink" href="#options-parameters" title="Permalink to this headline">¶</a></h2>
<p>These are all the options that SSAGES provides for running the NEB method. In
order to add NEB to the JSON file, the method should be labeled as &#8220;ElasticBand&#8221;.</p>
<dl class="docutils">
<dt>centers</dt>
<dd>For each driver, the initial values of each CV should be specified as a list
under &#8220;centers&#8221;.  In this way, the initial band is defined.</dd>
<dt>number samples</dt>
<dd>A specification of how many times to sample the gradient during the umbrella
sampling portion of the method.</dd>
<dt>time step</dt>
<dd>The time step used in the Verlet integration of the force to update the
images of the band.</dd>
<dt>ksprings</dt>
<dd>The constant used in performing umbrella sampling for the simulation; it can
be specified uniquely for each image and for each CV.  Please notice its
difference from kstring.</dd>
<dt>kstring</dt>
<dd>The constant used in calculating the spring force at each image.  It can be
specified uniquely for each image.  Please notice its difference from
kpsrings.</dd>
<dt>frequency</dt>
<dd>The frequency of each integration step. This should almost always be set to
1.</dd>
<dt>equilibration steps</dt>
<dd>The number of MD steps to simply perform umbrella sampling without invoking
the NEB method.  A sufficiently long number of steps ensures that the
underlying molecular systems have CVs close to the CVs of their associated
image on the band.</dd>
<dt>max iterations</dt>
<dd>The simulation will terminate after the specified number of iterations.</dd>
<dt>evolution steps</dt>
<dd>The number of steps to perform the NEB over; the band is updated after
evolution steps times the number of samples total MD steps.  A new value of
the gradient is harvested every time the number of MD steps taken is an
integer multiple of evolution steps.</dd>
</dl>
</div>
<div class="section" id="tutorial">
<span id="eb-tutorial"></span><h2>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h2>
<p>This tutorial will walk you step by step through the user example provided with
the SSAGES source code that runs the NEB method on the alanine dipeptide using
LAMMPS.  First, be sure you have compiled SSAGES with LAMMPS.  Then, navigate to
the <code class="docutils literal"><span class="pre">SSAGES/Examples/User/ElasticBand/ADP</span></code> subdirectory.  Now, take a moment
to observe the <code class="docutils literal"><span class="pre">in.ADP_Test</span> <span class="pre">and</span> <span class="pre">data.input</span></code> files in order to familiarize
yourself with the system being simulated.</p>
<p>The next two files of interest are the <code class="docutils literal"><span class="pre">EB_Template.json</span></code> input file and the
<code class="docutils literal"><span class="pre">EB_Input_Generator.py</span></code> script.  Both of these files can be modified in your
text editor of choice to customize the inputs, but for this tutorial, simply
observe them and leave them be.  EB_Template.json contains all the information
necessary to fully specify one driver; EB_Input_Generator.py copies this
information a number of times specified within the script (for this tutorial,
12 times) while also linearly interpolating through the start and end states
defined in the script and substituting the correct values into the “centers”
portion of the method definition.  Execute this script as follows:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>python EB_Input_Generator.py
</pre></div>
</div>
<p>You will produce a file called <code class="docutils literal"><span class="pre">EB.json</span></code>. You can also open this file to
verify for yourself that the script did what it was supposed to do.  Now, with
your JSON input and your SSAGES binary, you have everything you need to perform
a simulation.  Simply run:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>mpiexec -np <span class="m">12</span> ./ssages EB.json
</pre></div>
</div>
<p>Soon, the simulation will produce a <code class="docutils literal"><span class="pre">node-X.log</span></code> file for each driver, where
X is the number specifying the driver (in this case, 0-11 for our 12 drivers).
Each one will report the following information, in order: the node number, the
iteration number, and for each CV, the current value of the band CV as well as
the current value of the CV calculated from the molecular system.</p>
<p>Allow your system to run for the specified number of iterations (2000 for this
tutorial).  The last line of every node file can be analyzed to view the last
positons of each image of the elastic band.</p>
</div>
<div class="section" id="developer">
<h2>Developer<a class="headerlink" href="#developer" title="Permalink to this headline">¶</a></h2>
<p>Ben Sikora.</p>
</div>
<div class="section" id="elastic-band-references">
<span id="id5"></span><h2>References<a class="headerlink" href="#elastic-band-references" title="Permalink to this headline">¶</a></h2>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td>G. Henkelman, B. P. Uberuaga, and H. Jónsson, <em>A climbing image nudged
elastic band method for finding saddle points and minimum energy paths</em>.
J. Chem. Phys. <strong>113</strong>, 9901 (2000).</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id4">2</a>)</em> G. Henkelman, and H. Jónsson, <em>Improved tangent estimate in the nudged
elastic band method for finding minimum energy paths and saddle points</em>.
J. Chem. Phys. <strong>113</strong>, 9978 (2000).</td></tr>
</tbody>
</table>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Finite Temperature String.html" class="btn btn-neutral float-right" title="Finite Temperature String" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Basis Function Sampling.html" class="btn btn-neutral" title="Basis Function Sampling" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, the SSAGES Team.
      Last updated on Oct 14, 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>