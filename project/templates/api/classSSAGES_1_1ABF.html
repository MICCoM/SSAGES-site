<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>SSAGES: SSAGES::ABF Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SSAGES
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">A MetaDynamics Package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceSSAGES.html">SSAGES</a></li><li class="navelem"><a class="el" href="classSSAGES_1_1ABF.html">ABF</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classSSAGES_1_1ABF-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">SSAGES::ABF Class Reference<div class="ingroups"><a class="el" href="group__Methods.html">Methods</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Adaptive Biasing Force Algorithm.  
 <a href="classSSAGES_1_1ABF.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ABF_8h_source.html">ABF.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for SSAGES::ABF:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1ABF__inherit__graph.png" border="0" usemap="#SSAGES_1_1ABF_inherit__map" alt="Inheritance graph"/></div>
<map name="SSAGES_1_1ABF_inherit__map" id="SSAGES_1_1ABF_inherit__map">
<area shape="rect" id="node2" href="classSSAGES_1_1Method.html" title="Interface for Method implementations. " alt="" coords="23,80,151,107"/><area shape="rect" id="node3" href="classSSAGES_1_1EventListener.html" title="Base abstract class for listening in to events fired by &quot;Hook&quot;. " alt="" coords="4,5,168,32"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7071f09b2810b388ff6eabdc49fab005"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a7071f09b2810b388ff6eabdc49fab005">ABF</a> (const MPI_Comm &amp;world, const MPI_Comm &amp;comm, <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; int &gt; *N, <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; int &gt; *Nworld, std::vector&lt; <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; * &gt; F, std::vector&lt; <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; * &gt; Fworld, std::vector&lt; std::vector&lt; double &gt;&gt; restraint, std::vector&lt; bool &gt; isperiodic, std::vector&lt; std::vector&lt; double &gt;&gt; periodicboundaries, double min, bool massweigh, std::string filename, std::string Nworld_filename, std::string Fworld_filename, const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;histdetails, int FBackupInterv, double unitconv, double timestep, unsigned int frequency)</td></tr>
<tr class="memdesc:a7071f09b2810b388ff6eabdc49fab005"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a7071f09b2810b388ff6eabdc49fab005">More...</a><br /></td></tr>
<tr class="separator:a7071f09b2810b388ff6eabdc49fab005"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27d1b2f056d32066d7c62a037836948c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a27d1b2f056d32066d7c62a037836948c">PreSimulation</a> (<a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *snapshot, const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;cvmanager) override</td></tr>
<tr class="memdesc:a27d1b2f056d32066d7c62a037836948c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pre-simulation hook.  <a href="#a27d1b2f056d32066d7c62a037836948c">More...</a><br /></td></tr>
<tr class="separator:a27d1b2f056d32066d7c62a037836948c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2007ce8bb539072a97d4d02d268c638"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#ad2007ce8bb539072a97d4d02d268c638">PostIntegration</a> (<a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *snapshot, const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;cvmanager) override</td></tr>
<tr class="memdesc:ad2007ce8bb539072a97d4d02d268c638"><td class="mdescLeft">&#160;</td><td class="mdescRight">Post-integration hook.  <a href="#ad2007ce8bb539072a97d4d02d268c638">More...</a><br /></td></tr>
<tr class="separator:ad2007ce8bb539072a97d4d02d268c638"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02fae49d009dcf405d82144a2d123faa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a02fae49d009dcf405d82144a2d123faa">PostSimulation</a> (<a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *snapshot, const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;cvmanager) override</td></tr>
<tr class="memdesc:a02fae49d009dcf405d82144a2d123faa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Post-simulation hook.  <a href="#a02fae49d009dcf405d82144a2d123faa">More...</a><br /></td></tr>
<tr class="separator:a02fae49d009dcf405d82144a2d123faa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac206ccf90c29d11d6abdebeae44b033f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#ac206ccf90c29d11d6abdebeae44b033f">SetIteration</a> (const int iter)</td></tr>
<tr class="memdesc:ac206ccf90c29d11d6abdebeae44b033f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set iteration of the method.  <a href="#ac206ccf90c29d11d6abdebeae44b033f">More...</a><br /></td></tr>
<tr class="separator:ac206ccf90c29d11d6abdebeae44b033f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa683e1d8a8df3522bc64529ea5e80a78"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa683e1d8a8df3522bc64529ea5e80a78"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#aa683e1d8a8df3522bc64529ea5e80a78">~ABF</a> ()</td></tr>
<tr class="memdesc:aa683e1d8a8df3522bc64529ea5e80a78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:aa683e1d8a8df3522bc64529ea5e80a78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classSSAGES_1_1Method"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classSSAGES_1_1Method')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classSSAGES_1_1Method.html">SSAGES::Method</a></td></tr>
<tr class="memitem:a05bb6ea0244814c1290c46bb3a059be9 inherit pub_methods_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a05bb6ea0244814c1290c46bb3a059be9">Method</a> (uint frequency, const MPI_Comm &amp;world, const MPI_Comm &amp;comm)</td></tr>
<tr class="memdesc:a05bb6ea0244814c1290c46bb3a059be9 inherit pub_methods_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a05bb6ea0244814c1290c46bb3a059be9">More...</a><br /></td></tr>
<tr class="separator:a05bb6ea0244814c1290c46bb3a059be9 inherit pub_methods_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5438a9b6cd41bcc86b9662b1af2313a0 inherit pub_methods_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5438a9b6cd41bcc86b9662b1af2313a0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a5438a9b6cd41bcc86b9662b1af2313a0">SetCVMask</a> (const std::vector&lt; uint &gt; &amp;mask)</td></tr>
<tr class="memdesc:a5438a9b6cd41bcc86b9662b1af2313a0 inherit pub_methods_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the collective variable mask. <br /></td></tr>
<tr class="separator:a5438a9b6cd41bcc86b9662b1af2313a0 inherit pub_methods_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86b979a552970f63a8edf160387f6ff9 inherit pub_methods_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a86b979a552970f63a8edf160387f6ff9"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a86b979a552970f63a8edf160387f6ff9">~Method</a> ()</td></tr>
<tr class="memdesc:a86b979a552970f63a8edf160387f6ff9 inherit pub_methods_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:a86b979a552970f63a8edf160387f6ff9 inherit pub_methods_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classSSAGES_1_1EventListener"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classSSAGES_1_1EventListener')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classSSAGES_1_1EventListener.html">SSAGES::EventListener</a></td></tr>
<tr class="memitem:a9e65b79ad13d30014481a3efd26d654c inherit pub_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#a9e65b79ad13d30014481a3efd26d654c">EventListener</a> (uint frequency)</td></tr>
<tr class="memdesc:a9e65b79ad13d30014481a3efd26d654c inherit pub_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a9e65b79ad13d30014481a3efd26d654c">More...</a><br /></td></tr>
<tr class="separator:a9e65b79ad13d30014481a3efd26d654c inherit pub_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f36ffb7052dad44fe24df6c8fb50e75 inherit pub_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top">uint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#a9f36ffb7052dad44fe24df6c8fb50e75">GetFrequency</a> () const </td></tr>
<tr class="memdesc:a9f36ffb7052dad44fe24df6c8fb50e75 inherit pub_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get frequency of event listener.  <a href="#a9f36ffb7052dad44fe24df6c8fb50e75">More...</a><br /></td></tr>
<tr class="separator:a9f36ffb7052dad44fe24df6c8fb50e75 inherit pub_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cadffb0e82186a12023dd5963c3c5b1 inherit pub_methods_classSSAGES_1_1EventListener"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7cadffb0e82186a12023dd5963c3c5b1"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1EventListener.html#a7cadffb0e82186a12023dd5963c3c5b1">~EventListener</a> ()</td></tr>
<tr class="memdesc:a7cadffb0e82186a12023dd5963c3c5b1 inherit pub_methods_classSSAGES_1_1EventListener"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:a7cadffb0e82186a12023dd5963c3c5b1 inherit pub_methods_classSSAGES_1_1EventListener"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:aa131b026ddb40941889c8bde7840ac6a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSSAGES_1_1ABF.html">ABF</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#aa131b026ddb40941889c8bde7840ac6a">Build</a> (const Json::Value &amp;json, const MPI_Comm &amp;world, const MPI_Comm &amp;comm, const std::string &amp;path)</td></tr>
<tr class="separator:aa131b026ddb40941889c8bde7840ac6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_classSSAGES_1_1Method"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classSSAGES_1_1Method')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classSSAGES_1_1Method.html">SSAGES::Method</a></td></tr>
<tr class="memitem:a1464579bb8b15653ccd0ffa834e15e93 inherit pub_static_methods_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSSAGES_1_1Method.html">Method</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a1464579bb8b15653ccd0ffa834e15e93">BuildMethod</a> (const Json::Value &amp;json, const MPI_Comm &amp;world, const MPI_Comm &amp;comm, const std::string &amp;path)</td></tr>
<tr class="memdesc:a1464579bb8b15653ccd0ffa834e15e93 inherit pub_static_methods_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build a derived method from JSON node.  <a href="#a1464579bb8b15653ccd0ffa834e15e93">More...</a><br /></td></tr>
<tr class="separator:a1464579bb8b15653ccd0ffa834e15e93 inherit pub_static_methods_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aa2200677359f582d73f095c42ec5ad83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#aa2200677359f582d73f095c42ec5ad83">CalcBiasForce</a> (const <a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *snapshot, const <a class="el" href="namespaceSSAGES.html#acddea47426ac0a643b048f870ddd2907">CVList</a> &amp;cvs, const std::vector&lt; double &gt; &amp;cvVals)</td></tr>
<tr class="memdesc:aa2200677359f582d73f095c42ec5ad83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the bias force.  <a href="#aa2200677359f582d73f095c42ec5ad83">More...</a><br /></td></tr>
<tr class="separator:aa2200677359f582d73f095c42ec5ad83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab63434a1cefe80372e2555e1128e39d2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab63434a1cefe80372e2555e1128e39d2"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#ab63434a1cefe80372e2555e1128e39d2">WriteData</a> ()</td></tr>
<tr class="memdesc:ab63434a1cefe80372e2555e1128e39d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes out data to file. <br /></td></tr>
<tr class="separator:ab63434a1cefe80372e2555e1128e39d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae223e09cc686522073fd881088edb8ac"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#ae223e09cc686522073fd881088edb8ac">boundsCheck</a> (const std::vector&lt; double &gt; &amp;CVs)</td></tr>
<tr class="memdesc:ae223e09cc686522073fd881088edb8ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether the local walker is within CV bounds.  <a href="#ae223e09cc686522073fd881088edb8ac">More...</a><br /></td></tr>
<tr class="separator:ae223e09cc686522073fd881088edb8ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a47453516b73e968060821c57d67b44ff"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a47453516b73e968060821c57d67b44ff">F_</a></td></tr>
<tr class="memdesc:a47453516b73e968060821c57d67b44ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">To store running total of the local walker.  <a href="#a47453516b73e968060821c57d67b44ff">More...</a><br /></td></tr>
<tr class="separator:a47453516b73e968060821c57d67b44ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7df76c30aa32223fb74f3fbdb9202706"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a7df76c30aa32223fb74f3fbdb9202706">Fworld_</a></td></tr>
<tr class="memdesc:a7df76c30aa32223fb74f3fbdb9202706"><td class="mdescLeft">&#160;</td><td class="mdescRight">Will hold the global total, synced across walkers at every time step.  <a href="#a7df76c30aa32223fb74f3fbdb9202706">More...</a><br /></td></tr>
<tr class="separator:a7df76c30aa32223fb74f3fbdb9202706"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45daad9b41bac9009f1c2f09da10f58e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; int &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a45daad9b41bac9009f1c2f09da10f58e">N_</a></td></tr>
<tr class="memdesc:a45daad9b41bac9009f1c2f09da10f58e"><td class="mdescLeft">&#160;</td><td class="mdescRight">To store number of local hits at a given CV bin.  <a href="#a45daad9b41bac9009f1c2f09da10f58e">More...</a><br /></td></tr>
<tr class="separator:a45daad9b41bac9009f1c2f09da10f58e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2306049903c2ed6e6fb07eaee71e9ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; int &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#ae2306049903c2ed6e6fb07eaee71e9ae">Nworld_</a></td></tr>
<tr class="memdesc:ae2306049903c2ed6e6fb07eaee71e9ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">To store number of global hits at a given CV bin.  <a href="#ae2306049903c2ed6e6fb07eaee71e9ae">More...</a><br /></td></tr>
<tr class="separator:ae2306049903c2ed6e6fb07eaee71e9ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e2b1995149d50d1b1e9d05e6a44c1b6"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak" />
&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a></td></tr>
<tr class="memdesc:a7e2b1995149d50d1b1e9d05e6a44c1b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Information for a harmonic restraint to keep CV in the region of interest.  <a href="#a7e2b1995149d50d1b1e9d05e6a44c1b6">More...</a><br /></td></tr>
<tr class="separator:a7e2b1995149d50d1b1e9d05e6a44c1b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa575ad59d0bbaac2709de9c481d4db30"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa575ad59d0bbaac2709de9c481d4db30"></a>
std::vector&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#aa575ad59d0bbaac2709de9c481d4db30">isperiodic_</a></td></tr>
<tr class="memdesc:aa575ad59d0bbaac2709de9c481d4db30"><td class="mdescLeft">&#160;</td><td class="mdescRight">For each CV, holds whether that CV has periodic boundaries or not. <br /></td></tr>
<tr class="separator:aa575ad59d0bbaac2709de9c481d4db30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85f39957134c0d27298aff5ad306cbd9"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak" />
&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a85f39957134c0d27298aff5ad306cbd9">periodicboundaries_</a></td></tr>
<tr class="memdesc:a85f39957134c0d27298aff5ad306cbd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds periodic boundaries of CVs.  <a href="#a85f39957134c0d27298aff5ad306cbd9">More...</a><br /></td></tr>
<tr class="separator:a85f39957134c0d27298aff5ad306cbd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88322f13d3424be20d46cf68a3c8ce28"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a88322f13d3424be20d46cf68a3c8ce28">min_</a></td></tr>
<tr class="separator:a88322f13d3424be20d46cf68a3c8ce28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c882e37a3676cb3e33776621929c3b7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7c882e37a3676cb3e33776621929c3b7"></a>
Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">wdotp1_</a></td></tr>
<tr class="memdesc:a7c882e37a3676cb3e33776621929c3b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">To hold last iteration wdotp value for numerical derivative. <br /></td></tr>
<tr class="separator:a7c882e37a3676cb3e33776621929c3b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a0082f17ab10382191cbf39046e7052"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1a0082f17ab10382191cbf39046e7052"></a>
Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a1a0082f17ab10382191cbf39046e7052">wdotp2_</a></td></tr>
<tr class="memdesc:a1a0082f17ab10382191cbf39046e7052"><td class="mdescLeft">&#160;</td><td class="mdescRight">To hold second to last iteration wdotp value for numerical derivative. <br /></td></tr>
<tr class="separator:a1a0082f17ab10382191cbf39046e7052"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0158dff5be22bf287e22aab2eadd4e25"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0158dff5be22bf287e22aab2eadd4e25"></a>
Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a0158dff5be22bf287e22aab2eadd4e25">Fold_</a></td></tr>
<tr class="memdesc:a0158dff5be22bf287e22aab2eadd4e25"><td class="mdescLeft">&#160;</td><td class="mdescRight">To hold last iterations F_ value for removing bias. <br /></td></tr>
<tr class="separator:a0158dff5be22bf287e22aab2eadd4e25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa792d019aee0f614a2a0935405244e91"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa792d019aee0f614a2a0935405244e91"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#aa792d019aee0f614a2a0935405244e91">massweigh_</a></td></tr>
<tr class="memdesc:aa792d019aee0f614a2a0935405244e91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mass weighing of bias enabled/disabled. <br /></td></tr>
<tr class="separator:aa792d019aee0f614a2a0935405244e91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae88ce69e6e7fcb15b8db68d5530f6a1e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae88ce69e6e7fcb15b8db68d5530f6a1e"></a>
std::vector&lt; <a class="el" href="namespaceSSAGES.html#a630084a0a5e185e89e21b3735f8f8b2e">Vector3</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#ae88ce69e6e7fcb15b8db68d5530f6a1e">biases_</a></td></tr>
<tr class="memdesc:ae88ce69e6e7fcb15b8db68d5530f6a1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Biases applied to atoms each timestep. <br /></td></tr>
<tr class="separator:ae88ce69e6e7fcb15b8db68d5530f6a1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f9514efb13e9a86b4557ae081274ce1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9f9514efb13e9a86b4557ae081274ce1"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">dim_</a></td></tr>
<tr class="memdesc:a9f9514efb13e9a86b4557ae081274ce1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of CVs in system. <br /></td></tr>
<tr class="separator:a9f9514efb13e9a86b4557ae081274ce1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a528906f35295ab1a4bf7ed638fbd1973"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a528906f35295ab1a4bf7ed638fbd1973"></a>
std::ofstream&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a528906f35295ab1a4bf7ed638fbd1973">worldout_</a></td></tr>
<tr class="memdesc:a528906f35295ab1a4bf7ed638fbd1973"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output stream for F/N world data. <br /></td></tr>
<tr class="separator:a528906f35295ab1a4bf7ed638fbd1973"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86e220cdd655537e95b97b97384b506a"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a86e220cdd655537e95b97b97384b506a">filename_</a></td></tr>
<tr class="separator:a86e220cdd655537e95b97b97384b506a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51e4b0b53add40a74dc4152b402092c6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a51e4b0b53add40a74dc4152b402092c6"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a51e4b0b53add40a74dc4152b402092c6">Nworld_filename_</a></td></tr>
<tr class="memdesc:a51e4b0b53add40a74dc4152b402092c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Nworld print out filename, for restarts. <br /></td></tr>
<tr class="separator:a51e4b0b53add40a74dc4152b402092c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb8eed7ac7b199b96c277991f9ca58e1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afb8eed7ac7b199b96c277991f9ca58e1"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#afb8eed7ac7b199b96c277991f9ca58e1">Fworld_filename_</a></td></tr>
<tr class="memdesc:afb8eed7ac7b199b96c277991f9ca58e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fworld print out filename, for restarts. <br /></td></tr>
<tr class="separator:afb8eed7ac7b199b96c277991f9ca58e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a060acb9e57d66e702de14ff8a5d36ee6"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak" />
&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">histdetails_</a></td></tr>
<tr class="memdesc:a060acb9e57d66e702de14ff8a5d36ee6"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classSSAGES_1_1Histogram.html" title="Basic Histogram. ">Histogram</a> details.  <a href="#a060acb9e57d66e702de14ff8a5d36ee6">More...</a><br /></td></tr>
<tr class="separator:a060acb9e57d66e702de14ff8a5d36ee6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc2ac53b0342d31bce16cce64448830f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#acc2ac53b0342d31bce16cce64448830f">FBackupInterv_</a></td></tr>
<tr class="memdesc:acc2ac53b0342d31bce16cce64448830f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integer to hold F estimate backup information.  <a href="#acc2ac53b0342d31bce16cce64448830f">More...</a><br /></td></tr>
<tr class="separator:acc2ac53b0342d31bce16cce64448830f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a012104abf51fd7fe050a31fddc3c7180"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a012104abf51fd7fe050a31fddc3c7180">unitconv_</a></td></tr>
<tr class="memdesc:a012104abf51fd7fe050a31fddc3c7180"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unit Conversion Constant from W dot P to Force.  <a href="#a012104abf51fd7fe050a31fddc3c7180">More...</a><br /></td></tr>
<tr class="separator:a012104abf51fd7fe050a31fddc3c7180"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c0bbf27d10f6f773a7215f5df4f78c9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2c0bbf27d10f6f773a7215f5df4f78c9"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#a2c0bbf27d10f6f773a7215f5df4f78c9">timestep_</a></td></tr>
<tr class="memdesc:a2c0bbf27d10f6f773a7215f5df4f78c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timestep of integration. <br /></td></tr>
<tr class="separator:a2c0bbf27d10f6f773a7215f5df4f78c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac07e22498ef647ff94ad36d903a974be"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac07e22498ef647ff94ad36d903a974be"></a>
uint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#ac07e22498ef647ff94ad36d903a974be">iteration_</a></td></tr>
<tr class="memdesc:ac07e22498ef647ff94ad36d903a974be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Iteration counter. <br /></td></tr>
<tr class="separator:ac07e22498ef647ff94ad36d903a974be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4ad4bbc8a1796f32a93987c5879a695"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac4ad4bbc8a1796f32a93987c5879a695"></a>
Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1ABF.html#ac4ad4bbc8a1796f32a93987c5879a695">mass_</a></td></tr>
<tr class="memdesc:ac4ad4bbc8a1796f32a93987c5879a695"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mass vector. Empty unless required. <br /></td></tr>
<tr class="separator:ac4ad4bbc8a1796f32a93987c5879a695"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classSSAGES_1_1Method"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classSSAGES_1_1Method')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classSSAGES_1_1Method.html">SSAGES::Method</a></td></tr>
<tr class="memitem:a8471b11097a1018a9635bc578bf22f61 inherit pro_attribs_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8471b11097a1018a9635bc578bf22f61"></a>
mxx::comm&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">world_</a></td></tr>
<tr class="memdesc:a8471b11097a1018a9635bc578bf22f61 inherit pro_attribs_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global MPI communicator. <br /></td></tr>
<tr class="separator:a8471b11097a1018a9635bc578bf22f61 inherit pro_attribs_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1118666d61dbf3bc7606e3b61aa3a460 inherit pro_attribs_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1118666d61dbf3bc7606e3b61aa3a460"></a>
mxx::comm&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a1118666d61dbf3bc7606e3b61aa3a460">comm_</a></td></tr>
<tr class="memdesc:a1118666d61dbf3bc7606e3b61aa3a460 inherit pro_attribs_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local MPI communicator. <br /></td></tr>
<tr class="separator:a1118666d61dbf3bc7606e3b61aa3a460 inherit pro_attribs_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04e4b8b9ea8d154ae88f6cccf6c91700 inherit pro_attribs_classSSAGES_1_1Method"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a04e4b8b9ea8d154ae88f6cccf6c91700"></a>
std::vector&lt; uint &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSSAGES_1_1Method.html#a04e4b8b9ea8d154ae88f6cccf6c91700">cvmask_</a></td></tr>
<tr class="memdesc:a04e4b8b9ea8d154ae88f6cccf6c91700 inherit pro_attribs_classSSAGES_1_1Method"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mask which identifies which CVs to act on. <br /></td></tr>
<tr class="separator:a04e4b8b9ea8d154ae88f6cccf6c91700 inherit pro_attribs_classSSAGES_1_1Method"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Adaptive Biasing Force Algorithm. </p>
<p>Implementation of the Adaptive Biasing Force algorithm based on <a class="el" href="citelist.html#CITEREF_DARVE2008144120">[2]</a> </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00042">42</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a7071f09b2810b388ff6eabdc49fab005"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SSAGES::ABF::ABF </td>
          <td>(</td>
          <td class="paramtype">const MPI_Comm &amp;&#160;</td>
          <td class="paramname"><em>world</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MPI_Comm &amp;&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>Nworld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; * &gt;&#160;</td>
          <td class="paramname"><em>F</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt; double &gt; * &gt;&#160;</td>
          <td class="paramname"><em>Fworld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; double &gt;&gt;&#160;</td>
          <td class="paramname"><em>restraint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; bool &gt;&#160;</td>
          <td class="paramname"><em>isperiodic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; double &gt;&gt;&#160;</td>
          <td class="paramname"><em>periodicboundaries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>massweigh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>Nworld_filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>Fworld_filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>histdetails</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>FBackupInterv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>unitconv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>frequency</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">world</td><td>MPI global communicator. </td></tr>
    <tr><td class="paramname">comm</td><td>MPI local communicator. </td></tr>
    <tr><td class="paramname">N</td><td>Local CV histogram. </td></tr>
    <tr><td class="paramname">Nworld</td><td>Global CV histogram. </td></tr>
    <tr><td class="paramname">F</td><td>Vector of grids holding local raw generalized force totals per bin per CV. </td></tr>
    <tr><td class="paramname">Fworld</td><td>Vector of grids holding global raw generalized force totals per bin per CV. </td></tr>
    <tr><td class="paramname">restraint</td><td>Minimum, maximum and spring constant for CV restraints. </td></tr>
    <tr><td class="paramname">isperiodic</td><td>Vector of bools that holds whether each CV is periodic or not. </td></tr>
    <tr><td class="paramname">periodicboundaries</td><td>Periodic boundaries of each CV. </td></tr>
    <tr><td class="paramname">min</td><td>Minimum number of hist in a histogram bin before biasing is applied. </td></tr>
    <tr><td class="paramname">massweigh</td><td>Turn mass weighing on/off. </td></tr>
    <tr><td class="paramname">filename</td><td>Name for output file. </td></tr>
    <tr><td class="paramname">Nworld_filename</td><td>Name to read/write CV histogram. </td></tr>
    <tr><td class="paramname">Fworld_filename</td><td>Name to read/write raw generalized force histograms. </td></tr>
    <tr><td class="paramname">histdetails</td><td>Minimum, maximum and number of bins for each CV. </td></tr>
    <tr><td class="paramname">FBackupInterv</td><td>Set how often the adaptive force histograms are backed up. </td></tr>
    <tr><td class="paramname">unitconv</td><td>Unit conversion from d(momentum)/d(time) to force. </td></tr>
    <tr><td class="paramname">timestep</td><td>Simulation time step. </td></tr>
    <tr><td class="paramname">frequency</td><td>Frequency with which this method is invoked.</td></tr>
  </table>
  </dd>
</dl>
<p>Constructs an instance of Adaptive Biasing Force method. </p><dl class="section note"><dt>Note</dt><dd>The restraints should be outside of the range defined in histdetails_ by at least one bin size on each side. </dd></dl>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00216">216</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                    :</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <a class="code" href="classSSAGES_1_1Method.html#a05bb6ea0244814c1290c46bb3a059be9">Method</a>(frequency, world, comm), <a class="code" href="classSSAGES_1_1ABF.html#a45daad9b41bac9009f1c2f09da10f58e">N_</a>(N), <a class="code" href="classSSAGES_1_1ABF.html#ae2306049903c2ed6e6fb07eaee71e9ae">Nworld_</a>(Nworld), <a class="code" href="classSSAGES_1_1ABF.html#a47453516b73e968060821c57d67b44ff">F_</a>(F), <a class="code" href="classSSAGES_1_1ABF.html#a7df76c30aa32223fb74f3fbdb9202706">Fworld_</a>(Fworld),  <a class="code" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a>(restraint), <a class="code" href="classSSAGES_1_1ABF.html#aa575ad59d0bbaac2709de9c481d4db30">isperiodic_</a>(isperiodic), <a class="code" href="classSSAGES_1_1ABF.html#a85f39957134c0d27298aff5ad306cbd9">periodicboundaries_</a>(periodicboundaries),</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#a88322f13d3424be20d46cf68a3c8ce28">min_</a>(min), <a class="code" href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">wdotp1_</a>(), <a class="code" href="classSSAGES_1_1ABF.html#a1a0082f17ab10382191cbf39046e7052">wdotp2_</a>(), <a class="code" href="classSSAGES_1_1ABF.html#a0158dff5be22bf287e22aab2eadd4e25">Fold_</a>(), <a class="code" href="classSSAGES_1_1ABF.html#aa792d019aee0f614a2a0935405244e91">massweigh_</a>(massweigh),</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#ae88ce69e6e7fcb15b8db68d5530f6a1e">biases_</a>(), <a class="code" href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">dim_</a>(0), <a class="code" href="classSSAGES_1_1ABF.html#a86e220cdd655537e95b97b97384b506a">filename_</a>(filename), <a class="code" href="classSSAGES_1_1ABF.html#a51e4b0b53add40a74dc4152b402092c6">Nworld_filename_</a>(Nworld_filename), <a class="code" href="classSSAGES_1_1ABF.html#afb8eed7ac7b199b96c277991f9ca58e1">Fworld_filename_</a>(Fworld_filename),</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">histdetails_</a>(histdetails), </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#acc2ac53b0342d31bce16cce64448830f">FBackupInterv_</a>(FBackupInterv), <a class="code" href="classSSAGES_1_1ABF.html#a012104abf51fd7fe050a31fddc3c7180">unitconv_</a>(unitconv), <a class="code" href="classSSAGES_1_1ABF.html#a2c0bbf27d10f6f773a7215f5df4f78c9">timestep_</a>(timestep),</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#ac07e22498ef647ff94ad36d903a974be">iteration_</a>(0)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        }</div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a86e220cdd655537e95b97b97384b506a"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a86e220cdd655537e95b97b97384b506a">SSAGES::ABF::filename_</a></div><div class="ttdeci">std::string filename_</div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00126">ABF.h:126</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a45daad9b41bac9009f1c2f09da10f58e"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a45daad9b41bac9009f1c2f09da10f58e">SSAGES::ABF::N_</a></div><div class="ttdeci">Grid&lt; int &gt; * N_</div><div class="ttdoc">To store number of local hits at a given CV bin. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00066">ABF.h:66</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_afb8eed7ac7b199b96c277991f9ca58e1"><div class="ttname"><a href="classSSAGES_1_1ABF.html#afb8eed7ac7b199b96c277991f9ca58e1">SSAGES::ABF::Fworld_filename_</a></div><div class="ttdeci">std::string Fworld_filename_</div><div class="ttdoc">Fworld print out filename, for restarts. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00132">ABF.h:132</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a012104abf51fd7fe050a31fddc3c7180"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a012104abf51fd7fe050a31fddc3c7180">SSAGES::ABF::unitconv_</a></div><div class="ttdeci">double unitconv_</div><div class="ttdoc">Unit Conversion Constant from W dot P to Force. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00158">ABF.h:158</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a060acb9e57d66e702de14ff8a5d36ee6"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a060acb9e57d66e702de14ff8a5d36ee6">SSAGES::ABF::histdetails_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; histdetails_</div><div class="ttdoc">Histogram details. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00143">ABF.h:143</a></div></div>
<div class="ttc" id="classSSAGES_1_1Method_html_a05bb6ea0244814c1290c46bb3a059be9"><div class="ttname"><a href="classSSAGES_1_1Method.html#a05bb6ea0244814c1290c46bb3a059be9">SSAGES::Method::Method</a></div><div class="ttdeci">Method(uint frequency, const MPI_Comm &amp;world, const MPI_Comm &amp;comm)</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00061">Method.h:61</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a47453516b73e968060821c57d67b44ff"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a47453516b73e968060821c57d67b44ff">SSAGES::ABF::F_</a></div><div class="ttdeci">std::vector&lt; Grid&lt; double &gt; * &gt; F_</div><div class="ttdoc">To store running total of the local walker. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00051">ABF.h:51</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_aa792d019aee0f614a2a0935405244e91"><div class="ttname"><a href="classSSAGES_1_1ABF.html#aa792d019aee0f614a2a0935405244e91">SSAGES::ABF::massweigh_</a></div><div class="ttdeci">bool massweigh_</div><div class="ttdoc">Mass weighing of bias enabled/disabled. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00113">ABF.h:113</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a0158dff5be22bf287e22aab2eadd4e25"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a0158dff5be22bf287e22aab2eadd4e25">SSAGES::ABF::Fold_</a></div><div class="ttdeci">Eigen::VectorXd Fold_</div><div class="ttdoc">To hold last iterations F_ value for removing bias. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00110">ABF.h:110</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_aa575ad59d0bbaac2709de9c481d4db30"><div class="ttname"><a href="classSSAGES_1_1ABF.html#aa575ad59d0bbaac2709de9c481d4db30">SSAGES::ABF::isperiodic_</a></div><div class="ttdeci">std::vector&lt; bool &gt; isperiodic_</div><div class="ttdoc">For each CV, holds whether that CV has periodic boundaries or not. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00087">ABF.h:87</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ae88ce69e6e7fcb15b8db68d5530f6a1e"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ae88ce69e6e7fcb15b8db68d5530f6a1e">SSAGES::ABF::biases_</a></div><div class="ttdeci">std::vector&lt; Vector3 &gt; biases_</div><div class="ttdoc">Biases applied to atoms each timestep. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00116">ABF.h:116</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a7e2b1995149d50d1b1e9d05e6a44c1b6"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">SSAGES::ABF::restraint_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; restraint_</div><div class="ttdoc">Information for a harmonic restraint to keep CV in the region of interest. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00084">ABF.h:84</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a51e4b0b53add40a74dc4152b402092c6"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a51e4b0b53add40a74dc4152b402092c6">SSAGES::ABF::Nworld_filename_</a></div><div class="ttdeci">std::string Nworld_filename_</div><div class="ttdoc">Nworld print out filename, for restarts. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00129">ABF.h:129</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a9f9514efb13e9a86b4557ae081274ce1"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">SSAGES::ABF::dim_</a></div><div class="ttdeci">unsigned int dim_</div><div class="ttdoc">Number of CVs in system. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00119">ABF.h:119</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a7df76c30aa32223fb74f3fbdb9202706"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a7df76c30aa32223fb74f3fbdb9202706">SSAGES::ABF::Fworld_</a></div><div class="ttdeci">std::vector&lt; Grid&lt; double &gt; * &gt; Fworld_</div><div class="ttdoc">Will hold the global total, synced across walkers at every time step. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00059">ABF.h:59</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a88322f13d3424be20d46cf68a3c8ce28"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a88322f13d3424be20d46cf68a3c8ce28">SSAGES::ABF::min_</a></div><div class="ttdeci">int min_</div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00101">ABF.h:101</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_acc2ac53b0342d31bce16cce64448830f"><div class="ttname"><a href="classSSAGES_1_1ABF.html#acc2ac53b0342d31bce16cce64448830f">SSAGES::ABF::FBackupInterv_</a></div><div class="ttdeci">int FBackupInterv_</div><div class="ttdoc">Integer to hold F estimate backup information. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00149">ABF.h:149</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ae2306049903c2ed6e6fb07eaee71e9ae"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ae2306049903c2ed6e6fb07eaee71e9ae">SSAGES::ABF::Nworld_</a></div><div class="ttdeci">Grid&lt; int &gt; * Nworld_</div><div class="ttdoc">To store number of global hits at a given CV bin. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00073">ABF.h:73</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a1a0082f17ab10382191cbf39046e7052"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a1a0082f17ab10382191cbf39046e7052">SSAGES::ABF::wdotp2_</a></div><div class="ttdeci">Eigen::VectorXd wdotp2_</div><div class="ttdoc">To hold second to last iteration wdotp value for numerical derivative. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00107">ABF.h:107</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a2c0bbf27d10f6f773a7215f5df4f78c9"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a2c0bbf27d10f6f773a7215f5df4f78c9">SSAGES::ABF::timestep_</a></div><div class="ttdeci">double timestep_</div><div class="ttdoc">Timestep of integration. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00172">ABF.h:172</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ac07e22498ef647ff94ad36d903a974be"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ac07e22498ef647ff94ad36d903a974be">SSAGES::ABF::iteration_</a></div><div class="ttdeci">uint iteration_</div><div class="ttdoc">Iteration counter. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00175">ABF.h:175</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a85f39957134c0d27298aff5ad306cbd9"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a85f39957134c0d27298aff5ad306cbd9">SSAGES::ABF::periodicboundaries_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; periodicboundaries_</div><div class="ttdoc">Holds periodic boundaries of CVs. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00097">ABF.h:97</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a7c882e37a3676cb3e33776621929c3b7"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">SSAGES::ABF::wdotp1_</a></div><div class="ttdeci">Eigen::VectorXd wdotp1_</div><div class="ttdoc">To hold last iteration wdotp value for numerical derivative. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00104">ABF.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ae223e09cc686522073fd881088edb8ac"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SSAGES::ABF::boundsCheck </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>CVs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks whether the local walker is within CV bounds. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CVs</td><td>Current values of CVs. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether the walker is in bounds or not. </dd></dl>

<p>Definition at line <a class="el" href="ABF_8cpp_source.html#l00298">298</a> of file <a class="el" href="ABF_8cpp_source.html">ABF.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">dim_</a> ; ++i)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">if</span>((CVs[i] &lt; <a class="code" href="classSSAGES_1_1ABF.html#a45daad9b41bac9009f1c2f09da10f58e">N_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a1d73d329cfc609d30a9c0bd7e844467c">GetLower</a>(i)) || (CVs[i] &gt; <a class="code" href="classSSAGES_1_1ABF.html#a45daad9b41bac9009f1c2f09da10f58e">N_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a1c0410f0b34b5eb00112ca11c7a912ed">GetUpper</a>(i)))</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    }</div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a45daad9b41bac9009f1c2f09da10f58e"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a45daad9b41bac9009f1c2f09da10f58e">SSAGES::ABF::N_</a></div><div class="ttdeci">Grid&lt; int &gt; * N_</div><div class="ttdoc">To store number of local hits at a given CV bin. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00066">ABF.h:66</a></div></div>
<div class="ttc" id="classSSAGES_1_1GridBase_html_a1d73d329cfc609d30a9c0bd7e844467c"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#a1d73d329cfc609d30a9c0bd7e844467c">SSAGES::GridBase::GetLower</a></div><div class="ttdeci">const std::vector&lt; double &gt; &amp; GetLower() const </div><div class="ttdoc">Return the lower edges of the Grid. </div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00164">GridBase.h:164</a></div></div>
<div class="ttc" id="classSSAGES_1_1GridBase_html_a1c0410f0b34b5eb00112ca11c7a912ed"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#a1c0410f0b34b5eb00112ca11c7a912ed">SSAGES::GridBase::GetUpper</a></div><div class="ttdeci">const std::vector&lt; double &gt; &amp; GetUpper() const </div><div class="ttdoc">Return the upper edges of the Grid. </div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00190">GridBase.h:190</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a9f9514efb13e9a86b4557ae081274ce1"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">SSAGES::ABF::dim_</a></div><div class="ttdeci">unsigned int dim_</div><div class="ttdoc">Number of CVs in system. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00119">ABF.h:119</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa131b026ddb40941889c8bde7840ac6a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSSAGES_1_1ABF.html">ABF</a> * SSAGES::ABF::Build </td>
          <td>(</td>
          <td class="paramtype">const Json::Value &amp;&#160;</td>
          <td class="paramname"><em>json</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MPI_Comm &amp;&#160;</td>
          <td class="paramname"><em>world</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MPI_Comm &amp;&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p></p>

<p>Definition at line <a class="el" href="ABF_8cpp_source.html#l00311">311</a> of file <a class="el" href="ABF_8cpp_source.html">ABF.cpp</a>.</p>

<p>References <a class="el" href="Requirement_8h_source.html#l00092">Json::Requirement::GetErrors()</a>, <a class="el" href="Requirement_8h_source.html#l00086">Json::Requirement::HasErrors()</a>, <a class="el" href="Grid_8h_source.html#l00626">SSAGES::Grid&lt; T &gt;::LoadFromFile()</a>, <a class="el" href="ObjectRequirement_8h_source.html#l00142">Json::ObjectRequirement::Parse()</a>, and <a class="el" href="ObjectRequirement_8h_source.html#l00239">Json::ObjectRequirement::Validate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <a class="code" href="classJson_1_1ObjectRequirement.html">ObjectRequirement</a> validator;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        Value schema;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        Reader reader;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        reader.parse(JsonSchema::ABFMethod, schema);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        validator.<a class="code" href="classJson_1_1ObjectRequirement.html#a4ed02ae1d612a5efba1688fcdd2df092">Parse</a>(schema, path);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="comment">// Validate inputs.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        validator.<a class="code" href="classJson_1_1ObjectRequirement.html#a9ac3b920001a35bc70580035d8d802b7">Validate</a>(json, path);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">if</span>(validator.<a class="code" href="classJson_1_1Requirement.html#adfaec336a9f051d6f6b9a6d7f1d97b75">HasErrors</a>())</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keywordflow">throw</span> BuildException(validator.<a class="code" href="classJson_1_1Requirement.html#a60bc275c366eb59f192fa2e621268480">GetErrors</a>());</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        uint wid = mxx::comm(world).rank()/mxx::comm(comm).size(); </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="comment">//bool multiwalkerinput = false;</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="comment">// Obtain lower bound for each CV.</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        std::vector&lt;double&gt; minsCV;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; mins : json[<span class="stringliteral">&quot;CV_lower_bounds&quot;</span>])</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keywordflow">if</span>(mins.isArray())</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                <span class="keywordflow">throw</span> BuildException({<span class="stringliteral">&quot;Separate inputs for multi-walker not fully implemented. Please use global entries for CV ranges&quot;</span>});</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                <span class="comment">//multiwalkerinput = true;</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                <span class="comment">//for(auto&amp; bound : mins)</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                <span class="comment">//  minsCV.push_back(bound.asDouble());</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                minsCV.push_back(mins.asDouble());</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="comment">// Obtain upper bound for each CV.</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        std::vector&lt;double&gt; maxsCV;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; maxs : json[<span class="stringliteral">&quot;CV_upper_bounds&quot;</span>])</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <span class="comment">/*if(maxs.isArray())</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">                {</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">                for(auto&amp; bound : maxs)</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">                    maxsCV.push_back(bound.asDouble());</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">                }*/</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="comment">//else</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                maxsCV.push_back(maxs.asDouble());</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="comment">// Obtain number of bins for each CV dimension.</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        std::vector&lt;int&gt; binsCV;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; bins : json[<span class="stringliteral">&quot;CV_bins&quot;</span>])</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            binsCV.push_back(bins.asInt());</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment">// Obtain lower bounds for restraints for each CV.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        std::vector&lt;double&gt; minsrestCV;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; mins : json[<span class="stringliteral">&quot;CV_restraint_minimums&quot;</span>])</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="comment">/*if(mins.isArray())</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">                {</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">                for(auto&amp; bound : mins)</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">                    minsrestCV.push_back(bound.asDouble());</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">                }*/</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="comment">//else</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                minsrestCV.push_back(mins.asDouble());</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="comment">// Obtain upper bounds for restraints for each CV.      </span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        std::vector&lt;double&gt; maxsrestCV;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; maxs : json[<span class="stringliteral">&quot;CV_restraint_maximums&quot;</span>])</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <span class="comment">/*if(maxs.isArray())</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">                {</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">                for(auto&amp; bound : maxs)</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">                    maxsrestCV.push_back(bound.asDouble());</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">                }*/</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="comment">//else</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                maxsrestCV.push_back(maxs.asDouble());</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="comment">// Obtain harmonic spring constant for restraints for each CV.</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        std::vector&lt;double&gt; springkrestCV;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; bins : json[<span class="stringliteral">&quot;CV_restraint_spring_constants&quot;</span>])</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            springkrestCV.push_back(bins.asDouble());</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="comment">// Obtain periodicity information for restraints for each CV for the purpose of correctly applying restraints through periodic boundaries.</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        std::vector&lt;bool&gt; isperiodic;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; isperCV : json[<span class="stringliteral">&quot;CV_isperiodic&quot;</span>])</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            isperiodic.push_back(isperCV.asBool());</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="comment">// Obtain lower periodic boundary for each CV.</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        std::vector&lt;double&gt; minperboundaryCV;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; minsperCV : json[<span class="stringliteral">&quot;CV_periodic_boundary_lower_bounds&quot;</span>])</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            minperboundaryCV.push_back(minsperCV.asDouble());</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="comment">// Obtain upper periodic boundary for each CV.</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        std::vector&lt;double&gt; maxperboundaryCV;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; maxsperCV : json[<span class="stringliteral">&quot;CV_periodic_boundary_upper_bounds&quot;</span>])</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            maxperboundaryCV.push_back(maxsperCV.asDouble());</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="comment">// Verify inputs are all correct lengths.</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keywordflow">if</span>(!((   minsCV.size() == maxsCV.size() &amp;&amp; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;             maxsCV.size() == minsrestCV.size() &amp;&amp;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;             minsrestCV.size() == maxsrestCV.size()) &amp;&amp;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            (binsCV.size() == springkrestCV.size() &amp;&amp;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;             springkrestCV.size() == isperiodic.size())))       </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="keywordflow">throw</span> BuildException({<span class="stringliteral">&quot;CV lower bounds, upper bounds, restrain minimums, restrains maximums must match in size. Bins, spring constants and periodicity info must match in size.&quot;</span>});</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="comment">// Verify that all periodicity information is provided if CVs are periodic.</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordtype">bool</span> anyperiodic=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i&lt;isperiodic.size(); ++i)</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="keywordflow">if</span>(isperiodic[i])</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                anyperiodic = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                <span class="keywordflow">if</span>(!(isperiodic.size() == minperboundaryCV.size() &amp;&amp;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                     minperboundaryCV.size() == maxperboundaryCV.size()))</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                    <span class="keywordflow">throw</span> BuildException({<span class="stringliteral">&quot;If any CV is defined as periodic, please define the full upper and lower bound vectors. They should both have the same number of entries as CV lower bounds, upper bounds... Entries corresponding to non-periodic CVs will not be used.&quot;</span>});</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keywordtype">int</span> dim = binsCV.size();</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="comment">// Read in JSON info.</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keyword">auto</span> FBackupInterv = json.get(<span class="stringliteral">&quot;output_frequency&quot;</span>, 1000).asInt();</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keyword">auto</span> unitconv = json.get(<span class="stringliteral">&quot;unit_conversion&quot;</span>, 0).asDouble();</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keyword">auto</span> timestep = json.get(<span class="stringliteral">&quot;timestep&quot;</span>, 2).asDouble();</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keyword">auto</span> min = json.get(<span class="stringliteral">&quot;minimum_count&quot;</span>, 200).asDouble();</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keyword">auto</span> massweigh = json.get(<span class="stringliteral">&quot;mass_weighing&quot;</span>,<span class="keyword">false</span>).asBool();          </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        std::vector&lt;std::vector&lt;double&gt;&gt; histdetails;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        std::vector&lt;std::vector&lt;double&gt;&gt; restraint;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        std::vector&lt;std::vector&lt;double&gt;&gt; periodicboundaries;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        std::vector&lt;double&gt; temp1(3);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        std::vector&lt;double&gt; temp2(3);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        std::vector&lt;double&gt; temp3(2);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keyword">auto</span> freq = json.get(<span class="stringliteral">&quot;frequency&quot;</span>, 1).asInt();</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keyword">auto</span> filename = json.get(<span class="stringliteral">&quot;output_file&quot;</span>, <span class="stringliteral">&quot;F_out&quot;</span>).asString();</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keyword">auto</span> Nworld_filename = json.get(<span class="stringliteral">&quot;Nworld_output_file&quot;</span>, <span class="stringliteral">&quot;Nworld&quot;</span>).asString();</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keyword">auto</span> Fworld_filename = json.get(<span class="stringliteral">&quot;Fworld_output_file&quot;</span>, <span class="stringliteral">&quot;Fworld_cv&quot;</span>).asString();</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="comment">// Generate the grids based on JSON.</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        Grid&lt;int&gt; *N;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        Grid&lt;int&gt; *Nworld;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        std::vector&lt;Grid&lt;double&gt;*&gt; F(dim);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        std::vector&lt;Grid&lt;double&gt;*&gt; Fworld(dim);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="comment">// This feature is disabled for now.</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="comment">/*if(multiwalkerinput)</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">        {</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">            for(size_t i=0; i&lt;dim; ++i)</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">            {</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">                temp1 = {minsCV[i+wid*dim], maxsCV[i+wid*dim], binsCV[i]};</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">                temp2 = {minsrestCV[i+wid*dim], maxsrestCV[i+wid*dim], springkrestCV[i]};</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">                histdetails.push_back(temp1);</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">                restraint.push_back(temp2);</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">                if(anyperiodic)</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">                {</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">                    temp3 = {minperboundaryCV[i], maxperboundaryCV[i]};</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">                    periodicboundaries.push_back(temp3);</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">                }</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">            for(size_t i=0; i&lt;dim; ++i)</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">            {</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">                minsCVperwalker[i] = histdetails[i][0];</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">                maxsCVperwalker[i] = histdetails[i][1];</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">            N= new Grid&lt;int&gt;(binsCV, minsCVperwalker, maxsCVperwalker, isperiodic);</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">            Nworld= new Grid&lt;int&gt;(binsCV, minsCVperwalker, maxsCVperwalker, isperiodic);</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">            </span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">            for(auto&amp; grid : F)</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">            {</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">                grid= new Grid&lt;double&gt;(binsCV, minsCVperwalker, maxsCVperwalker, isperiodic);</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">            for(auto&amp; grid : Fworld)</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">            {</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">                grid= new Grid&lt;double&gt;(binsCV, minsCVperwalker, maxsCVperwalker, isperiodic);</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">            </span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="comment">//else</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="comment">//{</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="comment">// Appropriately size the grids.</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i&lt;dim; ++i) </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            N= <span class="keyword">new</span> Grid&lt;int&gt;(binsCV, minsCV, maxsCV, isperiodic);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            Nworld= <span class="keyword">new</span> Grid&lt;int&gt;(binsCV, minsCV, maxsCV, isperiodic);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; grid : F)</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                grid= <span class="keyword">new</span> Grid&lt;double&gt;(binsCV, minsCV, maxsCV, isperiodic);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; grid : Fworld)</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                grid= <span class="keyword">new</span> Grid&lt;double&gt;(binsCV, minsCV, maxsCV, isperiodic);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i&lt;dim; ++i)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                temp1 = {minsCV[i], maxsCV[i], binsCV[i]};</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                temp2 = {minsrestCV[i], maxsrestCV[i], springkrestCV[i]};</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                histdetails.push_back(temp1);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                restraint.push_back(temp2);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                <span class="keywordflow">if</span>(anyperiodic)</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                    temp3 = {minperboundaryCV[i], maxperboundaryCV[i]};</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                    periodicboundaries.push_back(temp3);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="comment">//}</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="comment">// Check if previously saved grids exist. If so, check that data match and load grids.</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">if</span>(std::ifstream(Nworld_filename) &amp;&amp; std::ifstream(Fworld_filename+std::to_string(0)) &amp;&amp; wid == 0)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Attempting to load data from a previous run of ABF.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            N-&gt;LoadFromFile(Nworld_filename);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i&lt;dim; ++i)</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                <span class="keywordflow">if</span>(std::ifstream(Fworld_filename+std::to_string(i)))</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                    F[i]-&gt;LoadFromFile(Fworld_filename+std::to_string(i));</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                    <span class="keywordflow">throw</span> BuildException({<span class="stringliteral">&quot;Some, but not all Fworld outputs were found. Please check that these are appropriate inputs, or clean the working directory of other Fworld and Nworld inputs.&quot;</span>});</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;     </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keyword">auto</span>* m = <span class="keyword">new</span> <a class="code" href="classSSAGES_1_1ABF.html#a7071f09b2810b388ff6eabdc49fab005">ABF</a>(world, comm, N, Nworld, F, Fworld, restraint, isperiodic, periodicboundaries, min, massweigh, filename, Nworld_filename, Fworld_filename, histdetails, FBackupInterv, unitconv, timestep, freq);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordflow">if</span>(json.isMember(<span class="stringliteral">&quot;iteration&quot;</span>))</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            m-&gt;SetIteration(json.get(<span class="stringliteral">&quot;iteration&quot;</span>,0).asInt());</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keywordflow">return</span> m;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    }</div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a7071f09b2810b388ff6eabdc49fab005"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a7071f09b2810b388ff6eabdc49fab005">SSAGES::ABF::ABF</a></div><div class="ttdeci">ABF(const MPI_Comm &amp;world, const MPI_Comm &amp;comm, Grid&lt; int &gt; *N, Grid&lt; int &gt; *Nworld, std::vector&lt; Grid&lt; double &gt; * &gt; F, std::vector&lt; Grid&lt; double &gt; * &gt; Fworld, std::vector&lt; std::vector&lt; double &gt;&gt; restraint, std::vector&lt; bool &gt; isperiodic, std::vector&lt; std::vector&lt; double &gt;&gt; periodicboundaries, double min, bool massweigh, std::string filename, std::string Nworld_filename, std::string Fworld_filename, const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;histdetails, int FBackupInterv, double unitconv, double timestep, unsigned int frequency)</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00216">ABF.h:216</a></div></div>
<div class="ttc" id="classJson_1_1Requirement_html_adfaec336a9f051d6f6b9a6d7f1d97b75"><div class="ttname"><a href="classJson_1_1Requirement.html#adfaec336a9f051d6f6b9a6d7f1d97b75">Json::Requirement::HasErrors</a></div><div class="ttdeci">bool HasErrors()</div><div class="ttdoc">Check if errors have occured. </div><div class="ttdef"><b>Definition:</b> <a href="Requirement_8h_source.html#l00086">Requirement.h:86</a></div></div>
<div class="ttc" id="classJson_1_1ObjectRequirement_html_a4ed02ae1d612a5efba1688fcdd2df092"><div class="ttname"><a href="classJson_1_1ObjectRequirement.html#a4ed02ae1d612a5efba1688fcdd2df092">Json::ObjectRequirement::Parse</a></div><div class="ttdeci">virtual void Parse(Value json, const std::string &amp;path) override</div><div class="ttdoc">Parse JSON value to generate Requirement(s). </div><div class="ttdef"><b>Definition:</b> <a href="ObjectRequirement_8h_source.html#l00142">ObjectRequirement.h:142</a></div></div>
<div class="ttc" id="classJson_1_1Requirement_html_a60bc275c366eb59f192fa2e621268480"><div class="ttname"><a href="classJson_1_1Requirement.html#a60bc275c366eb59f192fa2e621268480">Json::Requirement::GetErrors</a></div><div class="ttdeci">std::vector&lt; std::string &gt; GetErrors()</div><div class="ttdoc">Get list of error messages. </div><div class="ttdef"><b>Definition:</b> <a href="Requirement_8h_source.html#l00092">Requirement.h:92</a></div></div>
<div class="ttc" id="classJson_1_1ObjectRequirement_html"><div class="ttname"><a href="classJson_1_1ObjectRequirement.html">Json::ObjectRequirement</a></div><div class="ttdoc">Requirements on an object. </div><div class="ttdef"><b>Definition:</b> <a href="ObjectRequirement_8h_source.html#l00046">ObjectRequirement.h:46</a></div></div>
<div class="ttc" id="classJson_1_1ObjectRequirement_html_a9ac3b920001a35bc70580035d8d802b7"><div class="ttname"><a href="classJson_1_1ObjectRequirement.html#a9ac3b920001a35bc70580035d8d802b7">Json::ObjectRequirement::Validate</a></div><div class="ttdeci">virtual void Validate(const Value &amp;json, const std::string &amp;path) override</div><div class="ttdoc">Validate JSON value. </div><div class="ttdef"><b>Definition:</b> <a href="ObjectRequirement_8h_source.html#l00239">ObjectRequirement.h:239</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1ABF_aa131b026ddb40941889c8bde7840ac6a_cgraph.png" border="0" usemap="#classSSAGES_1_1ABF_aa131b026ddb40941889c8bde7840ac6a_cgraph" alt=""/></div>
<map name="classSSAGES_1_1ABF_aa131b026ddb40941889c8bde7840ac6a_cgraph" id="classSSAGES_1_1ABF_aa131b026ddb40941889c8bde7840ac6a_cgraph">
<area shape="rect" id="node2" href="classJson_1_1Requirement.html#a60bc275c366eb59f192fa2e621268480" title="Get list of error messages. " alt="" coords="463,5,603,46"/><area shape="rect" id="node3" href="classJson_1_1Requirement.html#adfaec336a9f051d6f6b9a6d7f1d97b75" title="Check if errors have occured. " alt="" coords="463,70,603,111"/><area shape="rect" id="node4" href="classSSAGES_1_1Grid.html#a279c1e9005fdf4c6fc23358d51b75b86" title="Builds a grid from file. " alt="" coords="203,255,399,281"/><area shape="rect" id="node5" href="classJson_1_1ObjectRequirement.html#a4ed02ae1d612a5efba1688fcdd2df092" title="Parse JSON value to generate Requirement(s). " alt="" coords="216,494,387,535"/><area shape="rect" id="node13" href="classJson_1_1ObjectRequirement.html#a9ac3b920001a35bc70580035d8d802b7" title="Validate JSON value. " alt="" coords="216,189,387,230"/><area shape="rect" id="node6" href="classJson_1_1RequirementLoader.html#a82857d029b7ebfeb315f5b1b32401291" title="Extended Requirement loader. " alt="" coords="448,462,619,503"/><area shape="rect" id="node7" href="classJson_1_1RequirementLoader.html#aeb1344919deda4bd8b8aa8a00cb50390" title="Load specific requirement. " alt="" coords="448,527,619,569"/><area shape="rect" id="node8" href="classJson_1_1ObjectRequirement.html#a4f2e76636df4f7b153aaac02a1b05e4f" title="Reset Requirement. " alt="" coords="448,593,619,634"/><area shape="rect" id="node9" href="classJson_1_1ObjectRequirement.html#aa8181c37cbe67db098bc2b82cdea71ef" title="Clear errors on all Requirements. " alt="" coords="667,559,837,601"/><area shape="rect" id="node11" href="classJson_1_1ObjectRequirement.html#a4fc797684496f4f0381d1388877c133d" title="Clear notices on all Requirements. " alt="" coords="667,625,837,666"/><area shape="rect" id="node10" href="classJson_1_1Requirement.html#ace71ebbbcc885f0c4c391a3807c80f33" title="Clear list of error messages. " alt="" coords="886,559,1026,601"/><area shape="rect" id="node12" href="classJson_1_1Requirement.html#a8a8a4020e4955be56dcacf4727ae5bc3" title="Clear list of notice messages. " alt="" coords="886,625,1026,666"/><area shape="rect" id="node14" href="classJson_1_1Requirement.html#a46a0056414100386541cd1cb899e0030" title="Get list of notices. " alt="" coords="463,135,603,177"/><area shape="rect" id="node15" href="classJson_1_1Requirement.html#ad407cff3cc37295c3b2a7ebe31798548" title="Check if notices have been queued. " alt="" coords="463,201,603,242"/><area shape="rect" id="node16" href="classJson_1_1Requirement.html#adeb9efa6cf271d9cea0599ff2d458a08" title="Add error to list of error messages. " alt="" coords="463,266,603,307"/><area shape="rect" id="node17" href="classJson_1_1Requirement.html#a00feadb29fa33f4f2cca7362f12aaed4" title="Add message to list of notices. " alt="" coords="463,331,603,373"/><area shape="rect" id="node18" href="classJson_1_1Requirement.html#aa97494b642414d00482745a0d5b2c2c3" title="Validate that JSON value meets requirements. " alt="" coords="463,397,603,438"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa2200677359f582d73f095c42ec5ad83"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ABF::CalcBiasForce </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *&#160;</td>
          <td class="paramname"><em>snapshot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceSSAGES.html#acddea47426ac0a643b048f870ddd2907">CVList</a> &amp;&#160;</td>
          <td class="paramname"><em>cvs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>cvVals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the bias force. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">snapshot</td><td>Current simulation snapshot. </td></tr>
    <tr><td class="paramname">cvs</td><td>Details of CVs. </td></tr>
    <tr><td class="paramname">cvVals</td><td>Current values of CVs. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ABF_8cpp_source.html#l00179">179</a> of file <a class="el" href="ABF_8cpp_source.html">ABF.cpp</a>.</p>

<p>References <a class="el" href="Snapshot_8h_source.html#l00200">SSAGES::Snapshot::GetNumAtoms()</a>.</p>
<div class="fragment"><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="comment">// Reset the bias.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#ae88ce69e6e7fcb15b8db68d5530f6a1e">biases_</a>.resize(snapshot-&gt;GetNumAtoms(), <a class="code" href="namespaceSSAGES.html#a630084a0a5e185e89e21b3735f8f8b2e">Vector3</a>{0,0,0});</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; b : <a class="code" href="classSSAGES_1_1ABF.html#ae88ce69e6e7fcb15b8db68d5530f6a1e">biases_</a>)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            b.setZero();</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="comment">// Compute bias if within bounds.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1ABF.html#ae223e09cc686522073fd881088edb8ac">boundsCheck</a>(cvVals))</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">dim_</a>; ++i)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <span class="keyword">auto</span>&amp; grad = cvs[i]-&gt;GetGradient();</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> j = 0; j &lt; biases_.size(); ++j)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    biases_[j] -= (<a class="code" href="classSSAGES_1_1ABF.html#a7df76c30aa32223fb74f3fbdb9202706">Fworld_</a>[i]-&gt;at(cvVals))*grad[j]/std::max(<a class="code" href="classSSAGES_1_1ABF.html#a88322f13d3424be20d46cf68a3c8ce28">min_</a>,<a class="code" href="classSSAGES_1_1ABF.html#ae2306049903c2ed6e6fb07eaee71e9ae">Nworld_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a896d88442ef110a3afb58944e5107b53">at</a>(cvVals));</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="comment">// Otherwise, apply harmonic restraint if enabled.</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">dim_</a>; ++i)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                <span class="keywordtype">double</span> cvVal = cvs[i]-&gt;GetValue();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                <span class="keyword">auto</span> k = 0.;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                <span class="keyword">auto</span> x0 = 0.;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1ABF.html#aa575ad59d0bbaac2709de9c481d4db30">isperiodic_</a>[i])</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                    <span class="keywordtype">double</span> periodsize = <a class="code" href="classSSAGES_1_1ABF.html#a85f39957134c0d27298aff5ad306cbd9">periodicboundaries_</a>[i][1]-<a class="code" href="classSSAGES_1_1ABF.html#a85f39957134c0d27298aff5ad306cbd9">periodicboundaries_</a>[i][0];</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                    <span class="keywordtype">double</span> cvRestrMidpoint = (<a class="code" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a>[i][1]+<a class="code" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a>[i][0])/2;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                    <span class="keywordflow">while</span>((cvVal-cvRestrMidpoint) &gt; periodsize/2)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                        cvVal -= periodsize;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                    <span class="keywordflow">while</span>((cvVal-cvRestrMidpoint) &lt; -periodsize/2)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                        cvVal += periodsize;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="keywordflow">if</span>(cvVal &lt; <a class="code" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a>[i][0] &amp;&amp; <a class="code" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a>[i][2] &gt; 0)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                    k = <a class="code" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a>[i][2];</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                    x0 = <a class="code" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a>[i][0];</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cvVal &gt; <a class="code" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a>[i][1] &amp;&amp; <a class="code" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a>[i][2] &gt; 0)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    k = <a class="code" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a>[i][2];</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                    x0 = <a class="code" href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">restraint_</a>[i][1];</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                <span class="keyword">auto</span>&amp; grad = cvs[i]-&gt;GetGradient();</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> j = 0; j &lt; biases_.size(); ++j)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                    biases_[j] -= (cvVal - x0)*k*grad[j];</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            }   </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    }</div>
<div class="ttc" id="classSSAGES_1_1ABF_html_aa575ad59d0bbaac2709de9c481d4db30"><div class="ttname"><a href="classSSAGES_1_1ABF.html#aa575ad59d0bbaac2709de9c481d4db30">SSAGES::ABF::isperiodic_</a></div><div class="ttdeci">std::vector&lt; bool &gt; isperiodic_</div><div class="ttdoc">For each CV, holds whether that CV has periodic boundaries or not. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00087">ABF.h:87</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ae88ce69e6e7fcb15b8db68d5530f6a1e"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ae88ce69e6e7fcb15b8db68d5530f6a1e">SSAGES::ABF::biases_</a></div><div class="ttdeci">std::vector&lt; Vector3 &gt; biases_</div><div class="ttdoc">Biases applied to atoms each timestep. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00116">ABF.h:116</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a7e2b1995149d50d1b1e9d05e6a44c1b6"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a7e2b1995149d50d1b1e9d05e6a44c1b6">SSAGES::ABF::restraint_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; restraint_</div><div class="ttdoc">Information for a harmonic restraint to keep CV in the region of interest. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00084">ABF.h:84</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a9f9514efb13e9a86b4557ae081274ce1"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">SSAGES::ABF::dim_</a></div><div class="ttdeci">unsigned int dim_</div><div class="ttdoc">Number of CVs in system. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00119">ABF.h:119</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a7df76c30aa32223fb74f3fbdb9202706"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a7df76c30aa32223fb74f3fbdb9202706">SSAGES::ABF::Fworld_</a></div><div class="ttdeci">std::vector&lt; Grid&lt; double &gt; * &gt; Fworld_</div><div class="ttdoc">Will hold the global total, synced across walkers at every time step. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00059">ABF.h:59</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ae223e09cc686522073fd881088edb8ac"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ae223e09cc686522073fd881088edb8ac">SSAGES::ABF::boundsCheck</a></div><div class="ttdeci">bool boundsCheck(const std::vector&lt; double &gt; &amp;CVs)</div><div class="ttdoc">Checks whether the local walker is within CV bounds. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8cpp_source.html#l00298">ABF.cpp:298</a></div></div>
<div class="ttc" id="namespaceSSAGES_html_a630084a0a5e185e89e21b3735f8f8b2e"><div class="ttname"><a href="namespaceSSAGES.html#a630084a0a5e185e89e21b3735f8f8b2e">SSAGES::Vector3</a></div><div class="ttdeci">Eigen::Vector3d Vector3</div><div class="ttdoc">Three-dimensional vector. </div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00033">types.h:33</a></div></div>
<div class="ttc" id="classSSAGES_1_1GridBase_html_a896d88442ef110a3afb58944e5107b53"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#a896d88442ef110a3afb58944e5107b53">SSAGES::GridBase::at</a></div><div class="ttdeci">const T &amp; at(const std::vector&lt; int &gt; &amp;indices) const </div><div class="ttdoc">Access Grid element read-only. </div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00394">GridBase.h:394</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a88322f13d3424be20d46cf68a3c8ce28"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a88322f13d3424be20d46cf68a3c8ce28">SSAGES::ABF::min_</a></div><div class="ttdeci">int min_</div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00101">ABF.h:101</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ae2306049903c2ed6e6fb07eaee71e9ae"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ae2306049903c2ed6e6fb07eaee71e9ae">SSAGES::ABF::Nworld_</a></div><div class="ttdeci">Grid&lt; int &gt; * Nworld_</div><div class="ttdoc">To store number of global hits at a given CV bin. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00073">ABF.h:73</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a85f39957134c0d27298aff5ad306cbd9"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a85f39957134c0d27298aff5ad306cbd9">SSAGES::ABF::periodicboundaries_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; periodicboundaries_</div><div class="ttdoc">Holds periodic boundaries of CVs. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00097">ABF.h:97</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1ABF_aa2200677359f582d73f095c42ec5ad83_cgraph.png" border="0" usemap="#classSSAGES_1_1ABF_aa2200677359f582d73f095c42ec5ad83_cgraph" alt=""/></div>
<map name="classSSAGES_1_1ABF_aa2200677359f582d73f095c42ec5ad83_cgraph" id="classSSAGES_1_1ABF_aa2200677359f582d73f095c42ec5ad83_cgraph">
<area shape="rect" id="node2" href="classSSAGES_1_1Snapshot.html#ae05879b78672cd4899a06ae2d6a140fd" title="Get number of atoms in this snapshot. " alt="" coords="259,5,456,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad2007ce8bb539072a97d4d02d268c638"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ABF::PostIntegration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *&#160;</td>
          <td class="paramname"><em>snapshot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;&#160;</td>
          <td class="paramname"><em>cvmanager</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Post-integration hook. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">snapshot</td><td>Current simulation snapshot. </td></tr>
    <tr><td class="paramname">cvmanager</td><td>Collective variable manager.</td></tr>
  </table>
  </dd>
</dl>
<p>Post-integration hook is where processes carried out every timestep happen. First, information from current snapshot is retrieved and stored in variables as necessary. Then, coordinates in CV space are determined. Then, for each CV, the time derivative of w.p is calculated. Then, information is printed out if its enabled. Finally, bias is applied from current estimate of generalized force. </p>
<p>Coord holds where we are in CV space in current timestep.</p>
<p>Eigen::MatrixXd to hold the CV gradient.</p>
<p>std::vector&lt;double&gt; to hold CV values to address grid. </p>

<p>Implements <a class="el" href="classSSAGES_1_1Method.html#af2f33dfaa758c5cd505477f4767fb339">SSAGES::Method</a>.</p>

<p>Definition at line <a class="el" href="ABF_8cpp_source.html#l00076">76</a> of file <a class="el" href="ABF_8cpp_source.html">ABF.cpp</a>.</p>

<p>References <a class="el" href="CVManager_8h_source.html#l00080">SSAGES::CVManager::GetCVs()</a>, <a class="el" href="Snapshot_8h_source.html#l00362">SSAGES::Snapshot::GetForces()</a>, <a class="el" href="Snapshot_8h_source.html#l00378">SSAGES::Snapshot::GetMasses()</a>, <a class="el" href="Snapshot_8h_source.html#l00200">SSAGES::Snapshot::GetNumAtoms()</a>, and <a class="el" href="Snapshot_8h_source.html#l00349">SSAGES::Snapshot::GetVelocities()</a>.</p>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        ++<a class="code" href="classSSAGES_1_1ABF.html#ac07e22498ef647ff94ad36d903a974be">iteration_</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">// Gather information.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keyword">auto</span> cvs = cvmanager.GetCVs(<a class="code" href="classSSAGES_1_1Method.html#a04e4b8b9ea8d154ae88f6cccf6c91700">cvmask_</a>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keyword">auto</span>&amp; vels = snapshot-&gt;GetVelocities();</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keyword">auto</span>&amp; mass = snapshot-&gt;GetMasses();</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keyword">auto</span>&amp; forces = snapshot-&gt;GetForces();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keyword">auto</span> n = snapshot-&gt;GetNumAtoms();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="comment">//int coord = histCoords(cvs);</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        Eigen::MatrixXd J(<a class="code" href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">dim_</a>, 3*n);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        std::vector&lt;double&gt; cvVals(<a class="code" href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">dim_</a>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="comment">// Fill J and CV. Each column represents grad(CV) with flattened Cartesian elements. </span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">dim_</a>; ++i)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keyword">auto</span>&amp; grad = cvs[i]-&gt;GetGradient();</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j)</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                J.block&lt;1, 3&gt;(i,3*j) = grad[j];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            cvVals[i] = cvs[i]-&gt;GetValue();</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">//* Calculate W using Darve&#39;s approach (http://mc.stanford.edu/cgi-bin/images/0/06/Darve_2008.pdf).</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        Eigen::MatrixXd Jmass = J.transpose();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1ABF.html#aa792d019aee0f614a2a0935405244e91">massweigh_</a>)</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; forces.size(); ++i)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                Jmass.block(3*i, 0, 3, dim_) = Jmass.block(3*i, 0, 3, dim_)/mass[i];</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        Eigen::MatrixXd Minv = J*Jmass;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        MPI_Allreduce(MPI_IN_PLACE, Minv.data(), Minv.size(), MPI_DOUBLE, MPI_SUM, <a class="code" href="classSSAGES_1_1Method.html#a1118666d61dbf3bc7606e3b61aa3a460">comm_</a>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        Eigen::MatrixXd Wt = Minv.inverse()*Jmass.transpose();  </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="comment">// Fill momenta.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        Eigen::VectorXd momenta(3*vels.size());</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; vels.size(); ++i)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            momenta.segment&lt;3&gt;(3*i) = mass[i]*vels[i];</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="comment">// Compute dot(w,p)</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        Eigen::VectorXd wdotp = Wt*momenta;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="comment">// Reduce dot product across processors.</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        MPI_Allreduce(MPI_IN_PLACE, wdotp.data(), wdotp.size(), MPI_DOUBLE, MPI_SUM, <a class="code" href="classSSAGES_1_1Method.html#a1118666d61dbf3bc7606e3b61aa3a460">comm_</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="comment">// Compute d(wdotp)/dt second order backwards finite difference. </span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">// Adding old force removes bias. </span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        Eigen::VectorXd dwdotpdt = <a class="code" href="classSSAGES_1_1ABF.html#a012104abf51fd7fe050a31fddc3c7180">unitconv_</a>*(1.5*wdotp - 2.0*<a class="code" href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">wdotp1_</a> + 0.5*<a class="code" href="classSSAGES_1_1ABF.html#a1a0082f17ab10382191cbf39046e7052">wdotp2_</a>)/<a class="code" href="classSSAGES_1_1ABF.html#a2c0bbf27d10f6f773a7215f5df4f78c9">timestep_</a> + <a class="code" href="classSSAGES_1_1ABF.html#a0158dff5be22bf287e22aab2eadd4e25">Fold_</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="comment">// If we are in bounds, sum force into running total.</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1ABF.html#ae223e09cc686522073fd881088edb8ac">boundsCheck</a>(cvVals))</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i&lt;<a class="code" href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">dim_</a>; ++i)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                <a class="code" href="classSSAGES_1_1ABF.html#a47453516b73e968060821c57d67b44ff">F_</a>[i]-&gt;at(cvVals) += dwdotpdt[i];</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <a class="code" href="classSSAGES_1_1ABF.html#a45daad9b41bac9009f1c2f09da10f58e">N_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a896d88442ef110a3afb58944e5107b53">at</a>(cvVals)++;               </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">// Reduce data across processors.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i&lt;<a class="code" href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">dim_</a>; ++i)                </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            MPI_Allreduce(<a class="code" href="classSSAGES_1_1ABF.html#a47453516b73e968060821c57d67b44ff">F_</a>[i]-&gt;data(), <a class="code" href="classSSAGES_1_1ABF.html#a7df76c30aa32223fb74f3fbdb9202706">Fworld_</a>[i]-&gt;data(), (<a class="code" href="classSSAGES_1_1ABF.html#a47453516b73e968060821c57d67b44ff">F_</a>[i]-&gt;size()), MPI_DOUBLE, MPI_SUM, <a class="code" href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">world_</a>); </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        MPI_Allreduce(<a class="code" href="classSSAGES_1_1ABF.html#a45daad9b41bac9009f1c2f09da10f58e">N_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a52e519b13f9b53c0767957d86015b0a1">data</a>(), <a class="code" href="classSSAGES_1_1ABF.html#ae2306049903c2ed6e6fb07eaee71e9ae">Nworld_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a52e519b13f9b53c0767957d86015b0a1">data</a>(), <a class="code" href="classSSAGES_1_1ABF.html#a45daad9b41bac9009f1c2f09da10f58e">N_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a7bde73c54b11d8841bc7710a5fc604bd">size</a>(), MPI_INT, MPI_SUM, <a class="code" href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">world_</a>);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="comment">// If we are in bounds, store the old summed force.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1ABF.html#ae223e09cc686522073fd881088edb8ac">boundsCheck</a>(cvVals))</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i &lt; <a class="code" href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">dim_</a>; ++i)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                <a class="code" href="classSSAGES_1_1ABF.html#a0158dff5be22bf287e22aab2eadd4e25">Fold_</a>[i] = <a class="code" href="classSSAGES_1_1ABF.html#a7df76c30aa32223fb74f3fbdb9202706">Fworld_</a>[i]-&gt;at(cvVals)/std::max(<a class="code" href="classSSAGES_1_1ABF.html#a88322f13d3424be20d46cf68a3c8ce28">min_</a>, <a class="code" href="classSSAGES_1_1ABF.html#ae2306049903c2ed6e6fb07eaee71e9ae">Nworld_</a>-&gt;<a class="code" href="classSSAGES_1_1GridBase.html#a896d88442ef110a3afb58944e5107b53">at</a>(cvVals));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="comment">// Update finite difference time derivatives.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#a1a0082f17ab10382191cbf39046e7052">wdotp2_</a> = <a class="code" href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">wdotp1_</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">wdotp1_</a> = wdotp;        </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="comment">// Write out data to file.</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1ABF.html#ac07e22498ef647ff94ad36d903a974be">iteration_</a> % <a class="code" href="classSSAGES_1_1ABF.html#acc2ac53b0342d31bce16cce64448830f">FBackupInterv_</a> == 0)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <a class="code" href="classSSAGES_1_1ABF.html#ab63434a1cefe80372e2555e1128e39d2">WriteData</a>();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="comment">// Calculate the bias from averaged F at current CV coordinates.</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">// Or apply harmonic restraints to return CVs back in bounds.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#aa2200677359f582d73f095c42ec5ad83">CalcBiasForce</a>(snapshot, cvs, cvVals);       </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="comment">// Update the forces in snapshot by adding in the force bias from each</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="comment">// CV to each atom based on the gradient of the CV.</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; forces.size(); ++j)</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            forces[j] += <a class="code" href="classSSAGES_1_1ABF.html#ae88ce69e6e7fcb15b8db68d5530f6a1e">biases_</a>[j];    </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a45daad9b41bac9009f1c2f09da10f58e"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a45daad9b41bac9009f1c2f09da10f58e">SSAGES::ABF::N_</a></div><div class="ttdeci">Grid&lt; int &gt; * N_</div><div class="ttdoc">To store number of local hits at a given CV bin. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00066">ABF.h:66</a></div></div>
<div class="ttc" id="classSSAGES_1_1Method_html_a1118666d61dbf3bc7606e3b61aa3a460"><div class="ttname"><a href="classSSAGES_1_1Method.html#a1118666d61dbf3bc7606e3b61aa3a460">SSAGES::Method::comm_</a></div><div class="ttdeci">mxx::comm comm_</div><div class="ttdoc">Local MPI communicator. </div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00047">Method.h:47</a></div></div>
<div class="ttc" id="classSSAGES_1_1Method_html_a8471b11097a1018a9635bc578bf22f61"><div class="ttname"><a href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">SSAGES::Method::world_</a></div><div class="ttdeci">mxx::comm world_</div><div class="ttdoc">Global MPI communicator. </div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00046">Method.h:46</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ab63434a1cefe80372e2555e1128e39d2"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ab63434a1cefe80372e2555e1128e39d2">SSAGES::ABF::WriteData</a></div><div class="ttdeci">void WriteData()</div><div class="ttdoc">Writes out data to file. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8cpp_source.html#l00235">ABF.cpp:235</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a012104abf51fd7fe050a31fddc3c7180"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a012104abf51fd7fe050a31fddc3c7180">SSAGES::ABF::unitconv_</a></div><div class="ttdeci">double unitconv_</div><div class="ttdoc">Unit Conversion Constant from W dot P to Force. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00158">ABF.h:158</a></div></div>
<div class="ttc" id="classSSAGES_1_1GridBase_html_a7bde73c54b11d8841bc7710a5fc604bd"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#a7bde73c54b11d8841bc7710a5fc604bd">SSAGES::GridBase::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdoc">Get the size of the internal storage vector. </div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00249">GridBase.h:249</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a47453516b73e968060821c57d67b44ff"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a47453516b73e968060821c57d67b44ff">SSAGES::ABF::F_</a></div><div class="ttdeci">std::vector&lt; Grid&lt; double &gt; * &gt; F_</div><div class="ttdoc">To store running total of the local walker. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00051">ABF.h:51</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_aa792d019aee0f614a2a0935405244e91"><div class="ttname"><a href="classSSAGES_1_1ABF.html#aa792d019aee0f614a2a0935405244e91">SSAGES::ABF::massweigh_</a></div><div class="ttdeci">bool massweigh_</div><div class="ttdoc">Mass weighing of bias enabled/disabled. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00113">ABF.h:113</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a0158dff5be22bf287e22aab2eadd4e25"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a0158dff5be22bf287e22aab2eadd4e25">SSAGES::ABF::Fold_</a></div><div class="ttdeci">Eigen::VectorXd Fold_</div><div class="ttdoc">To hold last iterations F_ value for removing bias. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00110">ABF.h:110</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ae88ce69e6e7fcb15b8db68d5530f6a1e"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ae88ce69e6e7fcb15b8db68d5530f6a1e">SSAGES::ABF::biases_</a></div><div class="ttdeci">std::vector&lt; Vector3 &gt; biases_</div><div class="ttdoc">Biases applied to atoms each timestep. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00116">ABF.h:116</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_aa2200677359f582d73f095c42ec5ad83"><div class="ttname"><a href="classSSAGES_1_1ABF.html#aa2200677359f582d73f095c42ec5ad83">SSAGES::ABF::CalcBiasForce</a></div><div class="ttdeci">void CalcBiasForce(const Snapshot *snapshot, const CVList &amp;cvs, const std::vector&lt; double &gt; &amp;cvVals)</div><div class="ttdoc">Computes the bias force. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8cpp_source.html#l00179">ABF.cpp:179</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a9f9514efb13e9a86b4557ae081274ce1"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">SSAGES::ABF::dim_</a></div><div class="ttdeci">unsigned int dim_</div><div class="ttdoc">Number of CVs in system. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00119">ABF.h:119</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a7df76c30aa32223fb74f3fbdb9202706"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a7df76c30aa32223fb74f3fbdb9202706">SSAGES::ABF::Fworld_</a></div><div class="ttdeci">std::vector&lt; Grid&lt; double &gt; * &gt; Fworld_</div><div class="ttdoc">Will hold the global total, synced across walkers at every time step. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00059">ABF.h:59</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ae223e09cc686522073fd881088edb8ac"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ae223e09cc686522073fd881088edb8ac">SSAGES::ABF::boundsCheck</a></div><div class="ttdeci">bool boundsCheck(const std::vector&lt; double &gt; &amp;CVs)</div><div class="ttdoc">Checks whether the local walker is within CV bounds. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8cpp_source.html#l00298">ABF.cpp:298</a></div></div>
<div class="ttc" id="classSSAGES_1_1Method_html_a04e4b8b9ea8d154ae88f6cccf6c91700"><div class="ttname"><a href="classSSAGES_1_1Method.html#a04e4b8b9ea8d154ae88f6cccf6c91700">SSAGES::Method::cvmask_</a></div><div class="ttdeci">std::vector&lt; uint &gt; cvmask_</div><div class="ttdoc">Mask which identifies which CVs to act on. </div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00050">Method.h:50</a></div></div>
<div class="ttc" id="classSSAGES_1_1GridBase_html_a896d88442ef110a3afb58944e5107b53"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#a896d88442ef110a3afb58944e5107b53">SSAGES::GridBase::at</a></div><div class="ttdeci">const T &amp; at(const std::vector&lt; int &gt; &amp;indices) const </div><div class="ttdoc">Access Grid element read-only. </div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00394">GridBase.h:394</a></div></div>
<div class="ttc" id="classSSAGES_1_1GridBase_html_a52e519b13f9b53c0767957d86015b0a1"><div class="ttname"><a href="classSSAGES_1_1GridBase.html#a52e519b13f9b53c0767957d86015b0a1">SSAGES::GridBase::data</a></div><div class="ttdeci">T * data()</div><div class="ttdoc">Get pointer to the internal data storage vector. </div><div class="ttdef"><b>Definition:</b> <a href="GridBase_8h_source.html#l00261">GridBase.h:261</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a88322f13d3424be20d46cf68a3c8ce28"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a88322f13d3424be20d46cf68a3c8ce28">SSAGES::ABF::min_</a></div><div class="ttdeci">int min_</div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00101">ABF.h:101</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_acc2ac53b0342d31bce16cce64448830f"><div class="ttname"><a href="classSSAGES_1_1ABF.html#acc2ac53b0342d31bce16cce64448830f">SSAGES::ABF::FBackupInterv_</a></div><div class="ttdeci">int FBackupInterv_</div><div class="ttdoc">Integer to hold F estimate backup information. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00149">ABF.h:149</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ae2306049903c2ed6e6fb07eaee71e9ae"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ae2306049903c2ed6e6fb07eaee71e9ae">SSAGES::ABF::Nworld_</a></div><div class="ttdeci">Grid&lt; int &gt; * Nworld_</div><div class="ttdoc">To store number of global hits at a given CV bin. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00073">ABF.h:73</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a1a0082f17ab10382191cbf39046e7052"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a1a0082f17ab10382191cbf39046e7052">SSAGES::ABF::wdotp2_</a></div><div class="ttdeci">Eigen::VectorXd wdotp2_</div><div class="ttdoc">To hold second to last iteration wdotp value for numerical derivative. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00107">ABF.h:107</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a2c0bbf27d10f6f773a7215f5df4f78c9"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a2c0bbf27d10f6f773a7215f5df4f78c9">SSAGES::ABF::timestep_</a></div><div class="ttdeci">double timestep_</div><div class="ttdoc">Timestep of integration. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00172">ABF.h:172</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ac07e22498ef647ff94ad36d903a974be"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ac07e22498ef647ff94ad36d903a974be">SSAGES::ABF::iteration_</a></div><div class="ttdeci">uint iteration_</div><div class="ttdoc">Iteration counter. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00175">ABF.h:175</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a7c882e37a3676cb3e33776621929c3b7"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">SSAGES::ABF::wdotp1_</a></div><div class="ttdeci">Eigen::VectorXd wdotp1_</div><div class="ttdoc">To hold last iteration wdotp value for numerical derivative. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00104">ABF.h:104</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1ABF_ad2007ce8bb539072a97d4d02d268c638_cgraph.png" border="0" usemap="#classSSAGES_1_1ABF_ad2007ce8bb539072a97d4d02d268c638_cgraph" alt=""/></div>
<map name="classSSAGES_1_1ABF_ad2007ce8bb539072a97d4d02d268c638_cgraph" id="classSSAGES_1_1ABF_ad2007ce8bb539072a97d4d02d268c638_cgraph">
<area shape="rect" id="node2" href="classSSAGES_1_1CVManager.html#a7317d7a4400d1c6ece08559f146dc049" title="Get CV iterator. " alt="" coords="293,5,456,46"/><area shape="rect" id="node3" href="classSSAGES_1_1Snapshot.html#a2533f7b900bc33185424eb94d6996edf" title="Access the per&#45;particle forces. " alt="" coords="270,71,479,97"/><area shape="rect" id="node4" href="classSSAGES_1_1Snapshot.html#a035ed6fb2cd46d4f66d1614bd90ad14b" title="Const access to the particle masses. " alt="" coords="267,121,482,148"/><area shape="rect" id="node5" href="classSSAGES_1_1Snapshot.html#ae05879b78672cd4899a06ae2d6a140fd" title="Get number of atoms in this snapshot. " alt="" coords="276,173,473,214"/><area shape="rect" id="node6" href="classSSAGES_1_1Snapshot.html#aeadc50cebd62e3fcbdc17511f781de19" title="Access the particle velocities. " alt="" coords="261,239,488,265"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a02fae49d009dcf405d82144a2d123faa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ABF::PostSimulation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *&#160;</td>
          <td class="paramname"><em>snapshot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;&#160;</td>
          <td class="paramname"><em>cvmanager</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Post-simulation hook. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">snapshot</td><td>Current simulation snapshot. </td></tr>
    <tr><td class="paramname">cvmanager</td><td>Collective variable manager. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classSSAGES_1_1Method.html#a7d18226669c88bc76b9b758f2d29e3c9">SSAGES::Method</a>.</p>

<p>Definition at line <a class="el" href="ABF_8cpp_source.html#l00174">174</a> of file <a class="el" href="ABF_8cpp_source.html">ABF.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#ab63434a1cefe80372e2555e1128e39d2">WriteData</a>();</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ab63434a1cefe80372e2555e1128e39d2"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ab63434a1cefe80372e2555e1128e39d2">SSAGES::ABF::WriteData</a></div><div class="ttdeci">void WriteData()</div><div class="ttdoc">Writes out data to file. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8cpp_source.html#l00235">ABF.cpp:235</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a27d1b2f056d32066d7c62a037836948c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ABF::PreSimulation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSSAGES_1_1Snapshot.html">Snapshot</a> *&#160;</td>
          <td class="paramname"><em>snapshot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const class <a class="el" href="classSSAGES_1_1CVManager.html">CVManager</a> &amp;&#160;</td>
          <td class="paramname"><em>cvmanager</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pre-simulation hook. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">snapshot</td><td>Current simulation snapshot. </td></tr>
    <tr><td class="paramname">cvmanager</td><td>Collective variable manager. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classSSAGES_1_1Method.html#a7d840d2b5f6dbf9ec75a7909ccf13ef7">SSAGES::Method</a>.</p>

<p>Definition at line <a class="el" href="ABF_8cpp_source.html#l00039">39</a> of file <a class="el" href="ABF_8cpp_source.html">ABF.cpp</a>.</p>

<p>References <a class="el" href="CVManager_8h_source.html#l00080">SSAGES::CVManager::GetCVs()</a>, and <a class="el" href="Snapshot_8h_source.html#l00323">SSAGES::Snapshot::GetPositions()</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="comment">// Open/close outfile to create it fresh. </span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">world_</a>.rank() == 0)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <a class="code" href="classSSAGES_1_1ABF.html#a528906f35295ab1a4bf7ed638fbd1973">worldout_</a>.open(<a class="code" href="classSSAGES_1_1ABF.html#a86e220cdd655537e95b97b97384b506a">filename_</a>);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <a class="code" href="classSSAGES_1_1ABF.html#a528906f35295ab1a4bf7ed638fbd1973">worldout_</a>.close();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="comment">// Convenience. Number of CVs.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keyword">auto</span> cvs = cvmanager.GetCVs(<a class="code" href="classSSAGES_1_1Method.html#a04e4b8b9ea8d154ae88f6cccf6c91700">cvmask_</a>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">dim_</a> = cvs.size();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="comment">// Size and initialize Fold_</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#a0158dff5be22bf287e22aab2eadd4e25">Fold_</a>.setZero(<a class="code" href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">dim_</a>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="comment">// Size and initialize Fworld_ and Nworld_      </span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keyword">auto</span> nel = 1;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="comment">// Initialize biases.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#ae88ce69e6e7fcb15b8db68d5530f6a1e">biases_</a>.resize(snapshot-&gt;GetPositions().size(), <a class="code" href="namespaceSSAGES.html#a630084a0a5e185e89e21b3735f8f8b2e">Vector3</a>{0, 0, 0});</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="comment">// Initialize w \dot p&#39;s for finite difference. </span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">wdotp1_</a>.setZero(<a class="code" href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">dim_</a>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="classSSAGES_1_1ABF.html#a1a0082f17ab10382191cbf39046e7052">wdotp2_</a>.setZero(<a class="code" href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">dim_</a>);  </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a86e220cdd655537e95b97b97384b506a"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a86e220cdd655537e95b97b97384b506a">SSAGES::ABF::filename_</a></div><div class="ttdeci">std::string filename_</div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00126">ABF.h:126</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a528906f35295ab1a4bf7ed638fbd1973"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a528906f35295ab1a4bf7ed638fbd1973">SSAGES::ABF::worldout_</a></div><div class="ttdeci">std::ofstream worldout_</div><div class="ttdoc">Output stream for F/N world data. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00122">ABF.h:122</a></div></div>
<div class="ttc" id="classSSAGES_1_1Method_html_a8471b11097a1018a9635bc578bf22f61"><div class="ttname"><a href="classSSAGES_1_1Method.html#a8471b11097a1018a9635bc578bf22f61">SSAGES::Method::world_</a></div><div class="ttdeci">mxx::comm world_</div><div class="ttdoc">Global MPI communicator. </div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00046">Method.h:46</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a0158dff5be22bf287e22aab2eadd4e25"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a0158dff5be22bf287e22aab2eadd4e25">SSAGES::ABF::Fold_</a></div><div class="ttdeci">Eigen::VectorXd Fold_</div><div class="ttdoc">To hold last iterations F_ value for removing bias. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00110">ABF.h:110</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ae88ce69e6e7fcb15b8db68d5530f6a1e"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ae88ce69e6e7fcb15b8db68d5530f6a1e">SSAGES::ABF::biases_</a></div><div class="ttdeci">std::vector&lt; Vector3 &gt; biases_</div><div class="ttdoc">Biases applied to atoms each timestep. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00116">ABF.h:116</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a9f9514efb13e9a86b4557ae081274ce1"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a9f9514efb13e9a86b4557ae081274ce1">SSAGES::ABF::dim_</a></div><div class="ttdeci">unsigned int dim_</div><div class="ttdoc">Number of CVs in system. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00119">ABF.h:119</a></div></div>
<div class="ttc" id="classSSAGES_1_1Method_html_a04e4b8b9ea8d154ae88f6cccf6c91700"><div class="ttname"><a href="classSSAGES_1_1Method.html#a04e4b8b9ea8d154ae88f6cccf6c91700">SSAGES::Method::cvmask_</a></div><div class="ttdeci">std::vector&lt; uint &gt; cvmask_</div><div class="ttdoc">Mask which identifies which CVs to act on. </div><div class="ttdef"><b>Definition:</b> <a href="Method_8h_source.html#l00050">Method.h:50</a></div></div>
<div class="ttc" id="namespaceSSAGES_html_a630084a0a5e185e89e21b3735f8f8b2e"><div class="ttname"><a href="namespaceSSAGES.html#a630084a0a5e185e89e21b3735f8f8b2e">SSAGES::Vector3</a></div><div class="ttdeci">Eigen::Vector3d Vector3</div><div class="ttdoc">Three-dimensional vector. </div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00033">types.h:33</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a1a0082f17ab10382191cbf39046e7052"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a1a0082f17ab10382191cbf39046e7052">SSAGES::ABF::wdotp2_</a></div><div class="ttdeci">Eigen::VectorXd wdotp2_</div><div class="ttdoc">To hold second to last iteration wdotp value for numerical derivative. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00107">ABF.h:107</a></div></div>
<div class="ttc" id="classSSAGES_1_1ABF_html_a7c882e37a3676cb3e33776621929c3b7"><div class="ttname"><a href="classSSAGES_1_1ABF.html#a7c882e37a3676cb3e33776621929c3b7">SSAGES::ABF::wdotp1_</a></div><div class="ttdeci">Eigen::VectorXd wdotp1_</div><div class="ttdoc">To hold last iteration wdotp value for numerical derivative. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00104">ABF.h:104</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classSSAGES_1_1ABF_a27d1b2f056d32066d7c62a037836948c_cgraph.png" border="0" usemap="#classSSAGES_1_1ABF_a27d1b2f056d32066d7c62a037836948c_cgraph" alt=""/></div>
<map name="classSSAGES_1_1ABF_a27d1b2f056d32066d7c62a037836948c_cgraph" id="classSSAGES_1_1ABF_a27d1b2f056d32066d7c62a037836948c_cgraph">
<area shape="rect" id="node2" href="classSSAGES_1_1CVManager.html#a7317d7a4400d1c6ece08559f146dc049" title="Get CV iterator. " alt="" coords="284,5,447,46"/><area shape="rect" id="node3" href="classSSAGES_1_1Snapshot.html#aee2ceb317884bc5e0105b9824b5026d3" title="Access the particle positions. " alt="" coords="254,71,477,97"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac206ccf90c29d11d6abdebeae44b033f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SSAGES::ABF::SetIteration </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iter</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set iteration of the method. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iter</td><td>New value for the iteration counter. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00269">269</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

<p>References <a class="el" href="ABF_8h_source.html#l00175">iteration_</a>.</p>
<div class="fragment"><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <a class="code" href="classSSAGES_1_1ABF.html#ac07e22498ef647ff94ad36d903a974be">iteration_</a> = iter;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        }           </div>
<div class="ttc" id="classSSAGES_1_1ABF_html_ac07e22498ef647ff94ad36d903a974be"><div class="ttname"><a href="classSSAGES_1_1ABF.html#ac07e22498ef647ff94ad36d903a974be">SSAGES::ABF::iteration_</a></div><div class="ttdeci">uint iteration_</div><div class="ttdoc">Iteration counter. </div><div class="ttdef"><b>Definition:</b> <a href="ABF_8h_source.html#l00175">ABF.h:175</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a47453516b73e968060821c57d67b44ff"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt;double&gt;*&gt; SSAGES::ABF::F_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>To store running total of the local walker. </p>
<p>This is a grid that holds dF/dCVx where x is one of the CVs. For N CVs, there will be N grids, and thus this vector will be N long. </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00051">51</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

</div>
</div>
<a class="anchor" id="acc2ac53b0342d31bce16cce64448830f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SSAGES::ABF::FBackupInterv_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Integer to hold F estimate backup information. </p>
<p>Print every how many timesteps? ; -1: Do not backup during simulation </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00149">149</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

</div>
</div>
<a class="anchor" id="a86e220cdd655537e95b97b97384b506a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SSAGES::ABF::filename_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>File name for world data. Principal output of the method. </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00126">126</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7df76c30aa32223fb74f3fbdb9202706"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt;double&gt;*&gt; SSAGES::ABF::Fworld_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Will hold the global total, synced across walkers at every time step. </p>
<p>This is a grid that holds dF/dCVx where x is one of the CVs. For N CVs, there will be N grids, and thus this vector will be N long. Global version. </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00059">59</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

</div>
</div>
<a class="anchor" id="a060acb9e57d66e702de14ff8a5d36ee6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; SSAGES::ABF::histdetails_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classSSAGES_1_1Histogram.html" title="Basic Histogram. ">Histogram</a> details. </p>
<p>This is a 2 Dimensional object set up as the following: Histdetails is a vector of (nr of CV) vectors, ordered in CV order. Each of those vectors are 3 long. First entry of each vector holds the lower bound for that CV. Second entry of each vector holds the upper bound for that CV. Third entry of each vector holds the nr of bins for that CV dimension. </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00143">143</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

</div>
</div>
<a class="anchor" id="a88322f13d3424be20d46cf68a3c8ce28"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SSAGES::ABF::min_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The minimum number of hits required before full biasing, bias is F_[i]/max(N_[i],min_). </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00101">101</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

</div>
</div>
<a class="anchor" id="a45daad9b41bac9009f1c2f09da10f58e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt;int&gt;* SSAGES::ABF::N_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>To store number of local hits at a given CV bin. </p>
<p>Stores the number of times each bin was visited in CV space. </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00066">66</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae2306049903c2ed6e6fb07eaee71e9ae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSSAGES_1_1Grid.html">Grid</a>&lt;int&gt;* SSAGES::ABF::Nworld_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>To store number of global hits at a given CV bin. </p>
<p>Stores the number of times each bin was visited in CV space. Global version. </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00073">73</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

</div>
</div>
<a class="anchor" id="a85f39957134c0d27298aff5ad306cbd9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; SSAGES::ABF::periodicboundaries_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds periodic boundaries of CVs. </p>
<p>This is a 2 Dimensional object set up as the following: periodicboundaries_ is a vector of (nr of CV) vectors, ordered in CV order. Each of those vectors are 2 long. First entry of each vector holds the lower bound for that CV periodic boundary. Second entry of each vector holds the upper bound for that CV periodic boundary. </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00097">97</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7e2b1995149d50d1b1e9d05e6a44c1b6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; SSAGES::ABF::restraint_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Information for a harmonic restraint to keep CV in the region of interest. </p>
<p>This is a 2 Dimensional object set up as the following: restraint_ is a vector of (nr of CV) vectors, ordered in CV order. Each of those vectors are 3 long. First entry of each vector holds the lower bound for that CV restraint. Second entry of each vector holds the upper bound for that CV restraint. Third entry of each vector holds the spring constant for that CV restraint. </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00084">84</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

</div>
</div>
<a class="anchor" id="a012104abf51fd7fe050a31fddc3c7180"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SSAGES::ABF::unitconv_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Unit Conversion Constant from W dot P to Force. </p>
<p>It is crucial that unit conversion is entered correctly. Unit conversion from d(momentum)/d(time) to force for the simulation. For LAMMPS using units real, this is 2390.06 (gram.angstrom/mole.femtosecond^2 -&gt; kcal/mole.angstrom) </p>

<p>Definition at line <a class="el" href="ABF_8h_source.html#l00158">158</a> of file <a class="el" href="ABF_8h_source.html">ABF.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/cody/SSAGES/src/Methods/<a class="el" href="ABF_8h_source.html">ABF.h</a></li>
<li>/home/cody/SSAGES/src/Methods/<a class="el" href="ABF_8cpp_source.html">ABF.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jul 14 2017 15:33:30 for SSAGES by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
