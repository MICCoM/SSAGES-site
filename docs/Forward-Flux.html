

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Forward-Flux &mdash; SSAGES 0.9.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Metadynamics" href="Metadynamics.html" />
    <link rel="prev" title="Finite Temperature String" href="Finite Temperature String.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> SSAGES
          

          
          </a>

          
            
            
              <div class="version">
                0.9.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Getting Started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Input Files.html">Input Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Engines.html">Engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="Collective Variables.html">Collective Variables</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Advanced Sampling Methods.html">Advanced Sampling Methods</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Adaptive Biasing Force Algorithm.html">Adaptive Biasing Force Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="Artificial Neural Network Sampling.html">Artificial Neural Network Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="Basis Function Sampling.html">Basis Function Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="Combined Force-Frequency Sampling.html">Combined Force-Frequency Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elastic Band.html">Elastic Band</a></li>
<li class="toctree-l2"><a class="reference internal" href="Finite Temperature String.html">Finite Temperature String</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Forward-Flux</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rate-constant-and-initial-flux">Rate Constant and Initial Flux</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rosenbluth-like-forward-flux-sampling-rbffs">Rosenbluth-like Forward Flux Sampling (RBFFS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#options-parameters">Options &amp; Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tutorial">Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="#developers">Developers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Metadynamics.html">Metadynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="Swarm of Trajectories.html">Swarm of Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="Umbrella Sampling.html">Umbrella Sampling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Write your own Methods and CVs.html">Write Your Own CVs and Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="Contribute to SSAGES.html">Contribute to SSAGES</a></li>
<li class="toctree-l1"><a class="reference internal" href="The SSAGES Cookbook.html">The SSAGES Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="Acknowledgements.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="zReferences.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="Copyright and License.html">Copyright and License Information</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SSAGES</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="Advanced Sampling Methods.html">Advanced Sampling Methods</a> &raquo;</li>
        
      <li>Forward-Flux</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Forward-Flux.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="forward-flux">
<span id="id1"></span><h1>Forward-Flux<a class="headerlink" href="#forward-flux" title="Permalink to this headline">¶</a></h1>
<p>Forward Flux Sampling (FFS) is an advanced sampling method to simulate
“rare events” in non-equilibrium and equilibrium systems. Several review
articles in the literature present a comprehensive perspective on the basics,
applications, implementations, and recent advances of FFS. Here, we provide a
brief general introduction to FFS, and describe the Rosenbluth-like variant of
forward flux method. We also explain various options and variables to setup
and run an efficient FFS simulation using SSAGES.</p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Rare events are ubiquitous in nature. Important examples include crystal
nucleation, earthquake formation, slow chemical reactions, protein
conformational changes, switching in biochemical networks, and translocation
through pores. The activated/rare process from a stable/metastable region A to
a stable/metastable region B is characterized by a long waiting time between
events, which is several orders of magnitude longer than the transition process
itself. This long waiting time typically arises due to the presence of a large
free energy barrier that the system has to overcome to make the transition from
one region to another. The outcomes of rare events are generally substantial
and thereby it is essential to obtain a molecular-level understanding of the
mechanisms and kinetics of these events.</p>
<p>“Thermal fluctuations” commonly drive the systems from an initial state to a
final state over an energy barrier <span class="math notranslate nohighlight">\(\Delta E\)</span>. The transition frequency
from state A to state B is proportional to <span class="math notranslate nohighlight">\(e^{\frac{-\Delta E}{k_{B}T}}\)</span>,
where <span class="math notranslate nohighlight">\(k_{B}T\)</span> is the thermal energy of the system. Accordingly, the time
required for an equilibrated system in state A to reach state B grows
exponentially (at a constant temperature) as the energy barrier <span class="math notranslate nohighlight">\(\Delta E\)</span>
become larger. Eventually, none or only a few transitions may occur within the
typical timescale of molecular simulations. In FFS method, several intermediate
states or so-called interfaces (<span class="math notranslate nohighlight">\(\lambda_{i}\)</span>) are placed along a
“reaction coordinate” or an “order parameter” between the initial state A and
the final state B (Figure 1). These intermediate states are chosen such that the
energy barrier between adjacent interfaces are readily surmountable using
typical simulations. Using the stored configurations at an interface, several
attempts are made to arrive at the next interface in the forward direction (the
order parameter must change monotonically when going from A to B). This
incremental progress makes it more probable to observe a full transition path
from state A to state B. FFS uses positive flux expression to calculate rate
constant. The system dynamics are integrated forward in time and therefore
detailed balance is not required.</p>
<div class="figure align-center" id="id7">
<img alt="Forward Flux Sampling setup" src="_images/forward_flux_image1.png" />
<p class="caption"><span class="caption-text">In the Forward Flux Sampling method, several intermediate states are placed
along the order parameter to link the initial state A and the final
state B. Incremental progress of the system is recorded and analyzed to
obtain relevant kinetic and thermodynamic properties.</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<p>Several protocols of Forward Flux Sampling have been adopted in the literature to</p>
<ol class="arabic simple">
<li><p>generate the intermediate configurations,</p></li>
<li><p>calculate the conditional probability of reaching state B starting from
state A, <span class="math notranslate nohighlight">\(P(\lambda_{B} = \lambda_{n} | \lambda_{A} = \lambda_{0})\)</span>,</p></li>
<li><p>compute various thermodynamic properties, and</p></li>
<li><p>optimize overall efficiency of the method <a class="bibtex reference internal" href="zReferences.html#allen2006194111" id="id2">[1]</a>.
The following are the widely-used variants of Forward Flux Sampling method:</p></li>
</ol>
<ul class="simple">
<li><p>Direct FFS (DFFS) (currently implemented in SSAGES)</p></li>
<li><p>Branched Growth FFS (BGFFS)</p></li>
<li><p>Rosenbluth-like FFS (RBFFS)</p></li>
<li><p>Restricted Branched Growth FFS (RBGFFS)</p></li>
<li><p>FFS Least-Squares Estimation (FFS-LSE)</p></li>
<li><p>FF Umbrella Sampling (FF-US)</p></li>
</ul>
</div>
<div class="section" id="rate-constant-and-initial-flux">
<h2>Rate Constant and Initial Flux<a class="headerlink" href="#rate-constant-and-initial-flux" title="Permalink to this headline">¶</a></h2>
<p>The overall rate constant or the frequency of going from state A to state B is
computed using the following equation:</p>
<div class="math notranslate nohighlight">
\[k_{AB} = \Phi_{A,0} \cdot P\left(\lambda_{N} \vert \lambda_{0}\right)\]</div>
<p>here, <span class="math notranslate nohighlight">\(\Phi_{A,0}\)</span> is the initial forward flux or the flux at the initial
interface, and <span class="math notranslate nohighlight">\(P\left(\lambda_{N} \vert \lambda_{0}\right)\)</span> is the
conditional probability of the trajectories that initiated from A and reached B
before returning to A. In practice, <span class="math notranslate nohighlight">\(\Phi_{A,0}\)</span> can be obtained by
simulating a single trajectory in State A for a certain amount of time
<span class="math notranslate nohighlight">\(t_{A}\)</span>, and counting the number of crossings of the initial interface
<span class="math notranslate nohighlight">\(\lambda_{0}\)</span>. Alternatively, a simulation may be carried out around state
A for a period of time until <span class="math notranslate nohighlight">\(N_{0}\)</span> number of accumulated
configurations is stored:</p>
<div class="math notranslate nohighlight">
\[\Phi_{A,0} = \frac{N_{0}}{t_{A}}\]</div>
<p>here, <span class="math notranslate nohighlight">\(N_{0}\)</span> is the number of instances in which <span class="math notranslate nohighlight">\(\lambda_{0}\)</span> is
crossed in forward direction, and <span class="math notranslate nohighlight">\(t_{A}\)</span> is the simulation time that the system was run around
state A. Note that</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\lambda_{0}\)</span> can be crossed in either forward
(<span class="math notranslate nohighlight">\(\lambda_{t} &lt; \lambda_{0}\)</span>) or backward
(<span class="math notranslate nohighlight">\(\lambda_{t} &gt; \lambda_{0}\)</span>) directions, but only “forward crossing”
marks a checkpoint (see Figure 2) and</p></li>
<li><p><span class="math notranslate nohighlight">\(t_{A}\)</span> should only include the simulation time around state A and
thereby the portion of time spent around state B must be excluded, if any.</p></li>
</ol>
<p>In general, the conditional probability is computed using the following expression:</p>
<div class="math notranslate nohighlight">
\[P\left(\lambda_{n} \vert \lambda_{0}\right) =
\prod\limits_{i=0}^{n-1} P\left(\lambda_{i+1} \vert \lambda_{i}\right) =
P\left(\lambda_{1}\vert\lambda_{0}\right) \cdot
P\left(\lambda_{2}\vert\lambda_{1}\right) \dots
P\left(\lambda_{n}\vert\lambda_{n-1}\right)\]</div>
<p><span class="math notranslate nohighlight">\(P\left(\lambda_{i+1}\vert\lambda_{i}\right)\)</span> is computed by initiating a
large number of trials from the current interface and recording the number of
successful trials that reaches the next interface. The successful trials in
which the system reaches the next interface are stored and used as
checkpoints in the next interface. The failed trajectories that go all the way
back to state A are terminated. Different flavors of forward flux method use
their unique protocol to select checkpoints to initiate trials at a given
interface, compute final probabilities, create transitions paths, and analyze
additional statistics.</p>
<div class="figure align-center" id="id8">
<img alt="Forward Flux Sampling initial flux" src="_images/forward_flux_image2.png" />
<p class="caption"><span class="caption-text">A schematic representation of computation of initial flux using a single
trajectory initiated in state A. The simulation runs for a certain period of
time <span class="math notranslate nohighlight">\(t_{A}\)</span> and number of forward crossing is recorded. Alternatively,
we can specify the number of necessary checkpoints <span class="math notranslate nohighlight">\(N_{0}\)</span> and run a
simulation until desired number of checkpoints are collected. In this figure,
green circles show the checkpoints that can be used to generate transition
paths.</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="rosenbluth-like-forward-flux-sampling-rbffs">
<h2>Rosenbluth-like Forward Flux Sampling (RBFFS)<a class="headerlink" href="#rosenbluth-like-forward-flux-sampling-rbffs" title="Permalink to this headline">¶</a></h2>
<p>Rosenbluth-like Forward Flux Sampling (RBFFS) method is an adaptation of
Rosenbluth method in polymer sampling to simulate rare events
<a class="bibtex reference internal" href="zReferences.html#rosenbluth1955356" id="id3">[19]</a>.
The RBFFS is comparable to Branched Growth Forward Flux (BGFFS)
<a class="bibtex reference internal" href="zReferences.html#allen2009463102" id="id4">[2]</a><a class="bibtex reference internal" href="zReferences.html#escobedo2009333101" id="id5">[7]</a> but,
in contrast to BGFFS, a single checkpoint is randomly selected at a non-initial
interface instead of initiation of trials from all checkpoints at a given
interface (Figure 3). In RBFFS, first a checkpoint at <span class="math notranslate nohighlight">\(\lambda_{0}\)</span> is
selected and <span class="math notranslate nohighlight">\(k_{0}\)</span> trials are initiated. The successful runs that reach
<span class="math notranslate nohighlight">\(\lambda_{1}\)</span> are stored. Next, one of the checkpoints at <span class="math notranslate nohighlight">\(\lambda_{1}\)</span> is randomly chosen (in
contrast to Branched Growth where all checkpoints are involved), and
<span class="math notranslate nohighlight">\(k_{1}\)</span> trials are initiated to <span class="math notranslate nohighlight">\(\lambda_{2}\)</span>. Last, this procedure
is continued for the following interfaces until state B is reached or all trials
fail. This algorithm is then repeated for the remaining checkpoints at
<span class="math notranslate nohighlight">\(\lambda_{0}\)</span> to generate multiple “transition paths”.</p>
<div class="figure align-center" id="id9">
<img alt="Rosenbluth-like Forward Flux Sampling" src="_images/forward_flux_image3.png" />
<p class="caption"><span class="caption-text">Rosenbluth-like Forward Flux Sampling (RBFFS) involves sequential generation
of unbranched transition paths from all available checkpoints at the first
interface <span class="math notranslate nohighlight">\(\lambda_{0}\)</span>. A single checkpoint at the interface
<span class="math notranslate nohighlight">\(\lambda_{i &gt; 0}\)</span>  is randomly marked and <span class="math notranslate nohighlight">\(k_{i}\)</span> trials are
initiated from that checkpoint which may reach to the next interface
<span class="math notranslate nohighlight">\(\lambda_{i+1}\)</span> (successful trials) or may return to state A (failed
trial).</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<p>In Rosenbluth-like forward flux sampling, we choose one checkpoint from each
interface independent of the number of successes. The number of available
checkpoints at an interface are not necessarily identical for different
transition paths <span class="math notranslate nohighlight">\(p\)</span>. This implies that more successful transition paths
are artificially more depleted than less successful paths. Therefore, we need to
enhance those extra-depleted paths by reweighting them during post-processing.
The weight of path <span class="math notranslate nohighlight">\(p\)</span> at the interface <span class="math notranslate nohighlight">\(\lambda_{i}\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[w_{i,b} = \prod\limits_{j=0}^{i-1} \frac{S_{j,p}}{k_{j}}\]</div>
<p>where <span class="math notranslate nohighlight">\(S_{j,p}\)</span> is the number of successes at the interface <span class="math notranslate nohighlight">\(j\)</span> for
path <span class="math notranslate nohighlight">\(p\)</span>. The conditional probability is then computed using the following
expression:</p>
<div class="math notranslate nohighlight">
\[P\left(\lambda_{n}\vert\lambda_{0}\right) =
\prod\limits_{i=0}^{n-1} P\left(\lambda_{i+1} \vert \lambda_{i}\right) =
frac{ \prod_{i=0}^{n-1}\sum_{p} w_{i,p} S_{i,p} / k_{i} }{ \sum_{p} w_{i,p} }\]</div>
<p>Here, the summation runs over all transition paths in the simulation.</p>
</div>
<div class="section" id="options-parameters">
<h2>Options &amp; Parameters<a class="headerlink" href="#options-parameters" title="Permalink to this headline">¶</a></h2>
<p>The notation used in SSAGES implementation of the FFS is mainly drawn from
Ref. <a class="bibtex reference internal" href="zReferences.html#allen2009463102" id="id6">[2]</a>. We recommend referring to this review article if
the user is unfamiliar with the terminology.</p>
<p>To run a DFFS simulation using SSAGES, an input file in JSON format is required
along with a general input file designed for your choice of molecular dynamics
engine (MD engine). For your convenience, two files <code class="docutils literal notranslate"><span class="pre">Template_Input.json</span></code> and
<code class="docutils literal notranslate"><span class="pre">FF_Input_Generator.py</span></code> are provided to assist you in generating the JSON
file. Here we describe the parameters and the options that should be set in
<code class="docutils literal notranslate"><span class="pre">Template_Input.json</span></code> file in order to successfully generate an input file and
run a DFFS simulation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The current implementation of FFS only accepts one CV.</p>
</div>
<p>The following parameters need to be set under <code class="docutils literal notranslate"><span class="pre">&quot;method&quot;</span></code> in the JSON input file:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;ForwardFlux&quot;</span>
</pre></div>
</div>
<p>The following options are available for Forward Flux Sampling:</p>
<dl class="simple">
<dt>flavor (required)</dt><dd><p>Specifies the flavor of the FFS method that SSAGES should run.
Available options: “DirectForwardFlux”</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, only DFFS has been implemented in SSAGES.
RBFFS and BGFFS will be available in the future releases.</p>
</div>
<dl class="simple">
<dt>trials (required)</dt><dd><p>Array of number of trials to be spawned from each interface. The length of
this array should match the length of the array of <code class="docutils literal notranslate"><span class="pre">interfaces</span></code>, or can
be left blank (<code class="docutils literal notranslate"><span class="pre">[]</span></code>) if defined in <code class="docutils literal notranslate"><span class="pre">FF_Input_Generator.py</span></code>.</p>
</dd>
<dt>interfaces (required)</dt><dd><p>Array of intermediate interfaces linking the initial state A to the final
state B. This array can either be defined in <code class="docutils literal notranslate"><span class="pre">Template_Input.json</span></code>
or <code class="docutils literal notranslate"><span class="pre">FF_Input_Generator.py</span></code>. In the latter case, the values of
<strong>interfaces</strong> is left blank in the <code class="docutils literal notranslate"><span class="pre">Template_Input.json</span></code> file.</p>
</dd>
<dt>nInterfaces (optional)</dt><dd><p>Total number of interfaces connecting the initial state A to
the final state B, inclusive. (Default: 5)</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Minimum of two interfaces must be defined.</p>
</div>
<dl>
<dt>N0Target (optional)</dt><dd><p>Number of configurations to be generated (or provided by user) at the
first interface. (Default: 100)</p>
</dd>
<dt>computeInitialFlux (optional)</dt><dd><p>Specifies whether a calculation of the initial flux should be performed.
If this parameter is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, SSAGES would also generate the
user-specified number of initial configurations (<code class="docutils literal notranslate"><span class="pre">N0Target</span></code>) at the first
interface. To compute the initial flux, user must provide an initial
configuration in state A, otherwise SSAGES would issue an error. If this
parameter is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>, the user must provide the necessary number
of the initial configurations in separate files. The files name and the
files content should follow a specific format. The format of the filenames
should be <code class="docutils literal notranslate"><span class="pre">l0-n&lt;n&gt;.dat</span></code> where &lt;n&gt; is the configuration number
(i.e. <code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">2</span></code>, …, <code class="docutils literal notranslate"><span class="pre">N0Target</span></code>).</p>
<p>The first line of the configuration files includes three numbers
<code class="docutils literal notranslate"><span class="pre">&lt;l&gt;</span> <span class="pre">&lt;n&gt;</span> <span class="pre">&lt;a&gt;</span></code>, where <code class="docutils literal notranslate"><span class="pre">&lt;l&gt;</span></code> is the interface number (set to zero here),
<code class="docutils literal notranslate"><span class="pre">&lt;n&gt;</span></code> is the configuration number, and <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;</span></code> is the attempt
number (set to zero here). The rest of the lines include the atoms IDs and
their corresponding values of positions and velocities, in the format
<code class="docutils literal notranslate"><span class="pre">&lt;atom</span> <span class="pre">ID&gt;</span> <span class="pre">&lt;x&gt;</span> <span class="pre">&lt;y&gt;</span> <span class="pre">&lt;z&gt;</span> <span class="pre">&lt;vx&gt;</span> <span class="pre">&lt;vy&gt;</span> <span class="pre">&lt;vz&gt;</span></code>
where &lt;atom ID&gt; is the ID of an atoms,
&lt;x&gt;, &lt;y&gt;, &lt;z&gt; are the coordinates of that atom,
and &lt;vx&gt;, &lt;vy&gt;, and &lt;vz&gt; are the components of the velocity in
the x, y, and z directions. Please note that the stored configurations at
other interfaces follow a similar format. (Default: <code class="docutils literal notranslate"><span class="pre">true</span></code>)</p>
</dd>
<dt>saveTrajectories (optional)</dt><dd><p>This flag determines if the FFS trajectories should be saved.
(Default: <code class="docutils literal notranslate"><span class="pre">true</span></code>)</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Saving trajectories of thousands of atoms may require large amount
of storage space.</p>
</div>
<dl class="simple">
<dt>currentInterface (optional)</dt><dd><p>Specifies the interface from which the calculations should start
(or continue). This parameter is helpful in restarting a FFS calculation
from interfaces other than the initial state A. (Default: 0)</p>
</dd>
<dt>outputDirectoryName (optional)</dt><dd><p>Specifies the directory name that contains the output of the FFS
calculations including the initial flux, the successful and failed
configurations, commitor probabilities, and the trajectories. The output
data related to the computation of the initial flux is stored in the file
<code class="docutils literal notranslate"><span class="pre">initial_flux_value.dat</span></code>, and the data related to transition probabilities
is stored in the file <code class="docutils literal notranslate"><span class="pre">commitor_probabilities.dat</span></code>. (Default: “FFSoutput”)</p>
</dd>
</dl>
</div>
<div class="section" id="tutorial">
<span id="ffs-tutorial"></span><h2>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h2>
<p>This tutorial will walk you step-by-step through the user example provided with
the SSAGES source code that runs the forward flux method on a Langevin particle
in a two-dimensional potential energy surface using LAMMPS. This example shows
how to prepare a multi-walker simulation (here we use 2 walkers). First, be
sure you have compiled SSAGES with LAMMPS. Then, navigate to the
<code class="docutils literal notranslate"><span class="pre">Examples/User/ForwardFlux/LAMMPS/Langevin</span></code> subdirectory. Now, take a moment
to observe the <code class="docutils literal notranslate"><span class="pre">in.LAMMPS_FF_Test_1d</span></code> file to familiarize
yourself with the system being simulated.</p>
<p>The next two files of interest are the <code class="docutils literal notranslate"><span class="pre">Template_Input.json</span></code> input file and
the <code class="docutils literal notranslate"><span class="pre">FF_Input_Generator.py</span></code> script. These files are provided to help setup
sophisticated simulations. Both of these files can be modified in your
text editor of choice to customize your input files, but for this tutorial,
simply observe them and leave them be. <code class="docutils literal notranslate"><span class="pre">FF_Template.json</span></code> contains all
information necessary to fully specify a walker; <code class="docutils literal notranslate"><span class="pre">FF_Input_Generator.py</span></code>
uses the information in this file and generates a new JSON along with necessary
LAMMPS input files. Issue the following command to generate the files:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python FF_Input_Generator.py
</pre></div>
</div>
<p>You will produce a file called <code class="docutils literal notranslate"><span class="pre">Input-2walkers.json</span></code> along with
<code class="docutils literal notranslate"><span class="pre">in.LAMMPS_FF_Test_1d-0</span></code> and <code class="docutils literal notranslate"><span class="pre">in.LAMMPS_FF_Test_1d-1</span></code>. You can also open
these files to verify for yourself that the script did what it was supposed to
do. Now, with your JSON input and your SSAGES binary, you have everything you
need to perform a simulation. Simply run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mpiexec -np <span class="m">2</span> ./ssages Input-2walkers.json
</pre></div>
</div>
<p>This should run a quick FFS calculation and generate the necessary output.</p>
</div>
<div class="section" id="developers">
<h2>Developers<a class="headerlink" href="#developers" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Joshua Lequieu</p></li>
<li><p>Hadi Ramezani-Dakhel</p></li>
<li><p>Benjamin Sikora</p></li>
<li><p>Vikram Thapar</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Metadynamics.html" class="btn btn-neutral float-right" title="Metadynamics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Finite Temperature String.html" class="btn btn-neutral float-left" title="Finite Temperature String" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, the SSAGES Team
      <span class="lastupdated">
        Last updated on Oct 13, 2020.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>