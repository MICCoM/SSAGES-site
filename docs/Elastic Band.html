

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Elastic Band &mdash; SSAGES 0.9.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Finite Temperature String" href="Finite Temperature String.html" />
    <link rel="prev" title="Combined Force-Frequency Sampling" href="Combined Force-Frequency Sampling.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> SSAGES
          

          
          </a>

          
            
            
              <div class="version">
                0.9.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Getting Started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Input Files.html">Input Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Engines.html">Engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="Collective Variables.html">Collective Variables</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Advanced Sampling Methods.html">Advanced Sampling Methods</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Adaptive Biasing Force Algorithm.html">Adaptive Biasing Force Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="Artificial Neural Network Sampling.html">Artificial Neural Network Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="Basis Function Sampling.html">Basis Function Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="Combined Force-Frequency Sampling.html">Combined Force-Frequency Sampling</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Elastic Band</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#options-parameters">Options &amp; Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tutorial">Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="#developer">Developer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Finite Temperature String.html">Finite Temperature String</a></li>
<li class="toctree-l2"><a class="reference internal" href="Forward-Flux.html">Forward-Flux</a></li>
<li class="toctree-l2"><a class="reference internal" href="Metadynamics.html">Metadynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="Swarm of Trajectories.html">Swarm of Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="Umbrella Sampling.html">Umbrella Sampling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Write your own Methods and CVs.html">Write Your Own CVs and Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="Contribute to SSAGES.html">Contribute to SSAGES</a></li>
<li class="toctree-l1"><a class="reference internal" href="The SSAGES Cookbook.html">The SSAGES Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="Acknowledgements.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="zReferences.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="Copyright and License.html">Copyright and License Information</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SSAGES</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="Advanced Sampling Methods.html">Advanced Sampling Methods</a> &raquo;</li>
        
      <li>Elastic Band</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Elastic Band.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="elastic-band">
<span id="id1"></span><h1>Elastic Band<a class="headerlink" href="#elastic-band" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>There are many methods, several of which are included in SSAGES, to calculate
transition pathways between metastable states. One kind of pathway between
states in the <em>Minimum Energy Pathway</em> (MEP), quite simply the lowest energy
pathway a system can take between these states. An MEP has the condition that
the force everywhere along the pathway points only along the path, that is, it
has no perpendicular component. By finding the MEP, one also finds the saddle
points of the potential energy surface, as they are by definition the maxima of
the MEP. The <em>Nudged Elastic Band</em> (NEB) method is a popular and efficient
method to calculate the MEP between the initial and final state of a transition
<a class="bibtex reference internal" href="zReferences.html#henkelman20009978" id="id2">[10]</a><a class="bibtex reference internal" href="zReferences.html#henkelman20009901" id="id3">[11]</a>.</p>
<p>The method involves the evolution of a series of images connected by a spring
interaction (hence the “elastic” nature of the band). The force acting on the
images (a combination of the spring force along the band and the true force
acting perpendicular to the band) is minimized to ensure convergence to the MEP.
The <strong>nudged</strong> nature of NEB refers to a force projection that ensures the
spring forces do not interfere with the elastic band converging to the MEP, as
well as that the true force does not alter the distribution of images along the
band (that is, it ensures all the images do not fall into the metastable states).
This projection is accomplished by using the parallel portion of the spring
force and the perpendicular portion of the true force. In this way, the spring
forces act similarly to reparameterization schemes common to the string method.</p>
<p>Full mathematical background is available in <a class="bibtex reference internal" href="zReferences.html#henkelman20009978" id="id4">[10]</a> and
<a class="bibtex reference internal" href="zReferences.html#henkelman20009901" id="id5">[11]</a>, but a brief overview is given here. The
band is discretized as a series of N+1 images, and the force on each image is
given by:</p>
<div class="math notranslate nohighlight">
\[F_{i} = F_{i,\parallel}^{s} - \nabla E(R_{i})_{\perp}\]</div>
<p>Where <span class="math notranslate nohighlight">\(F_{i}\)</span> is the total force on the image, <span class="math notranslate nohighlight">\(F_{i,\parallel}^{s}\)</span>
refers to the parallel component of the spring force on the
<span class="math notranslate nohighlight">\(i^\text{th}\)</span> image, and
<span class="math notranslate nohighlight">\(\nabla E(R_{i})_{\perp}\)</span> is the perpendicular component of the gradient
of the energy evaluated at each image <span class="math notranslate nohighlight">\(R_{i}\)</span>. The second term on the
right hand side is the “true force” and is evaluated as:</p>
<div class="math notranslate nohighlight">
\[\nabla E(R_{i})_{\perp} = \nabla E(R_{i}) - \nabla E(R_{i})\cdot\hat{\tau_{i}}\]</div>
<p>The term <span class="math notranslate nohighlight">\(\hat{\tau_{i}}\)</span> represents the normalized local tangent at the
<span class="math notranslate nohighlight">\(i^\text{th}\)</span> image, and thus this equation states simply that the perpendicular component
of the gradient is the full gradient minus the parallel portion of the gradient.
There are different schemes available in literature to evaluate the tangent
vector <a class="bibtex reference internal" href="zReferences.html#henkelman20009978" id="id6">[10]</a>. The “spring force” is calculated as:</p>
<div class="math notranslate nohighlight">
\[F_{i,\parallel}^{s} =
k \left( \lvert R_{i+1} - R_{i} \rvert -
         \lvert R_{i} - R_{i-1} \rvert \right) \hat{\tau_{i}}\]</div>
<p>Where <span class="math notranslate nohighlight">\(k\)</span> is the spring constant, which can be different for each image of
the band. One can evolve the images with these forces according to any number
of schemes - a straightforward Verlet integration scheme is used in the SSAGES
implementation, described below.</p>
<p>Algorithmically, the NEB method is implemented in SSAGES as follows:</p>
<ol class="arabic simple">
<li><p>An initial band is defined between the two states of interest. This can be
defined however one wishes; often it is simply a linear interpolation through
the space of the collective variables. In fact, the ends of the band need
not necessarily be in the basins of interest; the method should allow the
ends to naturally fall into nearby metastable basins.</p></li>
<li><p>For each image of the band, a molecular system with atomic coordinates that
roughly correspond to the collective variables of that image is constructed.
A period of equilibration is performed to ensure that the underlying systems’
CVs match their respective band images.</p></li>
<li><p>The gradient is sampled over a user-defined period of time and intervals,
this being the only quantity with statistical variance that needs to be
averaged over.</p></li>
<li><p>When sufficient sampling of the gradient is done, the band is updated one
time-step forward with a simple Verlet scheme.</p></li>
</ol>
<p>Steps 2–4 are iterated upon, leading to convergence of the method and the MEP.</p>
</div>
<div class="section" id="options-parameters">
<h2>Options &amp; Parameters<a class="headerlink" href="#options-parameters" title="Permalink to this headline">¶</a></h2>
<p>To construct an EB input file, the following options are available. A
complete EB JSON file will inherit some of its inputs from the String
schema (for parameters common to all string methods).
The options unique to EB are:</p>
<dl class="simple">
<dt>equilibration_steps</dt><dd><p>The number of MD steps to simply perform umbrella sampling without
invoking the NEB method. A sufficiently long number of steps ensures
that the underlying molecular systems have CVs close to the CVs of their
associated image on the band.</p>
</dd>
<dt>evolution_steps</dt><dd><p>The number of steps to perform the NEB over; the band is updated after
evolution steps times the number of samples total MD steps. A new value
of the gradient is harvested every time the number of MD steps taken is
an integer multiple of evolution steps.</p>
</dd>
<dt>kstring</dt><dd><p>The constant used in calculating the spring force at each image. It
can be specified uniquely for each image. Please notice its difference
from ksprings.</p>
</dd>
</dl>
<p>From the String schema, the options are:</p>
<dl class="simple">
<dt>type</dt><dd><p>This parameter identifies that a String-type method is being used, and
thus should be set to <code class="docutils literal notranslate"><span class="pre">&quot;String&quot;</span></code>.</p>
</dd>
<dt>flavor</dt><dd><p>This parameter identifies the specific kind of string-type method
being used; for EB, it should be set to <code class="docutils literal notranslate"><span class="pre">&quot;ElasticBand&quot;</span></code>.</p>
</dd>
<dt>centers</dt><dd><p>This parameter assigns a location in CV space for each individual image
along the string/elastic band. This should be an array with size equal to
the total number of images, with each entry consisting of an array with size
equal to the number of CVs used for the elastic band method.</p>
</dd>
<dt>tolerance</dt><dd><p>This is a tolerance threshold that can be set to trigger the end of
the method; it is a percentage by which, if no node CV changes by this
percentage, the method will end. It must be specified as an array with
one entry for each CV desired.</p>
</dd>
<dt>max_iterations</dt><dd><p>A complementary stopping criterion can be specified; the method will
stop if it undergoes this many iterations of the string method.</p>
</dd>
<dt>ksprings</dt><dd><p>A unique spring constant must be defined for each CV; its purpose is
described above.</p>
</dd>
<dt>frequency</dt><dd><p>The frequency of each integration step. This should almost always be
set to 1.</p>
</dd>
</dl>
</div>
<div class="section" id="tutorial">
<span id="eb-tutorial"></span><h2>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h2>
<p>This tutorial will walk you step by step through the user example provided with
the SSAGES source code that runs the NEB method on the alanine dipeptide using
LAMMPS. First, be sure you have compiled SSAGES with LAMMPS. Then, navigate to
the <code class="docutils literal notranslate"><span class="pre">Examples/User/ElasticBand/ADP</span></code> subdirectory. Now, take a moment
to observe the <code class="docutils literal notranslate"><span class="pre">in.ADP_Test</span> <span class="pre">and</span> <span class="pre">data.input</span></code> files in order to familiarize
yourself with the system being simulated.</p>
<p>The next two files of interest are the <code class="docutils literal notranslate"><span class="pre">Template_Input.json</span></code> input file and the
<code class="docutils literal notranslate"><span class="pre">Input_Generator.py</span></code> script. Both of these files can be modified in your
text editor of choice to customize the inputs, but for this tutorial, simply
observe them and leave them be. <code class="docutils literal notranslate"><span class="pre">Template_Input.json</span></code> contains all the information
necessary to fully specify one driver; <code class="docutils literal notranslate"><span class="pre">Input_Generator.py</span></code> copies this
information a number of times specified within the script (for this tutorial,
22 times) while also linearly interpolating through the start and end states
defined in the script and substituting the correct values into the “centers”
portion of the method definition. Execute this script as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python Input_Generator.py
</pre></div>
</div>
<p>You will produce a file called <code class="docutils literal notranslate"><span class="pre">ElasticBand.json</span></code>. You can also open this file to
verify for yourself that the script did what it was supposed to do. Now, with
your JSON input and your SSAGES binary, you have everything you need to perform
a simulation. Simply run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mpiexec -np <span class="m">22</span> ./ssages ElasticBand.json
</pre></div>
</div>
<p>Soon, the simulation will produce a <code class="docutils literal notranslate"><span class="pre">node-X.log</span></code> file for each driver, where
X is the number specifying the driver (in this case, 0-21 for our 22 drivers).
Each one will report the following information, in order: the node number, the
iteration number, and for each CV, the current value of the band CV as well as
the current value of the CV calculated from the molecular system.</p>
<p>Allow your system to run for the specified number of iterations (1000 for this
tutorial). The last line of every node file can be analyzed to view the last
positions of each image of the elastic band.</p>
</div>
<div class="section" id="developer">
<h2>Developer<a class="headerlink" href="#developer" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Benjamin Sikora</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Finite Temperature String.html" class="btn btn-neutral float-right" title="Finite Temperature String" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Combined Force-Frequency Sampling.html" class="btn btn-neutral float-left" title="Combined Force-Frequency Sampling" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, the SSAGES Team
      <span class="lastupdated">
        Last updated on Jun 11, 2020.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>