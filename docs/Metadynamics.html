

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Metadynamics &mdash; SSAGES 0.9.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Swarm of Trajectories" href="Swarm of Trajectories.html" />
    <link rel="prev" title="Forward-Flux" href="Forward-Flux.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> SSAGES
          

          
          </a>

          
            
            
              <div class="version">
                0.9.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Getting Started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Input Files.html">Input Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Engines.html">Engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="Collective Variables.html">Collective Variables</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Advanced Sampling Methods.html">Advanced Sampling Methods</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Adaptive Biasing Force Algorithm.html">Adaptive Biasing Force Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="Artificial Neural Network Sampling.html">Artificial Neural Network Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="Basis Function Sampling.html">Basis Function Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="Combined Force-Frequency Sampling.html">Combined Force-Frequency Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elastic Band.html">Elastic Band</a></li>
<li class="toctree-l2"><a class="reference internal" href="Finite Temperature String.html">Finite Temperature String</a></li>
<li class="toctree-l2"><a class="reference internal" href="Forward-Flux.html">Forward-Flux</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Metadynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#options-parameters">Options &amp; Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-input">Example Input</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output">Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tutorial">Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="#developer">Developer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Swarm of Trajectories.html">Swarm of Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="Umbrella Sampling.html">Umbrella Sampling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Write your own Methods and CVs.html">Write Your Own CVs and Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="Contribute to SSAGES.html">Contribute to SSAGES</a></li>
<li class="toctree-l1"><a class="reference internal" href="The SSAGES Cookbook.html">The SSAGES Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="Acknowledgements.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="zReferences.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="Copyright and License.html">Copyright and License Information</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SSAGES</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="Advanced Sampling Methods.html">Advanced Sampling Methods</a> &raquo;</li>
        
      <li>Metadynamics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Metadynamics.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="metadynamics">
<span id="id1"></span><h1>Metadynamics<a class="headerlink" href="#metadynamics" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Metadynamics defines a class of flat-histogram methods useful for
molecular dynamics simulations. Within metadynamics, a
history-dependent bias is accrued through the periodic application of
elemental Gaussian biases to the collective variables (CVs) of
interest. The form of the individual biases is</p>
<div class="math notranslate nohighlight">
\[g(\vec{\xi},\vec{s}_i) = W_i
e^{-\frac{\left[\vec{\xi}-\vec{s}_i\right]^2}{2\sigma_i^2}}\;.\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\vec{\xi}\)</span> is the collective variable, <span class="math notranslate nohighlight">\(\vec{s}_i\)</span> is
the location of the <span class="math notranslate nohighlight">\(i^\text{th}\)</span> hill, <span class="math notranslate nohighlight">\(W_i\)</span> is the weight and
<span class="math notranslate nohighlight">\(\sigma_i\)</span> the width of the hill. This bias acts to push the
system away from previously visited states. As this bias accrues to
the height of nearby features in the free energy surface, the system’s
trajectory will begin to explore an expanded area in CV space. After a
sufficient number of biases have been applied, the total applied bias
within a given region will begin to oscillate around the negative of
the free energy in that region.</p>
<p>The free energy surface (FES) at any time <span class="math notranslate nohighlight">\(t\)</span> may be
reconstructed by summing over all applied biases thusly</p>
<div class="math notranslate nohighlight">
\[F(\vec{\xi},t) = -V(\vec{\xi}) = -\sum_{i &lt; n(t)} W_i
e^{-\frac{\left[\vec{\xi}-\vec{s}_i\right]^2}{2\sigma_i^2}}\;.\]</div>
<p>Here, <span class="math notranslate nohighlight">\(n(t)\)</span> refers to the number of biases applied before time
<span class="math notranslate nohighlight">\(t\)</span>. The time-dependent FES can be used to determine whether or
not a simulation has reached a converged FES by computing block
averages of the applied bias (see <a class="bibtex reference internal" href="zReferences.html#singh2012369" id="id2">[23]</a>).</p>
<p>Metadynamics can be applied to unbounded regions of CV space, or to
bounded regions. For the case of bounded, non-periodic CVs, boundary
corrections must be applied which alter the structure of the hills
<span class="math notranslate nohighlight">\(g(\vec{\xi},\vec{s}_i)\)</span> (see <a class="bibtex reference internal" href="zReferences.html#mcgovern2013084102" id="id3">[16]</a>)</p>
<p>Metadynamics exists in many flavors, in which <span class="math notranslate nohighlight">\(W_i\)</span> and
<span class="math notranslate nohighlight">\(\sigma_i\)</span> are altered in a time- or trajectory- dependent
fashion. These include Well-Tempered Metadynamics, Transition-Tempered
Metadynamics and Metadynamics with Adaptive Gaussians. Each of these
methods has advantages and drawbacks. Currently, SSAGES includes only
standard Metadynamics with fixed-shape hills and no tempering
algorithm. Details on how to use these algorithms within SSAGES are
given in the following sections.</p>
</div>
<div class="section" id="options-parameters">
<h2>Options &amp; Parameters<a class="headerlink" href="#options-parameters" title="Permalink to this headline">¶</a></h2>
<p>Metadynamics is selected by defining <code class="docutils literal notranslate"><span class="pre">type&quot;</span> <span class="pre">:</span> <span class="pre">&quot;Metadynamics&quot;</span></code> as the
method in the JSON input file. It supports the following options:</p>
<dl class="simple">
<dt>widths</dt><dd><p><em>array of doubles (length: number of CVs)</em>.
This array defines the width of the Gaussians being deposited over time
in each CV dimension.</p>
</dd>
<dt>height</dt><dd><p><em>double</em>.
This value defines the height of the Gaussians being deposited over time,
in units of energy used by the MD engine.</p>
</dd>
<dt>hill_frequency</dt><dd><p><em>double</em>
This value defines the frequency in iterations with which the Gaussians
are deposited.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Metadynamics method does not yet support CV bounds.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Metadynamics method does not yet support restarts.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Metadynamics will run for the duration specified in the input files. It is
the user’s responsibility to ensure that enough time is given for
Metadynamics to obtain an satisfactory representation of the free energy
surface of interest. A simple way to prevent Metadynamics from terminating
before convergence is to define a very large number of timesteps and to
check the output file periodically for convergence.</p>
</div>
</div>
<div class="section" id="example-input">
<h2>Example Input<a class="headerlink" href="#example-input" title="Permalink to this headline">¶</a></h2>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;method&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;Metadynamics&quot;</span><span class="p">,</span>
        <span class="s2">&quot;widths&quot;</span><span class="o">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
        <span class="s2">&quot;height&quot;</span><span class="o">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s2">&quot;hill_frequency&quot;</span><span class="o">:</span> <span class="mi">1</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="output">
<h2>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<p>The output of Metadynamics is stored in a file called “hills.out”. This file
contains the location, width and height of each Gaussian that has been deposited
over time. Each time Gaussian is deposited, a new line is written to the file
in the following format:</p>
<p><em>center1 center2 … width1 width2 … height</em></p>
<p>The centers denote the locations in CV space where each Gaussian has been
deposited, listed in the order in which the CVs appear within the SSAGES JSON
input file. The widths denote the corresponding Gaussian widths for each CV
dimension. The height is the Gaussian height, which should match the parameter
height defined in the JSON input file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the widths and height of the Gaussian currently do not change in
time, future additions to the Metadynamics method will allow for adaptive
Gaussians.</p>
</div>
<p>Example MATLAB scripts are provided in the <code class="docutils literal notranslate"><span class="pre">Examples/User/Meta</span></code> directory.
These scripts sum the Gaussians and generate a free energy surface from
the “hills.out” file.</p>
</div>
<div class="section" id="tutorial">
<span id="metadynamics-tutorial"></span><h2>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h2>
<p>Two Metadynamics examples are included in the <code class="docutils literal notranslate"><span class="pre">Examples/User/Meta</span></code> directory.
In the first example, Metadynamics is used to sample the free energy surface of
a two-dimensional particle undergoing Langevin dynamics. This example is found in
the <code class="docutils literal notranslate"><span class="pre">Single_Atom</span></code> directory and uses LAMMPS.
The files included are described below:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">in.LAMMPS_Meta_Test</span></code>: LAMMPS input file describing the Langevin particle
and underlying free energy surface to be sampled. The free energy surface
consists of two Gaussian wells at (0.98, 0.98) and (-0.98, -0.98)
respectively, and one Gaussian barrier at the origin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Meta.json</span></code>: SSAGES JSON input file specifying Metadynamics and CVs to be
sampled. In this case the CVs are the <em>x</em> and <em>y</em> coordinates of the particle.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">analysis.m</span></code>: MATLAB script that analyzes the output of the Metadynamics
method.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Movie.m</span></code>: MATLAB script that generates a movie of the free energy
surface estimate over time.</p></li>
</ul>
<p>To run this example:</p>
<ol class="arabic simple">
<li><p>Either copy or create a symbolic link to the SSAGES executable in the
examples directory.</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ln -s /path/to/SSAGES/build/ssages
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Run the example by issuing the command below. Please note that in this
example, two walkers are used to explore the system more efficiently. If
you would like to use more walkers (1 processor per walker), simply include
more drivers in the <code class="docutils literal notranslate"><span class="pre">Meta.json</span></code> input file.</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mpirun -np <span class="m">2</span> ./ssages Meta.json
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>After the run is complete use the provided <code class="docutils literal notranslate"><span class="pre">analysis.m</span></code> or <code class="docutils literal notranslate"><span class="pre">analysis.py</span></code>
script to generate a representation of the underlying free energy surface using
MatLab or python (Matplotlib and numpy required).</p></li>
</ol>
</div>
<div class="section" id="developer">
<h2>Developer<a class="headerlink" href="#developer" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Hythem Sidky</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Swarm of Trajectories.html" class="btn btn-neutral float-right" title="Swarm of Trajectories" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Forward-Flux.html" class="btn btn-neutral float-left" title="Forward-Flux" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, the SSAGES Team
      <span class="lastupdated">
        Last updated on Oct 13, 2020.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>