

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Finite Temperature String &mdash; SSAGES 0.9.3 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Forward-Flux" href="Forward-Flux.html" />
    <link rel="prev" title="Elastic Band" href="Elastic%20Band.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> SSAGES
          

          
          </a>

          
            
            
              <div class="version">
                0.9.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Getting%20Started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Input%20Files.html">Input Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Engines.html">Engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="Collective%20Variables.html">Collective Variables</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Advanced%20Sampling%20Methods.html">Advanced Sampling Methods</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Adaptive%20Biasing%20Force%20Algorithm.html">Adaptive Biasing Force Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="Artificial%20Neural%20Network%20Sampling.html">Artificial Neural Network Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="Basis%20Function%20Sampling.html">Basis Function Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="Combined%20Force-Frequency%20Sampling.html">Combined Force-Frequency Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elastic%20Band.html">Elastic Band</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Finite Temperature String</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#options-parameters">Options &amp; Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tutorial">Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="#developers">Developers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Forward-Flux.html">Forward-Flux</a></li>
<li class="toctree-l2"><a class="reference internal" href="Metadynamics.html">Metadynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="Swarm%20of%20Trajectories.html">Swarm of Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="Umbrella%20Sampling.html">Umbrella Sampling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Write%20your%20own%20Methods%20and%20CVs.html">Write Your Own CVs and Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="Contribute%20to%20SSAGES.html">Contribute to SSAGES</a></li>
<li class="toctree-l1"><a class="reference internal" href="The%20SSAGES%20Cookbook.html">The SSAGES Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="Acknowledgements.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="zReferences.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="Copyright%20and%20License.html">Copyright and License Information</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SSAGES</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="Advanced%20Sampling%20Methods.html">Advanced Sampling Methods</a> &raquo;</li>
        
      <li>Finite Temperature String</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/Finite Temperature String.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="finite-temperature-string">
<span id="id1"></span><h1>Finite Temperature String<a class="headerlink" href="#finite-temperature-string" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Along with Nudged Elastic Band and Swarm of Trajectories, Finite Temperature
String Method (FTS) is a chain-of-states method. As in other chain-of-states
methods, multiple copies of a system are simulated, with each copy (“image”)
corresponding to a different state of the system along some proposed transition
pathway. In FTS, each image is associated with a node along a smooth curve
through in collective variable space, representing a transition pathway.</p>
<p>The goal of FTS is to evolve the path of this smooth curve or “string” until it
approximates a transition pathway by finding the <strong>principal curve</strong>, which by
definition intersects each of the perpendicular hyperplanes that it passes
through at the expected value of each hyperplane. As such, a principal curve is
often referred to as being its own expectation. Rather than sampling along each
hyperplane belonging to each node along the string, we use the Voronoi
approximation introduced by Vanden-Eijnden and Venturoli in 2009
<span id="id2">[<a class="reference internal" href="zReferences.html#id17">24</a>]</span>. We
associate each node along the string with a corresponding Voronoi cell,
consisting of the region in state space where any point is closer to its origin
node than any other node along the string. Each image is free to explore within
the bounds of its associated Voronoi cell. To evolve the string toward its own
expectation, the string is evolved toward the running averages in CV space for
each image along the string.</p>
<p>The evolution of the string can be broken down into the following steps:</p>
<ol class="arabic simple">
<li><p>Evolve the individual images with some dynamics scheme, using the location of
the initial image as a starting point. Only keep the new update at each time
step if it falls within the Voronoi cell of its associated image; if the
updated position leaves the Voronoi cell, the system is returned back to the
state at the previous timestep.</p></li>
<li><p>Keep track of a running average of locations visited in CV space for each
image.</p></li>
<li><p>Update each node on the string toward the running average while keeping the
path smooth; specific equations can be found in
<span id="id3">[<a class="reference internal" href="zReferences.html#id17">24</a>]</span>.</p></li>
<li><p>Enforce parametrization (e.g. interpolate a smooth curve through the new node
locations, and redistribute the nodes to new locations along the smooth curve
such that there is equal arc length between any two adjacent nodes).</p></li>
<li><p>After images have been moved, their respective Voronoi cells have also
changed. Check that each image still falls within the new Voronoi cell of its
associated image. If the image is no longer in the correct Voronoi cell, the
system must be returned to the Voronoi cell.</p></li>
<li><p>Return to step 1 and repeat until convergence (i.e. until change in the string
falls below some tolerance criteria or stop iterating after a certain number
of string method iterations)</p></li>
</ol>
</div>
<div class="section" id="options-parameters">
<h2>Options &amp; Parameters<a class="headerlink" href="#options-parameters" title="Permalink to this headline">¶</a></h2>
<p>The following parameters need to be set under <code class="docutils literal notranslate"><span class="pre">&quot;method&quot;</span></code> in the JSON input file:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;String&quot;</span>
<span class="s2">&quot;flavor&quot;</span> <span class="o">:</span> <span class="s2">&quot;FTS&quot;</span>
</pre></div>
</div>
<p>The following options are available as FTS inputs:</p>
<dl class="simple">
<dt>centers (required)</dt><dd><p>Array containing this image’s coordinates in CV space.</p>
</dd>
<dt>ksprings (required)</dt><dd><p>Array of spring constants corresponding to each CV.
Used to ensure that each simulation remains within its own respective
Voronoi cell.</p>
</dd>
<dt>block_iterations (required)</dt><dd><p>Number of integration steps to perform before updating the string.
(Default: 2000)</p>
</dd>
<dt>time_step (required)</dt><dd><p>Parameter used for updating the string.
(<span class="math notranslate nohighlight">\(\Delta\tau\)</span> in <span id="id4">[<a class="reference internal" href="zReferences.html#id17">24</a>]</span>).
(Default: 0.1)</p>
</dd>
<dt>kappa (required)</dt><dd><p>Parameter used for smoothing the string.
(<span class="math notranslate nohighlight">\(\kappa\)</span> in <span id="id5">[<a class="reference internal" href="zReferences.html#id17">24</a>]</span>).
(Default: 0.1)</p>
</dd>
<dt>frequency (required)</dt><dd><p>Frequency to perform integration; should almost always be set to 1.</p>
</dd>
<dt>max_iterations (required)</dt><dd><p>Maximum number of string method iterations to perform.</p>
</dd>
<dt>tolerance (required)</dt><dd><p>Array of tolerance values corresponding to each CV. Simulation will stop
after tolerance criteria has been met for all CVs.</p>
</dd>
<dt>iteration</dt><dd><p>Value of initial string method iterator.
(Default: 0)</p>
</dd>
</dl>
</div>
<div class="section" id="tutorial">
<span id="fts-tutorial"></span><h2>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h2>
<p>Two examples for running FTS can be found in the <code class="docutils literal notranslate"><span class="pre">Examples/User/FTS</span></code>
directory. This tutorial will go through running FTS on a 2D single particle
system, using LAMMPS as the MD engine. The necessary files are found in
<code class="docutils literal notranslate"><span class="pre">Examples/User/FTS/2D_Particle</span></code>, which should contain the following:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">in.LAMMPS_2DParticle</span></code></dt><dd><p>LAMMPS input file; sets up 1 particle on a 2D surface with two Gaussian
wells of different depths (at <span class="math notranslate nohighlight">\((-0.98, -0.98)\)</span> and
<span class="math notranslate nohighlight">\((0.98, 0.98)\)</span>) and one Gaussian barrier at the origin.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Template_Input.json</span></code></dt><dd><p>Template JSON input containing information for one image on the string. We
are looking at two CVs: x and y coordinates. We will use
<code class="docutils literal notranslate"><span class="pre">Input_Generator.py</span></code> to use this template to create a JSON input file
containing information for all string images.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Input_Generator.py</span></code></dt><dd><p>Python script for creating FTS JSON input file.</p>
</dd>
</dl>
<p>After compiling SSAGES with LAMMPS, we will use <code class="docutils literal notranslate"><span class="pre">Input_Generator.py</span></code> to
create a JSON input file for FTS. Run this script</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python Input_Generator.py
</pre></div>
</div>
<p>to create a file called <code class="docutils literal notranslate"><span class="pre">FTS.json</span></code>. A string with 16 images is initalized on
the 2D surface, evenly spaced on a straight line from <span class="math notranslate nohighlight">\((-0.98, -0.68)\)</span> to
<span class="math notranslate nohighlight">\((0.98, 1.28)\)</span>. If you take a look at <code class="docutils literal notranslate"><span class="pre">FTS.json</span></code>, you will see that the
location of each image along the string has been appended to the <code class="docutils literal notranslate"><span class="pre">&quot;centers&quot;</span></code>
field. These center locations are listed from one end of the string to the
other; the first center listed corresponds to one end of the string, and the
final center listed corresponds to the opposite end of the string.</p>
<p>Once <code class="docutils literal notranslate"><span class="pre">FTS.json</span></code> has been generated, we can run the example with the following
command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mpiexec -np <span class="m">16</span> ./ssages FTS.json
</pre></div>
</div>
<p>As SSAGES runs, a series of output files are generated:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">log.lammps</span></code></dt><dd><p>Output from LAMMPS.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">node-00xx.log</span></code></dt><dd><p>FTS output for each of the 16 nodes on the string. The first column contains
the image number (0-15). The second column contains the iteration number. The
remaining columns list the location of the image and the instantaneous value
for each of the CVs. For this example we have two CVs (x coordinate and y
coordinate), so the remaining columns are (from left to right): x coordinate
of the string node, instantaneous x coordinate of the particle, y coordinate
of the string node, instantaneous y coordinate of the particle.</p>
</dd>
</dl>
<p>To visualize the string, we can plot the appropriate values from the last line
of each <code class="docutils literal notranslate"><span class="pre">node-00xx.log</span></code> file. For example, one can quickly plot the final
string using gnuplot with the command</p>
<div class="highlight-gnuplot notranslate"><div class="highlight"><pre><span></span><span class="k">plot</span> <span class="s">&quot;&lt; tail -n 1 node*&quot;</span> <span class="nb">u</span> <span class="mi">3</span><span class="o">:</span><span class="mi">5</span>
</pre></div>
</div>
<p>The following image shows the initial string in blue, compared with the final
string plotted in green:</p>
<div class="figure align-center">
<img alt="_images/2dsingle.png" src="_images/2dsingle.png" />
</div>
<p>The two ends of the string have moved to the two energy minima (at
<span class="math notranslate nohighlight">\((-0.98, -0.98)\)</span> and <span class="math notranslate nohighlight">\((0.98, 0.98)\)</span>), and the center of the string
has curved away from the energy barrier at the origin.</p>
</div>
<div class="section" id="developers">
<h2>Developers<a class="headerlink" href="#developers" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Ashley Guo</p></li>
<li><p>Benjamin Sikora</p></li>
<li><p>Yamil J. Colón</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Forward-Flux.html" class="btn btn-neutral float-right" title="Forward-Flux" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Elastic%20Band.html" class="btn btn-neutral float-left" title="Elastic Band" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018, the SSAGES Team.
      <span class="lastupdated">
        Last updated on Jun 04, 2021.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>